http://www.infomaps.gov.sk.ca/website/SIR_Geological_Atlas/viewer.htm
Geological atlas of Saskatchewan
Saskatchewan Energy and Resources

UPDATE sources.saskatchewan set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike period;
UPDATE sources.saskatchewan set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike era and early_id IS NULL;
UPDATE sources.saskatchewan set late_id=early_id;
UPDATE sources.saskatchewan set early_id=259, late_id=258 where era like 'Meso to Paleoproterozoic';
UPDATE sources.saskatchewan set early_id=m.id, late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike eon and early_id IS NULL;
UPDATE sources.saskatchewan set early_id=132, late_id=259 where eon like 'Archean / Proterozoic' and early_id IS NULL;
UPDATE sources.saskatchewan set early_id=132, late_id=259 where eon IS NULL and early_id IS NULL;
UPDATE sources.saskatchewan set group_=concat(group_, ' Gp') where group_ is not null;
UPDATE sources.saskatchewan set formation=concat(formation, ' Fm') where formation is not null;
UPDATE sources.saskatchewan set member=concat(member, ' Mbr') where member is not null;
UPDATE sources.saskatchewan set formation=replace(formation, '/', ' Fm; ')  where formation ilike '%/%';
update sources.saskatchewan set lithostrat=concat(member, ' of ', formation, ' of ', group_) where member is not null and group_ is not null;
update sources.saskatchewan set lithostrat=concat(formation, ' of ', group_) where formation is not null and group_ is not null and lithostrat IS NULL;
update sources.saskatchewan set lithostrat=formation where formation is not null and group_ is null and lithostrat IS NULL;
update sources.saskatchewan set lithostrat=group_ where group_ is not null and formation is null and lithostrat IS NULL;
update sources.saskatchewan set name=lithostrat where lithostrat is not null;
update sources.saskatchewan set name=rock_type where name is null;
update sources.saskatchewan set age=period where period IS NOT NULL;
	update sources.saskatchewan set age=era where era IS NOT NULL and age is null;
		update sources.saskatchewan set age=eon where age is null;
			update sources.saskatchewan set age='Precambrian' where age is null;
update sources.saskatchewan set age=concat(m.interval_name, '-', l.interval_name) from

####
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,lith,t_interval,b_interval,geom) SELECT gid,9,name,lithostrat,age,rock_type,late_id,early_id,st_makevalid(geom) FROM sources.saskatchewan

########## manitoba
update sources.manitoba set epoch=replace(epoch, 'Upper', 'Late');
update sources.manitoba set epoch=replace(epoch, 'Lower', 'Early');

update sources.manitoba set epoch=NULL where epoch like 'NULL';
	update sources.manitoba set era=NULL where era like 'NULL';
		update sources.manitoba set period=NULL where period like 'NULL';
UPDATE sources.manitoba set age = concat(epoch, ' ', period) where epoch in ('Late','Early','Middle');
update sources.manitoba set age = epoch where epoch like 'Paleocene';
update sources.manitoba set age	= period where age is null and period is not null;
update sources.manitoba set age= era where age is null and era is not null;
update sources.manitoba set age= eon where age is null and eon is not null;
update sources.manitoba set age='Jurassic' where age like 'Jurrasic';
UPDATE sources.manitoba set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike age;
UPDATE sources.manitoba set early_id=132 where age like'Archean and Inferred Archean';
update sources.manitoba set late_id=early_id;
update sources.manitoba set subunit_mod=subunit;
update sources.manitoba set subunit_mod=NULL where subunit_mod in ('PHANEROZOIC','UNDIFF');
update sources.manitoba set subunit_mod=NULL where subunit_mod='NULL';
update sources.manitoba set unit_mod = concat(unit,'; ', subunit_mod) where subunit_mod IS NOT NULL;
update sources.manitoba set unit_mod=unit where unit_mod is null;
update sources.manitoba set unit_descr_mod=REPLACE(unit_descr, unit_code,'');
update sources.manitoba set unit_descr_mod=lower(trim(unit_descr_mod);
update sources.manitoba set unit_descr_mod=replace(unit_descr_mod,'24b','');

INSERT INTO maps.medium (orig_id,source_id,name, descrip, comments, age,lith, t_interval,b_interval, geom) SELECT gid, 10, lithotec, unit_mod, province, age, unit_descr_mod, late_id, early_id, st_makevalid(geom) FROM sources.manitoba;

pg_dump -t sources.manitoba -C -O burwell | gzip > ~/Desktop/manitoba.sql.gz


############## australia2 #################
update sources.australia2 set early_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike concat(m.interval_name, '%');
update sources.australia2 set late_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike concat('% to ',m.interval_name);
update sources.australia2 set late_id=early_id where late_id IS NULL;
update sources.australia2 set name=rtrim(name,'0123456789');
UPDATE sources.australia2 set late_id=90 where geolhist ilike '% to Early Carboniferous';

INSERT INTO maps.small (orig_id,source_id,name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,11,name,geolhist,lithology,descr,morphology, late_id,early_id,st_makevalid(geom) FROM sources.australia2

pg_dump -t bgs_lexicon -C -O burwell | gzip > ~/Desktop/bgs_lexicon.sql.gz


insert into maps.map_liths select small.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=45 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');


############# africa

update sources.africa set early_id=NULL, late_id=NULL;

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Q' and interval_name='Quaternary';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Qe' and interval_name='Holocene';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Qp' and interval_name='Pleistocene';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='QT' and interval_name='Cenozoic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='T' and interval_name='Tertiary';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Mz' and interval_name='Mesozoic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='TK' and interval_name='Cretaceous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='TK' and interval_name='Paleogene';

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='K' and interval_name='Cretaceous';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Kl' and interval_name='Early Cretaceous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='KJ' and interval_name='Cretaceous';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='KJ' and interval_name='Jurassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='J' and interval_name='Jurassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Jl' and interval_name='Early Jurassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='JTr' and interval_name='Triassic';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='JTr' and interval_name='Jurassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Tr' and interval_name='Triassic';

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Trl' and interval_name='Early Triassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='MzPz' and interval_name='Paleozoic';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='MzPz' and interval_name='Mesozoic';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='MzPz' and interval_name='Cretaceous';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='MzPz' and interval_name='Carboniferous';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='KC' and interval_name='Carboniferous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='KC' and interval_name='Cretaceous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='JC' and interval_name='Jurassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='JC' and interval_name='Carboniferous';

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Pz' and interval_name='Paleozoic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='P' and interval_name='Permian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='TrP' and interval_name='Permian';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='TrP' and interval_name='Triassic';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='PC' and interval_name='Carboniferous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='PC' and interval_name='Permian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='C' and interval_name='Carboniferous';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='CD' and interval_name='Carboniferous';

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='CD' and interval_name='Devonian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='D' and interval_name='Devonian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Du' and interval_name='Middle Devonian';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Du' and interval_name='Late Devonian';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='DS' and interval_name='Devonian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='DS' and interval_name='Silurian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='S' and interval_name='Silurian';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='SO' and interval_name='Silurian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='SO' and interval_name='Ordovician';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='O' and interval_name='Ordovician';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='OCm' and interval_name='Ordovician';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='OCm' and interval_name='Cambrian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='Cm' and interval_name='Cambrian';

update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='pCm' and interval_name='Precambrian';
update sources.africa set early_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='PzpC' and interval_name='Precambrian';
update sources.africa set late_id=m.id,lith='sedimentary' FROM macrostrat.intervals m WHERE glg='PzpC' and interval_name='Paleozoic';


update sources.africa set early_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='Qv' and interval_name='Quaternary';
update sources.africa set early_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='Ti' and interval_name='Tertiary';
update sources.africa set early_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='Mi' and interval_name='Mesozoic';
update sources.africa set late_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='MiPi' and interval_name='Mesozoic';
update sources.africa set early_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='MiPi' and interval_name='Paleozoic';
update sources.africa set early_id=m.id,lith='igneous' FROM macrostrat.intervals m WHERE glg='Pi' and interval_name='Paleozoic';

update sources.africa set late_id=early_id WHERE late_id IS NULL;


################ newzealand
UPDATE sources.newzealand set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike geolhist and early_id IS NULL;
update sources.newzealand set early_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike concat(m.interval_name,' %') and early_id IS NULL;
update sources.newzealand set late_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike concat('% to ',m.interval_name) and late_id IS NULL;
update sources.newzealand set early_id=134, late_id=223 where geolhist='Middle Permian to Late Permian';
update sources.newzealand set early_id=134, late_id=63 where geolhist='Middle Permian to Triassic';
update sources.newzealand set early_id=63, late_id=63 where geolhist='?Triassic';
update sources.newzealand set early_id=90, late_id=90 where geolhist='Early Carboniferous';
update sources.newzealand set early_id=75, late_id=63 where geolhist='?Permian to Triassic';
update sources.newzealand set early_id=4, late_id=4 where geolhist='Early Quaternary';
update sources.newzealand set early_id=4, late_id=4 where geolhist='Middle Quaternary';
update sources.newzealand set early_id=275, late_id=275 where geolhist='?Paleozoic or ?Early Cretaceous';
update sources.newzealand set early_id=421, late_id=421 where geolhist ilike '%Quaternary%' and early_id IS NULL;
update sources.newzealand set late_id=90 where geolhist like '% to Early Carboniferous';
update sources.newzealand set late_id=33 where geolhist like '% to Middle Cretaceous';
update sources.newzealand set late_id=75 where geolhist like '% to Middle Permian';
update sources.newzealand set late_id=4 where geolhist like '% to Early Quaternary';

update sources.newzealand set strat_name=concat(sgrpequiv,'; ',name) where name=grpequiv and (typename='lithostratigraphic unit' or typename='lithotectonic unit');
update sources.newzealand set strat_name=concat(sgrpequiv,'; ',grpequiv,'; ',name) where typename='lithostratigraphic unit' or typename='lithotectonic unit' and strat_name IS NULL;
update sources.newzealand set strat_name=sgrpequiv where strat_name IS NULL and sgrpequiv is not null;
update sources.newzealand set strat_name=trim(both, ';', from strat_name);
	 ; Anita Shear Zone gneiss and mylonite

INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,12,name,strat_name,geolhist,lithology,descr, simplename , late_id,early_id,st_makevalid(geom) FROM sources.newzealand

pg_dump -t gmus.lookup_units -C -O geomacro > ~/Desktop/lookup_units.sql


#################### newzealandq
update sources.newzealandq set old_age=abs_max;
update sources.newzealandq set young_age=abs_min;
update sources.newzealandq set dur=old_age-young_age;
update sources.newzealandq set young_age=abs_max, old_age=abs_min where dur<0;

update sources.newzealandq set early_id=NULL;
update sources.newzealandq set late_id=NULL;


update sources.newzealandq set early_id=m.id from macrostrat.intervals m WHERE old_age>m.age_top and old_age<=m.age_bottom and m.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=1);
update sources.newzealandq set early_id=3 where young_age=0 and early_id IS NULL;
update sources.newzealandq set early_id=3 where young_age<.05 and early_id IS NULL;
update sources.newzealandq set early_id=4 where young_age<2 and early_id IS NULL;



update sources.newzealandq set late_id=m.id from macrostrat.intervals m WHERE young_age>=m.age_top and young_age<m.age_bottom and m.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=1)

update sources.newzealandq set early_id=m.id from macrostrat.intervals m WHERE old_age>m.age_top and old_age<=m.age_bottom and m.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=3) and early_id IS NULL;
update sources.newzealandq set late_id=m.id from macrostrat.intervals m WHERE young_age>=m.age_top and young_age<m.age_bottom and m.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=3) and late_id IS NULL;

update sources.newzealandq set early_id=m.id from macrostrat.intervals m WHERE old_age>m.age_top and old_age<=m.age_bottom and m.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=3) and early_id IS NULL;

update sources.newzealandq set lith=concat('Major:: {',main_rock, '}') where main_rock IS NOT NULL;
update sources.newzealandq set lith=concat(lith, ',Minor:: {',replace(sub_rocks,';',','), '}') where sub_rocks IS NOT NULL;
update sources.newzealandq set age_name=concat(l.interval_name,' - ', t.interval_name) from macrostrat.intervals l, macrostrat.intervals t where early_id=l.id and late_id=t.id and early_id!=late_id;

update sources.newzealandq set age_name=l.interval_name from macrostrat.intervals l where early_id=l.id and early_id=late_id;
#update sources.newzealandq set strat_name=key_name;
#update sources.newzealandq set strat_name=replace(key_name,')',concat(' of ', spgrp_eqiv,')')) where spgrp_eqiv IS NOT NULL;
update sources.newzealandq set confidence='stratigraphic inference' where confidence='Stratigraphic inference';
update sources.newzealandq set comments=sim_name;
update sources.newzealandq set comments=concat(comments, '. Age based on ',confidence) where confidence is not null;

# need to fix strat_name: set to NULL everything that does not contain a proper name
update sources.newzealandq set strat_name=concat_ws('; ', terr_eqiv, spgrp_eqiv, grp_eqiv, sbgrp_eqiv,fmn_eqiv,mbr_eqiv)

pg_dump -t sources.newzealandq -C -O burwell | gzip > ~/Desktop/newzealandq.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,13,key_name,strat_name,age_name,lith,descr,comments, late_id,early_id,st_makevalid(geom) FROM sources.newzealandq


###### edits to fix bad ages in gmus
###### edits to fix bad ages in gmus
update sources.gmus set late_id=131 where early_id=132 and late_id=24;
update maps.medium set t_interval=131 where b_interval=132 and t_interval=24 and source_id=8;

select distinct unit_age,e.interval_name,e.id,l.interval_name,l.id from sources.gmus m join macrostrat.intervals e on early_id=e.id join macrostrat.intervals l on late_id=l.id;

update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (2-24 Ma)' and e.interval_name='Oligocene' and l.interval_name='Pliocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (2.5-3.5 Ma)' and e.interval_name='Pliocene' and l.interval_name='Pliocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (3-4 Ma)' and e.interval_name='Pliocene' and l.interval_name='Pliocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (3-7 Ma)' and e.interval_name='Miocene' and l.interval_name='Pliocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (4-22 Ma)' and e.interval_name='Miocene' and l.interval_name='Pliocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (7.5-9.5 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (8-12 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (8-25 Ma)' and e.interval_name='Oligocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (8-25 Ma; most near 15)' and e.interval_name='Oligocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (8-28 Ma)' and e.interval_name='Oligocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (9.5-13 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (12-19 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (12-15 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (14-16 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (14-18 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (16-18 Ma)' and e.interval_name='Miocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Tertiary (22-24 Ma)' and e.interval_name='Oligocene' and l.interval_name='Miocene';
update sources.gmus set early_id=e.id, late_id=l.id from macrostrat.intervals e, macrostrat.intervals l WHERE unit_age='Early Proterozoic to Miocene' and e.interval_name='Proterozoic' and l.interval_name='Proterozoic';

update maps.medium set t_interval=late_id,b_interval=early_id from sources.gmus where orig_id=gid and source_id=8

########################################################################################################################
########################################################################################################################
########################################################################################################################
############################## HIGH RESOLUTION IMPORT

### manually had to update all units with descriptions from PDF include in GIS data download
update sources.utquad_cedarcity set descrip='Poorly to moderately sorted silt, sand, and gravel deposited by streams, sheetwash, debris flows, and flash floods on coalesced proximal alluvial fans and pediments; surface is well dissected by modern and older streams; where mapped northeast of Table Butte in the Escalante Desert, unit ranges from above to below the level of the Lake Bonneville shoreline and contains overlying sand and gravel that may represent a crows-foot delta or bars of a mixed shoreline and lagoonal environment; above the level of the shoreline it has been locally eroded by floods; maximum thickness at least 100 feet (30 m).' where unitsymbol='QTafp3';

update sources.utquad_cedarcity set early_id=m.id,late_id=m.id from macrostrat.intervals m WHERE age=interval_name;
update sources.utquad_cedarcity set early_id=63,late_id=48 where age='Triassic-Jurrasic';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,14,unitname,age,descrip,concat_ws('; ',notes,changes),late_id,early_id,st_makevalid(geom) FROM sources.utquad_cedarcity

#utquad_eastslc source_id=15
update sources.utquad_eastslc set descrip='Moderate-red to reddish-brown and olive to dark-olive-green shale and siltstone containing thin lenticular quartzite and arkose beds. About 300 m thick.' where unitsymbol='Yum';
update sources.utquad_eastslc set descrip='Moderate-red to grayish-red and reddish-brown, pebbly, arkosic sandstone and feldspathic shale and siltstone. More than 730 m thick. Intertongues with Dead Horse Pass unit of Wallace (1972).' where unitsymbol='Yuc';
update sources.utquad_eastslc set descrip='Pink to red, fine- to medium- grained quartzite and arkosic quartzite. Some beds of olive to dark-olive-green and, locally, reddish-brown shale and siltstone. Includes the Mount Agassiz unit of Wallace (1972). About 900 m thick. Intertongues with Mount Wilson unit of Wallace (1972).' where unitsymbol='Yud';
update sources.utquad_eastslc set descrip='Thick-bedded, yellowish-gray to grayish-white, lithic arkose and fine-grained quartzite containing thin, lenticular, olive-drab shale and siltstone beds. About 1,000 m thick.' where unitsymbol='Yuw';
update sources.utquad_eastslc set descrip='Grayish-red, brownish-red, and whitish- gray quartz sandstone, arkose, and shale containing thick moderate-red lenticular shale beds on the northern side and thin discontinuous olive-drab shale beds on the southern side of the Uinta Moun- tains. Thickness 1,800-3,000 m.' where unitsymbol='Yuh';
update sources.utquad_eastslc set descrip='Grayish-black to olive-drab siltstone and shale containing thin discontinuous beds of quartzite and arkose. Contains much sandstone and conglomerate between Stillwater Fork and West Fork of Blacks Fork. Maximum thickness about 1,800 m north of Castle Peak in the western Uinta Mountains. Whole rock Rb-Sr age 952 Ma (Crittenden and Peterman, 1975).' where unitsymbol='Yur';
update sources.utquad_eastslc set descrip='Limestone with pink mottling, sandy yellowish-gray limestone, pinkish-gray limestone, grayish-red sandstone, and coarse-grained sandstone overlying yellowish-brown glauconitic sandstone containing green shale interbeds and shaly sandstone above quartzite. The lower two units resemble the Lodore Formation mapped in Dinosaur National Monument 100 km to the east. About 140 m thick.' where unitsymbol='Cu';
update sources.utquad_eastslc set descrip='Occurs as dikes 2-6 m thick south and southeast of Gilbert Peak in the Uinta Mountains in northeastern part of quadrangle. Whole rock K-Ar age 552 ± 21 Ma (Ritzma, 1983).' where unitsymbol='Cd';
update sources.utquad_eastslc set descrip='Medium- to thick-bedded; fine- to coarse-grained; white, pale-yellowish-gray, or pale-reddish-brown quartzite. Conglomeratic beds in lowest 100 m. Thickness 250-300 m in Wasatch Range. As much as 100 m is locally preserved below pre-Late Devonian unconformity around Uinta Mountains. Is Early Cambrian in Charleston thrust sheet (Baker, 1973) and Early and Middle Cambrian in autochthonous section of the Cottonwood uplift (Bromfield and others, 1970). Inferred to be Middle Cambrian in the Uinta Mountains.' where unitsymbol='Ct';
update sources.utquad_eastslc set descrip='Fine- to coarse-grained, dark-gray dolomite and limestone; abundant gray and white chert in some beds. Dark- to light-gray, thin- to medium- bedded, fossiliferous limestone near base. At base in many places in the western part of the Uinta Mountains are a few meters of dolomite underlain by dolomitic shale and sandstone, and conglom- erate, which correlate with the lower part of the Fitchville Formation and the Pinyon Peak Limestone of Late Devonian age (Spreng, 1979). As much as 300 m thick.' where unitsymbol='Mm';
update sources.utquad_eastslc set descrip='Medium-gray thin-bedded limestone containing pods of dark-gray to black chert and abundant fossils. A zone from 10- to 30-m-thick of black, greenish, or locally reddish shale at the base contains thin beds of greenish-gray to rusty-weathering silty limestone. Basal black shale contains thin beds of dark-gray limestone and rusty-weathering sandstone in the Uinta Mountains. About 130 m thick in Wasatch Range and 60-90 m in Uinta Mountains.' where unitsymbol='Mdh';
update sources.utquad_eastslc set descrip='Medium- to dark-gray limestone and dolomite, and limestone breccia containing beds of reddish-brown to yellowish-gray, brown-weathering sandstone and sparse interbeds of red siltstone. Thickness 100-280 m.' where unitsymbol='Mh';
update sources.utquad_eastslc set descrip='Morgan Formation (Middle Pennsylvanian) – Grayish-red calcareous siltstone and silty limestone; light-greenish-gray siltstone; grayish-red or reddish-brown sandstone; gray fossiliferous limestone containing gray, yellowish-gray, reddish-brown, or pinkish-orange chert; and white to light-gray sandstone. Contact with overlying Weber Quartzite gradational. About 100 m thick. Round Valley Limestone (Lower Pennsylvanian) – Light-gray-weathering, gray to dark-gray, fossiliferous limestone containing gray and reddish-gray chert and interbeds of gray and light-green shale and siltstone, grayish-red silty shale, and sandstone and sandy limestone. Pale-reddish-orange silicified fossils characteristic. Thickness 130 m in Wasatch Range and 60 m on the north side of the Uinta Mountains.' where unitsymbol='IPmr';
update sources.utquad_eastslc set descrip='Pale-yellowish-gray to white crossbedded quartzite and calcareous sandstone and a few beds of light-gray to white limestone and dolomite. Large-scale crossbedding prominent in upper part in eastern half of quadrangle. The top of the Weber is entirely of Middle Pennsylvanian age in the Wasatch Range (Van Horn and Critten- den, 1987), but Permian (Wolfcampian) foraminifera occur in the uppermost part of the formation in the Uinta Mountains (Bissell, 1964). Thickness generally from 300 to 500 m; ranges from 150 to 750 m south of City Creek Canyon, where attenuated by bedding faults and thickened by folding or fault repetition; and is 600 m east of head of American Fork Canyon.' where unitsymbol='PIPw';
update sources.utquad_eastslc set descrip='Fossiliferous and cherty, gray to pinkish-gray limestone, calcareous siltstone, and cherty sandstone containing, in the middle, a dark-gray phosphatic shale (Meade Peak Phosphatic Shale Member of Phosphoria Formation). Upper part contains about 30 m of moderate-red siltstone and mudstone, reddish-brown and pale-red sandstone and subordinate cherty limestone (the Mackentire Tongue of the Phosphoria Formation of Williams, 1939) in the Lake Fork River and Burnt Fork areas. Thickness 100 m in eastern part of the quadrangle and 700 m on Hobble Creek in southeastern part.' where unitsymbol='Pp';
update sources.utquad_eastslc set descrip='Moderate-red and reddish-brown siltstone and yellowish- gay and pinkish-gray sandstone. Partial section 200 m thick exposed in Burnt Fork area in northeastern corner of quadrangle.' where unitsymbol='TRm';
update sources.utquad_eastslc set descrip='Grayish-red, grayish-purple, reddish-brown, and moderate- red shale, siltstone, and fine-grained sandstone, and thin white limestone beds that grade to grayish-red siltstone. Locally a few tens of meters of green or greenish-gray shale and siltstone, at the base, is a tongue of the Dinwoody Formation. White, gray, and greenish-gray beds of shale, siltstone, and limestone in the upper part in the eastern part of the quadrangle south of the Uinta Mountains represent interbeds of and gradation into the Thaynes Limestone. Thickness 120 m north of Red Butte Canyon, 300 m near Park City, and 200-300 m along flanks of Uinta Mountains.' where unitsymbol='TRw';
update sources.utquad_eastslc set descrip='Light-gray, thin- to thick-bedded limestone, brownish-gray siltstone, and subordinate light-gray sandstone, pale-red silty limestone, light-gray shaly limestone, and dark-greenish-gray siltstone and shale. In eastern part of quadrangle, interfingers and intergrades with nonmarine redbeds above and below. At Lake Fork River, unit consists of thin- to medium-bedded sandstone, siltstone, and limestone in the lower part, and gray to light-reddish- brown mudstone, shale, siltstone and subordinate beds of limestone and gypsum in the upper part. Thickness 600 m north of Emigration Canyon and 110 m at Lake Fork River on the south side of the Uinta Mountains.' where unitsymbol='TRt';
update sources.utquad_eastslc set descrip='Upper member (Upper Triassic) – Moderate-red, grayish-red, and grayish-purple mudstone and fine-grained sandstone. Thickness about 210 m in the Wasatch Range and 90-115 m in the Uinta Mountains.
	Gartra Member (Upper Triassic) – White to pale-purple, massive, crossbedded, coarse-grained to pebbly quartzite. Thickness as much as 70 m in Wasatch Range; 8-30 m in Uinta Mountains.
Mahogany Member (Lower Triassic) – Purplish-gray and pale-red sandstone, mudstone, and a few thin limestone beds. Thickness 215-305 m.' where unitsymbol='TRa';
update sources.utquad_eastslc set descrip='Pale-grayish-orange fine-grained sandstone, and white quartz sandstone. Planar bedded in lower part, crossbedded in upper part. Becomes whiter and more entirely crossbeddedin the eastern part of quadrangle. Thickness 400 m in Parleys Canyon area, 280 m near Peoa, and 180-210 m along south flank of the Uinta Mountains.' where unitsymbol='JTRn';
update sources.utquad_eastslc set descrip='Thin- to medium-bedded gray, light-gray, and purplish- gray limestone containing some beds of grayish-red to brown siltstone and sandstone. Thickness 850 m near Parleys Canyon and 400 m near Peoa. Thins eastward along south flank of Uintas to 125 m at Lake Fork River where it contains shale, especially in lower part.' where unitsymbol='Jtc';
update sources.utquad_eastslc set descrip='Stump Formation – 45 to 67 m thick.
Redwater Member (Upper Jurassic) – Light- to dark-gray-green shale; greenish gray siltstone; and light-gray, white, dark-greenish-gray and brown limestone and glauconite sandstone.
Curtis Member (Middle Jurassic) – Greenish-gray and white, fine-grained calcareous and glauco- nite sandstone; in Currant Creek area, white, pink, red, dark-red, and pale-lavender limestone and sandy limestone; gray shale locally in upper part.
Preuss Sandstone (Middle Jurassic) – Reddish-brown, grayish-red, light-red, and moderate-red silty sandstone, sandstone, and silty shale. Contains anhydrite and salt in the subsurface in the Chalk Creek and East Canyon graben areas (Lamerson, 1982) where it is locally thickened tectonically. About 300 m thick in the Wasatch Range. Thins eastward along the south flank of the Uinta Moun- tains from 240 m to 135 m at Lake Fork River.' where unitsymbol='Jsp';
update sources.utquad_eastslc set descrip='White, medium-grained sandstone; light-reddish-brown sandstone, calcareous sandstone, and sandy siltstone; light-pinkish-gray sandy limestone; gray nodular limestone; variegated mudstone and siltstone, and gray conglomerate containing chert and quartzite pebbles as much as 10 cm in diameter. Mapped south and southwest of the Uinta Mountains. Thickness from 355 to 810 m; thins eastward.' where unitsymbol='KJc';
update sources.utquad_eastslc set descrip='Gray shale, and yellowish-gray sandstone. North of Uinta Mountains, near Moffit Pass, unit contains siliceous shale and coal and correlates with lower member of Frontier Formation (Kfl) and Aspen Shale (Ka). West of Bald Knoll, southwest of the Uinta Mountains, and east of Beaver Creek in the northeastern corner of the quadrangle, correlates with Mesaverde Formation (Kmu) and (or) Frontier Member of the Mancos Shale (Kmf).' where unitsymbol='Ku';
update sources.utquad_eastslc set descrip='Lower member of Mancos Shale (Lower Cretaceous) – Dark-gray sandy to silty shale, 25 m thick; 3-5 m of siliceous black shale containing teleost fish scales, which is the local equivalent of the Aspen or Mowry Shale of Early Cretaceous age; in the Red Creek area, black shale 95 m thick. Total thickness 110-130 m.
Dakota Sandstone (Lower Cretaceous) – White to light gray, medium- to coarse-grained, crossbed- ded, locally pebbly sandstone in two units separated by gray, black, pink and greenish-gray shale. Total thickness from 45 to 70 m.' where unitsymbol='Kmd';
update sources.utquad_eastslc set descrip='White and light-yellowish gray to light-yellowish-brown, fine- to coarse-grained, locally pebbly, cross-bedded sandstone, mudstone, siltstone, and coal. From 135 to 230 m thick; thins and intertongues with shale to the east.' where unitsymbol='Kmf';
update sources.utquad_eastslc set descrip='Medium- to dark-gray and bluish-gray shale and a few beds of gray shaly limestone and calcareous shaly sandstone. Thickens from 500 m to 800 m, from west to east, along the south flank of the Uinta Mountains.' where unitsymbol='Kmu';
update sources.utquad_eastslc set descrip='White, light-gray, and yellowish-gray sandstone; gray siltstone; and dark-gray carbonaceous shale and coal. Iron-oxide-rich concretions in some beds; sandstone crossbedded in part. Crops out on south side of the Uinta Mountains. In the Red Creek- Currant Creek area in south-central part of quadrangle, lower 250 m contains some beds with marine fossils. Lenticular coal beds as much as 5 m thick in upper part of formation at Red Creek. In the Red Creek-Currant Creek area, pollen characteristic of the Chatangiella Interval Zone and the Proteacidites refusus Interval Zone and megafossils (Pleuriocardia subcurtum) indicate that the Mesaverde is Coniacian to Santonian in age (Nichols and Bryant, 1986; W. A. Cobban, written commun., 1979). Thickness ranges from 1,650 m in Currant Creek drainage to 550 m at Dry Moun- tain east of Duchesne River.' where unitsymbol='Kmv';
update sources.utquad_eastslc set descrip='Conglomerate, sandstone, siltstone, and mudstone. Gray, rounded-boulder conglomerate, moderate-red silty sandstone and light-gray sandstone in western part of outcrop belt in central part of quadrangle. Variegated siltstone, sandstone, pebble conglomerate, and a few beds of mudstone in eastern part of belt. At Red Creek, basal 140 m composed of gray silty mudstone, grayish-red and moderate-red siltstone and silty mudstone, medium-grained sandstone, and quartz- and chert-pebble conglomerate. At Red Creek and east of the Duchesne River, basal part contains palynomorphs of the Aquilapollenites quadrilo- bus Interval Zone of late Campanian or early Maastrichtian age (Nichols and Bryant, 1986) and east of the Duchesne River, ostracodes Timiriasevia sp., Cypridea sp., and a new genus and species; and charophytes Stellatochara mundula, Mesochara (two new species), Strobilochara sp., and a new genus and species of Late Cretaceous age (R. M. Forester, written commun., 1980). Thickness 0 -1,500 m.' where unitsymbol='TKc';
update sources.utquad_eastslc set descrip='Moderate-red, grayish-red, pale-red, reddish-brown, and gray sandstone, conglomerate, siltstone, and mudstone. Contains scattered thin lenticular beds of light-purplish-gray to light-gray non-marine limestone. Rapid facies changes. Conglomerate contains a variety of pebble- to boulder-size clasts, reflecting diverse source rocks. Maximum stratigraphic thickness in the Mountain Dell-Porterville area on eastern side of Wasatch Range is about 1,500 m and north of the upper reaches of the Weber River is about 1,200 m. In Chalk Creek, near the northern border of area a yellowish-gray-weathering conglomerate forms a basal unit as much as 100 m thick and is overlain by a markedly finer grained sequence of variegated sandstone and siltstone that is overlain by or interfingers to the south with coarse conglomerate derived from Paleozoic and Precambrian rocks of the Uinta uplift. Palynomorphs indicate the lower 200-300 m of the formation is late Paleocene in this area (Lamerson, 1982; Jacobson and Nichols, 1982; Nichols and Bryant, 1990). North of the Uinta Mountains, facies change from coarse conglomerate on the flank of the mountains to sandstone and siltstone, and then to lacustrine rocks of the Green River Formation and lacustrine and alluvial rocks of the Bridger Formation in the Green River basin. The transition to the Green River and Bridger Formations occurs very close to the quadrangle boundary from west of Blacks Fork east to Burnt Fork. This transition is mostly concealed by landslides and slumping involving the overlying Bishop Conglomerate and, in the Beaver Creek-Burnt Fork region in the northeastern corner of quadrangle, by a tongue of Wasatch conglomerate.' where unitsymbol='Tw';
update sources.utquad_eastslc set descrip='Yellowish-gray to light-yellowish-brown, brownish-gray, and white, thinly laminated limestone containing nodules and lenses of brownish-black and dark gray chert, and white, very light greenish-gray, and yellowish-gray medium-grained sandstone, red silty sandstone, carbonaceous siltstones, and silty limestone. Mapped only in northeastern corner of quadrangle. At least 150 m thick.' where unitsymbol='Tbr';
update sources.utquad_eastslc set descrip='Oil shale marker bed in the mahogany zone; oil shale 3-4 m thick contains a 2-4 cm thick tuff bed in its upper half.' where unitsymbol='os';
update sources.utquad_eastslc set descrip='Gray and greenish-gray limestone, shale, sandstone, oil shale, and tuff. As much as 800 m thick.' where unitsymbol='Tgr';
update sources.utquad_eastslc set descrip='Gray to moderate-brown limestone, claystone, dolomite, siltstone, sandstone, oil shale, and tuff. Limestone beds characterized by mottled texture on weathered surface because of dissolution of calcite crystals and saline minerals. Limestone in upper part contains gray chert. Contains beds of mixed halite and sodium-carbonate minerals as much as 6 m thick in the subsurface in the Duchesne area (Dyni and others, 1985). Upper contact with sandstone and limestone facies (Tgsl) is gradational. Intertongues with and grades laterally into sandstone and limestone facies to east and with Duchesne River Formation (Tdu) to the west. As much as 350 m thick.' where unitsymbol='Tgs';
update sources.utquad_eastslc set descrip='Generally thin-bedded sandstone containing a few siltstone, shale, and limestone interbeds. Deposited in a deltaic environment.' where unitsymbol='Tgss';
update sources.utquad_eastslc set descrip='Gray to moderate brown thin-bedded sandstone, siltstone, shale, and limestone. White and dark-gray limestone. Sandstone locally fills channels cut into underlying rocks. Ostracods, gar pike scales, and lenses and stringers of light-brownish-gray chert in some limestone beds. Plant fragments in some beds and a few partings of coaly material. A few greenish-gray and grayish-red siltstone and shale interbeds. Deposited in a marginal lacustrine environment. South of Strawberry Reservoir, unit contains less sandstone than to the east and some beds of oil shale about one meter thick. Grades laterally to sandstone facies (Tgss) and grades down- ward into saline facies. To east, intertongues with lower member of the Uinta Formation (Tul). As much as 300 m thick.' where unitsymbol='Tgsl';
update sources.utquad_eastslc set descrip='Dark-greenish-gray and gray mudstone containing lenticular beds of yellowish- gray, gray, and light yellowish-brown sandstone as much as 6 m thick and scattered continuous beds of white to light-graylacustrine marlstone as much as 3 m thick. Minor beds of grayish-red siltstone and brownish-gray- to yellowish-brown-weathering limestone. A few thin coaly beds. Dominantly fluvial in origin but contains some lacustrine beds. Interfingers with sandstone and limestone facies (Tgsl) of the Green River Formation southeast of Duchesne.' where unitsymbol='Tul';
update sources.utquad_eastslc set descrip='Gray mudstone and a few thin beds of sandstone and limestone. Dominantly alluvial in origin but contains some lacustrine beds. Interfingers with Duchesne River Formation (Tdu) west of Duchesne and with part of the sandstone and limestone facies (Tgsl) of the Green River Formation east of Duchesne.' where unitsymbol='Tuu';
update sources.utquad_eastslc set descrip='Moderate-red, grayish-red and gray sandstone, moderate-red siltstone, pale-red to moderate-red pebble to boulder conglomerate and, in the northeastern exposures of the unit, gray siltstone and claystone. Interfin- gers with upper member of Uinta Formation north of Duchesne and with members of the Duchesne River Formation in the Rock Creek area. Contact with alluvial facies rocks (Ta) at west margin of Uinta Basin near Wadsworth Peak is arbitrary. In Diamond Fork area, includes some beds of marginal lacustrine facies rocks that were included in Green River and Uinta Formations by Baker (1976).' where unitsymbol='Tdu';
update sources.utquad_eastslc set descrip='Moderate-red, grayish-red, reddish- brown, yellowish-brown, and yellowish-orange sandstone and less abundant reddish-brown siltstone. A few beds of pebble conglomerate. Contains Uintan (latest Eocene) vertebrate fauna 20 km east of quadrangle (Emry, 1981). Maximum thickness about 200 m.' where unitsymbol='Tdb';
update sources.utquad_eastslc set descrip='Moderate-red and grayish-red sandstone and siltstone and gray claystone. Maximum thickness about 200 m.' where unitsymbol='Tdd';

update sources.utquad_eastslc set descrip='Predominantly gray siltstone and claystone; includes some beds of orangish-gray sandstone and a few beds of limestone. Contains Duchesnian (probably earliest Chadronian) vertebrate fauna (Emry, 1981) 26 km east of quadrangle. Maximum thickness about 300 m.' where unitsymbol='Tdl';
update sources.utquad_eastslc set descrip='Ranges from pale-red, moderate-red, reddish-brown, grayish-red boulder conglomerate, sandstone, and minor siltstone and claystone near Uinta Mountains to yellowish-gray sandstone and minor gray and greenish-gray siltstone and claystone near the axis of the Uinta Basin. Unconformably overlies older part of Duchesne River Formation along south flank of the Uinta Mountains in Dry Mountain, Tabby Mountain, and Rock Creek areas. Rapid southward transition to conformable relations and finer-grained, sandstone-rich facies. Maximum thickness about 600 m.' where unitsymbol='Tds';
update sources.utquad_eastslc set descrip='Ranges from pale-red, moderate-red, reddish-brown, grayish-red boulder conglomerate, sandstone, and minor siltstone and claystone near Uinta Mountains to yellowish-gray sandstone and minor gray and greenish-gray siltstone and claystone near the axis of the Uinta Basin. Unconformably overlies older part of Duchesne River Formation along south flank of the Uinta Mountains in Dry Mountain, Tabby Mountain, and Rock Creek areas. Rapid southward transition to conformable relations and finer-grained, sandstone-rich facies. Maximum thickness about 600 m.' where unitsymbol='Tds?';

update sources.utquad_eastslc set descrip='Boulder, cobble, or pebble conglomerate containing fragments of sandstone derived from Mesozoic and upper Paleozoic formations that underlie the Keetley Volcanics. Clasts of Nugget Sandstone conspicuous. Contains a few lahars and beds of tuff and volcanic gravel. Includes the Oligocene Tibble Formation north of Mt. Timpanogos (Baker and Crittenden, 1961; Baker, 1964b). Zircon from tuff in conglomerate south of Red Creek Mountain south of the western Uinta Mountains has a zircon fission-track age of 44.9 Ma (C. W. Naeser, written commun., 1980). Maximum thickness about 800 m.' where unitsymbol='Tkc';
update sources.utquad_eastslc set descrip='Boulder to pebble conglomerate and sandstone. Poorly cemented and rarely forms outcrops. A bed of tuff and tuffaceous sandstone is locally exposed near or at its base. As much as 150 m thick on north and south sides of the Uinta Mountains.' where unitsymbol='Tbc';
update sources.utquad_eastslc set descrip='Unconsolidated pebble, cobble, and boulder gravel underlying highest terraces in Steamboat Mountain area of the Uinta Basin and in the Salt Lake salient (upper Tertiary Hooper Canyon Formation of Van Horn, 1981), and on the north flank of the Uinta Moun- tains in the northeastern part of the quadrangle. Also mapped in T. 3 N., R. 7 E. in north-central part of the Salt Lake City 1° x 2° quadrangle, where it apparently is lag from underlying gravel, and north of Strawberry Reservoir in south-central part, where it consists of colluvium, landslide debris, and gravel, much of which was derived from the Upper Cretaceous and Paleocene? Currant Creek Formation. Maximum thickness about 40 m.' where unitsymbol='QTg';
update sources.utquad_eastslc set descrip='Poorly sorted gravel and sand in terraces graded to moraines of till of pre-Pinedale age.' where unitsymbol='Qgo';
update sources.utquad_eastslc set descrip='Poorly sorted bouldery till having more subdued morainal topographic expression than till of Pinedale age. Mapped on north side of Uinta Mountains and at their west end, where the age of tills older than till of Pinedale age is unknown. Many of these depos- its may be of pre-Bull Lake age.' where unitsymbol='Qto';
update sources.utquad_eastslc set descrip='Along Beaver Creek in northeastern corner of quadrangle. Compound outwash apron formed during several glaciations; surface material probably mainly of Bull Lake and Pinedale ages.' where unitsymbol='Qug';
update sources.utquad_eastslc set descrip='Till deeply dissected by Holocene and Pleistocene erosion along Yellowstone River in east-central part of quadrangle.' where unitsymbol='Qut';
update sources.utquad_eastslc set descrip='Poorly sorted bouldery till. Generally more dissected than till of Bull Lake age; locally forms broad, high, gently sloping moraines, such as those east of the Yellowstone River.' where unitsymbol='Qtpb';
update sources.utquad_eastslc set descrip='Poorly sorted gravel and sand; surface graded to terminal moraine of Bull Lake age.' where unitsymbol='Qgb';
update sources.utquad_eastslc set descrip='Poorly sorted bouldery till. Bull Lake till contains fewer undrained depressions, and terminal moraines are more widely breached by streams than are Pinedale moraines. Age based on studies by Osborn (1973) and Nelson and Weisser (1985) south of the Uinta Mountains.' where unitsymbol='Qtb';
update sources.utquad_eastslc set descrip='Poorly sorted gravel, sand, and silt; locally contains boulders; crudely bedded to nonbedded. Fan surfaces are above present drainages and are inactive. Maximum thickness about 10 m.' where unitsymbol='Qof';
update sources.utquad_eastslc set descrip='Pebble and cobble gravel, sand, and silt deposited by streams; terraces are several to more than 100 m above modern flood plains. Some deposits may be glacial outwash.' where unitsymbol='Qfg';
update sources.utquad_eastslc set descrip='Clay to large blocks of rock more than several tens of meters in diameter, deposited by sliding and slumping; includes some material deposited by debris flows.' where unitsymbol='Ql';
update sources.utquad_eastslc set descrip='Boulder to pebble gravel, sand, silt, and clay deposited in channels and flood plains of streams. Thickness as much as 3 m.' where unitsymbol='Qa';
update sources.utquad_eastslc set descrip='Angular pebble to boulder gravel, with or without matrix of silt and sand, and gravelly sand and silt; massive to crudely bedded. Maximum thickness about 10 m.' where unitsymbol='Qt';
update sources.utquad_eastslc set descrip='Angular boulders and cobbles at the surface, embedded in a matrix of sand, silt, and possibly ice below the surface. Deposit has a convex cross profile. Maximum thickness several tens of meters.' where unitsymbol='Qr';
update sources.utquad_eastslc set descrip='Boulder, cobble, and pebble gravel, sand, and silt on dissected pediment remnants.' where unitsymbol='Qop';


update sources.utquad_eastslc set age_text=NULL;
update sources.utquad_eastslc set age_text=age;
update sources.utquad_eastslc set age_text=replace(age_text, 'Upper', 'Late');
update sources.utquad_eastslc set age_text=replace(age_text, 'Lower', 'Early');
update sources.utquad_eastslc set early_id=NULL, late_id=NULL;
UPDATE sources.utquad_eastslc set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike age_text and early_id IS NULL;
UPDATE sources.utquad_eastslc set late_id=m.id FROM macrostrat.intervals m WHERE age_text ilike concat(m.interval_name, ' %') and late_id IS NULL;
UPDATE sources.utquad_eastslc set early_id=m.id FROM macrostrat.intervals m WHERE age_text ilike concat('% and ',m.interval_name) and early_id IS NULL;
UPDATE sources.utquad_eastslc set early_id=m.id FROM macrostrat.intervals m WHERE age_text ilike concat('% to ',m.interval_name) and early_id IS NULL;
UPDATE sources.utquad_eastslc set early_id=m.id FROM macrostrat.intervals m WHERE age_text ilike concat('% or ',m.interval_name) and early_id IS NULL;


UPDATE sources.utquad_eastslc set early_id=90,late_id=90 where age_text ilike 'Late and Early Mississippian';
UPDATE sources.utquad_eastslc set early_id=258,late_id=258 where age_text ilike 'Middle Proterozoic';
UPDATE sources.utquad_eastslc set early_id=483 where age_text ilike 'Oligocene and upper Eocene';
UPDATE sources.utquad_eastslc set early_id=978,late_id=978 where age_text ilike 'Jurassic? And Triassic?';
UPDATE sources.utquad_eastslc set early_id=984,late_id=983 where age_text ilike 'Middle Pennsylvanian; Early Pennsylvanian';
UPDATE sources.utquad_eastslc set early_id=33,late_id=33 where age_text ilike 'Late and Early Cretaceous';
UPDATE sources.utquad_eastslc set late_id=128 where age_text ilike 'Middle and Early Cambrian';
UPDATE sources.utquad_eastslc set late_id=21 where age_text ilike 'Oligocene, Eocene, and Paleocene';
UPDATE sources.utquad_eastslc set late_id=63,early_id=63 where age_text ilike 'Late and Early Triassic';
UPDATE sources.utquad_eastslc set late_id=478 where age_text ilike 'Paleocene? and Late Cretaceous';

UPDATE maps.large set b_interval=33,t_interval=33 where age ilike 'Upper and Lower Cretaceous';
UPDATE maps.large set t_interval=128 where age ilike 'Middle and Lower Cambrian';
UPDATE maps.large set t_interval=21 where age ilike 'Oligocene, Eocene, and Paleocene';
UPDATE maps.large set t_interval=63,b_interval=63 where age ilike 'Upper and Lower Triassic';
UPDATE maps.large set t_interval=478 where age ilike 'Paleocene? and Upper Cretaceous';
UPDATE maps.large set t_interval=493,b_interval=493 where age ilike 'Early Paleozoic to Neoproterozoic (443.7 Ma to 1.0 Ga)';
UPDATE maps.medium set t_interval=493,b_interval=493 where age ilike 'Early Paleozoic to Neoproterozoic (443.7 Ma to 1.0 Ga)';

UPDATE sources.utquad_eastslc set genesis = 'origin uncertain' where genesis='?';

INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,15,unitname,age,compositio,descrip,concat_ws('; ',grouping,genesis), late_id,early_id,st_makevalid(geom) FROM sources.utquad_eastslc
insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=15 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');


## usgs world map
UPDATE sources.usgs_world
set lith='Ice cap of major significance.', comments='As yet used only for Greenland Ice Cap. Geology has been interpreted through much of the Antarctic Ice Cap by de Wit et al., (1988) to an extent that few compilers could imitate elsewhere. '
where rxtp='ICE';
UPDATE sources.usgs_world
set lith='unclassified', comments='Used rarely - only where it is unlikely that rock-type information could not be found in available maps or literature to revise uncertain or incorrect assignments.'
where rxtp='UNC';
UPDATE sources.usgs_world
set lith='Tectonic assemblages, metamorphic schist belts, melanges', comments='Rocks distinguished in compilation sources primarily as part of a tectonic assemblage, belts of schist and mylonite of mixed parentage, and tectonic melanges.'
where rxtp='TEC';
UPDATE sources.usgs_world
set lith='intrusive and metamorphic terranes', comments='Mixtures of metamorphic and intrusive or plutonic rocks, tracts known as crystalline, migmatitic terranes, moderately to highly metamorphosed rocks of unknown origin with or without intrusions. This classification is inherently prone to variable interpretation, as other compilers might distinguish some packages by their metamorphic or gneissic protoliths, and the associated age ranges may be more variable.'
where rxtp='PLX';
UPDATE sources.usgs_world
set lith='plutonic rocks', comments='Deep-seated to high-level intrusions are included. Many charnockites, anorthosites, and large ophiolites, classified as plutons, are distinguished in the database using the SIGNIF item. Ophiolites were classified as plutons, even where remnants may be extrusive and/or sedimentary.'
where rxtp='PLU';
UPDATE sources.usgs_world
set lith='mixed volcanic, volcaniclastic and sedimentary rocks', comments='This designation includes Precambrian iron-formation-bearing sedimentary and volcanic sequences, as well as mixed sedimentary and volcanic or volcaniclastic sequences.'
where rxtp='SXV';
UPDATE sources.usgs_world
set lith='sedimentary rocks'
where rxtp='SED';
UPDATE sources.usgs_world
set lith='volcanic rocks', comments='May include hypabyssal intrusions.'
where rxtp='VOL';

UPDATE sources.usgs_world set interval='Cenozoic' where agera='CEN';
UPDATE sources.usgs_world set interval='Quaternary' where agera='CEN' and agequ='L';
UPDATE sources.usgs_world set interval='Miocene-Pliocene' where agera='CEN' and agequ='M';
UPDATE sources.usgs_world set interval='Paleogene' where agera='CEN' and agequ='E';
UPDATE sources.usgs_world set interval='Mesozoic' where agera='MES';
UPDATE sources.usgs_world set interval='Cretaceous' where agera='MES' and agequ='L';
UPDATE sources.usgs_world set interval='Jurassic' where agera='MES' and agequ='M';
UPDATE sources.usgs_world set interval='Triassic' where agera='MES' and agequ='E';
UPDATE sources.usgs_world set interval='Paleozoic' where agera='PAL';
UPDATE sources.usgs_world set interval='Carboniferous-Permian' where agera='PAL' and agequ='L';
UPDATE sources.usgs_world set interval='Silurian-Devonian' where agera='PAL' and agequ='M';
UPDATE sources.usgs_world set interval='Cambrian-Ordovician' where agera='PAL' and agequ='E';
UPDATE sources.usgs_world set interval='Proterozoic' where agera='PRO';
UPDATE sources.usgs_world set interval='Neoproterozoic' where agera='PRO' and agequ='L';
UPDATE sources.usgs_world set interval='Mesoproterozoic' where agera='PRO' and agequ='M';
UPDATE sources.usgs_world set interval='Paleoproterozoic' where agera='PRO' and agequ='E';
UPDATE sources.usgs_world set interval='Archean' where agera='ARC';
UPDATE sources.usgs_world set interval='Precambrian' where agera='PCU';
UPDATE sources.usgs_world set interval='uncertain age' where agera='UNC';


update sources.usgs_world set name=initcap(name) where name is not null;
update sources.usgs_world set name=initcap(signif) where signif is not null;
UPDATE sources.usgs_world set early_id=m.id, late_id=m.id FROM macrostrat.intervals m WHERE interval=m.interval_name;
UPDATE sources.usgs_world set early_id=m.id FROM macrostrat.intervals m WHERE interval like concat(m.interval_name,'%') and early_id IS NULL;
UPDATE sources.usgs_world set late_id=m.id FROM macrostrat.intervals m WHERE interval like concat('%-',m.interval_name) and late_id IS NULL;

INSERT INTO maps.tiny (orig_id,source_id,name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,18,concat_WS(' ',interval,lith),interval,lith,concat_WS(';', name,signif),comments,late_id,early_id,st_makevalid(geom) FROM sources.usgs_world;

########################################################################################################################
########################################################################################################################
########################################################################################################################
## iowa_co_wi


update sources.iowa_co_wi set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE unitcode like 'O%' and interval_name='Ordovician';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE unitcode like 'S%' and interval_name='Silurian';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE unitcode like 'C%' and interval_name='Cambrian';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id,lith='sand,gravel',age='Holocene' FROM macrostrat.intervals m WHERE unitcode like 'sp' and interval_name='Holocene';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id,lith='sand',age='Quaternary' FROM macrostrat.intervals m WHERE unitcode like 'ws' and interval_name='Quaternary';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id,lith='sand,gravel',age='Holocene' FROM macrostrat.intervals m WHERE unitcode like 'sm' and interval_name='Holocene';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id,lith='sand,gravel',age='Pleistocene' FROM macrostrat.intervals m WHERE unitcode like 'ss' and interval_name='Pleistocene';
update sources.iowa_co_wi set lith='sandstone',age='Late Cambrian' where unitcode like 'Cj';
update sources.iowa_co_wi set lith='sandstone',age='Late Cambrian' where unitcode like 'Cw';
update sources.iowa_co_wi set lith='carbonate,shale',age='Middle Ordovician' where unitcode like 'Od';
update sources.iowa_co_wi set lith='dolomite',age='Silurian' where unitcode like 'Su';
update sources.iowa_co_wi set lith='sandstone',age='Late Cambrian' where unitcode like 'Ctc';
update sources.iowa_co_wi set lith='sandstone',age='Middle Ordovician' where unitcode like 'Oa';
update sources.iowa_co_wi set lith='dolomite',age='Late Cambrian' where unitcode like 'Csl';
update sources.iowa_co_wi set early_id=m.id,late_id=m.id,lith='sand,gravel',age='Pleistocene' FROM macrostrat.intervals m where unitcode like 'Sj' and interval_name='Pleistocene';
update sources.iowa_co_wi set lith='carbonate,shale',age='Middle Ordovician' where unitcode like 'Op';
update sources.iowa_co_wi set lith='dolomite',age='Middle Ordovician' where unitcode like 'Og';
update sources.iowa_co_wi set lith='shale,limestone',age='Middle Ordovician' where unitcode like 'Om';
update sources.iowa_co_wi set lith='dolomite,sandstone',age='Early Ordovician' where unitcode like 'Opc';

pg_dump -t sources.iowa_co_wi -C -O burwell | gzip > ~/Desktop/iowa_co_wi.sql.gz

update maps.large set t_interval=m.id,b_interval=m.id FROM macrostrat.intervals m where age=interval_name;
update maps.large set t_interval=m.late_id, b_interval=m.early_id, age=m.age FROM sources.iowa_co_wi m where gid=m.gid;

INSERT INTO maps.large (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) SELECT gid,17,unitname,age,lith,late_id,early_id,st_makevalid(geom) FROM sources.iowa_co_wi
insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=17 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

update maps.large set name='Decorah Formation' where name='Decorah Formation (Sinnipee Group)';
update maps.large set name='St Peter Formation' where name='St Peter Formation (Ancell Group)';
update maps.large set name='Shakopee Formation and Oneota Formation' where name='Shakopee and Oneota Formations (Prairie du Chien Group)';
update maps.large set name='Platteville Formation' where name='Platteville Formation (Sinnipee Group)';
update maps.large set name='Decorah Formation' where name='Decorah Formation (Sinnipee Group)';
update maps.large set name='Galena Formation' where name='Galena Formation (Sinnipee Group)';

########################################################################################################################
## wa100k source_id = 19
update sources.wa100k set early_id=late_id where early_id IS NULL and late_id=131;
update sources.wa100k set early_id=m.id FROM macrostrat.intervals m WHERE geologic_a ilike m.interval_name;
update sources.wa100k set early_id=m.id FROM macrostrat.intervals m WHERE geologic_a ilike concat(m.interval_name, '%');
update sources.wa100k set late_id=m.id FROM macrostrat.intervals m WHERE geologic_a ilike concat('%-',m.interval_name);
update sources.wa100k set late_id=m.id FROM macrostrat.intervals m WHERE geologic_a ilike concat('% ',m.interval_name);
update sources.wa100k set geologic_a='Triassic-Permian' where geologic_a='Traissic-Permian';
update sources.wa100k set early_id=32,late_id=32 where geologic_a='pre-Tertiary';
update sources.wa100k set early_id=84,late_id=84 where geologic_a='pre-Permian';
update sources.wa100k set early_id=63,late_id=48 where geologic_a='pre-Cretaceous';
update sources.wa100k set early_id=112,late_id=105 where geologic_a='pre-Devonian';

update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Devonian' and l.interval_name='Late Devonian' and geologic_a ilike 'Devonian, upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and geologic_a ilike 'Miocene, upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and geologic_a ilike 'Miocene, lower';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and geologic_a ilike 'Miocene, middle to upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and geologic_a ilike 'Miocene, lower to middle';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and geologic_a ilike 'Miocene, middle';

update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and geologic_a ilike 'Eocene, lower to middle';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and geologic_a ilike 'Eocene, upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and geologic_a ilike 'Eocene, middle to upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and geologic_a ilike 'Eocene, lower';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and geologic_a ilike 'Eocene, middle';


update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and geologic_a ilike 'Jurassic, middle to upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Jurassic' and l.interval_name='Middle Jurassic' and geologic_a ilike 'Jurassic, middle';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Jurassic' and l.interval_name='Late Jurassic' and geologic_a ilike 'Jurassic, upper';

update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Cretaceous' and l.interval_name='Early Cretaceous' and geologic_a ilike 'Cretaceous, lower';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Cretaceous' and l.interval_name='Late Cretaceous' and geologic_a ilike 'Cretaceous, upper';

update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Cretaceous' and l.interval_name='Late Cretaceous' and geologic_a ilike 'Oligocene, lower';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Oligocene' and l.interval_name='Oligocene' and geologic_a ilike 'Oligocene, lower';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Oligocene' and l.interval_name='Oligocene' and geologic_a ilike 'Oligocene, upper';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Pliocene' and geologic_a ilike 'Pliocene, lower to middle';

update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mesoproterozoic' and l.interval_name='Mesoproterozoic' and geologic_a ilike 'middle Proterozoic';
update sources.wa100k set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Neoproterozoic' and geologic_a ilike 'upper Proterozoic';

##
update maps.large from sources.wa100k set t_interval=late_id,b_interval=early_id where source_id=19 and orig_id=gid;


update sources.wa100k set early_id=3,late_id=3 where geologic_a='Present';
update sources.wa100k set named_unit=NULL where named_unit='---';
update sources.wa100k set geologic_a='Holocene' where geologic_a='---' and named_unit='ice';
update sources.wa100k set named_unit='alluvium',lithology='sand,gravel' where lithology='alluvium' and named_unit IS NULL;
update sources.wa100k set named_unit='water',lithology = NULL where lithology='water' and named_unit IS NULL;
update sources.wa100k set named_unit='ice',lithology = NULL where lithology='ice' and named_unit IS NULL;
update sources.wa100k set named_unit= NULL ,lithology = concat_ws(' ', named_unit,lithology) where named_unit='equigranular';
update sources.wa100k set named_unit= 'talus deposits' ,lithology='boulders,gravel' WHERE named_unit IS NULL and lithology='talus deposits';
update sources.wa100k set named_unit= concat_ws('; ',lithology,named_unit),lithology='sand,gravel' WHERE lithology='continental glacial outwash, Fraser-age';
update sources.wa100k set named_unit= concat_ws('; ',lithology,named_unit),lithology='sand,gravel' WHERE lithology='continental glacial drift, Fraser-age';
update sources.wa100k set named_unit= concat_ws('; ',lithology,named_unit),lithology='sand,silt,mud' WHERE lithology='glaciolacustrine deposits, Fraser-age';
update sources.wa100k set named_unit= lithology,lithology='till,' WHERE lithology='alpine glacial till, Fraser-age';
update sources.wa100k set named_unit='alluvial fan deposits',lithology='gravel,sand,conglomerate' WHERE lithology='alluvial fan deposits';
update sources.wa100k set named_unit='beach deposits',lithology='sand,gravel' WHERE lithology='beach deposits';
update sources.wa100k set named_unit='peat deposits',lithology='peat' WHERE lithology='peat deposits';
update maps.large set name='mass-wasting deposits, mostly landslides',lith=NULL where source_id=19 and lith='mass-wasting deposits, mostly landslides';

pg_dump -t sources.wa100k -C -O burwell | gzip > ~/Desktop/wa100k.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) SELECT gid,19,named_unit,geologic_a,lithology,late_id,early_id,st_makevalid(geom) FROM sources.wa100k;
insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=19 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');
####
# lines
update sources.wa100k_dikes set named_unit=NULL where named_unit='---';
insert into sources.wa100k_line (orig_id,name,type,descrip,geom) SELECT dike_100k_,concat_ws('; ','dike',named_unit),'dike',concat_ws('; ',dike_desc,lithology,geologic_a),st_makevalid(geom) from sources.wa100k_dikes;
update sources.wa100k_folds set fold_type='Anticline' where fold_desc ilike '%Anticline%';
update sources.wa100k_folds set fold_type='Syncline' where fold_desc ilike '%Syncline%';
update sources.wa100k_folds set fold_type='Monocline' where fold_desc ilike '%monocline%';
update sources.wa100k_folds set fold_type=concat_ws(' ', 'Plunging',fold_type) where plunge_fla='Y';
update sources.wa100k_folds set fold_desc=replace(fold_desc,'?',', ');
insert into sources.wa100k_line (orig_id,descrip,name,type,geom) SELECT fold_100k_,fold_desc,fold_type,fold_type,st_makevalid(geom) from sources.wa100k_folds;

update sources.wa100k_lines set fault_desc=replace(fault_desc,'?','. ');
update sources.wa100k_lines set fault_type='Fault' where fault_cd in (1,2,3,4,5,6,49);
update sources.wa100k_lines set fault_type='Thrust Fault' where fault_cd in (7,8,9,10,11,12,50);
update sources.wa100k_lines set fault_type='Strike-Slip, right-lateral' where fault_cd in (13,14,15,17,51);
update sources.wa100k_lines set fault_type='Strike-Slip, left-lateral' where fault_cd in (19,20,21,52);
update sources.wa100k_lines set fault_type='Fracture' where fault_cd in (25,27);
update sources.wa100k_lines set fault_type='Normal Fault, low angle' where fault_cd in (31,33,35);
update sources.wa100k_lines set fault_type='Reverse Fault' where fault_cd in (37,39,41);
update sources.wa100k_lines set fault_type='Normal Fault' where fault_cd in (43,44,45,46,47,55);
update sources.wa100k_lines set fault_type='Normal Fault, right-lateral slip' where fault_cd in (59,78,80);
update sources.wa100k_lines set fault_type='Normal Fault, left-lateral slip' where fault_cd in (72);
insert into sources.wa100k_line (orig_id,descrip,name,type,geom) SELECT fault_100k,fault_desc,fault_type,fault_type,st_makevalid(geom) from sources.wa100k_lines;

pg_dump -t sources.wa100k_line -C -O burwell | gzip > ~/Desktop/wa100k_line.sql.gz

insert into lines.large (orig_id,source_id,name,type,descrip,geom) SELECT orig_id,19,name,type,descrip,st_makevalid(geom) from sources.wa100k_line;
#######
########################################################
update sources.oregon set thickness=concat_ws('-',m.minimumthickness,m.maximumthickness) FROM sources.or_thick m WHERE m.mapunitfk=mapunitpk;
update sources.oregon set thickness=typicalthickness FROM sources.or_thick m WHERE m.mapunitfk=mapunitpk and typicalthickness IS NOT NULL;
update sources.or_unitlith set piecescrystalsclastsmodifier=concat('fossils: ',piecescrystalsclastsmodifier) where piecescrystalsclasts='fossils';
delete from sources.or_unitlith where piecescrystalsclastsmodifier IS NULL and piecescrystalsclasts IS NULL and openspacefillingcompmodifier IS NULL and openspacefillingcomposition IS NULL and postdepositionprocesscomposition IS NULL and postdepositionprocessmodifier is null and generalcompositionterms is null and generalcompmodifier is null;

insert into sources.or_temp (mapid,lith)  (select mapsubunitfk,trim(both '; ' from string_agg(concat_ws('; ',concat_ws(' ',piecescrystalsclastsmodifier, piecescrystalsclasts),concat_ws(': ',openspacefillingcomposition,openspacefillingcompmodifier),concat_ws(': ',postdepositionprocesscomposition,postdepositionprocessmodifier),concat_ws(': ',generalcompositionterms,generalcompmodifier)),'; ')) from sources.or_unitlith group by mapsubunitfk) ;
update sources.or_temp set lith=replace(lith,' ;','');
update sources.or_subunit set lith=m.lith FROM sources.or_temp m where m.mapid=mapsubunitpk;
delete from sources.or_color where freshcolorkeyword is null and freshcolormodifier is null and weatheredcolorkey is null and weatheredcolormodifier is null;
update sources.or_subunit set color=m.c FROM (select mapsubunitfk, string_agg(concat_ws(' ',freshcolormodifier,freshcolorkeyword), ', ') c from sources.or_color group by mapsubunitfk) m where m.mapsubunitfk=mapsubunitpk;
update sources.or_subunit set lith_2=concat_ws('; ',color,lith);

update sources.oregon set lith_mods=m.c FROM (SELECT mapunitfk fk, string_agg(concat('Major:: {',trim(both ', ' from concat(mapsubunitmodifier,' ',mapsubunitname,', ',lith_2)), '}'),'; ') c from sources.or_subunit where mapsubunitrelabund='major' or mapsubunitrelabund IS NULL group by mapunitfk) m where m.fk=mapunitpk;

update sources.oregon set lith_mods=concat_ws(' ',lith_mods,m.c) FROM (SELECT mapunitfk fk, string_agg(concat('Minor:: {',trim(both ', ' from concat(mapsubunitmodifier,' ',mapsubunitname,', ',lith_2)), '}'),'; ') c from sources.or_subunit where mapsubunitrelabund='minor' group by mapunitfk) m where m.fk=mapunitpk;

update sources.oregon set early_id=m.id,late_id=m.id FROM macrostrat.intervals m where interval_name=age_name;
update sources.oregon set late_id=m.id FROM macrostrat.intervals m where age_name ilike concat('%/',interval_name) and late_id is null;
update sources.oregon set early_id=m.id FROM macrostrat.intervals m where age_name ilike concat(interval_name,'/%') and early_id is null;
update sources.oregon set age_name=NULL where age_name='no data';
update sources.oregon set early_id=3,late_id=3 where age_name='Recent';
update sources.oregon set layering=NULL where layering='no data';
update sources.oregon set layering=NULL where layering='some data';
update sources.oregon set cr_grn_siz=NULL where cr_grn_siz='no data';
update sources.oregon set cr_grn_siz=NULL where cr_grn_siz='some data';
update sources.oregon set cr_grn_siz=replace(cr_grn_siz,'some data','');
update sources.oregon set getec_prop=NULL where getec_prop='no data';
update sources.oregon set terrane_gr=NULL where terrane_gr='no data';
update sources.oregon set formation=NULL where formation='No data';
update sources.oregon set member=NULL where member='No data';
update sources.oregon set unit=NULL where unit ilike 'no data';
update sources.oregon set map_unit_n=NULL where map_unit_n='No name in explanation';
update sources.oregon set gn_lith_ty=NULL where gn_lith_ty ilike 'no data';
update sources.oregon set g_rock_typ=NULL where g_rock_typ ilike 'no data';
update sources.oregon set lth_rk_typ=NULL where lth_rk_typ ilike 'no data';
update sources.oregon set lith_gen_u=NULL where lith_gen_u ilike 'no data';
update sources.oregon set getec_prop=NULL where getec_prop ilike 'some data';
update sources.oregon set cr_grn_siz=NULL where cr_grn_siz ilike 'grains';
update sources.oregon set thickness=concat_ws(' ',thickness,'thick') where thickness is not null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,20,map_unit_n,concat_ws('; ',terrane_gr,formation,member),age_name,lith_mods,concat_ws('; ',thickness,lith_gen_u,g_rock_typ,lth_rk_typ,layering,cr_grn_siz,getec_prop),late_id,early_id,st_makevalid(geom) FROM sources.oregon;

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=20 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=20 and large.lith IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.oregon -C -O burwell | gzip > ~/Desktop/oregon.sql.gz

update sources.oregon_faults set flt_age=NULL where flt_age like 'no data';
update sources.oregon_faults set flt_age=concat('fault age ',flt_age) where flt_age is not null;
update sources.oregon_faults set notes=concat_ws('; ',notes,flt_age) where flt_age is not null;
update sources.oregon_faults set imp_ftype=NULL where imp_ftype like 'no data';
update sources.oregon_faults set fltpl_dir=NULL where fltpl_dir like 'no data';
update sources.oregon_faults set fltpl_deg=NULL where fltpl_deg like 'no data';
update sources.oregon_faults set notes=NULL where notes like 'no data';
update sources.oregon_faults set label=NULL where label like 'no data';
update sources.oregon_faults set imp_ftype='fault' where imp_ftype ilike 'Generic%';
update sources.oregon_faults set fltpl_deg=NULL where fltpl_deg='nd';

update sources.oregon_folds set gid=gid+55829;
insert into sources.oregon_faults SELECT * from sources.oregon_folds;

update sources.oregon_faults set fltpl_deg=NULL where fltpl_deg='<Null>';
update sources.oregon_faults set dir=concat('plunging ', fltpl_dir, ', ', fltpl_deg, ' degrees') where fltpl_dir IS NOT NULL and fltpl_deg IS NOT NULL and fc_id=502;
update sources.oregon_faults set dir=concat('plunging ', fltpl_dir) where fltpl_dir IS NOT NULL and fltpl_deg IS NULL and fc_id=502;
update sources.oregon_faults set dir=concat('dipping ', fltpl_dir) where fltpl_dir IS NOT NULL and fltpl_deg IS NULL and fc_id=202;
update sources.oregon_faults set dir=concat('dipping ', fltpl_dir, ', ', fltpl_deg, ' degrees') where fltpl_dir IS NOT NULL and fltpl_deg IS NOT NULL and fc_id=202;

update sources.oregon_faults set imp_ftype='fault' where fc_id=202 and imp_ftype='Other fault type';
update sources.oregon_faults set imp_ftype='Inclined fault' where fc_id=202 and imp_ftype='Inclined';
update sources.oregon_faults set imp_ftype='fault' where fc_id=202 and imp_ftype IS NULL;
update sources.oregon_faults set imp_ftype='normal fault' where fc_id=202 and imp_ftype ilike 'normal';
update sources.oregon_faults set imp_ftype='reverse fault' where fc_id=202 and imp_ftype ilike 'reverse';

update sources.oregon_faults set use_label=label;
update sources.oregon_faults set use_label=imp_ftype where use_label is null;

insert into lines.large (orig_id,source_id,name,type,direction,descrip,geom) SELECT gid,20,use_label,imp_ftype,dir,notes,st_makevalid(geom) from sources.oregon_faults;
pg_dump -t sources.oregon_faults -C -O burwell | gzip > ~/Desktop/oregon_faults.sql.gz
###########################
########################### ak#################################################################################

copy sources.ak_units from '/nsaunits.csv' CSV HEADER;
update sources.ak set descrip=m.description FROM sources.ak_units m where m.source_class=concat(ak.source,'_',ak.class);
update sources.ak set fossils=m.fossil FROM sources.ak_units m where m.source_class=concat(ak.source,'_',ak.class);
update sources.ak set age2=m.age FROM sources.ak_units m where m.source_class=concat(ak.source,'_',ak.class);
update sources.ak set lith=m.rock_class FROM sources.ak_units m where m.source_class=concat(ak.source,'_',ak.class);
update sources.ak set u_name=m.unit_name FROM sources.ak_units m where m.source_class=concat(ak.source,'_',ak.class);


update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing '?' from replace(age_range,'Lower','Early'))=m.interval_name;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing '?' from replace(age_range,'Upper','Lower'))=m.interval_name;

update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE replace(age_range,'Upper','Late') ilike concat(m.interval_name, '%') and early_id IS NULL;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE replace(age_range,'Lower','Early') ilike concat(m.interval_name, '%') and early_id IS NULL;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE replace(age_range,'lower','Early') ilike concat(m.interval_name, '%') and early_id IS NULL;


update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing '?' from replace(age_range,'Upper','Late')) ilike concat('% ',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing '?' from replace(age_range,'Lower','Early')) ilike concat('% ',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ', or older' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ', or older?' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ', and older' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ', and older' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ', and older?' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ak set late_id=m.id FROM macrostrat.intervals m WHERE trim(trailing ' and older?' from replace(age_range,'Lower','Early')) ilike concat('%',m.interval_name) and late_id IS NULL;




update sources.ak set late_id=94,early_id=112 WHERE age_range='lower Paleozoic, Devonian or older';
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Jurassic' and age_range='lower Paleozoic, Devonian or older';
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Triassic' and age_range='early Mesozoic or Paleozoic';
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Cretaceous' and age_range='lower Upper Cretaceous to upper Lower Cretaceous';
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cambrian' and age_range='early Paleozoic and Proterozoic?' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Early Permian' and age_range='lower Permian to Middle Pennsylvanian' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Early Devonian' and age_range='Lower? Devonian to Ordovician' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Early Permian' and age_range='lower Permian and Pennsylvanian' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cambrian-Ordovician' and age_range='early Paleozoic' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cambrian-Ordovician' and age_range='early Paleozoic to Proterozoic?' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cambrian' and age_range='earliest Paleozoic to Proterozoic' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Early Jurassic' and age_range='Upper and Middle Jurassic' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Middle Devonian' and age_range='Middle to Early Devonian' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Devonian' and age_range='Upper and Middle Devonian' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Early Permian' and age_range='lower Permian' and early_id is null;
update sources.ak set early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Cretaceous' and age_range='Upper and upper Lower Cretaceous' and early_id is null;
update sources.ak set early_id=98,late_id=95 WHERE  age_range='Upper and Middle? Devonian';
update sources.ak set early_id=42,late_id=40 WHERE  age_range='lower Upper or upper Lower Cretaceous';
update sources.ak set late_id=109,early_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Cambrian' and age_range='middle Silurian, Wenlock, to Upper Cambrian' and early_id is null;
update sources.ak set early_id=119,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Middle Ordovician' and age_range='Middle and Lower Ordovician' and early_id is null;
update sources.ak set early_id=98,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Devonian' and age_range='Late and Middle Devonian' and early_id is null;
update sources.ak set early_id=90,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Permian' and age_range='late Paleozoic' and early_id is null;
update sources.ak set early_id=493, late_id=493 WHERE age_range='early Paleozoic to Proterozoic' and early_id is null;
update sources.ak set early_id=53,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Jurassic' and age_range='Upper to Middle Jurassic' and early_id is null;
update sources.ak set early_id=68,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Triassic' and age_range='Upper and Middle Triassic' and early_id is null;
update sources.ak set early_id=984,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Mississippian' and age_range='Middle and Lower Pennsylvanian and Upper Mississippian?' and early_id is null;
update sources.ak set early_id=101,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Middle Devonian' and age_range='Middle to Lower Devonian' and early_id is null;
update sources.ak set early_id=493,late_id=493 where age_range='early Paleozoic and (or) late Proterozoic' and early_id is null;
update sources.ak set early_id=68,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Triassic' and age_range='Late and Middle Triassic' and early_id is null;
update sources.ak set early_id=41,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Late Cretaceous' and age_range='Upper and Lower? Cretaceous' and early_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cretaceous' and age_range='middle Cretaceous?' and early_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cambrian-Ordovician' and age_range='lower Paleozoic' and early_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Devonian-Mississippian' and age_range='Mississippian, Devonian, and older' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Triassic' and age_range='Triassic, Norian and older?' and late_id is null;
update sources.ak set early_id=42,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Hauterivian' and age_range='Lower Cretaceous, Hauterivian and younger' and late_id is null;
update sources.ak set early_id=34,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Paleocene' and age_range='Tertiary, Paleocene, or older' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cretaceous-Paleogene' and age_range='Tertiary, Paleogene, or older' and late_id is null;
update sources.ak set early_id=13,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Pliocene' and age_range='Tertiary, Pliocene? and older' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Devonian-Mississippian' and age_range='Mississippian and older' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Silurian-Devonian' and age_range='Devonian and older' and late_id is null;
update sources.ak set early_id=42,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Hauterivian' and age_range='Lower Cretaceous, Hauterivian and older' and late_id is null;
update sources.ak set early_id=24,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Oligocene' and age_range='Tertiary, Oligocene, or older' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Devonian-Mississippian' and age_range='Mississippian, Devonian, and older?' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Permian' and age_range='Permian? protolith' and late_id is null;
update sources.ak set early_id=29,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Eocene' and age_range='Tertiary, Eocene? or older' and late_id is null;

update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Paleocene' and age_range='Tertiary, Paleocene metamorphism' and late_id is null;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Jurassic' and age_range='Jurassic metamorphism' and late_id is null;

update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cenozoic' and age2='Quaternary and Tertiary' and late_id=0 and early_id=0;
update sources.ak set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE interval_name='Cenozoic' and age2='Quaternary and Tertiary' and late_id=0 and early_id=0;

update soures.ak set lith='Unconsolidated sediments' where lith='Unconsolidated';

INSERT INTO maps.medium (orig_id,source_id,name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,21,state_unit,age_range,lith,descrip,late_id,early_id,st_makevalid(geom) FROM sources.ak;

pg_dump -t sources.ak -C -O burwell | gzip > ~/Desktop/ak.sql.gz
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=21 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

#AK lines
UPDATE sources.ak_lines set type='Thrust Fault' where line_type ilike 'thrust fault%';
UPDATE sources.ak_lines set type='Thrust Fault' where line_type ilike '%thrust fault%';
UPDATE sources.ak_lines set type='Normal Fault' where line_type ilike '%normal fault%';
UPDATE sources.ak_lines set type='Reverse Fault' where line_type ilike '%reverse fault%';
UPDATE sources.ak_lines set type='Shear Zone' where line_type ilike '%shear zone%';
UPDATE sources.ak_lines set type='Strike Slip Fault',direct='left lateral' where line_type ilike '%left lateral fault%';
UPDATE sources.ak_lines set type='Strike Slip Fault',direct='right-lateral' where line_type ilike '%right lateral fault%';
UPDATE sources.ak_lines set type='Strike Slip Fault',direct='left lateral' where line_type ilike '%left-lateral fault%';
UPDATE sources.ak_lines set type='Strike Slip Fault',direct='right-lateral' where line_type ilike '%right-lateral fault%';
UPDATE sources.ak_lines set type='Fault' where line_type ilike '%fault%' and type IS NULL;

UPDATE sources.ak_lines set direct='Right, from origin' where line_type ilike '%teeth on right%';
UPDATE sources.ak_lines set direct='right lateral slip' where line_type ilike '%having right lateral oblique slip%' and direct is null;
UPDATE sources.ak_lines set direct='left lateral slip' where line_type ilike '%having left lateral oblique slip%' and direct is null;

insert into lines.medium (orig_id,source_id,descrip,type,direction,geom) SELECT gid,21,line_type,type,direct,st_makevalid(geom) from sources.ak_lines where type IS NOT NULL;

pg_dump -t sources.ak_lines -C -O burwell | gzip > ~/Desktop/ak_lines.sql.gz



#############################################################################################################################
#################################### ky24k
update sources.ky24k set description=left(descriptio,strpos(descriptio,':') -1);

UPDATE sources.ky24k set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Upper','Late')=m.interval_name;
UPDATE sources.ky24k set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Lower','Early')=m.interval_name;
update sources.ky24k set early_id=m.id FROM macrostrat.intervals m WHERE trim(left(replace(geologichi,'Upper','Late'),strpos(geologichi,'|') -1))=m.interval_name and early_id IS NULL;
update sources.ky24k set early_id=m.id FROM macrostrat.intervals m WHERE trim(left(replace(geologichi,'Lower','Early'),strpos(geologichi,'|') -1))=m.interval_name and early_id IS NULL;

update sources.ky24k set late_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Upper','Late') ilike concat('%| ',m.interval_name) and late_id IS NULL;
update sources.ky24k set late_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Lower','Early') ilike concat('%| ',m.interval_name) and late_id IS NULL;
update sources.ky24k set early_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Upper','Late') ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.ky24k set early_id=m.id FROM macrostrat.intervals m WHERE replace(geologichi,'Lower','Early') ilike concat(m.interval_name,'%') and early_id IS NULL;

UPDATE sources.ky24k set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE geologichi like 'Upper Mississippia' and interval_name ilike 'Late Mississippian';
UPDATE sources.ky24k set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE geologichi like 'Upper Pensylvanian | Upper Pennsylvanian' and interval_name ilike 'Late Pennsylvanian';
UPDATE sources.ky24k set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE geologichi like 'Middle Silurian' and interval_name ilike 'Wenlock';
UPDATE sources.ky24k set late_id=m.id FROM macrostrat.intervals m WHERE geologichi like 'Upper Ordovician | Middle Silurian' and interval_name ilike 'Wenlock';
UPDATE sources.ky24k set late_id=m.id FROM macrostrat.intervals m WHERE geologichi like 'Lower Silurian | Middle Silurian' and interval_name ilike 'Wenlock';
UPDATE sources.ky24k set early_id=20,late_id=2 FROM macrostrat.intervals m WHERE geologichi like 'Tertiary |';

update sources.ky24k set description='Osgood Formation and Brassfield Formation' where description='Osgood and Brassfield Formations';
update sources.ky24k set description='New Providence Shale and Chattanooga Shale' where description='New Providence and Chattanooga Shales';
update sources.ky24k set description='Nancy Member and Farmers Member' where description='Nancy and Farmers Members';
update sources.ky24k set description='Salem Limestone and Warsaw Limestone' where description='Salem and Warsaw Limestones';
update sources.ky24k set description='Shelburn Formation and Carbondale Formation' where description='Shelburn and Carbondale Formations';
update sources.ky24k set description='Tradewater Formation and Caseyville Formation' where description='Tradewater and Caseyville Formations';
update sources.ky24k set description='Grundy Formation and Alvy Creek Formation' where description='Grundy and Alvy Creek Formations';
update sources.ky24k set description='Bond Formation and Mattoon Formation' where description='Bond and Mattoon Formations';
update sources.ky24k set description='Kope Formation and Clays Ferry Formation' where description='Kope and Clays Ferry Formations';
update sources.ky24k set description='Tradewater Formation and Caseyville Formation' where description='conglomerate and sandstone, Tradewater and Caseyville Formations';
update sources.ky24k set description='Clayton Formation and McNairy Formation' where description='Clayton and McNairy Formations';


INSERT INTO maps.large (orig_id,source_id,name,age,lith,comments,t_interval,b_interval,geom) SELECT gid,22,description,geologichi,lithology,concat_ws('; ', name,source),late_id,early_id,st_makevalid(geom) FROM sources.ky24k;

pg_dump -t sources.ky24k -C -O burwell | gzip > ~/Desktop/ky24k.sql.gz

insert into lines.large (orig_id,source_id,name,descrip,type,direction,geom) SELECT gid,22,name,symbolizer,faulttype,movementty,st_makevalid(geom) from sources.ky24k_faults;

pg_dump -t sources.ky24k_faults -C -O burwell | gzip > ~/Desktop/ky24k_faults.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=22 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

update sources.ky_descrip set new_desc=NULL where new_desc='';
update sources.ky24k set descrip=m.new_desc from sources.ky_descrip m where m.orig_url=specificat and m.new_desc is not null;
update maps.large set descrip=m.descrip from sources.ky24k m where source_id=22 and m.gid=orig_id;
update maps.large set descrip=replace(descrip,'\n','') where source_id=22;
update maps.large set comments=concat(comments,' | ','Map description and column: ',specificat) from sources.ky24k m where m.descrip IS NOT NULL and source_id=22 and m.gid=orig_id;

############ uk  source 23
############ uk  source 23############ uk  source 23 ############ uk  source 23


UPDATE sources.uk set lex_d=initcap(lex_d);
UPDATE sources.uk set rcs_d=initcap(rcs_d);
UPDATE sources.uk set max_time_d=initcap(max_time_d);
UPDATE sources.uk set min_time_d=initcap(min_time_d);
UPDATE sources.uk set mb_eq_d=initcap(mb_eq_d);
UPDATE sources.uk set fm_eq_d=initcap(fm_eq_d);
UPDATE sources.uk set gp_eq_d=initcap(gp_eq_d);
UPDATE sources.uk set supgp_eq_d=initcap(supgp_eq_d);
UPDATE sources.uk set subgp_eq_d=initcap(subgp_eq_d);

UPDATE sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d ilike m.interval_name and late_id IS NULL;
UPDATE sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d ilike m.interval_name and early_id IS NULL;
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike concat(min_time_d,'%') and late_id IS NULL;
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike concat(max_time_d,'%') and early_id IS NULL;
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE replace(min_time_d,'Mid ','Middle ') ilike m.interval_name and late_id IS NULL;
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE replace(max_time_d,'Mid ','Middle ') ilike m.interval_name and early_id IS NULL;
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Courceyan' and interval_name='Tournaisian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Courceyan' and interval_name='Tournaisian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Brigantian' and interval_name='Visean';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Brigantian' and interval_name='Visean';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Asbian' and interval_name='Visean';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Asbian' and interval_name='Visean';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Palaeogene' and interval_name='Paleogene';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Palaeogene' and interval_name='Paleogene';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Dinantian' and interval_name='Mississippian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Dinantian' and interval_name='Mississippian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Bolsovian (Westphalian C)' and interval_name='Moscovian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Bolsovian (Westphalian C)' and interval_name='Moscovian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Duckmantian (Westphalian B)' and interval_name='Westphalian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Duckmantian (Westphalian B)' and interval_name='Westphalian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Langsettian (Westphalian A)' and interval_name='Westphalian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Langsettian (Westphalian A)' and interval_name='Westphalian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Palaeoproterozoic' and interval_name='Paleoproterozoic';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Palaeoproterozoic' and interval_name='Paleoproterozoic';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Archaean' and interval_name='Archean';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Archaean' and interval_name='Archean';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Chadian' and interval_name='Osagean';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Chadian' and interval_name='Osagean';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Ryazanian' and interval_name='Berriasian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Ryazanian' and interval_name='Berriasian';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Silesian' and interval_name='Carboniferous';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Silesian' and interval_name='Carboniferous';
update sources.uk set early_id=m.id FROM macrostrat.intervals m WHERE max_time_d='Abereiddian' and interval_name='Whiterock';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Abereiddian' and interval_name='Whiterock';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Marsdenian' and interval_name='Namurian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Yeadonian' and interval_name='Bashkirian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Pendleian' and interval_name='Chesterian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Holkerian' and interval_name='Meramecian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Praghian' and interval_name='Pragian';
update sources.uk set late_id=m.id FROM macrostrat.intervals m WHERE min_time_d='Westphalian D' and interval_name='Westphalian';
update sources.uk set max_time_d='Unknown', min_time_d='Unknown' where gid=4432;
update sources.uk set max_time_d='Unknown', min_time_d='Unknown' where max_time_d='Not Applicable' and min_time_d='Not Applicable';

UPDATE sources.uk set age_name=concat_ws(' - ', max_time_d,min_time_d) where max_time_d!=min_time_d;
UPDATE sources.uk set age_name=max_time_d where max_time_d=min_time_d;

update sources.uk set rcs_d=REPLACE(rcs_d,' And ',' and ');
update sources.uk set mb_eq_d=NULL where mb_eq_d='Not Applicable';
update sources.uk set fm_eq_d=NULL where fm_eq_d='Not Applicable';
update sources.uk set gp_eq_d=NULL where gp_eq_d='Not Applicable';
update sources.uk set supgp_eq_d=NULL where supgp_eq_d='Not Applicable';
update sources.uk set subgp_eq_d=NULL where subgp_eq_d='Not Applicable';
update sources.uk set mb_eq_d=NULL where mb_eq_d='No Parent';
update sources.uk set fm_eq_d=NULL where fm_eq_d='No Parent';
update sources.uk set gp_eq_d=NULL where gp_eq_d='No Parent';
update sources.uk set supgp_eq_d=NULL where supgp_eq_d='No Parent';
update sources.uk set subgp_eq_d=NULL where subgp_eq_d='No Parent';

update sources.uk set strat_name=concat_ws(' of ',mb_eq_d,fm_eq_d,subgp_eq_d,gp_eq_d,supgp_eq_d);
INSERT INTO maps.medium (orig_id,source_id,name,age,lith,strat_name,t_interval,b_interval,geom) SELECT gid,23,lex_d,age_name,rcs_d,strat_name, late_id,early_id,st_makevalid(geom) FROM sources.uk;

pg_dump -t sources.uk -C -O burwell | gzip > ~/Desktop/uk.sql.gz
gunzip -c ~/Desktop/uk.sql.gz | psql burwell -U john

update maps.medium set lith=lower(lith) where source_id=23;
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=23 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');
insert into lines.medium (orig_id,source_id,name,type,geom) SELECT gid,23,feature_d,feature_d,st_makevalid(geom) from sources.uk_lines;
pg_dump -t sources.uk_lines -C -O burwell | gzip > ~/Desktop/uk_lines.sql.gz

############ yukon  source 24
update sources.yukon set early_id=m.id FROM macrostrat.intervals m where m.interval_name=stage_max and early_id IS NULL;
update sources.yukon set early_id=m.id FROM macrostrat.intervals m where m.interval_name=epoch_max and early_id IS NULL;
update sources.yukon set early_id=m.id FROM macrostrat.intervals m where m.interval_name=period_max and early_id IS NULL;
update sources.yukon set early_id=m.id FROM macrostrat.intervals m where m.interval_name=era_max and early_id IS NULL;
update sources.yukon set late_id=m.id FROM macrostrat.intervals m where m.interval_name=stage_min and late_id IS NULL;
update sources.yukon set late_id=m.id FROM macrostrat.intervals m where m.interval_name=epoch_min and late_id IS NULL;
update sources.yukon set late_id=m.id FROM macrostrat.intervals m where m.interval_name=period_min and late_id IS NULL;
update sources.yukon set late_id=m.id FROM macrostrat.intervals m where m.interval_name=era_min and late_id IS NULL;

update sources.yukon set age_name=m.interval_name FROM macrostrat.intervals m where early_id=m.id and early_id=late_id;
update sources.yukon set age_name=concat_ws(' - ', m.interval_name, j.interval_name) FROM macrostrat.intervals m, macrostrat.intervals j where early_id=m.id and late_id=j.id and early_id!=late_id;

update sources.yukon set strat_name=concat(formation, ' Fm') where strat_name is null and formation is not null and formation not like 'lower' and formation not like 'upper' and formation not like 'undifferentiated';
update sources.yukon set gp_suite='upper' where gp_suite ilike '%upper%';
update sources.yukon set strat_name=concat(gp_suite, ' Gp') where strat_name is null and gp_suite is not null and gp_suite not like 'upper' and gp_suite not like 'upper';
update sources.yukon set strat_name=concat(supergroup, ' SGp') where strat_name is null and supergroup is not null;

update sources.yukon set lith=concat('Major:: {',rock_major, '}') where rock_major IS NOT NULL;
update sources.yukon set lith=concat(lith, ',Minor:: {',rock_minor, '}') where rock_minor IS NOT NULL;
update sources.yukon set lith=replace(lith,' qtz ',' quartz ');
update sources.yukon set lith=replace(lith,'/',',');
update sources.yukon set lith=replace(lith,'conglo,','conglomerate,');
update sources.yukon set unit_name=name where unit_name is null;
update sources.yukon set unit_name=strat_name where unit_name is null;
update sources.yukon set unit_name=concat_ws(' ', age_name,rock_major) where unit_name is null;

INSERT INTO maps.medium (orig_id,source_id,name,age,lith,strat_name,descrip,comments,t_interval,b_interval,geom) SELECT gid,24,unit_name,age_name,lith,strat_name,rock_notes,reference,late_id,early_id,st_makevalid(geom) FROM sources.yukon;
pg_dump -t sources.yukon -C -O burwell | gzip > ~/Desktop/yukon.sql.gz


insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=24 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');

update sources.yukon_lines set show_name=name;
update sources.yukon_lines set show_name=concat_ws(' ',type,feature) where show_name IS NULL and type not like 'unknown';
update sources.yukon_lines set show_name=concat_ws(' ',feature) where show_name IS NULL;
update sources.yukon_lines set show_type=show_name where name is null;
update sources.yukon_lines set show_type=concat_ws(' ',type,feature) where show_type IS NULL and type not like 'unknown';
update sources.yukon_lines set show_type=concat_ws(' ',feature) where show_type IS NULL;
update sources.yukon_lines set subtype=NULL where subtype='m';
update sources.yukon_lines set show_direction=subtype where subtype like 'dextral';
update sources.yukon_lines set show_direction=subtype where subtype like 'sinistral';
update sources.yukon_lines set show_direction=symbol_dir where show_direction IS NULL;
update sources.yukon_lines set confidence=concat_ws(' ','location',confidence);
#update sources.yukon_lines set confidence=NULL where confidence='location defined';

insert into lines.medium (orig_id,source_id,name,type,direction,descrip,geom) SELECT gid,24,show_name,show_type,show_direction,concat_ws('; ',confidence,comments),st_makevalid(geom) from sources.yukon_lines;
pg_dump -t sources.yukon_lines -C -O burwell | gzip > ~/Desktop/yukon_lines.sql.gz


update sources.yukon_folds set type_name='syncline' where fold_type ilike '%syncline%';
update sources.yukon_folds set type_name='anticline' where fold_type ilike '%anticline%';
update sources.yukon_folds set type_name='monocline' where fold_type ilike '%monocline%';
update sources.yukon_folds set print_name=fold_name;
update sources.yukon_folds set print_name=type_name where print_name IS NULL;

insert into lines.medium (orig_id,source_id,name,type,descrip,geom) SELECT gid,24,print_name,type_name,fold_type,st_makevalid(geom) from sources.yukon_folds;
pg_dump -t sources.yukon_folds -C -O burwell | gzip > ~/Desktop/yukon_folds.sql.gz

############ rockies large/medium  ref 25
delete from sources.rockies where gid=79780;
delete from sources.rockies where gid=79976;
UPDATE sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or ilike m.interval_name and early_id IS NULL;
UPDATE sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or ilike m.interval_name and late_id IS NULL;
update sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or='Middle Proterozoic' and interval_name='Mesoproterozoic';
update sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or='Late Proterozoic' and interval_name='Neoproterozoic';
update sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or='Early Proterozoic' and interval_name='Paleoproterozoic';
update sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or='Middle Archean' and interval_name='Mesoarchean';
update sources.rockies set late_id=m.id FROM macrostrat.intervals m WHERE minage_or='Late Archean' and interval_name='Neoarchean';

update sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or='Middle Proterozoic' and interval_name='Mesoproterozoic';
update sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or='Late Proterozoic' and interval_name='Neoproterozoic';
update sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or='Early Proterozoic' and interval_name='Paleoproterozoic';
update sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or='Middle Archean' and interval_name='Mesoarchean';
update sources.rockies set early_id=m.id FROM macrostrat.intervals m WHERE maxage_or='Late Archean' and interval_name='Neoarchean';

update sources.rockies set name_majr1=trim(replace(name_majr1,'nodata',''));
update sources.rockies set lith_name=concat('Major:: {',concat_ws(' ',name_majr1,name_majr2), '}') where name_majr1 is not null;
update sources.rockies set name_minor=trim(replace(name_minor,'nodata',''));
update sources.rockies set name_minor=trim(both '|' from name_minor)
update sources.rockies set lith_name=concat_ws('; ', lith_name, concat('Minor:: {',name_minor,'}')) where name_minor is not null;
update sources.rockies set lith_name='sand, gravel' where lith_name is null and uname_1 = 'unconsolidated sediments';
update sources.rockies set lith_name='siliciclastic sedimentary rocks' where lname_dom='siliciclastic sedimentary rocks' and lith_name IS NULL;
update sources.rockies set lith_name=lname_dom where lith_name IS NULL;


INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,25,name,age_or,lith_name,concat_ws('; ', name_major,name_oth_1),late_id,early_id,st_makevalid(geom) FROM sources.rockies;
pg_dump -t sources.rockies -C -O burwell | gzip > ~/Desktop/rockies.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=25 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

UPDATE sources.rockies_lines set new_type='thrust fault' where line_type2  like '%reverse fault%';
UPDATE sources.rockies_lines set new_type='strike-slip fault' where line_type2  like 'strike-slip fault';
UPDATE sources.rockies_lines set new_type='normal fault' where line_type2  like 'gravity fault';
UPDATE sources.rockies_lines set new_type='shear zone' where line_type2  like 'mylonite';

UPDATE sources.rockies_lines set new_type='dike' where line_type1 ilike '%dike%';
UPDATE sources.rockies_lines set new_type='syncline' where line_type2 ilike '%syncline%';
UPDATE sources.rockies_lines set new_type='anticline' where line_type2 ilike '%anticline%';
UPDATE sources.rockies_lines set new_type='monocline' where line_type2 ilike '%monocline%';
UPDATE sources.rockies_lines set new_type='normal fault' where line_type2 ='detachment fault';
UPDATE sources.rockies_lines set new_type='fault' where line_type2 ='fault';
UPDATE sources.rockies_lines set new_type='thrust fault' where line_type2  like '%thrust fault%';
UPDATE sources.rockies_lines set new_type='normal fault' where line_type2  like '%normal fault%';
update sources.rockies_lines set new_direction='right-lateral' where line_type3 like '%right-lateral%';
update sources.rockies_lines set new_direction='left-lateral' where line_type3 like '%left-lateral%';
update sources.rockies_lines set line_type3=NULL where line_type3=line_type2;
update sources.rockies_lines set line_type3=replace(line_type3,' (dashed)','');
update sources.rockies_lines set line_type3=replace(line_type3,' (dotted)','');

insert into lines.large (orig_id,source_id,type,new_type,new_direction,descrip,geom) SELECT gid,25,line_type2,new_type,new_direction,line_type3,st_makevalid(geom) from sources.rockies_lines;
pg_dump -t sources.rockies_lines -C -O burwell | gzip > ~/Desktop/rockies_lines.sql.gz


########## iowa map medium
update sources.iowa set age='upper Campanian', descrip='Terrace Terrane (Megablock Zone); Manson Impact Structure (Upper Cretaceous; upper Campanian). Upper Interval (bedrock surface): sedimentary-clast breccia with shaly matrix, clasts and blocks of Cretaceous shale and varied Paleozoic lithologies entrained in silty-sandy clay matrix; minor clasts/grains of Proterozoic red clastics (mudstone/siltstone), crystalline basement rock, devitrified melt rock. Lower Interval (variably present, locally forms bedrock surface): overturned ejecta flap, breccias of Paleozoic lithologies and Proterozoic red clastics preserved in general inverted stratigraphic order.  Breccias overlie down-dropped blocks (ring graben) of Cretaceous and Paleozoic strata in normal stratigraphic succession.  Maximum thicknesses: upper shaly breccia up to 700 ft (210 m); lower interval approx. 1000 ft (300 m).' WHERE unitcode='Kmt';
update sources.iowa set age='upper Campanian', descrip='Crater Moat area; Manson Impact Structure (Upper Cretaceous; upper Campanian). Primary Lithology: sedimentary clast breccia with shaly matrix; clasts and blocks of Cretaceous shale and varied Paleozoic lithologies in silty-sandy clay matrix.  Minor Lithologies: grains or clasts of Proterozoic "red clastics" (mudstone/siltstone), Proterozoic crystalline basement, devitrified melt grains.  Maximum thickness unknown, may reach thicknesses to 10,000 ft (3000 m).' WHERE unitcode='Kmm';
update sources.iowa set age='upper Campanian', descrip='Central Peak; Manson Impact Structure (Upper Cretaceous; upper Campanian). Primary Lithology (at bedrock surface): sedimentary clast breccia with shaly matrix; clasts and blocks of Cretaceous shale and varied Paleozoic lithologies in silty-sandy clay matrix (see above; thickness 0-200 ft; 60 m). Secondary Lithologies: crystalline rock megabreccia (locally forms bedrock surface), fractured and brecciated Proterozoic basement lithologies, dominantly gneiss but including granite and other igneous-metamorphic rocks (maximum thickness unknown).  Suevite and impact-melt breccias (locally forms bedrock surface), clasts of Proterozoic crystalline basement rocks, melt-rock, and minor Proterozoic red clastics in a matrix of melt-rich material (devitrified) and/or sandy-silty debris (thicknesses to 380 ft; 115 m). Keweenawan shale-clast breccia (locally forms bedrock surface), dominated by gray to black shale clasts (small to large) derived the lower red clastics sequence, common melt clasts, minor basement and Phanerozoic clasts, in a silty-sandy shaly matrix or melt-rich matrix (thicknesses to 250 ft; 75 m).' WHERE unitcode='Kmc';
update sources.iowa set age='Santonian, lower Campanian', descrip='Primary Lithologies: shale, gray, silty, calcareous to marly. Estimated maximum thickness 50 ft (15 m). Present only in Lyon County.' WHERE unitcode='Kn';
update sources.iowa set age='Cenomanian-Turonian', descrip='Interval includes "Graneros" Shale, Greenhorn Formation, Carlile Shale. Primary Lithologies: shale, medium to dark gray, variably silty, calcareous to very calcareous. Secondary lithologies: chalk, marl, argillaceous limestone, with skeletal (inoceramid) packstones; shale, gray, silty, noncalcareous. Minor: siltstone; calcite and siderite concretions. Maximum thickness 265 ft (80 m).' WHERE unitcode='Kf';
update sources.iowa set age='upper Albian-upper Cenomanian', descrip='Dakota Formation widespread in western Iowa, lower sandstone-dominated Nishnabotna Member, upper mudstone/shale-dominated Woodbury Member. Correlative Windrow Formation found as erosional outliers in northeastern and north-central Iowa. Primary lithologies: sandstone, quartzose, very fine to medium grained; mudstone/shale, light to dark gray, variably silty-sandy, noncalcareous (Woodbury Mbr.). Secondary lithologies: sandstone, medium to very coarse grained, part pebbly to gravelly, locally cemented by iron oxides (Nishnabotna Mbr., Windrow Fm.), gravel, quartz and chert clasts; siltstone; mudstone, red, pink, yellow-brown, black (carbonaceous). Minor: lignite; siderite (concretions, pedogenic sphaerosiderite pellets, cemented siltstone); massive iron ore, silty to sandy (Windrow Fm.). Maximum thickness Dakota Fm. 500 ft (150 m), commonly 100-300 ft (30-90 m); Windrow Fm. 40 ft (12 m).' WHERE unitcode='Kd';
update sources.iowa set age='Middle or Upper Jurassic, possibly Oxfordian', descrip='Present only in Webster County. Primary lithologies: gypsum, mostly alabastrine (lower unit, Gypsum Creek Mbr.); redbeds including mudstone/claystone (red to green-gray), sandstone (very fine to medium and coarse grained) (upper unit, Soldier Creek Mbr.). Secondary lithologies: basal conglomerate and sandstone, carbonate clasts (Shady Oak Mbr.). Minor: quartz crystals. Maximum thicknesses: gypsum bed to 32 ft (10 m), upper redbeds to 52 ft (16 m).' WHERE unitcode='Jf';
update sources.iowa set age='middle-upper Virgilian', descrip='Interval includes Howard, White Cloud, Scranton, Bern, Auburn, Emporia, Willard, Zeandale, Pillsbury, Stotler, Root formations. Primary Lithologies: shale, light to dark gray; mudstone, gray, part laminated silty to sandy. Secondary Lithologies: limestone, fossiliferous, part coated grain/Osagia; pedogenic mudstone, part red to maroon, part calcareous/nodular; siltstone to very fine sandstone. Minor: black shale; coal. Maximum thickness 320 ft (98 m) in Fremont County.' WHERE unitcode='Pw';
update sources.iowa set age='lower-middle Virgilian', descrip='Interval includes Oread, Kanwaka, Lecompton, Tecumseh, Deer Creek, Calhoun, Topeka formations. Primary Lithologies:  limestone, fossiliferous, part coated grain/Osagia; shale/mudstone, light to dark gray. Secondary Lithologies: pedogenic mudstone, part calcareous/nodular; siltstone to very fine sandstone; black shale, phosphatic. Minor: chert; coal, coaly shale; red-brown mudstone. Maximum thicknesses 190-220 ft (58-67 m).' WHERE unitcode='Ps';
update sources.iowa set age='upper Missourian-lower Virgilian', descrip='Interval includes Stranger, Cass, Lawrence formations. Primary Lithologies: shale and mudstone, light to dark gray, part silt laminated. Secondary Lithologies: limestone, fossiliferous, part coated grain; siltstone to very fine sandstone; pedogenic mudstone, part red-brown, part calcareous/nodular. Minor: coal, carbonaceous shale; black shale. Maximum thicknesses 90-135 ft (27-41 m).' WHERE unitcode='Pd';
update sources.iowa set age='upper Missourian', descrip='Interval includes Plattsburg, Vilas, Stanton formations. Primary Lithologies: limestone, fossiliferous; shale/mudstone, light to dark gray. Secondary Lithologies: limestone, coated grain/Osagia; mudstone to siltstone, gray. Minor: black shale, phosphatic; mudstone, red-brown. Maximum thicknesses 45-78 ft (14-24 m).' WHERE unitcode='Pl';
update sources.iowa set age='middle Missourian', descrip='Interval includes Cherryvale, Nellie Bly, Dewie, Chanute, Iola, Liberty Memorial, Wyandotte, Lane formations. Primary Lithologies: limestone fossiliferous; shale/mudstone, light to dark gray. Secondary Lithologies: limestone, coated grain/Osagia. Minor: mudstone, red-brown to green-gray; siltstone; black shale, phosphatic; thin coal, carbonaceous shale. Maximum thicknesses 100-140 ft (30-43 m).' WHERE unitcode='Pk';
update sources.iowa set age='uppermost Desmoinesian-lower Missourian', descrip='Interval includes Pleasanton, Hertha, Elm Branch, Swope, Galesburg, Dennis formations. Primary Lithologies: limestone, fossiliferous; shale/mudstone, light to dark gray. Secondary lithologies: mudstone to siltstone, gray to green-gray; limestone, coated grain. Minor: black shale, phosphatic; red/maroon mudstone; coal; chert. Maximum thicknesses 100-130 ft (30-40 m).' WHERE unitcode='Pb';
update sources.iowa set age='upper Desmoinesian', descrip='Interval includes Morgan School, Mouse Creek, Labette, Pawnee, Bandera, Altamont, Nowata, Lenapah, Memorial, Lost Branch formations. Primary Lithologies: shale/mudstone, light to dark gray; limestone, fossiliferous. Secondary Lithologies: mudstone, green-gray to red/maroon; shale, black, phosphatic; sandstone, very fine to medium grained. Minor: coal; siltstone, conglomerate. Maximum thicknesses: 125-175 ft (38-52 m).' WHERE unitcode='Pm';
update sources.iowa set age='middle Desmoinesian', descrip='Interval includes Verdigris and Swede Hollow formations; base of map unit drawn at the widespread Whitebreast Coal. Primary Lithologies:  shale/mudstone, light to dark gray, part silty to sandy; siltstone, gray. Secondary Lithologies: limestone, part fossiliferous, part sandy; sandstone, very fine to fine-grained. Minor: mudstone, red/maroon to brown; shale, black, phosphatic; carbonaceous shale; coal (beds locally &gt; 2 ft); ironstone/siderite concretions; limestone concretions (may be septarian); pyrite. Average thickness 100 ft (30 m); maximum thicknesses to 130 ft (40 m).' WHERE unitcode='Pcu';
update sources.iowa set age='Morrowan-lower Desmoinesian', descrip='Lower Cherokee Group in southern, central, and western Iowa includes Kilbourn, Kalo, Floris formations (primarily Atokan-lower Desmoinesian, locally Morrowan at base); Raccoon Creek Group in eastern Iowa includes "Caseyville" and Tradewater formations (primarily Morrowan at most localities; locally includes Atokan-lower Desmoinesian Tradewater Formation in upper part). Primary Lithologies:  shale/mudstone, light to dark gray, part silty to sandy; sandstone, very fine to medium grained; siltstone, gray. Secondary Lithologies:  carbonaceous shale/mudstone, gray to black; phosphatic black shale; limestone, dense, part fossiliferous, part sandy; coal (beds locally 2 ft). Minor: sandstone, coarse-grained to granular, part conglomeratic; mudstone, red to pink; limestone concretions (may be septarian); cone-in-cone limestone; siderite/ironstone concretions and pellets; pyrite. Maximum thicknesses Raccoon Creek Group in Muscatine-Scott counties: 230-250 ft (70-75 m). Maximum thicknesses Lower Cherokee Group across outcrop belt: 200-370 ft (60-113 m). Maximum thickness in southwest Iowa subsurface: 650 ft (200 m).' WHERE unitcode='Pcl';
update sources.iowa set age='Meramecian-lower Chesterian', descrip='Interval includes lower "St. Louis" (Meramecian) Croton and Yenruogis members; upper "St. Louis" (lower Genevievian) Verdi and Waugh members (interval does not correlate with type St. Louis of Missouri); Pella Fm (upper Genevievian); base includes Sonora Fm (Meramecian) in parts of southeast Iowa (Lee, Van Buren, Henry, Des Moines, Jefferson counties). Primary Lithologies: dolomite, part silty/sandy, part fossiliferous; limestone, part sandy to fossiliferous; part "sublithographic," part argillaceous. Secondary Lithologies: dolomite/limestone breccia; shale/marl, green-gray, calcareous; sandstone, fine to medium-grained; siltstone; gypsum/anhydrite (south-central Iowa). Minor: limestone, oolitic; shale, gray; shale, red to pink; chert/chalcedony. Croton Member contains gypsum-anhydrite in subsurface outside of outcrop belt. Interval is erosionally beveled to locally absent beneath Pcl; Pella Formation absent over broader areas. Maximum thicknesses for total interval 60-150 ft (18-45 m); maximum thickness Pella Formation 75 ft (23 m); maximum thickness "St. Louis" Formation 75 ft (23 m); maximum thickness Sonora Formation 35 ft (11 m).' WHERE unitcode='Ms';
update sources.iowa set age='Osagean-lower Meramecian', descrip='Interval includes Burlington, Keokuk, and Warsaw formations. Primary Lithologies: dolomite, part argillaceous to shaly; dolomitic limestone, fossiliferous; fossiliferous limestone (especially crinoidal packstone-grainstone). Secondary Lithologies: glauconitic limestone/dolomite; shale, gray to green-gray, part dolomitic, part silty; chert, nodular to bedded. Minor: quartz crystals, quartz geodes, chalcedony; phosphatic dolomite/limestone ("bone bed"); siltstone, dolomitic. Lithologies noted only in northern Iowa: oolitic limestone; "sublithographic" limestone; dolomite/chert breccia. Interval is erosionally beveled beneath sub-"St. Louis" and sub-Pennsylvanian unconformities. Maximum thicknesses in northern Iowa: 85-105  ft (26-32 m). Maximum thicknesses in southern Iowa: 155-240 ft (47-73 m).' WHERE unitcode='Ma';
update sources.iowa set age='upper Kinderhookian-lower Osagean', descrip='Interval includes lower Marble Valley Member, upper Humboldt Member; "Iowa Falls Dolomite" (dolomite facies); formation shares partial regional facies relationships with Burlington Formation; not present in southeastern Iowa. Primary Lithologies: limestone, primarily coated grain/oolitic to peloidal, variably fossiliferous to intraclastic. Secondary Lithologies: dolomite; dolomitic limestone; limestone, dense, "sublithographic."  Minor: shale, gray, calcareous; oncolitic limestone; glauconite; chert; breccia. Maximum thicknesses in northern Iowa 150-170 ft (45-52 m); interval thins to south and southeast 20-70 ft (6-21 m).' WHERE unitcode='Mg';
update sources.iowa set age='Kinderhookian', descrip='Interval includes Prospect Hill, Chapin, Maynes Creek, and Wassonville formations; locally includes basal Crapo ("McCraney") Formation in southeastern Iowa. Primary Lithologies: dolomite, part cherty to very cherty, part fossiliferous (Maynes Creek-Wassonville formations); limestone, skeletal to oolitic (Chapin Fm; lower Wassonville Fm/Starrs Cave Member; middle Maynes Creek/"Eagle City" member; basal Crapo Fm); siltstone (Prospect Hill Fm). Secondary Lithologies: shale, gray, silty (Prospect Hill Fm of southeastern Iowa); limestone, dense, "sublithographic" to stromatolitic (upper Maynes Creek Fm); limestone and dolomite, dense, nodular to banded, part silty (Crapo Fm). Maximum thicknesses for total interval: 100-175 ft (30-53 m). Thickness variations: Crapo ("McCraney") Fm, 0-65 ft (20 m); Prospect Hill Fm, 0-90 ft (27 m), generally 25 ft (8 m); Chapin Fm, 0-30 ft (9 m), generally 10 ft (3 m); Maynes Creek Fm, 35-155 ft (11-47 m), thickest in central to northern Iowa; Wassonville Fm (southeast Iowa only), 0-70 ft (21 m), replaced to northwest by Maynes Creek and Chapin formations, beveled beneath sub-Burlington unconformity to southeast.' WHERE unitcode='Mk';
update sources.iowa set age='Famennian', descrip='Interval includes Grassy Creek Shale, Saverton Shale, "Maple Mill" Shale, English River Formation, Louisiana Limestone (Lee County only), Aplington Formation (northern and western Iowa only), Sheffield Shale (central and northern Iowa). Famennian strata onlap Lime Creek Fm to the northwest. Primary Lithologies: shale, gray to green-gray, part silty; siltstone (especially English River Fm). Secondary Lithologies: shale, olive-brown and medium to dark brown, part laminated (Grassy Creek Fm, southeast Iowa); dolomite, part fossiliferous, part cherty, part argillaceous (Aplington Fm). Minor: interstratified dolomite and limestone, part fossiliferous (Louisiana Limestone); ooidal ironstone and phosphorite; phosphatic siltstone ("bone bed"); shale, red-brown. Maximum thicknesses in outcrop belt: southeast Iowa, 135-310 ft (41-95 m), thickest in Washington, Louisa, Des Moines counties; northern and central Iowa, 25-135 ft (8-41 m).' WHERE unitcode='Df';
update sources.iowa set age='upper Frasnian', descrip='Interval includes Sweetland Creek Shale in southeast Iowa, and "Amana beds" of Iowa County. Lime Creek Fm onlaps eroded Ordovician surface in northwestern Iowa. Primary Lithologies: shale, gray to green-gray, dolomitic to calcareous; limestone, variably argillaceous, fossiliferous, part biostromal; dolomite, variably argillaceous, part fossiliferous. Secondary Lithologies: limestone, dense, "sublithographic" (upper part of carbonate-dominated facies in central and northwestern Iowa); shale, green-gray to brown, silty (Sweetland Creek Shale). Minor: siltstone; chert; oolitic limestone, carbonate breccia (central to northwestern Iowa). Thickness variations in outcrop belt: Sweetland Creek Shale of southeastern Iowa, 3-30 ft (1-9 m); Lime Creek Fm of southeastern to north-central Iowa, 40-200 ft (12-60 m); Lime Creek Fm of northwestern Iowa, 200-350 ft (60-105 m).' WHERE unitcode='Dl';
update sources.iowa set age='middle Givetian-middle Frasnian', descrip='Interval includes Little Cedar, Coralville, Lithograph City, and Shell Rock formations; Shell Rock Fm in northern Iowa only. Primary Lithologies: limestone, fossiliferous, variably argillaceous, part biostromal; dolomite, part fossil-moldic to vuggy, variably argillaceous. Secondary Lithologies: limestone, dense, "sublithographic"; dolomite/limestone breccia (evaporite collapse); limestone, sparse to unfossiliferous, argillaceous to shaly; shale, gray to green-gray, dolomitic. Minor: anhydrite/gypsum (outcrop belt only in Grundy, Tama, Poweshiek counties; extensive in subsurface of central and southern Iowa); chert; glauconite; sandy limestone/sandstone. Maximum thicknesses in outcrop belt: southeast Iowa, 80-135 ft (24-41 m); east-central Iowa 130-210 ft (40-64 m); northern Iowa 250-350 ft (76-107 m). Cedar Valley Group thins and is overstepped by Dl westward in Winnebago County.' WHERE unitcode='Dc';
update sources.iowa set age='upper Eifelian-middle Givetian', descrip='Interval includes Pinicon Ridge, Otis, Spillville, and Bertram formations. Otis and Bertram formations restricted to east-central Iowa only; Spillville Formation in northeast Iowa only. Pinicon Ridge Formation oversteps Spillville and Otis edges in Fayette, Bremer, Black Hawk, Buchanan, southern Chickasaw counties to directly overlie Sh, Sw, or Om. Primary Lithologies: dolomite, part laminated, variably argillaceous, part fetid; limestone, dense, "sublithographic", part laminated to intraclastic; dolomite, fossil-moldic to vuggy (Otis-Spillville fms). Secondary Lithologies: limestone/dolomite breccia (evaporite collapse); dolomitic shale and shaly dolomite, gray to green-gray, part silty-sandy; limestone, part peloidal to fossiliferous (Otis Fm). Minor: chert and chalcedony nodules (Pinicon Ridge Fm); sandstone; oolitic limestone (Otis Fm). Extensive anhydrite/gypsum in subsurface outside of outcrop belt. Maximum thicknesses in outcrop belt: east-central Iowa, 60-160 ft (18-49 m); northern Iowa, 10-130 ft (3-40 m), locally absent in Bremer County beneath Dc.' WHERE unitcode='Dw';
update sources.iowa set age='Wenlock-Ludlow', descrip='Formation includes Anamosa, Brady, LeClaire (Scott-Muscatine counties) members; Brady and LeClaire members are carbonate mound facies. Erosionally beveled and truncated beneath Dw. Primary Lithologies: laminated dolomite (Anamosa Mbr), part fetid/organic to east (Scott-Clinton counties); dolomite mudstone, dense, featureless. Secondary Lithologies: dolomite, fossiliferous to vuggy, moldic, part brachiopod-rich (Brady Member); dolomite, part coarsely crystalline, vuggy, fossiliferous to sparsely fossiliferous, part crinoidal (LeClaire Member). Minor: chert; intraclastic dolomite. Maximum thickness: 180 ft (55 m); beveled and truncated beneath Dw.' WHERE unitcode='Sg';
update sources.iowa set age='upper Llandovery-lower Wenlock', descrip='Formation includes Welton, Buck Creek Quarry, Waubeek, Palisades-Kepler, Johns Creek Quarry members; Palisades-Kepler and Johns Creek Quarry members contain carbonate mound facies. Erosionally beveled and truncated beneath Dw. Primarily Lithologies: dolomite, porous, fossil-moldic to vuggy, part very crinoidal (includes Welton Mbr); dolomite, cherty to very cherty, dense (Buck Creek Quarry Mbr). Secondary Lithologies: dolomite, sparsely fossil-moldic, dense, part vuggy (includes Waubeek Mbr); dolomite, coarsely crystalline, part very crinoidal (within Johns Creek Quarry, Palisades-Kepler mbrs); dolomite mudstone, dense. Minor: dolomite, slightly argillaceous; quartz druse, chalcedony, silicified fossils. Maximum thicknesses: 94-240 ft (29-73 m); may reach thicknesses to 300 ft (90 m); beveled and truncated beneath Dw.' WHERE unitcode='Ss';
update sources.iowa set age='Rhuddanian, Aeronian-upper Llandovery', descrip='Recent work has proposed correlation of Mosalem and Tete des Morts formations with ?uppermost Ordovician, upper Hirnantian. Mosalem Formation infills erosional paleovalleys incised into Maquoketa Shale; absent outside of paleovalleys. Lower Hopkinton Formation locally contains carbonate mound facies in Bremer County. Blanding Formation oversteps Tete des Morts-Mosalem edge in southern outcrop area. Primary Lithologies: dolomite, fossil-moldic to vuggy, fine to coarse crystalline; dolomite, dense to porous, cherty to very cherty, nodular to bedded chert (especially Blanding Fm). Secondary Lithologies: dolomite, dense, sparsely fossiliferous; dolomite, argillaceous, part laminated (Mosalem Fm). Minor: chalcedony, silicified fossils. Maximum thicknesses total interval: 160-330 ft (49-100 m), thickest in Dubuque, Jackson, Jones counties where Mosalem present; southern outcrop total thickness 65-130 ft (20-40 m). Formation thicknesses: Hopkinton, 65-160 ft (20-49 m); Blanding, 25-65 ft (8-20 m); Tete des Morts, 0-35 ft (11 m); Mosalem, 0-100 ft (30 m).' WHERE unitcode='Sh';
update sources.iowa set age='upper Llandovery-lower Wenlock', descrip='Interval is a northwestern limestone facies that correlates with dolomite strata (upper Hopkinton-lower Scotch Grove formations) to the south and east; locally interfingers with dolomite to south; it overlies progressively higher stratigraphic levels southward within the Hopkinton to Scotch Grove formations. Sl forms highest Silurian unit throughout its extent; unconformably overlain by Dw. Primary lithologies: limestone, dense, fossiliferous, part cherty to very cherty. Secondary lithologies: dolomitic limestone, dolomite. Minor: argillaceous to shaly chert residuum at top (may be basal Dw); shale, green-gray. Maximum thickness, 140 ft (43 m); average thicknesses: 20-60 ft (6-18 m).' WHERE unitcode='Sl';
update sources.iowa set age='Rhuddanian-Aeronian', descrip='Interval is a northwestern limestone facies that correlates with dolomite strata (Tete des Morts, Blanding, lower Hopkinton formations) to the south and east. Sw forms the highest Silurian unit throughout most of its extent, generally overlain by Dw; locally interfingers with Sh dolomite strata to south. Primary lithology: limestone, dense, fossiliferous. Secondary lithologies: limestone, dense, cherty to very cherty; dolomitic limestone, dense; dolomite (locally at base). Minor: dolomite, silty to sandy (locally at base above Om). Maximum thickness, 80 ft (25 m).' WHERE unitcode='Sw';
update sources.iowa set age='upper Katian', descrip='Includes Elgin, Clermont, Fort Atkinson, Brainard, and Neda members. Overlain by Silurian strata in east-central Iowa, incised paleovalleys beneath Mosalem Fm.; truncated beneath Devonian strata in northern-most counties. Primary lithologies: shale, green-gray, variably dolomitic, mostly unfossiliferous; dolomite, argillaceous, part shaly, variably fossiliferous (part with common trilobites); dolomite, part argillaceous, part cherty to very cherty (northern Iowa). Secondary lithologies: shale, brown to brown-gray, organic, part graptolitic, part finely laminated (lower strata); dolomitic limestone to limestone, argillaceous, part cherty to very cherty, variably fossiliferous, part crinoidal (northern Iowa); interbedded dolomite and shale, part nodular, part fossiliferous. Minor: phosphorite, granular to massive (basal unit); dolomite, phosphatic to very phosphatic, argillaceous (Elgin Mbr.); ooidal ironstone and red shale (Neda Mbr.); pyrite, finely disseminated to nodular, pyrite cements. Maximum thicknesses: generally 200-275 ft (60-85 m) beneath Silurian, locally 100-200 ft (30-60 m) beneath Mosalem Fm.; 75-180 ft (23-55 m) where capped by Devonian strata in northern Iowa.' WHERE unitcode='Om';
update sources.iowa set age='upper Sandbian-upper Katian', descrip='Galena Group includes Decorah, Dunleith, Wise Lake, Dubuque formations; Platteville Formation includes Pecatonica, McGregor members; Glenwood Shale forms thin basal shale unit. Primary lithologies: dolomite, part porous to vuggy, fossiliferous, part cherty; limestone and dolomitic limestone, fossiliferous, part cherty (note: Galena Group entirely limestone to north, entirely dolomite to south, interstratified limestone-dolomite in intervening areas). Secondary lithologies: shale, green-gray, calcareous, with thin to nodular limestone, part fossiliferous (Decorah Sh); limestone, wavy-bedded to nodular, part fossiliferous (Decorah-Platteville); dolomite and limestone, slightly argillaceous. Minor: shale partings and thin beds, green-gray to brown-gray, part fossiliferous (Dubuque Fm); shale partings and thin beds, light to dark brown, part organic-rich (Decorah-Platteville); dolomite, sandy to very sandy (Pecatonica Mbr); shale, green-gray, noncalcareous, unfossiliferous, part sandy (Glenwood Sh); thin sandstone to siltstone (Glenwood Sh); dark phosphatic grains (primarily Glenwood, Pecatonica, Decorah); phosphate-pyrite-iron oxide crusts (on some hardground surfaces); pyrite nodules; thin K-bentonite beds (Galena Gp); ironstone ooids (Decorah Sh). Maximum thicknesses total interval: 330 ft (100 m); Galena Group, 250-280 ft (76-85 m); Platteville Formation, 25-55 ft (8-17 m); Glenwood Shale, 3-10 ft (1-3 m).' WHERE unitcode='Og';
update sources.iowa set age='Tremadocian-lower Floian', descrip='St. Peter, Middle-Upper Ordovician, Whiterockian [upper Darriwilian-lower Sandbian]). Prairie du Chien Group includes Oneota Fm (Coon Valley, Hager City members) and Shakopee Fm (New Richmond Sandstone, Willow River members); St. Peter Sandstone includes Readstown and Tonti members. Sub-St. Peter erosional surface bevels and locally truncates Prairie du Chien strata. Primary lithologies: dolomite, part cherty, part sandy, mostly unfossiliferous, common voids and vugs (Prairie du Chien); sandstone, quartzose, very fine to medium grained (St. Peter, Shakopee). Secondary lithologies: dolomite, laminated to stromatolitic, part intraclastic; dolomite, fossil molds (primarily mollusks); interbedded very fine to fine sandstone and dolomite (Coon Valley, Shakopee); conglomerate, dolomite and chert clasts in sandy matrix (Readstown). Minor: oolitic dolomite and oolitic chert (Shakopee); shale, green, part sandy (Shakopee); shale, green-brown to gray, part laminated, silty to sandy, part fossiliferous (locally in St. Peter of Winneshiek Co.); coarse sand grains (St. Peter, Shakopee); breccia, dolomite-chert clasts; chalcedony/quartz nodules. Maximum thicknesses total interval: generally 300-400 ft (90-120 m), may reach thicknesses to 700 ft (210 m) (locally thick St. Peter in Winneshiek Co.). Unit thicknesses: Prairie du Chien Group, 225-335 ft (69-102 m), locally thinner where overlain by thick St. Peter; Oneota Fm, 130-225 ft (40-69 m), locally thinned beneath thick St. Peter; Shakopee Fm, 55-100 ft (17-30 m), locally thinned to absent beneath thick St. Peter; St. Peter Sandstone, generally 40-75 ft (12-23 m), varies 25-225 ft (8-69 m), may locally reach thicknesses to 700 ft (210 m) in Winneshiek Co.' WHERE unitcode='Op';
update sources.iowa set age='Steptoean-lower Skullrockian', descrip='Surface exposures limited to Allamakee and northeast Clayton counties; subcrops beneath Mississippi River alluvium in southern Allamakee and Clayton counties. Primary lithologies: sandstone, very fine to coarse grained, quartzose to feldspathic (Jordan); silty dolomite to dolomitic siltstone (St. Lawrence); sandstone, very fine to fine grained, glauconitic to very glauconitic, common greensands (Lone Rock). Secondary lithologies: siltstone, part argillaceous (St. Lawrence, Lone Rock). Minor: silty shale partings (St. Lawrence, Lone Rock); dolomite, part sandy; intraclastic dolomite, sandstone, and siltstone. Maximum thicknesses of total interval: 260-310 ft (79-95 m). Formation thicknesses: Lone Rock Fm, 110-140 ft (34-43 m); St. Lawrence Fm, 60-80 ft (18-24 m); Jordan Sandstone, 80-110 ft (244-34 m).' WHERE unitcode='Cj';
update sources.iowa set age='Marjuman-Steptoean', descrip='Surface exposures limited to northeastern Allamakee County; subcrops beneath Mississippi River alluvium in Allamakee County. Includes Ironton and Galesville members. Primary lithology: sandstone, fine to coarse grained, upper part fossiliferous (Ironton). Thicknesses: 125-155 ft (38-47 m).' WHERE unitcode='Cw';
update sources.iowa set age='Marjuman', descrip='Subcrops beneath Mississippi River alluvium in Allamakee County; surface exposures absent. Primary lithologies: sandstone, very fine to fine grained, part argillaceous; shale, silty, gray to green-gray, part glauconitic. Secondary lithology: siltstone, part argillaceous, part dolomitic. Minor: dolomite. Thicknesses: 120-145 ft (37-44 m).' WHERE unitcode='Ce';
update sources.iowa set age='Middle Cambrian', descrip='Subcrops beneath Mississippi River alluvium in northeastern Allamakee County; surface exposures absent. Overlies erosional surface on Precambrian granitic basement rocks. Primary lithology: sandstone, very fine to very coarse grained, part iron-stained. Minor: shale, silty to sandy, gray, red, green; quartz granules; granitic pebbles. Thicknesses: 365-405 ft (111-123 m).' WHERE unitcode='Cm';
update sources.iowa set age='Paleoproterozoic', descrip='Crops out in northwestern Lyon County; buried beneath Cretaceous strata to south and east. Primary lithology: quartzite, fine to coarse grained, pink, red, purple (low-grade metamorphic rock). Minor: conglomerate; claystone/argillite, red. Estimated thickness 500 ft (150 m).' WHERE unitcode='Xs';
update sources.iowa set unitname='Hopkinton Fm, Blanding Fm, Tete des Morts Fm, Mosalem Fm' where unitcode='Sh';
update sources.iowa set unitname='Pella Fm and St. Louis Fm' where unitcode='Ms';
update sources.iowa set unitname='Prospect Hill Fm, Chapin Fm., Maynes Creek Fm, and Wassonville Fm' where unitcode='Mk';
update sources.iowa set unitname='Dakota Fm, Windrow Fm' where unitcode='Kd';


UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and early_id IS NULL;
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
update sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name, '%') and early_id IS NULL;
update sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name) and early_id IS NULL;
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Albian-upper Cenomanian' and m.interval_name='Albian';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'Rhuddanian, Aeronian-upper Llandovery' and m.interval_name='Aeronian';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Missourian-lower Virgilian' and m.interval_name='Virgilian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Missourian-lower Virgilian' and m.interval_name='Missourian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Llandovery-lower Wenlock' and m.interval_name='Telychian';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Llandovery-lower Wenlock' and m.interval_name='Wenlock';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'uppermost Desmoinesian-lower Missourian' and m.interval_name='Missourian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'uppermost Desmoinesian-lower Missourian' and m.interval_name='Desmoinesian';

UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Eifelian-middle Givetian' and m.interval_name='Givetian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Eifelian-middle Givetian' and m.interval_name='Eifelian';

UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Sandbian-upper Katian' and m.interval_name='Katian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Sandbian-upper Katian' and m.interval_name='Sandbian';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Kinderhookian-lower Osagean' and m.interval_name='Osagean';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'upper Kinderhookian-lower Osagean' and m.interval_name='Kinderhookian';
UPDATE sources.iowa set late_id=m.id FROM macrostrat.intervals m WHERE age ilike 'middle Givetian-middle Frasnian' and m.interval_name='Frasnian';
UPDATE sources.iowa set early_id=m.id FROM macrostrat.intervals m WHERE age ilike 'middle Givetian-middle Frasnian' and m.interval_name='Givetian';

INSERT INTO maps.medium (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,26,unitname,age,descrip,late_id,early_id,ST_MakeValid((st_dump(geom)).geom) FROM sources.iowa;
pg_dump -t sources.iowa -C -O burwell | gzip > ~/Desktop/iowa.sql.gz

insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=26 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.medium (orig_id,source_id,name,new_type,geom) SELECT gid,26,faultname,new_type,ST_MakeValid(geom) FROM sources.iowa_lines;



######### kanab
update sources.ut_kanab set descrip='Mostly sand with lenses of silty clay, sandy silt, and gravel deposited in stream beds, washes, adjacent floodplains, and on low alluvial slopes; includes lower terrace and alluvial fan deposits; 0 to 36 m (0-120 ft) thick.' where unitsymbol='Qa';
update sources.ut_kanab set descrip='Sand in active to partially stabilized dunes and sheets; mostly fine to medium grained; generally derived from and deposited on and downwind of large exposures of eolian sandstone formations (primarily Navajo and Entrada); locally includes alluvial deposits; 0 to 30 m (0-100 ft) thick.' where unitsymbol='Qes';
update sources.ut_kanab set descrip='Mostly sand with minor amounts of clay, silt, and gravel; stabilized sand sheets locally reworked by alluvial processes and with well-developed calcic soil; 0 to 30 m (0-100 ft) thick.' where unitsymbol='Qea';
update sources.ut_kanab set descrip='Poorly to well-sorted gravel, sand, and boulders with interlayers of silt and mud; present on pediments and higher river terraces, and as older erosional remnants; 0 to 20 m (0-60 ft) thick.' where unitsymbol='Qag';
update sources.ut_kanab set descrip='Well stratified sand, clay, silt, and minor gravel deposited where drainage was blocked by a landslide in Zion Canyon; also mapped in a human-made reservoir on South Creek near southwest corner of the quadrangle; 0 to 40 m (0-135 ft) thick.' where unitsymbol='Qls';
update sources.ut_kanab set descrip='Includes landslides, slumps, colluvium, talus, and other mass-movement deposits; very poorly sorted; nonstratified; common on moderate to steep slopes; only larger deposits mapped; 0 to 75 m (0-250 ft) thick.' where unitsymbol='Qmsc';
update sources.ut_kanab set descrip='Blocky vesicular basalt and basaltic andesite lava flows and cinder cones, commonly partially covered by a thin veneer of eolian silt and sand; phenocrysts include olivine, labradorite, titaniferous augite, plagioclase, and iron-titanium oxides (Sable and Hereford, 2004; Biek and Hylland, 2007); remnants of four flows are preserved near the Sevier fault and southwest to southeast of the Paunsaugunt Plateau (Sable and Hereford, 2004; Tilton, 1991a,b) – Best and others (1980) obtained K-Ar ages of 0.56±0.05 Ma on the Spencer Bench (Black Mountain) flow and 1.1±0.1 Ma on the Tenny Creek flow (26 km [16 mi] east-northeast of Glendale); Schiefelbein (2002) obtained 40Ar/39Ar ages of 0.58+0.05 Ma and 0.564+0.02 Ma on the Spencer Bench (Black Mountain) flow; remnants of six or more flows are preserved in the Markagunt Plateau area in the northwest part of the quadrangle – Best and others (1980) obtained K-Ar ages of 1.2±0.6 Ma on the Hornet Point flow (age is probably unreliable – note large standard error), 0.81±0.05 Ma on the Horse Knoll flow, and 0.36±0.08 Ma on the Volcano Knoll flow; Biek and Hylland (2007) obtained 40Ar/39Ar ages of 0.74±0.05 Ma on the Hornet Point flow, 0.37±0.02 Ma on the Virgin Flats flow, and 0.34±0.03 on the Volcano Knoll flow, and estimated the Three Creeks flow (near China Point) at less than 0.3 Ma; other flows have not been dated but are probably similar in age to the dated flows; some flows are cut by post-flow movement on Quaternary faults.' where unitsymbol='Qb';
update sources.ut_kanab set descrip='Unconsolidated, very poorly sorted, clay- to large boulder-size sediment characterized by very large quartz monzonite boulders as much as 30 feet (10 m) long; also includes large boulders of limestone, sandstone, and quartzite; probably deposited by debris flows originating in the Pine Valley Mountains west of the quadrangle (Biek and Hylland, 2007); 0 to 90 feet (0-27 m) thick.' where unitsymbol='Ta';
update sources.ut_kanab set descrip='Yellow-gray to pale-orange tuffaceous sandstone, conglomerate, mudstone, and minor limestone, shale, and claystone; weathers to drab gray and brown slopes; sandstone is mostly poorly sorted and cross-bedded; lower part is largely yellow-orange weathering siltstone and claystone; lower contact may be an unconformity; as much as 120 m (400 ft) thick.' where unitsymbol='Tbh';
update sources.ut_kanab set descrip='White to light-gray limestone and chalky claystone; calcite-filled vugs and fractures are common; forms massive rough-weathering cliffs; contains some limy shale partings; 20 to 40 m (60-120 ft) thick.' where unitsymbol='Tcw';
update sources.ut_kanab set descrip='Pink, orange, and pale gray, commonly stained limestone, limey mudstone, dolomite, mudstone, and conglomerate; irregularly bedded; nodular and mottled paleosols common; weathers into picturesque cliffs, columns, spires, and pinnacles; commonly overlying limestone breccia and a basal conglomerate; basal beds of map unit locally equivalent to Pine Hollow and Canaan Peak Formations (Bowers, 1972); unit forms the Pink Cliffs of the Grand Staircase; 150 to 250 m (490-820 ft) thick.' where unitsymbol='Tcp';
update sources.ut_kanab set descrip='Drab-gray, olive-gray, brown-gray, and green- gray sandstone, mudstone, and siltstone; sandstone is very fine to fine grained; bedding is poorly defined and lenticular; forms ledgy steep slopes and badlands; lesser amounts of thin light-gray mudstone and light yellow-gray calcareous siltstone are interbedded; locally contains molluscan fragments, plant debris, and dinosaur bones; 0 to 75 m (0-250 ft) thick; absent or thin and mapped with the Wahweap Formation (Kwk) in Paunsaugunt Plateau area.' where unitsymbol='Kk';
update sources.ut_kanab set descrip='Mostly gray to yellow-gray, interbedded mudstone, claystone, sandstone, siltstone, and conglomerate with some brown fine- to medium-grained sandstone beds; forms slopes and ledges; 100 to 200 m (330-660 ft) thick below and south of the Paunsaugunt Plateau and 245 to 300 m (800-1000 ft) thick south of the Markagunt Plateau.' where unitsymbol='Kw';
update sources.ut_kanab set descrip='Kaiparowits: Drab-gray, olive-gray, brown-gray, and green- gray sandstone, mudstone, and siltstone; sandstone is very fine to fine grained; Wahweap: Mostly gray to yellow-gray, interbedded mudstone, claystone, sandstone, siltstone, and conglomerate with some brown fine- to medium-grained sandstone beds.' where unitsymbol='Kwk';

update sources.ut_kanab set descrip='Interbedded yellow-gray to light-brown sandstone and gray mudstone and siltstone; forms ledges, cliffs, and slopes; sandstone is fine to coarse grained and locally conglomeratic; upper part commonly forms a sandy conglomeratic cliff that may correlate with the Drip Tank Member of the Straight Cliffs Formation in the Kaiparowits Plateau; mudstones are locally carbonaceous and contain thin coal beds, especially toward the east; 300 to 380 m (900-1250 ft) thick.' where unitsymbol='Ksu';
update sources.ut_kanab set descrip='Yellow-gray, orange-gray, and light-brown sandstone interbedded with lesser quantities of mudstone, siltstone, and claystone; generally forms a cliff or a series of ledges; locally contains carbonaceous mudstone and very thin beds of coal and coaly shale in upper part, especially toward the east; locally intertongues with the Tropic Shale below; 26 to as much as 100 m (85-330 ft) thick.' where unitsymbol='Ksl';
update sources.ut_kanab set descrip='Mapped as single line where thin in western part of map area. Drab-gray, marine shale with subordinate gray sandstone; generally forms a steep slope; sandstone becomes more abundant in the upper part and to the west; thins to the west where unit interfingers with non-marine sandstone beds and contains carbonaceous mudstone and very thin coaly beds; lower contact placed stratigraphically higherto west (see Dakota discussion); 90 to 300 m (300-1000 ft) thick; thickness varies irregularly, but generally is thicker to the east.' where unitsymbol='Kt';
update sources.ut_kanab set descrip='undivided (Upper-Lower Cretaceous; Cenomanian to Albian?) (Cedar Mountain beds locally present at base of unit) – Yellowish-brown, gray, and white, thin- to thick-bedded, interbedded sandstone, sandy shale, carbonaceous shale, shaly sandstone, conglomerate, smectitic mudstone, coal, and marl; forms a moderate to steep slope with ledgy cliffs; sandstone is fine to medium grained; smectitic strata become more common westward; oysters, clams, and gastropods are common; map unit is conducive to landsliding and complete, undeformed exposures are uncommon; lower contact is a regional unconformity; forms the Gray Cliffs of the Grand Staircase with the cliff-forming units of the Straight Cliffs Formation; 60 to 270 m (200-900 ft) thick; thickens westward across quadrangle; in western part of quadrangle (west of 112°45 W.) upper contact is placed at top of sugarledge sandstone (Hylland, 2000; Biek and Hylland, 2007; also see Gustason, 1989; Elder and others, 1994), making contact stratigraphically higher than in central part of map area where sugarledge sandstone is included in Tropic Shale (Cashion, 1961; Doelling and Davis, 1989; Sable and Hereford, 2004). Lower part of unit is 0 to 30 m (0-100 ft) of yellowish-brown, brown, pale-olive-gray, and gray, commonly variegated, thin- to medium- bedded sandstone, smectitic mudstone, and pebble conglomerate with a local thick basal conglomerate ledge; overall, this lower interval is thin, locally not present, and commonly difficult to distinguish from remaining Dakota strata; Hylland (2000) and Biek and Hylland (2007) mapped this interval as Cedar Mountain Formation because lithologic similarity and age data suggest it is correlative with the Cedar Mountain Formation of central Utah, while some workers consider it the basal part of the Dakota Formation (Titus and others, 2005).' where unitsymbol='Kdcm';
update sources.ut_kanab set descrip='Pale-yellow to pale-green-gray sandstone and siltstone, very fine to fine-grained sandstone, and coarse siltstone in exposures between Indian Hollow and Adams Wash; forms earthy weathering steep slopes or mud-plastered cliffs; in the extreme northeast corner of the quadrangle, the lower part of the unit is present and is red-brown, fine- grained sandstone that forms smooth rounded, "slickrim" cliffs; 0 to 170 m (0-560 ft) thick; thins westward and is entirely "cut out" beneath a pre-Cedar Mountain unconformity west of Adams Wash; in the northeast corner of the quadrangle only the lower 88 m (290 ft) of the formation is exposed.' where unitsymbol='Je';
update sources.ut_kanab set descrip='Red and yellow silty sandstone; contains a few thin gypsum beds near the top in the extreme northeast part of the quadrangle; red colors dominate to the east and yellow colors dominate to the west; forms earthy-weathering steep slopes; 60 to 85 m (200- 280 ft) thick; thins to the west.' where unitsymbol='Jcw';
update sources.ut_kanab set descrip='White alabaster gypsum at base with overlying red siltstone, white sandstone, and chippy weathering white to pink microgranular limestone at the top; locally the basal gypsum is missing; limestone at top locally contains casts and molds of pelecypods; overlies the Thousand Pockets Tongue of the Page Sandstone to the east and the Crystal Creek Member of the Carmel Formation to the west; 18 to 50 m (60-165 ft) thick; unit thins and thickens irregularly in relation to the thickness of gypsum, but generally thins westward; thickest gypsum bed is about 12 m (40 ft) thick.' where unitsymbol='Jcp';
update sources.ut_kanab set descrip='Yellow, white, or brown sandstone; generally massive and cross- bedded with thin red siltstone intercalations; overlies the Crystal Creek Member of the Carmel Formation to the west and the Judd Hollow Tongue of the Carmel Formation east of the Paunsaugunt fault; 0 to 30 m (0-100 ft) thick; thins westward and pinches out near Skutumpah Creek.' where unitsymbol='Jpt';
update sources.ut_kanab set descrip='Brown-banded sandstone, siltstone, and mudstone; generally earthy weathering; forms slopes and mounds; common gypsum as cement or veinlets; 15 to 55 m (50-180 ft) thick where not mapped as part of the Judd Hollow Tongue; thickens westward.' where unitsymbol='Jcx';
update sources.ut_kanab set descrip='Light-gray limestone and tan limey shale; forms thick limestone ledges at base and top with steep limestone shale in the middle; 3 to 4 m (9-12 ft) of red to brown siltstone interbedded with thin limestone beds common at base; locally fossiliferous with pelecypods, gastropods, and star-shaped crinoid columnals; unconformably overlies Navajo Sandstone to the east and Temple Cap Sandstone to the west; 15 to 80 m (50-260 ft) thick where not mapped as part of the Judd Hollow Tongue; thickens westward.' where unitsymbol='Jcc';
update sources.ut_kanab set descrip='Combined Crystal Creek and Co-op Creek Members where thin in the east part of the quadrangle underlying the Thousand Pockets Tongue of the Page Sandstone (Jpt); mostly forms a lower red slope and an upper white bench between Jpt and the Jn; unconformably overlies the Nj Sandstone; 30 to 60 m (100-200 ft) thick; thins eastward.' where unitsymbol='Jcj';
update sources.ut_kanab set descrip='Light-pink-gray, cross-bedded, cliff-forming sandstone with a few intercalations of dark-red siltstone (White Throne Member) overlying dark-red siltstone and silty sandstone (Sinawava Member) at the base; present only in the west part of the quadrangle where unconformably overlies Navajo Sandstone; 0 to 60 m (0-200 ft) thick; thickens westward.' where unitsymbol='Jt';
update sources.ut_kanab set descrip='White, pink, and brown sandstone; forms cliffs, domes, and bare-rock outcrops; famous for high-angle cross-beds in sets to 10 m (30 ft) thick or more; generally divisible into an upper white, cliff-forming, calcareous part recognized as the White Cliffs in the Grand Staircase, a less resistant pink part commonly covered with sand and cemented with iron oxides, and a lower cliff-forming brown part that contains many planar beds (not mapped separately); the Navajo is an excellent aquifer; 395 to 670 m (1300-2200 ft) thick; thickens westward.' where unitsymbol='Jn';
update sources.ut_kanab set descrip='(Mapped as single line between Jn and Jnl where thin or locally missing on the Wygaret Terrace west of the Paunsaugunt fault in eastern part of map area.) Red-brown siltstone, mudstone, and fine- grained sandstone; generally forms a steep slope, but locally contains thick to massive, planar, ledge-forming sandstone beds at the top of the unit; 0 to 98 m (0 to 320 ft) thick; pinches out eastward. The type locality (never officially defined) and name source of this unit is a small canyon about 6 km (4 mi) north of Kanab called Tenney Canyon on plate 2 of Gregory (1950) that is now called Tiny Canyon on modern U.S. Geological Survey topographic maps. (This "Tenney" differs from spelling of Tenny Creek in basalt lava flows unit description).' where unitsymbol='Jkt';
update sources.ut_kanab set descrip='(Mapped as single line between Jk and Jkt where thin in western part of map area.) White to light-gray, mostly fine- grained sandstone; massive with high-angle cross-beds; red-brown and locally planar bedded in far west exposures; pinchesout in southwest part of quadrangle; merges into main part of Navajo Sandstone in eastern part of quadrangle; excellent aquifer in the Kanab area; 0 to 125 m (0-410 ft) thick; thickens eastward.' where unitsymbol='Jnl';
update sources.ut_kanab set descrip='Red to red-brown sandstone, siltstone, and claystone with lesser amounts of limestone and intraformational conglomerate; locally, especially to the east, lavender, white, and brown sandstone is common; sandstone is dominant in eastern exposures, siltstone and claystone in western exposures; forms ledges and slopes to the east and steep slopes to the west; constitutes the entire formation where the Lamb Point Tongue is not present. All of the Kayenta Formation, including the Tenney Canyon Tongue, thickens westward; the entire formation along the Cockscomb is 60 to 90 m (200-300 ft) thick, near Kanab the Tenney Canyon Tongue is about 28 m (90 ft) thick and the main body is about 95 m (315 ft) thick, in the Zion Canyon area the Tenney Canyon Tongue is about 96 m (315 ft) thick and the main body is nearly 106 m (350 ft) thick, and in the southwest corner of the quadrangle the Kayenta Formation (where there is no Lamb Point Tongue) is about 183 m (600 ft) thick.' where unitsymbol='Jk';
update sources.ut_kanab set descrip='Generally red-orange to brown sandstone, siltstone, and shale; sandstone is mostly fine grained and commonly forms ledges and cliffs; generally divisible into two or three members (not mapped separately): in descending order – Springdale Sandstone Member, Whitmore Point Member, and Dinosaur Canyon Member. At the time source mapping was done, the Springdale was a member of the Moenave Formation; it was recently reassigned to the Kayenta Formation (see discussion and references in Biek and Hylland, 2007); the Springdale Sandstone generally forms cliffs and with the main body of the Kayenta Formation forms the Vermilion Cliffs of the Grand Staircase. In the west part of the quadrangle, the Whitmore Point Member forms a slope or a recess beneath the Springdale Sandstone and commonly contains fish fossil fragments; it pinches out east of Kanab near Johnson Canyon (Hayden, 2006). The Dinosaur Canyon Member forms ledges and steep slopes and rests unconformably on the Triassic Chinle Formation. As far west as Kitchen Corral Wash a thin layer of the Wingate Sandstone may be recognized at the base of the Dinosaur Canyon Member. The Springdale Sandstone is 27 to 60 m (90-200 ft) thick and unconformably overlies lower units, the Whitmore Point is 0 to 24 m (0-80 ft) thick, and the Dinosaur Canyon is 43 to 76 m (140-250 ft) thick.' where unitsymbol='JTRmo';
update sources.ut_kanab set descrip='Picturesque, varicolored and banded mudstone, claystone, sandstone, siltstone, limestone, and conglomerate; generally forms a steep slope; prone to landsliding that commonly involves the overlying Dinosaur Canyon Member of the Moenave Formation; locally contains petrified wood and siliceous nodules; 130 to 240 m (425-800 ft) thick.' where unitsymbol='TRcu';
update sources.ut_kanab set descrip='Gray, yellow-gray, and gray-orange conglomeratic sandstone, sandstone, and minor gray mudstone; massive and generally forms cliff; remobilized iron oxides commonly form Liesegang bands; upper part (locally part of Monitor Butte Member) commonly forms ledges or steep slopes rather than cliffs; locally contains large amounts of petrified logs and branches; unconformable with Moenkopi Formation below; 0 to 47 m (0-155 ft) thick; discontinuous and thins and thickens in paleochannels to the east.' where unitsymbol='TRcl';
update sources.ut_kanab set descrip='Dark-brown to dark-red sandstone in thin to thick beds; micaceous; forms cliffs and steep slopes; 38 to 50 m (99-165 ft) thick.' where unitsymbol='TRmu';
update sources.ut_kanab set descrip='Light-brown and white, interbedded sandstone, shale, and impure gypsum; earthy weathering; forms ledges and slopes; individual gypsum beds as much as 2 m (6 ft) thick; member is about 50 to 67 m (165-220 ft) thick.' where unitsymbol='TRms';
update sources.ut_kanab set descrip='Light red-brown to orange-brown, lightly banded sandstone, and red siltstone and mudstone; Light gray-brown limestone, dolomite, sandstone, cherty breccia, and siltstone' where unitsymbol='TRm';
update sources.ut_kanab set descrip='Light red-brown to orange-brown, lightly banded sandstone, and red siltstone and mudstone; sandstone is fine grained; thin to thick bedded; crisscrossed with gypsum veinlets and upper part cemented with gypsum; earthy weathering, forming gentle to steep slopes; 85 to 113 m (280-370 ft) thick.' where unitsymbol='TRmm';
update sources.ut_kanab set descrip='Red sandstone and siltstone capped by about 10 m (30 ft) of calcareous sandstone (Virgin Limestone Member equivalent); sandstone is fine grained and the unit forms gentle to steep slopes; upper calcareous sandstone is platy to thin bedded and forms ledges; 43 to 67 m (140-220 ft) thick.' where unitsymbol='TRml';
update sources.ut_kanab set descrip='Light gray-brown limestone, dolomite, sandstone, cherty breccia, and siltstone; thin to thick bedded; some sandstone beds are pebbly; upper half is more resistant and forms a cliff over a ledgy lower part; locally a thin section of tan and brown siltstone (Black Dragon Member?) underlies the unit; contact with Kaibab Formation below is an unconformity; 6 to 15 m (20-50 ft) thick at exposures on Buckskin Mountain in the southeast part of the quadrangle; well data indicate the Timpoweap may be as much as 45 m (150 ft) thick in western part of the quadrangle.' where unitsymbol='TRmt';
update sources.ut_kanab set descrip='Kaibab Formation (lower Permian) – Cherty gray limestone and dolomitic limestone and calcareous, commonly cherty sandstone; divisible into two members (not mapped separately), upper Harrisburg Member and lower Fossil Mountain Member; Harrisburg rocks are ledge-and slope-forming and unfossiliferous; Fossil Mountain rocks are massive, cliff forming, and fossiliferous containing mostly brachiopods, crinoid columnals, and bryozoa; thickness of the Kaibab ranges from 45 to 90 m (150-295 ft) in outcrops in the southeast corner of the quadrangle, of which 5 to 25 m (15-80 ft) is Harrisburg Member; it may be 45 to 155 m (150- 500 ft) thick in the quadrangle subsurface and thickens to the west.' where unitsymbol='Pk';
update sources.ut_kanab set descrip='Limestone, dolomite, anhydrite, gypsum, and sandstone. Upper part (Woods Ranch Member) is mostly slope-forming, yellow-gray and red-brown, very fine- to fine-grained calcareous sandstone, with discontinuous gypsum, travertine, and intraformational conglomerate, and is about 46 m (150 ft) thick; middle part (Brady Canyon Member) is yellow-gray, cherty, fossiliferous, cliff-forming limestone and subordinate sandstone, and is about 30 m (100 ft) thick; lower part (Coconino Sandstone) is pale-yellow, fine-grained, cliff-forming, quartz sandstone about 20 m (65 ft) thick. Map unit is 96 to 102 m (315-335 ft) thick in Buckskin Gulch in southeast corner of quadrangle.' where unitsymbol='Pt';
update sources.ut_kanab set descrip=' Red-brown, silty sandstone, mudstone, and shale; forms slope; only upper 17 m (55 ft) exposed in the southeast corner of the quadrangle in Buckskin Gulch; wells indicate the formation is 32 to 190 m (105-625 ft) thick in the subsurface.' where unitsymbol='Ph';


update sources.ut_kanab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early')=m.interval_name;
update sources.ut_kanab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late')=m.interval_name;
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Triassic' and l.interval_name='Early Jurassic' and age='Lower Jurassic to Upper Triassic';
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Albian' and l.interval_name='Cenomanian' and age='Upper-Lower Cretaceous; Cenomanian to Albian?';
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Triassic' and l.interval_name='Middle Triassic' and age='Middle to Lower Triassic';
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Quaternary' and l.interval_name='Quaternary' and age='Quaternary (0.36-1.2 Ma)';
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and age='Miocene?';
update sources.ut_kanab set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age='Holocene to upper Pleistocene';

pg_dump -t sources.ut_kanab -C -O burwell | gzip > ~/Desktop/ut_kanab.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,27,unitname,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.ut_kanab;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=27 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

delete from sources.ut_kanab_lines where type='contact';
delete from sources.ut_kanab_lines where type='map boundary';
update sources.ut_kanab_lines set use_name=concat_ws(' ', subtype,type) where type='fault';
update sources.ut_kanab_lines set use_name=type where type='marker bed';
insert into lines.large (orig_id,source_id,name,type,descrip,geom) SELECT gid,27,use_name,use_name,concat_ws('; ',notes,modifier),st_makevalid(geom) from sources.ut_kanab_lines;
pg_dump -t sources.ut_kanab_lines -C -O burwell | gzip > ~/Desktop/ut_kanab_lines.sql.gz


#### source 28 afghan
update sources.afghan set narrative='Permian red and variegated sandstone and siltstone  mudstone, conglomerate, gravelstone (NW Afghanistan) ; limestone, dolomite, sandstone, siltstone,shale, phyllite, mafic volcanic rocks, bauxite and bauxite-bearing rocks (Middle Afghanistan: Zuri and Kismaran zones, Katawaz trough)' where unit_symbo='Pssl';
update sources.afghan set narrative='Ordovician sandstone and siltstone shale (Lagar and Argandab Tectonic Zones); limestone, sandstone, siltstone, shale (Middle Afghanistan); shale, sandstone, chert (North Afghanistan)' where unit_symbo='Ossl';
update sources.afghan set narrative='Mesoarchean biotite, garnet-biotite, amphibole, biotite-amphibole, and calc-silicate gneiss; magnesian marble, quartzite, amphibolite' where unit_symbo='Vgn';
update sources.afghan set narrative='Pliocene gray conglomerate, grit, sandstone  siltstone, clay, limestone, marl; gypsum, salt; acid to mafic volcanic rocks' where unit_symbo='N2ucgs';
update sources.afghan set narrative='Early Triassic variegated sandstone, gravelstone, conglomerate, chert, rhyolite and basalt volcanic rocks (North Afghanistan)' where unit_symbo='T1ssc';
update sources.afghan set narrative='Miocene red conglomerate, sandstone  siltstone, clay; acid and mafic volcanic rocks; limestone, marl; olivine basalt, trachybasalt, andesitic basalt (Taywara Series)' where unit_symbo='N1cgs';
update sources.afghan set narrative='Early Neoproterozoic greenschist and phyllite derived from slate, schist, sandstone  metacarbonates (marble, dolomite, chert) and metavolcanic rocks.' where unit_symbo='Z1scp';
update sources.afghan set narrative='Early Paleoproterozoic two-mica, biotite, biotite-amphibole, garnet-biotite, garnet-sillimanite-biotite, pyroxene-amphibole, plagiocalse, and cordierite gneiss; schist, migmatite, quartzite, marble, amphibolite.' where unit_symbo='X1gn';
update sources.afghan set narrative='Late / Early Triassic limestone, dolomite  conglomerate, chert, marl (Middle Afghanistan);  limestone, sandstone, shale, conglomerate, chert, mafic volcanic rocks (Khashrud Tectonic Zone); limestone, dolomite (Kishmaran Tectonic Zone).' where unit_symbo='T13cld';
update sources.afghan set narrative='Early Cretaceous / Late Jurassic shale  siltstone, sandstone, conglomerate, chert, limestone, greenstone, acid and mafic volcanic rocks</edomvd><edomvds>U.S. Geological Survey, Earth Surface Processes Team.' where unit_symbo='J3K1sh';
update sources.afghan set narrative='Cambrian / Neoproterozoic limestone and dolomite (Argandab Tectonic Zone); [ZEmbq: marble, quartzite, metasandstone, mica schist{Kabul Massif}].' where unit_symbo='ZeEld';
update sources.afghan set narrative='Early Permian siltstone and sandstone  slate, limestone, conglomerate, grits (Helmand zone); limestone (Tashkupruk Tectonic Zone)' where unit_symbo='P1sls';
update sources.afghan set narrative='Eocene clay, shale, siltstone  sandstone, limestone, marl, gypsum, conglomerate (North Afghanistan - Katavaz Basin).' where unit_symbo='Pg2csh';
update sources.afghan set narrative='Late Jurassic conglomerate, sandstone  siltstone, clay, limestone, gypsum (North Afghanistan); limestone, marl, sandstone, siltstone (Farah Rod Basin - Upper Jurassic/Tithonian).' where unit_symbo='J3cgs';
update sources.afghan set narrative='Pliocene gray conglomerate, grit, sandstone  siltstone, clay, limestone, marl; gypsum, salt; acid to mafic volcanic rocks.' where unit_symbo='N2cgs';
update sources.afghan set narrative='Late / Middle Triassic sandstone and siltstone  mudstone, carbonaceous shale, limestone, marl, conglomerate, acid and mafic volcanic rocks (north Afghanistan); limestone, dolomite, marl (Kabul Massif and Kunar Tectonic Zone).' where unit_symbo='T23ssl';
update sources.afghan set narrative='Late Neoproterozoic red altered rhyolite and andesite volcanic rocks  sandstone, siltstone, phyllite, limestone, dolomite.' where unit_symbo='Z3ra';
update sources.afghan set narrative='Middle / Early Jurassic sandstone, siltstone  clay, conglomerate, coal (North Afghanistan); limestone, marl, sandstone, shale, siltstone (Middle Afghanistan); sandstone, siltstone,acid volcanic rocks (Kishmaran Tectonic Zone).' where unit_symbo='J12ssl';
update sources.afghan set narrative='Late Cretaceous sandstone, siltstone  clay, limestone, marl, conglomerate, gypsum (North Afghanistan); limestone (Middle Afghanistan) ; redstone, siltstone, conglomerate (Kashrud, Tectonic Zone).' where unit_symbo='K2ssl';
update sources.afghan set narrative='Paleoproterozoic two-mica, biotite, biotite-amphibole, garnet-biotite, and plagioclase gneiss; migmatite, quartzite, marble, amphibolite.' where unit_symbo='Xgn';
update sources.afghan set narrative='Cretaceous rhyolite and basalt mafic volcanic rocks  chert, fine- and coarse-grained terrigenous rocks, marl, limestone.' where unit_symbo='Krb';
update sources.afghan set narrative='Late Cretaceous limestone, sandstone  siltstone, marl, gravelstone, conglomerate, andesitic basalt, tuff and tuffaceous conglomerate.' where unit_symbo='K2clss';
update sources.afghan set narrative='Oligocene / Eocene basaltic andesite, basalt, trachyte, dacite, rhyolite, ignimbrite, tuff; conglomerate, sandstone, siltstone, limestone.' where unit_symbo='Pg23bab';
update sources.afghan set narrative='Early Carboniferous basalt, sandstone, siltstone, shale (North Afghanistan); sandstone, siltstone, shale (Tashkupruk and Kunar Tectonic Zones).' where unit_symbo='C1nbss';

UPDATE sources.afghan set late_id=m.id FROM macrostrat.intervals m WHERE time_name ilike m.interval_name and late_id IS NULL;
UPDATE sources.afghan set early_id=m.id FROM macrostrat.intervals m WHERE time_name ilike m.interval_name and early_id IS NULL;
update sources.afghan set late_id=m.id FROM macrostrat.intervals m WHERE time_name ilike concat('% ',m.interval_name) and late_id IS NULL;
update sources.afghan set early_id=m.id FROM macrostrat.intervals m WHERE time_name ilike concat(m.interval_name,'%') and early_id IS NULL;

update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Carboniferous' and l.interval_name='Early Permian' and time_name='Carbonifeous-Early Permian';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mississippian' and l.interval_name='Mississippian' and time_name='Early Carboniferous';
update sources.afghan set time_name='Early Carboniferous' where time_name='Early Carboniferous';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Stenian' and l.interval_name='Stenian' and time_name='Late Mesoproterzoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Triassic' and l.interval_name='Late Triassic' and time_name='Middle-Late Triassic';

update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Devonian' and l.interval_name='Middle Devonian' and time_name='Early-Middle Devonian';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Siderian' and l.interval_name='Siderian' and time_name='Early Paleoproterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Ectasian' and l.interval_name='Ectasian' and time_name='Middle Mesoproterzoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Triassic' and l.interval_name='Middle Triassic' and time_name='Early-Middle Triassic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Statherian' and l.interval_name='Statherian' and time_name='Late Paleoproterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Neoproterozoic' and time_name='Late Proterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pennsylvanian' and l.interval_name='Pennsylvanian' and time_name='Late Carboniferous';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mississippian' and l.interval_name='Namurian' and time_name='Early Carboniferous-Namurian';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Tournaisian' and l.interval_name='Tournaisian' and time_name='Early Carboniferous-early Tournasian';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Tournaisian' and l.interval_name='Visean' and time_name='Early Carboniferous-late Tournasian/Vise';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Ediacaran' and l.interval_name='Ediacaran' and time_name='Late Neoproterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Calymmian' and l.interval_name='Calymmian' and time_name='Early Mesoproterzoic';

update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and time_name='Middle-Late Jurassic';

update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Rhyacian' and l.interval_name='Orosirian' and time_name='Middle Paleoproterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Jurassic' and l.interval_name='Middle Jurassic' and time_name='Early-Middle Jurassic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Triassic' and l.interval_name='Carnian' and time_name='Early-Late Triassic/Carnian';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Tonian' and l.interval_name='Tonian' and time_name='Early Neoproterozoic';
update sources.afghan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Berriasian' and l.interval_name='Valanginian' and time_name='Early Cretaceous-Berriasian/Valanginian';
update sources.afghan set name='water' where descrip

pg_dump -t sources.afghan -C -O burwell | gzip > ~/Desktop/afghan.sql.gz

INSERT INTO maps.small (orig_id,source_id,name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,28,concat_ws(' ',time_name,lithology),time_name,narrative,lithology,late_id,early_id,st_makevalid(geom) FROM sources.afghan where time_name is not null;
insert into maps.map_liths select small.map_id,liths.id,'lith' from macrostrat.liths, maps.small WHERE small.source_id=28 and small.lith IS NOT NULL and small.lith ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select small.map_id,liths.id,'descrip' from macrostrat.liths, maps.small WHERE small.source_id=28 and small.descrip IS NOT NULL and small.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.afghan_lines -C -O burwell | gzip > ~/Desktop/afghan_lines.sql.gz
INSERT INTO lines.medium (orig_id,source_id,new_type,descrip,geom) SELECT gid,28,new_type,type,ST_MakeValid(geom) FROM sources.afghan_lines;


################## puerto Rico
copy pr from '/prunit.csv' CSV HEADER;
update pr set name=trim(name);
update pr set age=trim(age);
update pr set symbol=trim(symbol);
update pr set descript=trim(descript);
update sources.puerto_rico set name=pr.name from pr where pr.symbol ilike puerto_rico.fmatn;
update sources.puerto_rico set age=pr.age from pr where pr.symbol ilike puerto_rico.fmatn;
update sources.puerto_rico set descrip=pr.descript from pr where pr.symbol ilike puerto_rico.fmatn;


UPDATE sources.puerto_rico set age=replace(age,'Maestrichtian','Maastrichtian');
UPDATE sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and early_id IS NULL;
UPDATE sources.puerto_rico set late_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
update sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.puerto_rico set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.puerto_rico set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'lower','Early')=m.interval_name;
update sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'lower','Early') ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'upper','Late') ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,'-',1) ilike concat('%',m.interval_name,'%') and early_id IS NULL;
update sources.puerto_rico set late_id=m.id FROM macrostrat.intervals m WHERE split_part(age,'-',2) ilike concat('%',m.interval_name,'%') and late_id IS NULL;
update sources.puerto_rico set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name,'%') and early_id IS NULL;
update sources.puerto_rico set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name,'%') and late_id IS NULL;
update sources.puerto_rico set descrip='Predominantly rounded, generally fine- to medium-grained, volcanic lithic clasts, quartz grains, and shell fragments; includes friable, poorly consolidated beach sands "(beach rock") and, locally, sand dune deposits. Mapped chiefly on the north coast of Puerto Rico' where fmatn='Qb' and descrip ='';
update sources.puerto_rico set descrip='Dark-gray, black, and bluish-gray sandy and silty clay, locally ranges to peat or peaty muck' where fmatn='Qs' and descrip ='';
update sources.puerto_rico set descrip='Predominantly massive, but locally, near the top of deposits, laminated, friable, generally very poorly consolidated, mottled reddish-orange, orange-brown, dark reddish-brown, light-gray, and white quartz-rich sand. Composed chiefly (70 to 95 percent) of fine- to coarse-grained, angular to subangular, anhedral quartz grains suspended in a limonite- stained clay. Quartz grains commonly include abundant randomly- arranged or lineate fluid inclusions, and show undulose extinction. Deposits include sparse, but locally abundant, limonite-manganese oxide(?) concretions of irregular shape, which commonly enclose quartz grains. These concretions (perdigones) are locally concentrated on present topographic surfaces. Upper parts of deposits show locally poor- to well-developed stratification in which laminae are defined by different size quartz grains; deposits are commonly massive downward away from this superficially laminated zone. Blanket sand deposits overlie various rock types including serpentinite, but most commonly they overlie non quartz-bearing limestone. Estimated thickness may be as great as 30 m., but more commonly 4-5 m. thick. Exposed in a discontinuous belt along the north, and locally on the west and southwest coasts of Puerto Rico' where fmatn='QTs' and descrip ='';
update sources.puerto_rico set descrip='Dark green to dark greenish-gray, generally fine-crystalline, uncommonly phyllitic or schistose hornblende hornfels composed of hornblende, plagioclase, and subordinate quartz, magnetite, ilmenite, and hematite. Textures of original lava flows, volcanic breccia, tuff, and volcanic sandstone are generally preserved.' where fmatn='TKmv' and descrip ='';
update sources.puerto_rico set descrip='Very poorly sorted, massive to thin-bedded, unconsolidated sand and gravel, subordinate silt and clay; locally includes fluvial terrace deposits' where fmatn='Qa' and descrip ='';
update sources.puerto_rico set descrip='Avispa Formation: Massive, generally pillowed, dark greenish-gray, andesitic(?) lava; characteristically with abundant, and locally clustered, plagioclase phenocrysts; and subordinate, locally absent, smaller clinopyroxene phenocrysts in a fine-crystalline to almost glassy groundmass. Interbedded throughout the formation is dark grayish-green tuffaceous sandstone as much as 30 m thick, some volcanic breccia/conglomerate, and a local, thin (5m) algal rudist-bearing calcarenite, but fossils have not been identified. Maximum estimated thickness l,800 m. Perchas Formation: Massive, amygdaloidal, commonly pillowed, dark-gray to very dark greenish-gray basaltic lava; characteristically with larger and predominant clinopyroxene phenocrysts and subordinate and smaller plagioclase phenocrysts, thickness of individual flows ranges from l5 to 50 m. Interbedded with minor, thin-bedded, fine- to coarse-grained pyroxene-bearing basaltic tuff, volcanic sandstone, and minor hyaloclastite breccia. Some minor lava with plagioclase phenocrysts.' where fmatn='Kap' and descrip ='';
update sources.puerto_rico set descrip='Coarse-grained, angular to subangular, clayey and silty sand, locally with pebbles and cobbles of quartz and volcanic rocks. Noncalcareous and nonfossiliferous. Occupies channels cut into underlying Quebrada Arenas Limestone Member. Thickness of the formation ranges, from l70 to 260 m.' where fmatn='Tcbmi' and descrip ='';
update sources.puerto_rico set descrip='Generally light- to pale-green, light greenish-gray, equigranular to porphyritic hornblende quartz diorite, minor hornblende- granodiorite, and quartz monzonite and quartz diorite. Composed of abundant plagioclase and subordinate quartz and hornblende held in a microgranitic groundmass of quartz, orthoclase, and plagioclase. Hornblende is commonly replaced by chlorite, calcite and epidote. Plagioclase phenocrysts range from fresh to altered. Rock is locally pyritized, and in some areas includes disseminated chalcopyrite in the groundmass.' where fmatn='Thp' and descrip ='';
update sources.puerto_rico set descrip='Figuera Lava: Massive, medium- to dark-gray, reddish-brown weathering, porphyritic, andesitic lava; locally but not characteristically pillowed. Interlayered with very minor autobrecciated lava, thin- to medium-bedded, tuffaceous sandstone, siltstone, and hyaloclastite breccia. Sparse plagioclase and augite phenocrysts are held in a dense, generally altered groundmass. Lava is locally amygdaloidal. Daguao Formation: Interbedded volcaniclastic breccia, lava, and subordinate sandstone and crystal tuff. ' where fmatn='Kfd' and descrip ='';
update sources.puerto_rico set descrip='Characteristically sited in deeply weathered or hydrothermally altered rocks or in massive rocks overlying such rocks.' where fmatn='Ql' and descrip ='';


INSERT INTO maps.medium (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,29,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.puerto_rico;
pg_dump -t sources.puerto_rico -C -O burwell | gzip > ~/Desktop/puerto_rico.sql.gz
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=29 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.medium (orig_id,source_id,type,new_type,geom) SELECT gid,29,type,new_type,ST_MakeValid(geom) FROM sources.puerto_rico_lines;
pg_dump -t sources.puerto_rico_lines -C -O burwell | gzip > ~/Desktop/puerto_rico_lines.sql.gz



############################################ MOAB ############################################
update sources.ut_moab set descrip='Clay- to boulder-size material in tailings, railroad and road fill, and dams that are large enough to map at the l:100,000 scale; locally as much as 21 meters (70 ft) thick; late Holocene.' where unitsymbol='Qf';
update sources.ut_moab set descrip='Sand, silt, clay, granules, pebbles, and sparse cobbles adjacent to more active stream courses; unconsolidated, poorly to well-sorted channel-fill and low terrace deposits; thickness varies widely, but commonly less than 10 meters (33 ft) thick; Holocene to late Pleistocene.' where unitsymbol='Qal';
update sources.ut_moab set descrip='Light- to medium-gray silt, clay, sand, and minor fragments of sandstone, mostly derived from members of the Cretaceous Kmv; unconsolidated; fills swales in the softest parts of the Mancos Shale; thickness less than 10 meters (33 ft); Holocene to late Pleistocene.' where unitsymbol='Qam';
update sources.ut_moab set descrip='Poorly to  moderately sorted, rounded to angular boulders, cobbles, pebbles, granules, sand, silt, and clay; cover bedrock surfaces between drainages as much as 120 meters (400 ft) above local base level; commonly less than 30 meters (100 ft) thick; mostly late Pleistocene.' where unitsymbol='Qap';
update sources.ut_moab set descrip='Poorly sorted, angular to subrounded gravel, containing cobbles and sparse boulders, in crudely bedded to unstratified granules, sand, silt, and clay matrix; cut-and-fill channel features locally present; deposited at the foot of mountains, cliffs, and at the mouths of streams; thickness commonly less than 15 meters (50 ft); Holocene to late Pleistocene.' where unitsymbol='Qaf';
update sources.ut_moab set descrip='Cobbles, granules, pebbles, sand, silt, and clay adjacent to, but higher than, river, stream, and larger ephemeral stream courses; locally as high as 200 meters (650 ft) above present stream courses; generally contain clasts from distant upstream sources (metamorphic, igneous, and chert clasts); thickness mostly 5 meters (16 ft) or less, but may be 20 meters (60 ft) or more in salt valleys; late to middle Pleistocene.' where unitsymbol='Qat';
update sources.ut_moab set descrip='Clast sizes vary from deposit to deposit; no particular geomorphic form or location; thickness commonly 5 meters (16 ft) or less.' where unitsymbol='Qag';
update sources.ut_moab set descrip='Sand, silt, clay, granules, pebbles, and cobbles; may contain local lacustrine or eolian deposits; fills depressions created by salt dissolution in Pennsylvanian Paradox Formation; may be as much as 180 meters (600 ft) thick; mostly Pleistocene in age, commonly covered by Holocene unconsolidated deposits.' where unitsymbol='Qab';
update sources.ut_moab set descrip='Mostly drab, light-yellow-gray, calcareous tufa, some yellow ocher to dusky red brown, porous, crudely laminated, locally thin bedded; weathers in plates and platelets; formed by cold-water springs and geysers; thickness as much as 7.5 meters (25 ft); Holocene to middle Pleistocene.' where unitsymbol='Qst';
update sources.ut_moab set descrip='Sand and silt of eolian origin interspersed with silt, sand, and gravel of fluvial origin; generally dominated by eolian deposits; commonly displays a well- developed caliche soil horizon at the top; thickness 10 meters (33 ft) or less; Holocene to middle Pleistocene.' where unitsymbol='Qea';
update sources.ut_moab set descrip='Well-sorted sand and silt; deposited in sheets (Qes) and dunes (Qed); commonly fills hollows in sandstone outcrops or collects on the lee sides of cliffs and slopes; thickness 15 meters (50 ft) or less; mostly Holocene.' where unitsymbol='Qes';
update sources.ut_moab set descrip='Well-sorted sand and silt; deposited in sheets (Qes) and dunes (Qed); commonly fills hollows in sandstone outcrops or collects on the lee sides of cliffs and slopes; thickness 15 meters (50 ft) or less; mostly Holocene.' where unitsymbol='Qed';
update sources.ut_moab set descrip='Very poorly sorted, angular to subangular clasts of all sizes; larger clasts are commonly striated; fills U- shaped canyons in the La Sal Mountains; as much as 90 meters (300 ft) thick in lateral moraines; early Holocene to late Pleistocene.' where unitsymbol='Qgt';
update sources.ut_moab set descrip='Rock-fall blocks, boulders, smaller angular gravel, sand, and silt; deposited on slopes below cliffs and steep slopes; only larger deposits mapped; thickness generally 4.5 meters (15 ft) or less; Holocene to late Pleistocene.' where unitsymbol='Qmt';
update sources.ut_moab set descrip='Coherent to broken and jumbled masses of bedrock that have moved downslope due to gravity; most commonly associated with the Jurassic Brushy Basin Member of the Morrison Formation; varied thicknesses; Holocene to late Pleistocene.' where unitsymbol='Qms';
update sources.ut_moab set descrip='Large angular blocks covering slopes in La Sal Mountains; broken by freeze and thaw Kd of hard rock units; may be as thick as 30 meters (100 ft); Holocene to late Pleistocene.' where unitsymbol='Qcb';
update sources.ut_moab set descrip='Sand, silt, granules, pebbles, cobbles, and sparse boulders deposited at the foot of the La Sal Mountains; thickness 60 to 90 meters (200-300 ft); early Pleistocene Kdcm to Pliocene(?).' where unitsymbol='QTaf';
update sources.ut_moab set descrip='Yellow-brown, light-brown, and light-gray conglomerate, sandstone, and siltstone derived from the La Sal Mountains; generally poorly sorted and weakly cemented with calcium carbonate; thickness as much as 305 meters (1,000 ft), but exposures are generally less than 92 meters (300 ft) thick; Pliocene(?).' where unitsymbol='Tg';
update sources.ut_moab set descrip='Hornblende-plagioclase trachyte, quartz-plagioclase trachyte, peralkaline trachyte, peralkaline rhyolite, and nosean trachyte; all porphyritic with fine-grained to aphanitic ground mass (Ross, unpublished data, see 13 and 14); intruded at shallow depths as laccoliths, plugs, sills, and dikes; includes breccia pipes; emplaced 25 to 28 million years ago (Oligocene).' where unitsymbol='Ti';
update sources.ut_moab set descrip='Interbedded light- to dark-brown, medium-grained, thin- to thick-bedded sandstone and pale-gray, green-gray, and brown mudstone and siltstone; ledge and slope former; lower contact gradational, placed above highest carbonaceous beds in the underlying formation; only lower part preserved in the quadrangle; 70 to 204 meters (230-670 ft) thick; Campanian.' where unitsymbol='Kf';
update sources.ut_moab set descrip='Interbedded light- to dark-gray mudstone, carbonaceous shale, and coal and light- to dark-brown sandstone; slope-former with sporadic prominent ledges; coal beds generally less than 0.6 meters (2 ft) thick; lower contact at top of Sego Sandstone cliff; about 43 meters (140 ft) thick; Campanian.' where unitsymbol='Kn';
update sources.ut_moab set descrip='Light-gray and yellow- gray sandstone and gray mudstone; sandstone is fine to medium grained, massive, and cliff-forming; mudstone is slope-forming; displays hummocky bedding, cross-bedding, convolute bedding, ripple laminations, and bioturbation; contains trace fossils; contact with Buck Tongue of Mancos Shale is gradational, placed at the base of the first medium-bedded sandstone bed; about 40 meters (130 ft) thick; Campanian.' where unitsymbol='Ks';
update sources.ut_moab set descrip='Medium- to dark-gray marine mudstone or shale; forms badland slopes; contains thin, fine-grained sandstone beds at top; distinct contact with Castlegate Sandstone below; 37 to 73 meters (120- 240 ft) thick, thinning westward; Campanian.' where unitsymbol='Kmb';
update sources.ut_moab set descrip='Pale yellow- orange and light-gray, cross-bedded sandstone interbedded with minor mudstone, carbonaceous shale, and coal; sandstone is fine grained, generally thick bedded to massive, and cliff and bench forming; locally bioturbated, contains trace fossils; lower contact generally placed above highest carbonaceous shale bed in the underlying Blackhawk Formation; 18 to 30 meters (60-100 ft) thick, thinning eastward; Campanian.' where unitsymbol='Kc';
update sources.ut_moab set descrip='Pale yellow- orange to light-brown sandstone interbedded with mudstone, carbonaceous shale, and coal; sandstone is very fine grained, generally thick bedded, and cliff forming; lenticular coal beds less than 30 centimeters (1 ft) thick; locally intensely bioturbated, contains trace fossils, leaf imprints, and rare shark teeth; gradational with the upper (Blue Gate) shale member of the Mancos Shale, contact is placed at the base of the first thick or medium bed of sandstone; 9 to 40 meters (30-130 ft) thick, thinning eastward; Campanian.' where unitsymbol='Kb';
update sources.ut_moab set descrip='Mostly light- to dark- gray, marine, thinly laminated to thin- bedded, slope-forming shale, mudstone, and siltstone interbedded with subordinate yellow-brown to yellow- gray, mostly very fine- to fine-grained calcareous sandstone that crops out in several thin mappable (Kms) zones of subtle ledges and cliffs; the middle, more sandy part of the upper shale member that contains most of the ledges is the Prairie Canyon Member of Cole and others (1997); zone of thin-bedded, fine-grained sandstone at top; lower contact with Ferron Sandstone Member is gradational; about 1,020 meters (3,350 ft) thick; Campanian to Turonian.' where unitsymbol='Kmu';
update sources.ut_moab set descrip='Yellow-brown to yellow- gray, mostly very fine- to fine-grained calcareous sandstone' where unitsymbol='Kms';
update sources.ut_moab set descrip='Brown-gray to yellow-gray, marine, fine-grained sandstone, sandy mudstone, and carbonaceous shale; fissile to thin bedded; generally forms two sandstone cuestas with a slope of dark-gray to black carbonaceous shale between them; locally fossiliferous; lower contact is a subtle scour surface locally overlain by lenticular lag deposits of pebbly, medium- to coarse- grained sandstone; 15 to 40 meters (50- 130 ft) thick; Turonian.' where unitsymbol='Kmf';
update sources.ut_moab set descrip='Light- to dark-gray, marine shale or mudstone; contains fine-grained sandy zones, especially near the top; slope forming; locally contains concretionary Coon Springs Bed in the upper third of the unit; lower contact with Dakota is abrupt but conformable. The lower contact is an unconformity where the Dakota is missing (Western exposures) and marked by change from green (Cedar City Fm.) to gray shale; 45 to 120 meters (145-390 ft) thick, generally thicker to west; Turonian to Cenomanian.' where unitsymbol='Kmt';
update sources.ut_moab set descrip='On cross sections, includes Buck Tongue of Mancos, Castlegate Sandstone, Blackhawk Formation, upper shale (Blue Gate) member, Ferron Sandstone Member, and Tununk Shale Member of Mancos Shale, as well as Dakota Sandstone. On map in Salt Valley area, includes lower part of upper shale, Ferron, and Tununk members.' where unitsymbol='Km';
update sources.ut_moab set descrip='Yellow-gray to brown sandstone, conglomeratic sandstone, and conglomerate interbedded with gray mudstone, carbonaceous shale, coal, and claystone; commonly forms cliffs and ledges; commonly divisible in the east part of the quadrangle into upper and lower cliff-forming sandstone and conglomerate and a middle, slope- forming mudstone unit; scoured into the Cedar Mountain or Burro Canyon Formations; 0 to 37 meters (0-120 ft) thick, discontinuous in west part of quadrangle, thickens eastward; Cenomanian.' where unitsymbol='Kd';
update sources.ut_moab set descrip='Mapped in areas where they are too thin or where they are too difficult to separate accurately; Yellow-gray to brown sandstone, conglomeratic sandstone, and conglomerate interbedded with gray mudstone, carbonaceous shale, coal, and claystone (Dakota); Drab olive- green to variegated mudstone and brown to gray sandstone, gritstone, conglomerate, and limestone (Cedar Mountain)' where unitsymbol='Kdcm';
update sources.ut_moab set descrip='Drab olive- green to variegated mudstone and brown to gray sandstone, gritstone, conglomerate, and limestone; mudstone is slope forming, other rock types form ledges; locally contains petrified wood; lower contact (unconformity) is placed at base of a prominent sandstone or conglomerate ledge or cliff above the brighter variegated mudstone of the Brushy Basin Member of the Morrison Formation; correlative with the Burro Canyon Formation; 12 to 76 meters (40-250 ft) thick, thins irregularly eastward; Albian.' where unitsymbol='Kcm';
update sources.ut_moab set descrip='Brown to gray sandstone, gritstone, conglomerate, and limestone and olive-green to gray mudstone; mostly cliff forming; correlative with Cedar Mountain Formation; exposed southeast of the Colorado and Dolores Rivers; lower contact (unconformity) is abrupt and placed at base of a conglomeratic sandstone above the slope-forming mudstone of the Brushy Basin Member of the Morrison Formation; 0 to 60 meters (0-200 ft) thick; Albian.' where unitsymbol='Kbc';
update sources.ut_moab set descrip='Variegated (purple, green, white, orange) mudstone interbedded with gray, white, or brown conglom- eratic sandstone, conglomerate, nodular limestone, and gritstone; slope forming with subtle ledges; purple and lavender hues dominate in most areas, but bright green dominates in Cache Valley and in the southern part of the Salt Valley anticline; layers of bentonitic claystone are common, outcrops are generally prone to slumping; lower contact placed at the base of the mudstone sequence or at the base of the lowest conglomerate ledge; 90 to 135 meters (295-450 ft) thick; Upper Jurassic.' where unitsymbol='Jmb';
update sources.ut_moab set descrip='Light-yellow-gray sandstone interbedded with red and gray mudstone and siltstone; sandstone is fine to coarse grained, cross-bedded, and forms medium to thick lenses; mudstone and siltstone form slopes or recesses between sandstone ledges; lower contact at base of first thick sandstone bed above the red or lavender siltstone of the Tidwell Member of the Morrison Formation; locally intertongues with Tidwell siltstones; 40 to 90 meters (130-300 ft) thick; Upper Jurassic.' where unitsymbol='Jms';
update sources.ut_moab set descrip='Divisible in field, but too thin to map separately at the 1:100,000 scale. Tidwell Member (Jmt) consists of calcareous, thin-bedded lavender, Jcl maroon, and light-gray siltstone, light- gray, thin- to thick-bedded, very fine-grained sandstone, and gray thin-bedded or nodular limestone; all slope forming; limestone locally contains large white chert concretions; west of 110° W., locally intertongues with thick white gypsum bodies; 6 to 20 meters (20-65 ft) thick. Summerville unconformably (J-5 unconformity) overlain by Tidwell Member. In areas where combined with the Tidwell, the Summerville is gray, tan, brown, and red, mostly fine-grained, thin-bedded sandstone and siltstone that forms a steep slope and becomes ledgy near the top; 2-21 meters N (6-69 ft) thick. Upper and Middle Jurassic.' where unitsymbol='Jmt';
update sources.ut_moab set descrip='Mapped in areas where Morrison Formation members and the Summerville Formation cannont be separated; Upper and Middle Jurassic.' where unitsymbol='Jsm';
update sources.ut_moab set descrip='Mapped separately near the Green River where it is mostly red sandstone and siltstone; laminated to medium bedded; mostly forms steep slope with light-brown sandstone ledge at top; gypsum veinlets and thin beds of gypsum in the upper part in T. 22 and 23 S., R. 16 and 17 E.; lower contact gradational with Curtis For-mation in far west; lower contact abrupt at base of a reworked zone of the Moab Tongue of the Curtis Formation overlain by red beds; 2 to 67 meters (6-220 ft) thick (see figure 3, plate 3 for thickness detail); Middle Jurassic.' where unitsymbol='Js';
update sources.ut_moab set descrip='Mostly red fine-grained sandstone and siltstone; laminated to medium bedded; commonly forms steep slope; only mapped in T. 23 S., R. 17 1/2 E. and the southwest corner of T. 23 S., R. 18 E.; 30 to 40 meters (100-130 ft) thick; Middle Jurassic.' where unitsymbol='Jsc';
update sources.ut_moab set descrip='Brown, gray, green, lavender, and orange fine-grained sandstone and siltstone; mostly thin bedded, argillaceous and calcareous, forms slopes and ledges; contains red, black, and olive-brown chert near top; unconformable lower contact (J-3 unconformity of Pipiringos and OSullivan, 1978) with the earthy member of the Entrada Sandstone or the Slick Rock Member of the Entrada Sandstone; 0 to 54 meters (0-177 ft) thick, thickening westward; Middle Jurassic.' where unitsymbol='Jct';
update sources.ut_moab set descrip='Light-yellow-gray, fine- to medium-grained, cross-bedded, massive, and cliff-forming sandstone; forms a tongue between the Summerville and Entrada Formations and pinches out in the western part of the quadrangle; rests directly on the Slick Rock Member in the east; the lower contact with the Slick Rock Member of the Entrada Sandstone is placed at the base of a prominent parting or a subtle line, probably the J-3 unconformity of Pipiringos and OSullivan (1978), which has considerable relief in the Dewey area; 0 to 42 meters (0-138 ft) thick (including the main Curtis where both are present); Middle Jurassic.' where unitsymbol='Jctm';
update sources.ut_moab set descrip='Earthy red-brown, fine-grained sandstone; thick nodular to indistinct bedding; more resistant than the Curtis Formation above, but less resistant than the Slick Rock Member of the Entrada Sandstone below; lower contact is generally abrupt, placed above the massive, smooth-weathering sandstone of the Slick Rock; present in R. 16 and 17 E.; the outcrop pinches out in section 11, T. 23 S., R. 17 E.; 0 to 18 meters (0-60 ft) thick; Middle Jurassic.' where unitsymbol='Jee';
update sources.ut_moab set descrip='Mostly orange-red or banded orange- red and white sandstone; generally fine grained, eolian cross-bedded; massive with local discontinuous partings; resistant and smooth weathering, but not as resistant as the Moab Member of the Entrada Sandstone; locally pocked with abundant small spherical holes (with diameters up to 10 centimeters) in outcrop; the lower contact is commonly crenulated or contorted above the darker red-brown sandstone of the Dewey Bridge Member of the Carmel Formation; 43 to 152 meters (140-500 ft) thick, thinning eastward; Middle Jurassic.' where unitsymbol='Jes';
update sources.ut_moab set descrip='Mapped in areas where the Carmel and Entrada Formations were not differentiated in mapping.' where unitsymbol='Jec';
update sources.ut_moab set descrip='Upper half is dark-red, muddy, earthy, fine-grained sandstone; lower half is interbedded dark-red, red-brown, light-brown, and yellow-gray, fine- to medium-grained sandstone; upper half commonly has contorted, nodular, or indistinct bedding and locally contains white beds; upper half forms slopes or recesses between the overlying Slick Rock Member of the Entrada Sandstone and the lower half; lower half is more resistant, is commonly calcareous and cherty, and forms scabs on the underlying Navajo Sandstone; yellow-gray beds in the lower half resemble the underlying Navajo, but are flat bedded; lower half is locally missing, especially in the east; lower contact is the J-2 unconformity of Pipiringos and OSullivan (1978); 8 to 72 meters (25-235 ft) thick, generally thinning eastward; Middle Jurassic.' where unitsymbol='Jcd';
update sources.ut_moab set descrip='Western correlative of the upper half of the Dewey Bridge Member; mostly medium- to red-brown, fine-grained sandstone, with interbedded ledges of light-yellow sandstone and subordinate conglomerate and finely laminated, chippy-weathering calcareous siltstone; red-brown sandstones display indistinct bedding identical with that in the upper half of the Dewey Bridge Member; mapped as the upper Carmel Formation where chippy-weathering calcareous siltstones appear; lower contact is at the top of a distinctive white-weathering' where unitsymbol='Jcu';
update sources.ut_moab set descrip='Western correlative of the lower half of the Dewey Bridge Member; light-gray, light-brown, mostly fine-grained sandstone, in medium to thick, flat beds; generally capped by white to lavender, chippy-weathering, finely laminated calcareous siltstone; mapped where white to lavender siltstone appears; lower contact placed above upturned edges of Navajo Sandstone cross-beds (J-2 unconformity of Pipiringos and OSullivan, 1978); 24 to 27 meters (80- 90 ft) thick; Middle Jurassic.' where unitsymbol='Jcl';
update sources.ut_moab set descrip='Mostly light-hued, fine- to medium-grained, eolian cross- bedded, massive sandstone; lower third commonly weathers to a cliff, the remainder into domes and rounded knolls; locally contains thin, hard, gray limestone beds (Jnl); lower contact placed at the top of a thick, white to pink sandstone in the Kayenta Form- ation; 0 to 225 meters (0-740 ft) thick, pinches out to the northeast over the Uncompahgre uplift; Lower Jurassic.' where unitsymbol='Jn';
update sources.ut_moab set descrip='Red-brown, lavender-gray, fine- to coarse-grained, medium- to thick-bedded sandstone; contains local white and dark-brown beds, intraformational conglomerate, and limestone; forms thick ledges; generally contains abundant red slope- forming siltstone in upper third; lower contact is a scoured surface in the massive orange-brown Wingate Sandstone; 30 to 90 meters (100-300 ft) thick; Lower Jurassic.' where unitsymbol='Jk';
update sources.ut_moab set descrip='Orange-brown, dark-brown-weathering, fine-grained, massive sandstone; forms vertical cliff along canyon walls, commonly stained with desert varnish; abrupt contact with underlying Chinle Formation placed at base of massive, cliff-forming sandstone or on top of thick, orange-brown, flat- bedded sandstone (J-0 unconformity) below which typical Chinle slope- forming siltstones and sandstones are found; 75 to 137 meters (250-450 ft) thick; Lower Jurassic.' where unitsymbol='Jw';
update sources.ut_moab set descrip='Navajo, Kayenta, and Wingate Formations, where exposures cannot be differentiated; combined Navajo, Kayenta, and Wingate Formations also shown on cross sections.' where unitsymbol='Jgc';
update sources.ut_moab set descrip='Red-brown sandstone, siltstone, conglomeratic sandstone, and mudstone; forms steep slope with Moenkopi Formation below; has basal member of quartzose gritstone or sandstone and mottled siltstone and sandstone beneath an unconformity; contains multiple intraformational unconformities adjacent to salt diapirs; lower contact is the Tr-3 unconformity of Pipiringos and OSullivan (1978), which is slightly angular; 0 to 275 meters (0-900 ft) or more thick, greatest thickness in rim synclines adjacent to salt-cored anticlines and locally missing on anticlines; only 12 to 30 meters (40- 100 ft) cover Precambrian rocks on the Uncompahgre uplift to the northeast; Upper Triassic.' where unitsymbol='TRc';
update sources.ut_moab set descrip='Red-orange, chocolate-brown, and medium-brown sandstone, silty sandstone, and minor siltstone and conglomerate; generally divisible into two to four members, but are undivided on the map; lower contact is the Tr-1 unconformity of Pipiringos and OSullivan (1978), which is slightly angular and is found at the top of the more red-brown sandstone of the underlying Cutler Formation; total thickness is 0 to 400 meters (0-1,300 ft) or more, thinning regionally eastward and may be missing on the Uncompahgre uplift in the northeast and very thick in rim synclines adjacent to salt-cored anticlines; Middle (?) to Lower Triassic.' where unitsymbol='TRm';
update sources.ut_moab set descrip='Interbedded red- brown subarkosic, arkosic, and micaceous sandstone and lavender- brown conglomerate; sandstone is fine to coarse grained and gritty in eastern exposures; low- to high-angle cross- beds, thin bedded to massive, and forms smooth and rounded ledges; conglomerate is mostly pebbles to 13- centimeter (5-inch) cobbles, but cobbles exceeding 30 centimeters (1 ft) or more in diameter are common in the eastern part of the quadrangle; mostly quartzite, granite, felsite, gneiss, and schist clasts; matrix is poorly sorted, fine- to coarse- grained sandstone, with grains of quartz, lithic fragments, mica, feldspar, and unidentified black minerals; laminated to indistinct bedding; weathers to smooth irregular slopes or gentle ledges; lower contact is placed above a gray limestone ledge that contains Late Pennsylvanian (Virgilian) fusulinids; 0 to 2,450 meters (0-8,000 ft) thick; missing over some salt-cored anticlines, thickest at the west edge of the Uncompahgre uplift; as much as 1,000 meters (3,300 ft) exposed; 75 meters (245 ft) of gray-white, cross-bedded quartzose sandstone at the top of the Cutler Formation in the north part of the southwest flank of Castle Valley may be an outcrop of White Rim Sandstone; Lower Permian.' where unitsymbol='Pc';
update sources.ut_moab set descrip='Interbedded sandstone, siltstone, limestone, and subarkosic sandstone; limestone is commonly fossiliferous; the lower contact is not exposed, but the unit is juxtaposed against Paradox Formation caprock on the southwest flank of the Onion Creek salt-cored anticline; 0 to 1,525 meters (0-5,000 ft) or more thick, thickening eastward to the west edge of the Uncompahgre uplift, missing on the Uncompahgre uplift and over some salt-cored anticlines; maximum surface thickness is less than 300 meters (985 ft); Upper Pennsylvanian (Virgilian- Missourian).' where unitsymbol='IPh';
update sources.ut_moab set descrip='Mostly light-gray, contorted gypsum with interlayered black and gray shale, thin chippy limestone, and sandstone; locally exposed in salt valleys and along salt- dissolution deformed bedrock; caprock is the residue after salt is dissolved from the Paradox Formation; up to 200 meters (650 ft) exposed and may reach a total of 350 meters (1,150 ft) in the subsurface.' where unitsymbol='IPpc';
update sources.ut_moab set descrip='Mostly fine- to coarse-grained quartz with feldspar; Middle Proterozoic.' where unitsymbol='Yq';
update sources.ut_moab set descrip='Composed of amphibole, Yl biotite, feldspar, and quartz; exposed as dikes, sills, or plugs in Lower Proterozoic rocks so age relative to other Middle Proterozoic rocks is uncertain; Middle Proterozoic.' where unitsymbol='Yl';
update sources.ut_moab set descrip='Aplite - Overall fine-grained, non-foliated granitic rock with varying amounts of quartz, K- feldspar, and plagioclase; forms pink to red fractured outcrops locally cut by quartz veins and pegmatite dikes. Pegmatite - Shown near Coates Creek; medium- to coarse-grained, pink to white rock with varying amounts of quartz, K-feldspar, plagioclase, biotite, and muscovite. Both Middle Proterozoic.' where unitsymbol='Yap';
update sources.ut_moab set descrip='Coarse-grained, porphyritic, generally non-foliated rock containing subequal amounts of quartz, K-feldspar, and plagioclase, with minor hornblende, biotite, and opaque minerals; mostly granite in composition, but includes some quartz monzonite and granodiorite; contains large pink K- feldspar crystals generally up to 8 centimeters (3 inches) in diameter; forms gray to pink-gray bouldery outcrops cut by pegmatite, aplite, and quartz dikes and veins; Middle Proterozoic.' where unitsymbol='Yg';
update sources.ut_moab set descrip='Gray to pink, fine- Ybg to medium-grained; composed of various amounts of plagioclase, K- feldspar, quartz, and biotite; age relative to granite (Yg) uncertain; Middle Proterozoic.' where unitsymbol='Ybg';
update sources.ut_moab set descrip='Coarse-grained plutonic rock containing abundant plagioclase and hornblende, with lesser amounts of pyroxene, biotite and quartz; varies from nonfoliated to moderately foliated along pluton margins that also contain deformed inclusions of wall rock; forms black to brown knobby outcrops; Lower Proterozoic.' where unitsymbol='Xd';
update sources.ut_moab set descrip='Quartz-plagioclase, with or without K-feldspar, gneiss with about 10 to 20 percent hornblende plus biotite; medium to coarse grained with weak to strong foliation; larger bodies form black to dark-gray bouldery outcrops; also occurs as smaller unmapped dikes in the biotite gneiss; Lower Proterozoic.' where unitsymbol='Xg';
update sources.ut_moab set descrip='Contain varying proportions of quartz, plagioclase, and K-feldspar, with about 10 to 30 percent biotite and minor muscovite, hornblende, garnet, and rare sillimanite; generally fine grained, well foliated, thinly layered, and openly to isoclinally folded; locally migmatitic with medium-grained granitic dikelets and segregations, and locally intruded by variably deformed dikes ofgranodiorite and quartz diorite gneiss; forms dark-gray to black, bouldery outcrops; Lower Proterozoic.' where unitsymbol='Xb';
update sources.ut_moab set descrip='Hornblende- plagioclase gneiss with minor quartz, biotite, and K-feldspar; locally interlayered with thin bands of metaquartzite; fine to medium grained and generally strongly foliated and lineated; gneiss forms small, non- resistant black outcrops with local quartzite ledges; Lower Proterozoic.' where unitsymbol='Xa';
update sources.ut_moab set descrip='Quartz-K-feldspar- plagioclase gneiss with about 5 to 15 percent biotite; overall granitic composition, but locally variable; medium grained with strong foliation and lineation defined by preferred orientation of biotite; gneiss forms pink- gray to purple-red outcrops locally cut by dikes of pegmatite, aplite, and quartz; Lower Proterozoic.' where unitsymbol='Xf';
update sources.ut_moab set descrip='Honaker Trail Formation -- Interbedded sandstone, siltstone, limestone, and subarkosic sandstone; Paradox Formation -- Interbedded evaporite, clastic, and carbonate rocks; evaporites include finely laminated halite, sylvite, carnallite, and anhydrite and may constitute as much as 85 percent of the formation; clastic and carbonate rocks are interbedded shale, siltstone, limestone, and dolomite.' where unitsymbol='IP';

UPDATE sources.ut_moab set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
update sources.ut_moab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.ut_moab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.ut_moab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Mesoproterozoic' and age='Middle Proterozoic';
update sources.ut_moab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Paleoproterozoic' and age='Lower Proterozoic';
update sources.ut_moab set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ut_moab set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Pliocene' and age='Pliocene(?)';
update sources.ut_moab set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' - ',2) ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.ut_moab set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Holocene' and age ilike '%Holocene%';
update sources.ut_moab set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Holocene' and age ilike '%Holcene%';
select ut_moab.unitsymbol, m.interval_name,l.interval_name, ut_moab.age FROM sources.ut_moab JOIN macrostrat.intervals m on m.id=early_id join macrostrat.intervals l on l.id=late_id group by ut_moab.unitsymbol,m.interval_name,l.interval_name, ut_moab.age;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,30,unitname,age,descrip,notes,late_id,early_id,st_makevalid(geom) FROM sources.ut_moab;
pg_dump -t sources.ut_moab -C -O burwell | gzip > ~/Desktop/ut_moab.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=30 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

insert into lines.large (orig_id,source_id,name,type,descrip,geom) select gid,30,use_name,use_type,modifier,st_makevalid(geom) from sources.ut_moab_lines;
pg_dump -t sources.ut_moab_lines -C -O burwell | gzip > ~/Desktop/ut_moab_lines.sql.gz

####################################################### ut_lasal #######################################################
update sources.ut_lasal set descrip='Sand, silt, clay, and granule, pebble, and cobble gravel along streams, active washes, and rivers; unconsolidated, poorly to well-sorted channel fill, low terrace, and low-level valley fill deposits; thickness varies widely but commonly less than 12 meters (40 ft) thick; Holocene.' where unitsymbol='Qal';
update sources.ut_lasal set descrip='Alluvial gravel and rubble composed chiefly of poorly to moderately sorted, rounded cobbles with interstitial sand, silt, and clay derived from sedimentary, igneous, and minor contact-metamorphic rocks exposed in the La Sal Mountains; includes middle-level terrace deposits; as much as 7.5 meters (25 ft) thick; Holocene to upper Pleistocene.' where unitsymbol='Qagy';
update sources.ut_lasal set descrip='Alluvial gravel and rubble composed chiefly of poorly to moderately sorted, weathered, rounded cobbles with interstitial sand, silt, and clay derived from sedimentary, igneous, and minor contact-metamorphic rocks exposed in the La Sal Mountains; commonly coated with caliche and found chiefly on higher benches and mesas above modern stream valleys; as much as 7.5 meters (25 ft) thick; upper Pleistocene.' where unitsymbol='Qago';
update sources.ut_lasal set descrip='Poorly to moderately sorted, rounded to angular boulders, cobbles, pebbles in a poorly sorted matrix of sand, silt and clay; deposited as alluvial fans on flanks of the La Sal Mountains; some incised by modern stream channels and washes; as much as 9 meters (30 ft) thick; mostly upper Pleistocene.' where unitsymbol='Qap';
update sources.ut_lasal set descrip='Cobbles, pebbles, sand, silt, and clay; moderately to moderately well sorted; generally cap benches adjacent to rivers and streams; locally as high as 200 meters (650 ft) above the present stream courses; generally contain clasts from distant upstream sources, including metamorphic, igneous and chert clasts; typically less than 5 meters (16 ft) thick; Holocene to middle Pleistocene.' where unitsymbol='Qat';
update sources.ut_lasal set descrip=' Light-brown, red, and gray-yellow wind-blown sand and silt in thin sheet-like deposits covering tops of mesas and plateaus or as thicker deposits filling broad valleys, hollows, and other basins; locally interspersed with silt, sand and gravel of alluvial origin; generally dominated by eolian deposits; grades into stream-deposited sand and silt along washes and includes some modern alluvium; commonly displays a well-developed caliche soil horizon near the top; as much as 12 meters (40 ft) thick; Holocene to middle Pleistocene.' where unitsymbol='Qea';
update sources.ut_lasal set descrip='Mostly white, reddish-brown, or pink, well-sorted, fine- to coarse-grained, unconsolidated sand in dunes and thin sheets; generally less than 15 meters (50 ft) thick; mostly Holocene. Mass-movement deposits' where unitsymbol='Qes';
update sources.ut_lasal set descrip='Mostly angular debris consisting of rock-fall blocks, boulders, small angular gravel, sand, and silt deposited in cone-shaped sloping heaps below cliffs and steep slopes; abundant below outcrops of La Sal Mountains igneous rocks; generally less than 4.5 meters (15 ft) thick; Holocene to upper Pleistocene.' where unitsymbol='Qmt';
update sources.ut_lasal set descrip='Irregular hummocky deposits of rotated and slumped material made up of small to large blocks of sandstone foundering in thick smectitic clays and silts; moved downslope due to gravity; most common on slopes of the Jurassic Morrison Formation and to a lesser extent on the Triassic Chinle Formation and other formations; variable in thickness and extent; Holocene to upper Pleistocene.' where unitsymbol='Qms';
update sources.ut_lasal set descrip='Lobate masses of large blocks of igneous and resistant sedimentary rocks, mostly covering floors of cirques or steep valleys in the La Sal Mountains; show evidence of downslope flowage; thickness unknown; Holocene to upper Pleistocene.' where unitsymbol='Qmr';
update sources.ut_lasal set descrip='Large angular blocks covering slopes in the La Sal Mountains; broken by freeze and
thaw of hard rock units; may be as thick as 30 meters (100 ft); Holocene to upper Pleistocene.' where unitsymbol='Qcb';
update sources.ut_lasal set descrip=' Broken sedimentary rock in masses bounded by near-circular faults; broken rock has generally been displaced downward, generally several hundred feet; breccia contains clasts from formations overlying and adjacent to the deposit; commonly bleached; probably formed by collapse into caverns formed by dissolution of salt, gypsum, or limestone; age unknown, probably Quaternary or Tertiary.' where unitsymbol='bx';
update sources.ut_lasal set descrip='Very poorly sorted, angular to subangular, weathered till and glacial erratics that obscure underlying bedrock; ranges from clay to large boulder clasts, larger clasts commonly striated; as much as 90 meters (300 ft) thick; upper Pleistocene.' where unitsymbol='Qgt';
update sources.ut_lasal set descrip=' Well-consolidated yellowbrown stream gravels composed of igneous and sedimentary pebbles, cobbles, and boulders; cemented with calcium carbonate; mostly conglomerate and sandstone in poorly sorted lenticular beds; sandstones have mostly fine to coarse subangular to angular grains; forms low escarpments to steep slopes in and around La Sal Mountains; 0 to 300 meters (0-1,000 ft) thick; Pliocene(?).' where unitsymbol='Tg';
update sources.ut_lasal set descrip='Hornblendeplagioclase trachyte, quartz-plagioclase trachyte, peralkaline trachyte, peralkaline rhyolite, and nosean trachyte; all porphyritic with fine-grained to aphanitic groundmass; intruded at shallow depths as laccoliths, plugs, sills, and dikes; includes breccia pipes; emplaced 25 to 28 million years ago (Oligocene) (Nelson and others, 1992; M.L. Ross, Utah Geological Survey, unpublished data).' where unitsymbol='Ti';
update sources.ut_lasal set descrip='Dark-olive-gray, brownish-gray, darkgray, and black, fissile, thinly laminated to thinbedded, marine shale and subordinate thin beds of light-gray siltstone, yellow-gray very fine-grained sandstone, limy siltstone, dark-gray sandy limestone, and limestone nodules; forms a slope; limy units contain marine fossils--oysters, other pelecypods, and cephalopods; contact with underlying Dakota Sandstone is gradational and intertonguing. Locally contains a mappable unit (Kms) of fine-grained, fossiliferous, calcareous sandstone with minor thin interbeds of greenish-gray shale that is 60 to 120 meters (200-400 ft) thick and about 300 meters (1,500 ft) above the top of the Dakota Sandstone. The Mancos Shale is incompletely exposed in the quadrangle, a maximum of about 760 meters (2,500 ft) is present; Upper Cretaceous, Campanian to Cenomanian.' where unitsymbol='Km';
update sources.ut_lasal set descrip='Light-brown and yellowish-brown sandstone and conglomerate with interbedded carbonaceous mudstone, shale, and thin coal beds; commonly divisible into three parts (not mapped separately): an upper unit up to 49 meters (160 ft) thick of light-brown, medium- to fine-grained sandstone that crops out as ledges 3 to 9 meters (1030 ft) high; a middle unit up to 30 meters (100 ft) thick of gray shale, dark-gray carbonaceous shale, thin light-brown, fine-grained sandstone beds, and thin discontinuous coal beds; and a lower unit that ranges from a few centimeters up to about 18 meters (60 ft) thick of yellowish-brown to light orangishbrown medium-grained sandstone with sparse to abundant plant debris. Formation varies from 30 to 60 meters (100-200 ft) thick where complete; thicknesses of the parts range considerably because of irregular scouring into the underlying Burro Canyon Formation and by buildup of sands that intertongue into the overlying Mancos Shale; sections where the Dakota forms the tops of benches average about 30 meters (100 ft) thick; Cretaceous, Cenomanian.' where unitsymbol='Kd';
update sources.ut_lasal set descrip='Sandstone, conglomerate, and mudstone, locally containing nodules and thin beds of limestone and shale; sandstone and conglomerate are mostly yellowish brown or gray, weathered surfaces are darker; sandstones are mostly medium-grained, moderately to moderately well sorted, with subrounded to subangular grains of quartz, colored chert, and white feldspar, commonly firmly cemented by quartz cement; conglomerate consists of black, brown, red, and grayish-green subangular to rounded pebbles and cobbles averaging 12 to 13 millimeters (0.5 in) in diameter in a matrix of coarse to medium-grained sand; formation has medium to massive lenticular beds forming ledges and cliffs; locally in three parts: a basal light-gray to yellowishbrown medium- to coarse-grained cross-bedded sandstone containing pebble conglomerate lenses and sparse silicified logs, overlain by a sequence of lightgreen mudstone and siltstone, overlain by shale with thin beds of siliceous limestone, chert, and orthoquartzite; the lower contact is generally mapped at the base of the lowest persistent sandstone; 24 to 90 meters (80-300 ft) thick, averaging 38 meters (125 ft); Lower Cretaceous, Albian.' where unitsymbol='Kbc';
update sources.ut_lasal set descrip='Variegated siltstone, mudstone, smectitic clay, and lesser amounts of calcareous sandstone and conglomerate, locally with thin lentils of dense limestone; siltstone and mudstone are principally maroon, light purple, grayish red, and light to medium gray; crops out as gentle slopes and steep rounded hills, locally in steep slopes with slight ledges; sandstones range from poorly sorted, conglomeratic, and coarse-grained to well sorted, very fine grained to silty; locally has lenticular conglomeratic sandstone at base with bright-colored chert pebbles and cobbles; lower contact is generally a poorly exposed transition zone of frothy-weathering variegated mudstone and thin light-brown sandstone between the basal conglomeratic sandstone of the Brushy Basin Member and the uppermost sandstone lens of the Salt Wash Member; locally contains petrified dinosaur bone and wood; 76 to150 meters (250-500 ft) thick; Upper Jurassic.' where unitsymbol='Jmb';
update sources.ut_lasal set descrip='Interbedded lenses of light-brown, white, yellow-gray, and verypale-orange sandstone and medium red-brown and green-gray siltstone and mudstone; has local minor gray limestone and conglomeratic sandstone; sandstones are mostly medium grained with moderate sorting, however, some are fine grained and silty, others are conglomeratic; some are well sorted and others poorly sorted; conglomeratic sandstone is common at the base of the thick lenticular sandstone beds; sandstone lenses are thick and resistant, siltstone and mudstone form slopes or recesses between sandstone lenses; upper sandstone lens is generally mineralized with uranium and vanadium; 58 to 120 meters (190-400 ft) thick, thickening to the south; Upper Jurassic.' where unitsymbol='Jms';
update sources.ut_lasal set descrip='These two units form a red ledgy slope between the Salt Wash Member of the Morrison and the Moab Tongue of the Curtis Sandstone; the entire ledgy slope was mapped as the Summerville Formation on previous geologic maps (see Primary Map Sources references); the lower part of the ledgy slope is the Summerville Formation, equivalent to the Summerville Formation of the San Rafael Swell (some investigators have called this interval the Wanakah Formation); the upper part of the ledgy slope is the Tidwell Member of the Morrison Formation; the Tidwell (Upper Jurassic) and Summerville (Middle Jurassic) are separated by the J-5 unconformity. The Tidwell Member is red-brown, fine-grained, silty sandstone and siltstone with light-gray mottlings in undulating thin beds; a few thin interbeds of pinkgray crystalline limestone with red and white chert masses are locally present that are more prominent to the north; sandstones are calcareous, fine grained to very fine grained, with subangular, moderately sorted grains; intertongues with the overlying Salt Wash Member of the Morrison Formation; 3 to 15 meters (10-50 ft) thick. J-5 unconformity: The contact between the Summerville and the overlying Tidwell is placed at the base of a pink-gray, thin bed of limestone containing masses of red and white chert in the north part of the map area; and above a light-brownish-gray sandstone ledge in the middle of the red slope to the south; probably represents a hiatus of about 7 million years and marks the boundary between Middle and Upper Jurassic rocks. Summerville Formation (Wanakah Formation on some maps): Most of the Summerville Formation consists of interbedded reddish-brown to light-brown, thin to medium bedded, fine-grained silty sandstone and medium reddish-brown siltstone; in the southern part of the quadrangle it is capped by a light-brown, finegrained cliff of sandstone that is well sorted, friable, porous, and contains subrounded grains, and is up to 4.5 meters (15 ft) thick; commonly at the base is a 0.15 to 1.5 meters (0.5-5 ft) thick reworked zone of yellowish-gray to light-greenish-gray, fine- to mediumgrained sandstone with moderately sorted subangular grains; 1.5 to 21 meters (5-70 ft) thick; generally thin to the north and thick in the southeast part of the quadrangle.' where unitsymbol='Jsmt';
update sources.ut_lasal set descrip='Pinkish-gray, fineto medium-grained, cross-bedded, massive, cliffforming, non-calcareous to slightly calcareous sandstone; grains are subrounded to subangular and frosted; cliffs contain one or more prominent indentations; intertongues with typical greenish-gray Curtis Formation northwest of the quadrangle; 24 to 34 meters (80-110 ft) thick; Middle Jurassic. (The Moab Member was previously considered a member of the Entrada Sandstone see Doelling, 2001). The flat and sharp contact between the Slick Rock Member of the Entrada Sandstone and the Moab Member of the Curtis Formation is easily recognized in the north part of the quadrangle. In a few cases the unconformity is at a prominent indentation at the top of the massive Entrada cliff, but more commonly it is within a smooth cliff face beneath the indentations in the Moab Member. To the north the contact is placed at the top of orangishbrown, banded Slick Rock Member sandstone commonly pocked with small holes. Above the contact the Moab Member is light-pinkish-gray, is nowhere pocked with small holes, and is not banded. To the south the color banding in the Slick Rock Member is not as pronounced, but can be recognized with practice. Additionally, the Slick Rock Member weathers to smooth surfaces, whereas the Moab Member weathers to sugary surfaces. The unconformity probably represents a hiatus of less than a million years.' where unitsymbol='Jctm';
update sources.ut_lasal set descrip='Prominent red slope to ledgy slope zone between the Entrada and Navajo Sandstones; upper part is typical Dewey Bridge Member and is mostly mediumreddish-brown, moderately sorted, fine-grained sandstone, with white or gray mottled spots and streaks; grains are mostly subrounded to subangular; has some dark-reddish-brown partings of siltstone; forms slopes, recesses and ledgy slopes; upper contact with the Slick Rock is undulatory; lower part of member is grayish-yellow, light-gray, pinkish-gray, or light lavender, locally red-mottled, well-sorted, fine-grained sandstone that may correlate with the Paria River Member of southern Utah; grains are subrounded to subangular; generally non-calcareous, medium-bedded, ledgy and sugary weathering; at the base of the member is a thin zone containing scattered sparse to common chert fragments 0.3 to 3 centimeters (0.1 -1 in) in diameter; member is 6 to 24 meters (2080 ft) thick; Middle Jurassic. (Early maps show this unit as Carmel Formation; later maps show it as a member of the Entrada Sandstone; it is herein recognized as a member of the Carmel Formation.)' where unitsymbol='Jcd';
update sources.ut_lasal set descrip='limestone beds in Navajo Sandstone: Pale-yellowish-gray, very light-brown, and pinkish gray, fine- to medium-grained, massive, cross-bedded sandstone; grains are subrounded to subangular, wellsorted and equant, frosted quartz; conspicuously crossbedded with cross-bed sets that range from 1.5 to 7.5 meters (5-25 ft) in thickness; contains sparse thin lenses of gray sandy limestone and, near the base, lenses of reddish-brown siltstone; lower contact gradational and intertonguing; forms rounded knobs, buttes, and mesa rims marked by a checkered pattern of grooved cross-strata and weathering joints; 24 to 150 meters (80-500 ft) thick, thinning eastward; Lower Jurassic.' where unitsymbol='Jn';
update sources.ut_lasal set descrip='Light-brown, red, and reddishbrown, lenticular, cross-bedded, fine- to mediumgrained, poorly to moderately sorted sandstone with partings and thin beds of medium reddish-brown siltstone, fine-grained sandstone, and claystone; sand grains are mostly subangular and cement is mostly calcareous; locally contains beds of intraformational pebble conglomerate with pebbles of sandstone, siltstone and claystone; medium- to thick-bedded, forms thick ledges; locally contains sparse fossil wood and thin beds of pinkish-gray limestone; upper and lower contacts gradational and intertonguing with Wingate-like beds extending 3 to 6 meters (10-20 ft) into the Kayenta Sandstone; 18 to 110 meters (60360 ft) thick; Lower Jurassic.' where unitsymbol='Jk';
update sources.ut_lasal set descrip='Reddish orange, orangish-brown, and light-gray in faint to obvious color bands; mostly fine grained, but with scattered medium grains; mostly subangular to subrounded, moderately sorted grains, locally contains cross-bed streaks of medium and coarse grains; 0.3to 1.3-meter-high cross-bed sets and planar bedding weather into smooth, massive, bare-rock outcrops with few indentations; locally pocked with small holes that follow cross-bedding; slightly to moderately calcareous; thick dark-red-brown siltstone beds become common in the lower part of the member in the south half of the quadrangle and locally resemble the Carmel Formation; 18 to 95 meters (60-310 ft) thick, thickening westward; Middle Jurassic.' where unitsymbol='Jes';

update sources.ut_lasal set descrip='Orangish-brown, massive, crossbedded, fine-grained sandstone; grains are mostly subangular and well-sorted; faintly banded, with few partings; weathers into massive dark-brown vertical to rounded cliffs, generally with bare-rock surfaces; upper contact placed at top of massive cliff and below thick reddish-brown ledges of the Kayenta; near top locally becomes flat bedded with a few medium to thick beds of orangish-brown Wingate-like sandstone interbedded with red-brown siltstone and fine-grained sandstone of the Kayenta Formation; 67 to 130 meters (220-420 ft) thick; Lower Jurassic, basal beds may be Triassic.' where unitsymbol='Jw';

update sources.ut_lasal set descrip='Chocolate-brown or moderatereddish-brown, thinly laminated to medium-bedded, fine-grained sandstone and siltstone, gray very fineto fine-grained micaceous sandstone and thin beds of yellow claystone with common ripple marks, mud cracks, and thin veinlets of gypsum; forms a slope with a few sandstone ledges; commonly 67 to146 meters (220-480 ft) thick, locally ranges from 0 to more than 275 meters (0-900+ ft) thick, missing over salt anticlines and thickest in rim synclines, and probably thins regionally eastward; locally has a lower unit, the Hoskinnini Tongue, of pale-reddish-brown, grayish-red, light-brown, very thin to thick-bedded siltstone and mostly very fine- to medium-grained sandstone with scattered coarse and very coarse grains in tabular beds weathering into knobby ledges that are 27 to 37 meters (90-120 ft) thick; Middle(?) to Lower Triassic.' where unitsymbol='TRm';
update sources.ut_lasal set descrip='Fine to medium-grained, cross-bedded massive slightly calcareous sandstone (Moab Mbr); Reddish-orange sandstone, moderately calcareous (Slick Rock Mbr)' where unitsymbol='Ject';
update sources.ut_lasal set descrip='Red-brown fine-grained silty sandstone and siltstone (Tidwell Mbr); Interbedded light-brown, yellow-gray and pale-orange sandstone and siltstone (Salt Wash Mbr); Reddish-brown to light-brown silty ssandstone and redish-brown siltstone (Summerville Fm).' where unitsymbol='Jsms';
update sources.ut_lasal set descrip='Fine-grained to medium-grained cross-bedded sandstone (Moab Mbr); Reddish-orange fine grained sandstone (Slick Rock Mbr); ' where unitsymbol='Jcec';
update sources.ut_lasal set descrip='Fine-grained, fossiliferous, calcareous sansdtone with interbeds of greenish-gray shale that is 60 to 120 m thick.' where unitsymbol='Kms';
update sources.ut_lasal set descrip='Reddish-brown sandstone, siltstone, conglomeratic sandstone, and greenish-gray mudstone; has an upper interval of grayish-red and reddishbrown mudstone and siltstone with subordinate quantities of red lenticular sandstone and mudstonepebble conglomerate and a lower interval of lightcolored lenticular sandstone and cobble conglomerate interbedded with subordinate amounts of greenishgray mudstone; sandstones and conglomerates contain sparse silicified and carbonized fossil wood and other plant debris and are locally mineralized with uranium, copper, and iron sulfides; other lithologies contain sparse fossil fresh-water fish, phytosaur bones and teeth, and rare gastropods and pelecypods; forms a steep slope interrupted by several strong ledges; lower contact is a regional unconformity; divided into several named members not mapped at this scale; 100 to 230 meters (330-750 ft) thick, averaging 120 to 140 meters (400-450 ft); thickness probably affected by Paradox Formation salt movement, thins over salt diapirs, and thickens in rim synclines; Upper Triassic. Generally a sharp contact between the ledgy greenish-gray to brown fluvial rocks of the Chinle Formation and the "chocolate" brown siltstones and sandstones of the Moenkopi Formation. This unconformity is angular in the vicinity of salt anticlines, elsewhere beds above and below are parallel, with the basal Chinle beds scoured into the upper Moenkopi beds; in the Lisbon Valley area the Moenkopi is cut out by pre-Chinle erosion and rests directly on the Cutler Formation. Represents a hiatus of about 10 to 15 million years.' where unitsymbol='TRc';
update sources.ut_lasal set descrip='In the northeast map area the Cutler unit is a single thick arkosic formation deposited as coalescing alluvial fans on the southwest flank of the Pennsylvanian-Triassic Uncompahgre uplift. To the southwest the arkosic facies grades into a series of formations and thereby gains group status. In that area the Cutler Group consists of (descending order): White Rim Sandstone, Organ Rock Shale, Cedar Mesa Sandstone, Halgaito Formation (southwest part of map), and Rico or Elephant Canyon Formation; Lower Permian; refers to Cutler Group, undivided on cross sections.' where unitsymbol='Pc';
update sources.ut_lasal set descrip='Reddish-brown, red, purple, and reddish-orange, locally mottled palegray, arkosic and subarkosic sandstone, arkose, siltstone, and conglomerate and minor pale-gray limestone; sandstones are fine to coarse grained, gritty, generally fairly to poorly sorted, and irregularly bedded; contains thin, locally fossiliferous limestone beds in the lower part of the unit; forms rough slopes, ledges, and cliffs; exposed mostly around the edges of salt anticlines in the east half and in the north-central part of the map area; 120 to 1,500 meters (400-5,000 ft) thick; thins over salt anticlines and thickens in rim synclines and in the northeast corner of the quadrangle; Lower Permian.' where unitsymbol='Pca';
update sources.ut_lasal set descrip='Light-gray to yellowish-gray, fine-to coarse-grained, cross-bedded sandstone that forms a vertical cliff; exposed at the top of the Cutler Group in the west and northwest part of the map area; pinches out eastward into the arkosic facies; 0 to 76 meters (0-250 ft) thick; Lower Permian.' where unitsymbol='Pwr';
update sources.ut_lasal set descrip='Red-brown siltstone, fine-grained sandstone and subarkosic sandstone, and sandy shale; forms ledges and slopes; is an arkosic tongue that grades eastward into the arkosic facies; 76 to 120 meters (250-400 ft) thick; Lower Permian.' where unitsymbol='Po';
update sources.ut_lasal set descrip='White, yellowish-gray, reddishorange, and reddish-brown, fine-grained calcareous sandstone; thickly cross-bedded, massive, cliff forming; grades and interfingers northeasterly into arkosic facies; exposed in the southwest part of the map area; 60 to 370 meters (200-1,200 ft) thick; Lower Permian.' where unitsymbol='Pcm';
update sources.ut_lasal set descrip='Interbedded reddishbrown, grayish-red, greenish-gray, cross-bedded, very fine- to medium-grained sandstone, dark-red micaceous siltstone, and gray cherty fossiliferous limestone and dolomite ("Rico beds"); becomes thicker and contains more limestone in western sections (Elephant Canyon Formation); to southwest grades into red-brown and purple arkosic sandstone, siltstone, claystone, and conglomerate, with thin marine limestone beds (Halgaito Shale); northward, and northeastward in the subsurface, the formation tongues into the lower part of the arkosic facies; exposed principally in the western half of the map area; 0 to 460 meters (0-1,500 ft) thick; Pennsylvanian-Permian chronologic boundary may be in the lower part of this unit in the southeast part of the quadrangle; mostly Lower Permian.' where unitsymbol='Pcl';
update sources.ut_lasal set descrip='Gray cherty limestone and dolomite, brown, reddish-brown, and gray, fine- to coarsegrained, cross-bedded, locally micaceous and arkosic sandstone, and reddish-, yellowish-, and greenishgray mudstone; limestones locally highly fossiliferous; thin- to thick-bedded; forms ledges and slopes; exposed in deep canyon of the Colorado River and in a whaleback along the Lisbon anticline; 0 to 910 meters (0-3,000 ft) thick; thin or missing over some salt diapirs and thick in rim synclines, perhaps 300 to 460 meters (1,000-1,500 ft) thick in the Colorado River canyon and 460 to 640 meters (1,500-2,100 ft) thick in the Lisbon Valley area where it is mapped in upper (IPhu) and lower (IPhl) members; upper member has more reddish-brown sandstone and is less resistant than lower member; lower member has more abundant and thicker limestone beds; member contact is placed at base of a light-brown, fine-grained limestone containing fossil plant fragments; Upper Pennsylvanian, Virgilian to Missourian.' where unitsymbol='IPh';
update sources.ut_lasal set descrip='Gray cherty limestone and dolomite, brown, reddish-brown, and gray, fine- to coarsegrained, cross-bedded, locally micaceous and arkosic sandstone, and reddish-, yellowish-, and greenishgray mudstone; limestones locally highly fossiliferous; thin- to thick-bedded; forms ledges and slopes; exposed in deep canyon of the Colorado River and in a whaleback along the Lisbon anticline; 0 to 910 meters (0-3,000 ft) thick; thin or missing over some salt diapirs and thick in rim synclines, perhaps 300 to 460 meters (1,000-1,500 ft) thick in the Colorado River canyon and 460 to 640 meters (1,500-2,100 ft) thick in the Lisbon Valley area where it is mapped in upper (IPhu) and lower (IPhl) members; upper member has more reddish-brown sandstone and is less resistant than lower member; lower member has more abundant and thicker limestone beds; member contact is placed at base of a light-brown, fine-grained limestone containing fossil plant fragments; Upper Pennsylvanian, Virgilian to Missourian.' where unitsymbol='IPhu';
update sources.ut_lasal set descrip='Gray cherty limestone and dolomite, brown, reddish-brown, and gray, fine- to coarsegrained, cross-bedded, locally micaceous and arkosic sandstone, and reddish-, yellowish-, and greenishgray mudstone; limestones locally highly fossiliferous; thin- to thick-bedded; forms ledges and slopes; exposed in deep canyon of the Colorado River and in a whaleback along the Lisbon anticline; 0 to 910 meters (0-3,000 ft) thick; thin or missing over some salt diapirs and thick in rim synclines, perhaps 300 to 460 meters (1,000-1,500 ft) thick in the Colorado River canyon and 460 to 640 meters (1,500-2,100 ft) thick in the Lisbon Valley area where it is mapped in upper (IPhu) and lower (IPhl) members; upper member has more reddish-brown sandstone and is less resistant than lower member; lower member has more abundant and thicker limestone beds; member contact is placed at base of a light-brown, fine-grained limestone containing fossil plant fragments; Upper Pennsylvanian, Virgilian to Missourian.' where unitsymbol='IPhl';
update sources.ut_lasal set descrip='Black, gray, and yellowish-gray shale, sandstone, gypsum and thin-bedded limestone in surface exposures (cap rock), but dominated by evaporite minerals (halite, carnallite, and sylvite) in subsurface sections; exposed at the bottom of the Colorado River canyon in the south half of the quadrangle and in Sinbad Valley in the northeast corner of the quadrangle; 157 to 2,700 meters (5159,000 ft) thick; thickest sections are in the cores of salt anticlines, thinnest in the rim synclines; Middle Pennsylvanian, includes underlying Pinkerton Trail Formation on cross section.' where unitsymbol='IPp';
update sources.ut_lasal set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.ut_lasal set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.ut_lasal set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'upper','Late') ilike m.interval_name and early_id IS NULL;

update sources.ut_lasal set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%',m.interval_name) and late_id IS NULL;
update sources.ut_lasal set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Pliocene' and age='Pliocene(?)';
update sources.ut_lasal set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' - ',2) ilike concat(m.interval_name,'%') and early_id IS NULL;
update sources.ut_lasal set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Holocene' and age ilike '%Holocene%';
update sources.ut_lasal set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Oligocene' and age ilike 'Oligocene; emplaced 25 to 28 million years ago';
update sources.ut_lasal set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Pleistocene' and age ilike 'mostly upper Pleistocene';
update sources.ut_lasal set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Holocene' and age ilike 'mostly Holocene';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene to middle Pleistocene';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Pleistocene' and age ilike 'Upper to middle Pleistocene';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Triassic' and l.interval_name='Middle Triassic' and age ilike 'Middle (?) to Lower Triassic';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and age ilike 'Upper and Middle Jurassic';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Quaternary' and age ilike 'age unknown, probably Quaternary or Tertiary';

update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene to upper Pleistocene';
update sources.ut_lasal set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Oligocene' and l.interval_name='Oligocene' and age ilike 'Oligocene; emplaced 25 to 28 million years ago';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,31,unitname,age,trim(descrip),notes,late_id,early_id,st_makevalid(geom) FROM sources.ut_lasal;
pg_dump -t sources.ut_lasal -C -O burwell | gzip > ~/Desktop/ut_lasal.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=31 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.ut_lasal_lines set use_name=concat_WS(' ',subtype,type);
insert into lines.large (orig_id,source_id,name,type,descrip,geom) select gid,31,use_name,use_name,modifier,st_makevalid(geom) from sources.ut_lasal_lines;
pg_dump -t sources.ut_lasal_lines -C -O burwell | gzip > ~/Desktop/ut_lasal_lines.sql.gz


########## ut_stgeorge
update sources.ut_stgeorge set notes='Poorly to moderately consolidated, light-brown, gray, and light-reddish-brown, tuffaceous, alluvial sandstone and subordinate mudstone, siltstone, and conglomerate deposited in closed basins of various ages and origins; most basins are related to the basin-range episode of extension in the area; previously called the Muddy Creek Formation in some areas (Cook, 1957, 1960b; Hintze and others, 1994), but we prefer this generic label given the uncertain correlation to the principal Muddy Creek basin of southeast Nevada; includes the volcaniclastic rocks of Enterprise Reservoir (Blank, 1993) in the northwest corner of the map area, Miocene sedimentary rocks in the Dodge Spring quadrangle (Anderson and Hintze, 1993), and sedimentary breccia of Miocene volcanic units near the Gunlock fault in the Gunlock quadrangle (Hintze and others, 1994); maximum thickness at least 1500 feet (450 m).' where unitsymbol='Ts';

update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE age=m.interval_name;
update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.ut_stgeorge set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE split_part(age,', ',2) ilike m.interval_name and early_id IS NULL and age ilike '%,%';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Upper and Middle Cambrian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Upper and Middle Cambrian';
update sources.ut_stgeorge set early_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age,'Upper','Late'),' to ',2) ilike m.interval_name and early_id IS NULL and age ilike '% to %';
update sources.ut_stgeorge set early_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age,'Lower','Early'),' to ',2) ilike m.interval_name and early_id IS NULL and age ilike '% to %';
update sources.ut_stgeorge set late_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age,'Upper','Late'),' to ',1) ilike m.interval_name and late_id IS NULL and age ilike '% to %';
update sources.ut_stgeorge set late_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age,'Lower','Early'),' to ',1) ilike m.interval_name and late_id IS NULL and age ilike '% to %';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleoproterozoic' and l.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Oligocene' and age ilike 'lower Oligocene to upper Paleocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Oligocene' and l.interval_name='Miocene' and age ilike 'lower Miocene and upper Oligocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Mississippian' and age ilike 'Lower Mississippian and Upper and Middle Cambrian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Morrowan' and l.interval_name='Virgilian' and age ilike 'Upper to Lower Pennsylvanian, Virgilian to Morrowan';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene to upper Pleistocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Aquitanian' and l.interval_name='Serravallian' and age ilike 'middle to lower Miocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Middle Pleistocene' and age ilike 'middle[?] Pleistocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and age ilike 'Miocene?';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Oligocene' and l.interval_name='Oligocene' and age ilike 'upper to lower Oligocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Pleistocene' and age ilike 'middle to lower Pleistocene';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Wolfcampian' and l.interval_name='Leonardian' and age ilike 'Lower Permian, Leonardian to Wolfcampanian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Turonian' and l.interval_name='Santonian' and age ilike 'Upper Cretaceous, Santonian[?] to Turonian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bajocian' and l.interval_name='Callovian' and age ilike 'Middle Jurassic, Callovian to Bajocian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Triassic' and l.interval_name='Triassic' and age ilike 'Upper to Lower Triassic';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Cenomanian' and l.interval_name='Santonian' and age ilike 'Upper Cretaceous, Santonian or lower Campanian to Cenomanian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Albian' and l.interval_name='Cenomanian' and age ilike 'Cretaceous, Cenomanian to Albian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Cambrian' and l.interval_name='Middle Cambrian' and age ilike 'Middle to Lower Cambrian';
update sources.ut_stgeorge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bathonian' and l.interval_name='Callovian' and age ilike 'Middle Jurassic, Callovian to Bathonian';


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,32,unitname,age,trim(notes),compositio,genesis,late_id,early_id,st_makevalid(geom) FROM sources.ut_stgeorge;
pg_dump -t sources.ut_stgeorge -C -O burwell | gzip > ~/Desktop/ut_stgeorge.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=32 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

update sources.ut_stgeorge_lines set use_name=notes;
update sources.ut_stgeorge_lines set use_type='normal fault' where subtype ilike '%normal%';
update sources.ut_stgeorge_lines set use_type='thrust fault' where subtype ilike '%thrust%';
update sources.ut_stgeorge_lines set use_type='dextral strike-slip fault' where subtype ilike '%right-lateral%';
update sources.ut_stgeorge_lines set use_type='sinistral strike-slip fault' where subtype ilike '%left-lateral%';
update sources.ut_stgeorge_lines set use_type='reverse fault' where subtype ilike '%reverse%';
update sources.ut_stgeorge_lines set use_type='gravity slide' where subtype ilike '%gravity slide%';
update sources.ut_stgeorge_lines set use_type=type where use_type is null;
update sources.ut_stgeorge_lines set use_name=use_type where use_name is null;
insert into lines.large (orig_id,source_id,name,type,descrip,geom) select gid,32,use_name,use_type,feature,st_makevalid(geom) from sources.ut_stgeorge_lines;
pg_dump -t sources.ut_stgeorge_lines -C -O burwell | gzip > ~/Desktop/ut_stgeorge_lines.sql.gz

########## smokies
update sources.smokies set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.smokies set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;

update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neogene' and l.interval_name='Holocene' and age ilike 'Holocene to Tertiary';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Middle Cambrian and Upper Cambrian';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Cambrian-Ordovician' and age ilike 'Paleozoic and Neoproterozoic';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Serpukhovian' and l.interval_name='Serpukhovian' and age ilike 'lower Upper Mississippian';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Cambrian' and l.interval_name='Early Ordovician' and age ilike 'Upper Cambrian and Lower Ordovician';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene and Pleistocene';
update sources.smokies set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Devonian' and l.interval_name='Tournaisian' and age ilike 'Upper Devonian and Lower Mississippian';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,33,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.smokies;
pg_dump -t sources.smokies -C -O burwell | gzip > ~/Desktop/smokies.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=33 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,geom) SELECT gid,33,type,new_type,ST_MakeValid(geom) FROM sources.smokies_lines;
pg_dump -t sources.smokies_lines -C -O burwell | gzip > ~/Desktop/smokies_lines.sql.gz


########### grand canyon
## http://pubs.usgs.gov/imap/i-2688/

UPDATE sources.grandcanyon SET strat_name='', unit_name='Colorado River gravel deposits', age='Holocene', descrip='Mud, silt, and fine-grained sand transported by the Colorado River; interbedded with poorly sorted, angular to well-rounded, coarse-grained sand, gravel, pebbles, cobbles, and boulders of local alluvial debris fans and flows, partly reworked by the Colorado River. Includes local wind-blown sand sheets and small sand dune deposits derived from local gravel
deposits. Only large deposits shown. About 3–80 ft (1–25 m) thick' WHERE usgs_sym='Qr';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Terrace gravel deposits',age='Holocene and Pleistocene',descrip='Light-brown, pale-red, and gray, slope-forming, poorly sorted alluvial mud, silt, sand, coarse gravel, pebbles, cobbles, and boulders. Composed mainly of subangular to well-rounded Paleozoic sandstone and limestone clasts of local origin and some rounded clasts of assorted metamorphic rocks locally derived from inner gorge of Grand Canyon, and well-rounded quartzite and volcanic rocks that originated upstream in Utah, Colorado, and New Mexico. Clasts are partly consolidated by matrix of mud and sand cemented with calcium and gypsum. Thick deposits of mud and silt are preserved on south side of Colorado River just downstream of Tapeats Creek (north-central part of map area). Forms terraced benches about 3–300 ft (1–100 m) above post-Glen Canyon Dam high-water line of Colorado River, and above local tributary stream beds. Deposit is mixed with landslide and talus debris near Fossil Canyon and Tapeats Creek areas and may represent deltaic deposits resulting from temporary ponding of Colorado River by the Surprise Valley landslide near Tapeats Creek, or by volcanic dams farther downstream near western edge of map area. Only largest deposits shown. About 3–300 ft (1–100
m) thick' where usgs_sym='Qtg';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Alluvial deposits',age='Holocene and Pleistocene',descrip='Brown, red, and gray, slope-forming,
unsorted mixture of mud, silt, sand, pebbles, cobbles, and boulders. Clasts are mostly angular, some are rounded; locally consolidated by calcite and gypsum cement. Sandstone, limestone, and chert clasts and gravel are locally derived from Paleozoic rocks. Includes alluvial-fan, floodplain, talus, colluvium, and valley-fill deposits. Subject to extensive sheet wash erosion or deposition, flash-flood debris flows, and arroyo erosion. Only largest deposits shown; most talus deposits are not shown to emphasize the bedrock geology, but are common in headward slopes of local tributary drainages and as talus deposits on slopes of Hermit Formation (Ph). About 3–100 ft (1–30 m) thick' where usgs_sym='Qa';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Travertine deposits',age='Holocene and Pleistocene',descrip='Gray, white, and tan, massive, porous, cliff-forming limestone. Includes clasts of talus breccia or stream gravel. Formed as rapid chemical precipitation of calcium carbonate of spring water. Forms massive, rounded mounds or thick, layered encrustations on steep slopes or cliffs at and near active and inactive springs. Forms banded deposits of dripstone, flowstone, and rimstone as porous massive hanging sheets, including stalactites and stalagmites. Thickest deposits are in Havasu Canyon below Supai, and at Royal Arch Creek east of Supai. Forms temporary dams or blockages of Havasu Creek in Havasu Canyon. Only thickest deposits shown. About 3–100
ft (1–30 m) thick' where usgs_sym='Qt';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Landslide deposits',age='Holocene and Pleistocene',descrip='Unconsolidated to partly consoli-
dated masses of unsorted rock debris. Includes detached blocks that have rotated backward and slid downslope as loose incoherent masses of broken rock and deformed strata, partly surrounded by talus (talus not shown). Includes local talus, rock glaciers, and rock-fall debris. Landslide blocks may be associated with earthquake activity. Some landslide blocks may become unstable in very wet conditions. Only large landslide blocks shown (fig. 5). Many small landslide masses are commonly found below cliffs of Kaibab Formation (Pk), Coconino Sandstone (Pc), Redwall Limestone (Mr), and Tapeats Sandstone ( t). Variable thickness 10–200 ft (3–60 m)' where usgs_sym='Ql';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Intrusive dikes',age='Quaternary',descrip='Dark-gray, finely crystalline alkali-olivine basalt. Contains augite and olivine phenocrysts in glassy groundmass. Occurs as two dikes in unnamed western tributary of upper Tuckup Canyon that align with trend of 10 Hancock Knolls pyroclastic cones (Qhp) on Kanab Plateau. Alignment reflects prominent northwest strike of near-vertical fractures and joints in Paleozoic
strata in Tuckup Canyon area. Dikes are 1–3 ft (0.4–1 m) wide' where usgs_sym='Qti';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Pyroclastic deposits',age='Quaternary',descrip='Red and reddish-gray cinders and scoriaceous glassy fragments of basalt; unconsolidated. Forms small cinder cone overlying associated basalt flow (Qtb) and part of Toroweap and Kaibab Formations (Pt, Pk) and Coconino Sandstone (Pc) in an unnamed western tributary of Tuckup Canyon. Also forms small isolated deposit below Qti dike at Coconino Sandstone (Pc) and Hermit Formation (Ph) contact northwest of unnamed western tributary canyon
of Tuckup Canyon. Thickness about 200 ft (60 m)' where usgs_sym='Qtp';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Basalt flow',age='Quaternary',descrip='Dark- to light-gray, finely crystalline alkali-olivine basalt. Most of
the basalt came from a fissure-like dike (Qti) and pyroclastic cone (Qtp) vent area in unnamed western tributary of upper Tuckup Canyon (Billingsley, 1970). Basalt flowed into Tuckup Canyon over outcrops of Toroweap and Kaibab Formations, Coconino Sandstone, Hermit Formation, and Esplanade Sandstone (Pe). The basalt flow merged or coalesced with a basalt flow (Qhb) from the Hancock Knolls area and spread out into upper Tuckup Canyon onto alluvium and Esplanade Sandstone. Tuckup Canyon drainage has been diverted around east side of basalt flow in upper Tuckup Canyon. Remnants of basalt flow cascaded over and cling to steep canyon walls of Esplanade Sandstone and Wescogame Formation, undivided (M u), indicating that Tuckup Canyon had eroded at least as deep as Manakacha Formation, undivided, prior to the flow about 760,000 years ago. Thickness ranges from 3–25 ft (1–7.5 m)' where usgs_sym='Qtb';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Pyroclastic deposits',age='Quaternary',descrip='Red to reddish-black cinder and scoriaceous basaltic fragments, and black cinders; unconsolidated. Forms 10 pyroclastic cones on the Kanab Plateau that align along a strike of N. 30° W. for about 5 mi (8 km) northwest of Tuckup Canyon. Unit overlies associated basalt flows (Qhb) and Harrisburg Member of Kaibab Formation (Pk). Variable thickness 40–350 ft (12–107 m)' where usgs_sym='Qhp';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Basalt flows',age='Quaternary',descrip='Dark- to light-gray, finely crystalline alkali-olivine basalt. Contains augite and olivine phenocrysts less than 1 mm in diameter in glassy groundmass. Unit overlies Harrisburg Member of Kaibab Formation (Pk). The southernmost basalt flowed about 1 mi (1.5 km) and cascaded down an unnamed western tributary of upper Tuckup Canyon to coalesce with Tuckup Canyon Basalt (Qtb; Billingsley, 1970). Tributary drainage has eroded through this basalt flow. Variable thickness 3–90 ft (1–27 m)' where usgs_sym='Qhb';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Pyroclastic deposits',age='Quaternary',descrip='Red-brown and reddish-black scoriaceous basalt fragments, ash, and cinder deposits; partly consolidated. Including deposits outside of map area, forms three pyroclastic cones that align along a north-south, near-vertical bedrock fracture or joint system (Billingsley and Workman, 2000). Deposits overlie associated basalt flows (Qsb). Only eastern part of southernmost pyroclastic cone lies within map area. About 200 ft (60 m) thick' where usgs_sym='Qsp';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Basalt flows',age='Quaternary',descrip='Dark-gray, finely crystalline to glassy alkali-olivine basalt. Groundmass contains plagioclase, olivine, and augite laths. Includes abundant olivine phenocrysts 0.25–5 mm in diameter consisting of about 30 percent basalt in some outcrops. Overlies Harrisburg Member of Kaibab Formation (Pk). Basalt is offset about 110 ft (34 m) by the Toroweap Fault about 2 mi (3 km) west of northwestern corner of map area (Billingsley and Workman, 2000). Thickness ranges from 10 to 60 ft (3 to 18 m)' where usgs_sym='Qsb';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Basalt dikes and necks',age='Pleistocene',descrip='Dark-gray, finely crystalline alkali-olivine basalt with plagioclase laths in glassy groundmass. Intrudes through lower part of Hermit Formation (Ph). Forms small dike in an eastern tributary of Tuckup Canyon, two dikes and a neck just downstream of Havasu Canyon (159-Mile dikes, Wenrick and others, 1995), a dike or neck called “The Cork” on the Esplanade Sandstone just north of the 159-Mile dikes, and a neck/dike combination on the Esplanade Sandstone called “Yumtheska Vent West” and “Yumtheska Vent East” below Yumtheska Point (Wenrich and others, 1995), northwestern part of map area. Whole-rock K-Ar age obtained for The Cork is 0.407±0.07 Ma, and for Yumtheska Vent West 0.78±0.15 Ma. The Cork, the 159-Mile dikes, the Yumtheska Vents East and West , and the small dike in unnamed eastern tributary of Tuckup Canyon are aligned along a northwest-trending (N. 45° W.) near-vertical joint and fracture system, suggesting a similar eruptive event between 405,000 and 780,000 years ago. The Cork and the Yumtheska Vents East and West include red pyroclastic deposits and local minor basalt that flowed onto the Esplanade Sandstone surface. The neck associated with the 159-Mile dikes is exposed in upper part of Watahomigi-Manakacha Formations, undivided (M u), as a neck of welded pyroclastic tuff. All volcanic rocks in this part of map area suggest that the Colorado River had eroded the Grand Canyon almost down to, but not below, Redwall Limestone (Mr) about 405,000–780,000 years ago' where usgs_sym='Qi';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Pyroclastic deposits',age='Pleistocene',descrip='Red and reddish-black, scoriaceous alkali-olivine basalt fragments, cinders, ribbons, and bombs. Thickness about 30 ft (10 m) or more at Yumtheska Vent West; minor accumulations at “The Cork” and Yumtheska Vent West too thin to show at map scale' where usgs_sym='Qp';
UPDATE sources.grandcanyon SET strat_name='Moenkopi Formation', unit_name='',age='Lower Triassic',descrip='Red, slope-forming, fine-grained, thin-bedded shaley siltstone and sandstone. Unit mostly eroded from map area except for one small outcrop along Bright Angel Fault southwest of Grand Canyon. Only about 20 ft (6 m) of basal part of Moenkopi Formation is present and most certainly represents Lower Triassic strata only. Unit is distinguished from underlying red siltstone of Harrisburg Member of Kaibab Formation (Pk) by its darker red color and thin-bedded, platy sandstone beds as opposed to the massive-bedded, pale-red, undulating, softer siltstone beds of Harrisburg Member. A complete section of the Moenkopi crops out at the Vermilion Cliffs about 24 mi (38 km) northeast of map area, and at Mount Logan in the Sawmill Mountains about 13 mi (21 km) west of map area. About 20 ft (6 m) exposed' where usgs_sym='TRm';
UPDATE sources.grandcanyon SET strat_name='Kaibab Formation', unit_name='',age='Lower Permian',descrip='Includes, in descending order, Harrisburg and Fossil Mountain Members, undivided, as defined by Sorauf and Billingsley (1991). Harrisburg Member—Reddish-gray and brownish-gray, slope-forming gypsum, siltstone, sandstone, and limestone. Informally subdivided, in descending order, into three units forming an upper slope, middle cliff, and lower slope. Upper slope unit is interbedded red and gray gypsum, sandstone, and siltstone, and yellowish-gray fossiliferous sandy limestone. Middle cliff unit is gray, thin-bedded, fossiliferous cherty limestone and sandy limestone. Lower slope unit is (1) yellowish-gray to pale-red gypsifereous siltstone and calcareous sandstone, (2) gray, thin-bedded sandy limestone, and (3) gray to white, thick-bedded gypsum. Upper, middle, and lower units become inseparable on the Kaibab Plateau, northeastern quarter of map area. Solution weathering within gypsum beds of lower slope unit has resulted in warping and bending of limestone of middle cliff unit, especially in or near local drainages on Kanab and Coconino Plateaus where middle cliff unit forms surface bedrock. Gypsum solutioning is responsible for several sinkhole depressions within Harrisburg Member. Contact with underlying Fossil Mountain Member is gradational and arbitrarily marked at top of cherty limestone cliff of the Fossil Mountain. About 260 ft (80 m) thick in western half of map area, thinning eastward to about 120 ft (36 m) in northeastern quarter of map area. Average thickness about 165 ft (50 m) Fossil Mountain Member—Light-gray, cliff-forming, fine- to medium-grained, thin- to medium-bedded [1–6 ft (0.3–2 m)], fossiliferous, sandy, cherty limestone. In general, unit weathers dark gray. Unit characterized by gray to white fossiliferous chert nodules and white chert lenses parallel to bedding; chert weathers dark gray to black. Some chert nodules contain concentric black and white bands. Includes brecciated chert beds 4–10 ft (1–3 m) thick in upper part at contact of thin limestone or gypsifereous siltstone of Harrisburg Member. Chert in central and western parts of map area makes up about 20 percent of unit; unit becomes sandy in northeastern quarter of map area. Generally forms cliff at rim of the Grand Canyon. Weathers into pinnacles or “pillars” detached from cliff in western half of map area. Unconformable contact with underlying Woods Ranch Member of Toroweap Formation (Pt) attributed to solution erosion and channel erosion; average relief about 10 ft (3 m). Some channels have eroded as much as 150 ft (45 m) into the Woods Ranch in western half of map area. Erosion channels were filled with sandy cherty limestone typical of the Fossil Mountain, providing an extra thickness of the Fossil Mountain. Thickness about 230–350 ft (70–107 m)' where usgs_sym='Pk';
UPDATE sources.grandcanyon SET strat_name='Toroweap Formation', unit_name='',age='Lower Permian',descrip='Includes, in descending order, Woods Ranch, Brady Canyon, and Seligman Members, undivided, as defined by Sorauf and Billingsley (1991) Woods Ranch Member—Gray and light-red, slope-forming gypsifereous siltstone and silty sandstone, interbedded with white laminated gypsum and gray thin- bedded limestone. Gypsum beds are as much as 10 ft (3 m) thick. Unit as a whole weathers reddish gray. Bedding locally distorted due to solutioning of gypsum. Contact with underlying Brady Canyon Member is gradational and arbitrarily marked at top of cliff-forming limestone of the Brady Canyon. Variable thickness owing to solution of gypsum and channel erosion in upper part; averages about 65 ft (20 m) thick in southeastern quarter of map area, thickening to as much as 200 ft (60 m) in northwestern half of map area Brady Canyon Member—Gray, cliff-forming, thin- to medium-bedded [1–5 ft (0.05– 1.4 m)], fine- to coarse-grained, fetid, fossiliferous limestone. Weathers dark gray. Includes thin-bedded dolomite in upper and lower parts. Contains white and gray chert nodules that make up less than 8 percent of unit. Contact with underlying Seligman Member is gradational and arbitrarily placed at base of cliff-forming limestone of the Brady Canyon. Thickness about 40 ft (12 m) at eastern edge of map area, increasing to about 130 ft (40 m) at western edge of map area Seligman Member—Gray, light-purple, and yellowish-red, slope-forming, thin-bedded dolomite, sandstone, and gypsum above intertongued Coconino Sandstone, and yellowish-tan, flat-bedded, thin-bedded sandstone below the Coconino. In eastern two-thirds of map area, unit is mostly a purplish to light-red, flat-bedded calcareous sandstone interbedded with gray, thin-bedded limestone. In western third of map area, unit is gray-white gypsum and light-red to yellowish-red, thin-bedded calcareous sandstone and gray dolomite. Forms slope or recess between overlying cliff-forming Brady Canyon Member and underlying cliff-forming Coconino Sandstone (Pc) in southeastern two-thirds of map area; forms a gypsifereous slope similar to that of Woods Ranch Member in northwestern third of map area. Sharp gradational contact with the interbedded Coconino where cross-bedded sand dunes of the Coconino were beveled off and sand was redistributed as flat-bedded sandstone. The Coconino intertongues with lower part of the Seligman in western third of map area (Fisher, 1961; Schleh, 1966; Rawson and Turner, 1974; and Billingsley and Workman, 2000). Thickness about 30 ft (9 m) in eastern half of map area, increasing to about 55 ft (17 m) in western half' where usgs_sym='Pt';
UPDATE sources.grandcanyon SET strat_name='Coconino Sandstone', unit_name='',age='Lower Permian',descrip='Tan to white, cliff-forming, fine-grained, well-sorted, cross-bedded quartz sandstone. Contains large-scale, high-angle, planar cross-bedded sandstone sets that average about 35 ft (11 m) thick. Locally includes poorly preserved fossil tracks and low-relief wind ripple marks on cross-bedded planar sandstone surfaces. Lower 5–20 ft (2–6 m) is intertongued, thin-bedded, partly calcareous, flat-bedded sandstone of Seligman Member of Toroweap Formation (Pt). Unconformable contact with underlying Hermit Formation (Ph) is sharp planar, with relief generally less than 3 ft (1 m) but locally as much as 8 ft (2.5 m). Desiccation cracks in the Hermit, as much as 2 ft (0.05 m) wide and 12 ft (4 m) deep, are filled with tan sandstone of the Toroweap or Coconino, mainly in eastern third of map area. Thickness of the Coconino decreases east to west, whereas Brady Canyon and Seligman Members of Toroweap Formation increase proportionally in thickness. Forms a 500-ft (154m) thick cliff in southeast corner of map area, thinning northward to about 350 ft (122 m) and westward to about 150 ft (45 m) at western edge of map area' where usgs_sym='Pc';
UPDATE sources.grandcanyon SET strat_name='Hermit Formation', unit_name='',age='Lower Permian',descrip='Red, slope-forming, fine-grained, thin-bedded siltstone and sandstone. Upper part contains red and white, massive, low-angle cross-bedded calcareous sandstone and siltstone beds in western one-quarter of map area. Siltstone beds are dark red and crumbly, and fill shallow erosion channels that are widespread. Siltstone beds form recesses between thicker sandstone beds; locally contains poorly preserved plant fossils in channel fills in lower part of formation. Sandstone beds thicken and thin laterally either as channel fill or low sand dune accumulations. Sandstone bleaches to yellow-white color in vicinity of breccia pipes throughout map area, and at upper contact with Coconino Sandstone (Pc) or Toroweap Formation (Pt) in western half of map area. Unconformably overlies Esplanade Sandstone (Pe). Dark-red, platy, thin-bedded siltstone of Hermit Formation fills channels as much as 60 ft (16 m) deep eroded into the underlying Esplanade in eastern part of map area, and as much as 130 ft (40 m) deep in Havasu Canyon area, south-central part of map area. Erosional relief is generally less than 10 ft (3 m) in northeastern part of map area. About 260 ft (80 m) thick along eastern edge of map area, increasing to about 850 ft (260 m) at western edge of map area' where usgs_sym='Ph';
UPDATE sources.grandcanyon SET strat_name='Esplanade Sandstone', unit_name='',age='Lower Permian',descrip='Light-red and pinkish-gray, cliff-forming, fine- to medium-grained, medium-bedded [3–10 ft (1–3 m)], well-sorted calcareous sandstone. Includes intrabedded dark-red, thin-bedded, crumbly, slope-forming siltstone in upper and lower parts. Consists of an upper cliff and slope unit in western two-thirds of map area, and a middle cliff unit and a lower slope unit throughout map area. In western two-thirds of map area, the upper cliff and slope unit contains thin-bedded slope-forming sandstone and siltstone similar to (Ph) capped by cliff of thick-bedded, low-angle cross-bedded, red and white sandstone; entire unit thins and pinches out eastward in eastern third of map area. Maximum thickness of upper cliff and slope unit about 220 ft (67 m), western edge of map. Middle cliff unit forms a prominent cliff whose upper surface forms the “Esplanade Bench” in western two-thirds of map area, and a prominent cliff in eastern third of map area. Unit consists of light-red, medium-grained, medium- to thick-bedded sandstone and calcareous sandstone in upper half, and mostly flat, massive, low-angle cross-bedded sandstone sets and calcareous sandstone beds in lower half. Cross beds are small- to medium-scale, planar low-angle and high-angle sets. Cross-bedded calcareous sandstone is most common in western half of map area, lesser calcite in eastern half. Middle cliff unit averages about 250 ft (75 m) thick in western half of map area, thinning to about 200 ft (60 m) in eastern half. Lower slope unit consists of alternating layers of light-red, flat-bedded sandstone interbedded with dark-red siltstone and mudstone and gray, thin-bedded limestone. Lower slope unit averages about 80 ft (25 m) thick in western half of map area, thickening to about 100 ft (30 m) in eastern half. Unconformable contact with underlying Wescogame Formation marked by erosion channels as much as 50 ft (15 m) deep filled with limestone conglomerate; average channel depth about 35 ft (11 m). Overall, the Esplanade averages about 550 ft (167 m) thick in western half of map area, thinning to less than 300 ft (90 m) in eastern half' where usgs_sym='Pe';
UPDATE sources.grandcanyon SET strat_name='Wescogame Formation, Manakacha Formation, Watahomigi Formation', unit_name='',age='Late Pennsylvanian to Late Mississippian',descrip='Wescogame Formation—Light-red, pale-yellow, and light-gray upper slope unit and lower cliff unit. Upper slope unit consists mainly of dark-red, fine-grained siltstone and mudstone interbedded with light-red, coarse-grained, calcareous sandstone and dolomitic sandstone, siltstone, mudstone, and conglomerate. Lower cliff unit consists mainly of light-red to gray, high-angle, large- and medium-scale, tabular-planar, cross-bedded sandstone and calcareous sandstone sets as much as 40 ft (12 m) thick. Includes interbedded dark-red, thin-bedded siltstone in upper part of cliff. Cross-bed sets contain large footprints of four-footed vertebrate animals in eastern part of map area. Unconformable contact with underlying Manakacha Formation marked by unconformity of erosion channels as much as 80 ft (24 m) deep in western part of map area, and less than 30 ft (10 m) deep in eastern part of map area. Channels commonly filled with limestone/chert conglomerate. The Wescogame thickens slightly from west to east, averaging about 130 ft (40 m) in western part of map area and about 150 ft (45 m) in eastern part Manakacha Formation—Light-red, white, and gray upper slope unit and lower cliff unit of sandstone, calcareous sandstone, dark-red siltstone, and gray limestone. Upper slope unit consists mainly of shaley siltstone and mudstone with minor interbedded, thin-bedded limestone and sandstone. Carbonate content of upper slope unit increases westward to form numerous ledge-forming, thin- and medium-bedded limestone beds. Upper slope unit is about 100 ft (30 m) thick in eastern half of map area, decreasing to less than 60 ft (18 m) thick in western half. Lower cliff unit is dominated by grayish-red, medium- to thick-bedded, cross-bedded calcareous sandstone, dolomite, and sandy limestone. Lower cliff unit is about 60 ft (18 m) thick in eastern part of map area, thickening to about 100 ft (30 m) in western part. Carbonate content of lower cliff unit increases westward across map area, forming numerous gray limestone ledges. Unconformable erosional contact between the Manakacha and underlying Watahomigi Formation approximately marked at base of lower sandstone cliff of the Manakacha; erosional relief generally less than 3 ft (1 m) and wavy unconformable surface. Overall thickness averages about 200 ft (60 m) throughout map area Watahomigi Formation—Gray and purplish-red, slope-forming limestone, siltstone, mudstone, and conglomerate. Forms an upper ledge/slope unit and a lower slope unit. Upper ledge/slope unit consists of alternating gray, thin-bedded cherty limestone ledges interbedded with purplish-gray siltstone and mudstone; limestone beds contain Lower Pennsylvanian conodont fossils (Martin and Barrick, 1999); red chert lenses and nodules common. Includes limestone chert-pebble conglomerate at base, locally containing Lower Pennsylvanian fossils. Upper ledge/slope unit averages about 70 ft (21 m) thick throughout map area. Lower slope unit consists mainly of purplish-red mudstone and siltstone, interbedded with thin-bedded, aphanitic to granular limestone in upper part with red chert veins and nodules. Conodonts in lower thin limestone beds are Upper Mississippian (Martin and Barrick, 1999). Unit includes purple siltstone and gray limestone interbedded with conglomerate that fill small erosion channels cut into either Surprise Canyon Formation (Ms) or Redwall Limestone (Mr). Purple shale and mudstone of lower slope unit unconformably overlies the gray Redwall in majority of map area. Contact with the Surprise Canyon is often based on color change from purple mudstone of the Watahomigi to dark-red mudstone of the Surprise Canyon. Unit averages about 100 ft (30 m) thick along eastern edge of map area, thickening to about 200 ft (60 m) along western edge' where usgs_sym='MIPs';
UPDATE sources.grandcanyon SET strat_name='Surprise Canyon Formation', unit_name='',age='Upper Mississippian',descrip='Dark-reddish-brown siltstone and sandstone, gray limestone and dolomite, and grayish-white chert conglomerate in dark-red or black sandstone matrix. Formation locally absent throughout map area; present only in paleovalleys and karst caves eroded into top half of Redwall Limestone (Mr). Consists of an upper slope unit, a middle cliff unit, and a lower slope unit in western half of map area; forms slope in eastern half of map area. Upper slope unit consists of red-brown, thin-bedded siltstone, calcareous sandstone, and reddish-gray, thin-bedded sandy limestone. Contains numerous ripple marks and marine fossils. Thickness ranges from about 50 to 75 ft (15 to 23 m). Middle cliff unit consists of a reddish-gray, thin-bedded, coarse-grained silty and sandy limestone containing numerous marine fossils. Average thickness about 50 ft (15 m) in western third of map area, thinning and pinching out eastward in eastern two-thirds of map area. Lower slope unit consists of dark-red-brown to black, iron-stained, thin-bedded, coarse- to medium-grained siltstone, sandstone, limestone, and conglomerate. Sandstone and siltstone beds contain numerous plant fossils, bone fossils, mudcracks, and ripplemarks. Sandstone is coarse grained and thin bedded with some low-angle, cross-beds. Conglomerate beds consists of white and gray chert clasts supported in dark-red to black, coarse-grained chert sandstone or gravel matrix, all derived from the Redwall. Thickness of lower unit about 3–60 ft (1–18 m), averaging about 25 ft (8 m). In eastern half of map area, the Surprise Canyon consists mainly of dark-red-brown, slope-forming, massive to thin-bedded, poorly sorted siltstone and sandstone, containing localized plant fossils. The Surprise Canyon is the most fossiliferous rock unit in the Grand Canyon. Overall, thickness averages about 145 ft (45 m) in western half of map area, thinning to less than 50 ft (15 m) in eastern half' where usgs_sym='Ms';
UPDATE sources.grandcanyon SET strat_name='Redwall Limestone', unit_name='',age='Mississippian',descrip='Horseshoe Mesa Member—Light-olive-gray, ledge- and cliff-forming, thin-bedded, fine-grained limestone. Weathers to receding ledges. Gradational and disconformable contact with underlying massive-bedded limestone of Mooney Falls Member marked by thin-bedded, platy limestone beds of the Horseshoe Mesa that form recess about 3–9 ft (1–3 m) thick near top of cliff formed by the Mooney Falls. Fossils are locally common. Includes distinctive ripple-laminated limestone and oolitic limestone beds and some chert lenses. Member thickens slightly from east to west across map area; locally absent where removed by Late Mississippian paleovalley erosion. Thickness 50–100 ft (15–30 m) Mooney Falls Member—Light-gray, cliff-forming, fine- to coarse-grained, thick-bedded to very thick bedded [4–20 ft (1–6 m)], fossiliferous limestone. Limestone weathers dark gray; chert beds weather black. Includes dark-gray dolomite beds in lower part in western quarter of map area; oolitic limestone and chert beds restricted to upper part throughout map area. Contains large-scale, tabular and planar, low-angle cross-stratified limestone beds in upper third of unit in western half of map area. Disconformable contact with the underlying Thunder Springs distinguished by lithology; massive-bedded, gray limestone of the Mooney Falls overlies thin-bedded, dark-gray to brown dolomite and white chert beds of the Thunder Springs. Member thickens from about 250 ft (75 m) in southeast quarter of map area to about 400 ft (122 m) in northwest quarter Thunder Springs Member—About half of member is gray, cliff-forming, fossiliferous, thin-bedded limestone and about half is brownish-gray, cliff-forming, thin-bedded [1–5 in. (2–12 cm)], finely crystalline dolomite and fine- to coarse-grained limestone interbedded with white beds of chert lenses. Limestone is common in northern half of map area, dolomite is more common in southern half. Weathers into distinctive prominent band of black and light-brown bands on cliff face. Locally includes large-scale cross-bedding and irregularly folded beds in northern half of map area. Fossil content increases from east to west across map area. Disconformable planar contact with underlying Whitmore Wash Member distinguished by distinct lack of chert in the Whitmore Wash. Member is about 100 ft (30 m) thick in south half of map area, increasing to about 150 ft (45 m) thick in north half Whitmore Wash Member—Yellowish-gray and brownish-gray, cliff-forming, thick- bedded, fine-grained dolomite. Weathers dark gray. Fossiliferous in northwestern quarter of map area. Unit is mostly limestone in western and northern part of map area. Unconformable contact with underlying Temple Butte Formation (Dtb) marked by erosion channels of low relief about 5–10 ft (2–3 m) in depth. Contact generally recognized where major cliff of the Redwall overlies stair-step ledges of the Temple Butte. Uniform thickness throughout map area, about 80 ft (25 m)' where usgs_sym='Mr';
UPDATE sources.grandcanyon SET strat_name='Temple Butte Formation', unit_name='',age='Late Devonian and Middle Devonian',descrip='Purple, reddish-purple, dark-gray, and light-gray, ledge-forming dolomite, sandy dolomite, sandstone, mudstone, and limestone as defined by Beus (1990). Purple, reddish-purple, and light-gray, fine- to coarse-grained, thin- to medium-bedded, ripple-laminated ledges of mudstone, sandstone, dolomite, and conglomerate fill channels eroded into the underlying Cambrian strata; channels are as much as 100 ft (30 m) deep in eastern half of map area, and about 40 ft (12 m) deep in western half of map area. Channel deposits are overlain by dark-gray to olive-gray, medium- to thick-bedded dolomite, sandy dolomite, limestone, and sandstone. Unit as a whole forms sequence of dark-gray ledges. Unconformity at base of unit represents major stratigraphic break in Paleozoic rock record in the Grand Canyon, spanning part of Late Cambrian, all of Ordovician and Silurian, and most of Early and Middle Devonian time, about 100 million years. Dark-gray Devonian rocks are distinguished from underlying light-gray Cambrian rocks by color contrast. Unit thickens from about 50 ft (15 m) in eastern half of map area to as much as 275 ft (84 m) in western half of map area, excluding local channel deposit thickness' where usgs_sym='Dtb';
UPDATE sources.grandcanyon SET strat_name='Muav Limestone', unit_name='',age='Middle Cambrian',descrip='Dark-gray, light-gray, brown, and orange-red, cliff-forming limestone, dolomite, and calcareous mudstone. Includes, in descending order, unclassified dolomites, and Havasu, Gateway Canyon, Kanab Canyon, Peach Springs, Spencer Canyon, and Rampart Cave Members of McKee and Resser (1945). These members consist of fine- to medium-grained, thin- to thick-bedded, mottled, fossiliferous, silty limestone, limestone, and dolomite. Three unnamed slope-forming siltstone and shale units of Bright Angel Shale ( ba) lithology are intertongued between cliff-forming members of Muav Limestone. These unnamed siltstone and shale units are green and purplish-red, micaceous siltstone, mudstone, and shale, and thin brown sandstone. Contact with the underlying Bright Angel is gradational and lithology dependent. Contact is arbitrarily marked at base of lowest prominent cliff-forming limestone of Rampart Cave Member of the Muav in western half of map area, and of Peach Springs– Kanab Canyon Members of the Muav in eastern half of map area. All members of the Muav thicken from east to west across map area. However, the Peach Springs, Spencer Canyon, and Rampart Cave change to purple-red and green siltstone/shale facies of the Bright Angel in eastern half of map area, where they are included as part of the Bright Angel . Intertonguing and facies change relationships between the Muav and Bright Angel produce variable thickness trends. Overall, the Muav thickens from about 350 ft (107 m) in eastern part of map area to about 600 ft (183 m) in western part' where usgs_sym='Cm';
UPDATE sources.grandcanyon SET strat_name='Bright Angel Shale', unit_name='',age='Middle Cambrian',descrip='Green and purple-red, slope-forming siltstone and shale, and interbeds of red-brown to brown sandstone of Tapeats Sandstone lithology. Includes ledge-forming red-brown sandstone member of McKee and Resser (1945). Consists of green and purple-red, fine-grained, micaceous, ripple-laminated, fossiliferous siltstone and shale; dark-green, medium- to coarse-grained, thin-bedded, glauconitic sandstone; and interbedded purplish-red and brown, thin-bedded, fine- to coarse-grained, ripple-laminated sandstone. Includes gray, thin-bedded, fine-grained, micaceous silty dolomite in upper part of unit in western quarter of map area. Intertonguing and facies change relationships with the underlying Tapeats produce variable thickness trends. Contact with the Tapeats is arbitrarily marked at lithologic vertical and lateral transition from predominantly green siltstone and shale to predominantly brown sandstone in slope above the Tapeats cliff. Thickness is about 350 ft (107 m) in eastern quarter of map area, thickening to about 500 ft (150 m) in western quarter' where usgs_sym='Cba';
UPDATE sources.grandcanyon SET strat_name='Tapeats Sandstone', unit_name='',age='Early Cambrian and Middle Cambrian',descrip='Brown and red-brown, cliff-forming sandstone and conglomerate. Includes an upper slope-forming transition zone of nearly equal distribution of brown sandstone of Tapeats Sandstone lithology and green siltstone and shale of Bright Angel Shale lithology, and a lower unit of cliff-forming sandstone and conglomeratic sandstone. Lower cliff unit consists mainly of medium- to coarse-grained, thin-bedded, low-angle planar and trough cross-bedded sandstone and conglomeratic sandstone; sandstone beds 6–24 in. (15–60 cm) thick. Unconformable contact with underlying Middle and Late Proterozoic surface that forms the Great Unconformity. The Tapeats fills in lowland areas and thins across or pinches out against young Proterozoic highlands. Variable thickness 0–400 ft (0–122 m)' where usgs_sym='Ct';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Unnamed diabase sills and dikes',age='Stenian',descrip='Black, medium- to coarse-grained, olivine-rich diabase. Contains plagioclase, olivine, clinopyroxene, magnetite-ilmenite, and biotite. Diabase sills and dikes. Chemical variation diagrams indicate a potential common parentage between dikes and sills and the overlying Cardenas, but direct physical connection has not been observed, although isochron ages are basically identical at 1,070±70 Ma (Hendricks and Stevenson, 1990). Sills range in thickness from about 65 ft (20 m) in Clear Creek at eastern edge of map area to more than 655 ft (200 m) near Bass Rapids in central part of map area. Dike widths range from 3 to 12 ft (1 to 4 m)' where usgs_sym='Yi';
UPDATE sources.grandcanyon SET strat_name='Dox Formation', unit_name='',age='Mesoproterozoic',descrip='Includes, in descending order, Ochoa Point, Comanche Point, Solomon Temple, and Escalante Creek Members as defined by Stevenson and Beus (1982). Of these, only part of the Escalante Creek is exposed in map area. Upper two-thirds or more of the Dox is removed by erosion and subsequently covered by Paleozoic rocks. The Escalante Creek is exposed in upper Bright Angel Creek and Shinumo Creek, eastern quarter of map area. Escalante Creek Member—Gray, light-brown to dark-brown, cliff-forming, fine- to medium-grained sandstone and interbedded dark-brown to green, slope-forming shale and mudstone. Includes gray contorted sandstone beds in lower part similar to those in underlying Shinumo Quartzite and small-scale, tabular-planar cross-bedded and graded-bedding sets. Conformable contact with the underlying Shinumo marked at lowest shaley slope of the Dox. Incomplete exposure due to erosion of upper part. Exposed thickness about 200 ft (60 m)' where usgs_sym='Yd';
UPDATE sources.grandcanyon SET strat_name='Shinumo Quartzite', unit_name='',age='Mesoproterozoic',descrip='Red-brown, purple, and gray, cliff-forming sandstone. Includes four undivided informal members as defined by Daneker (1975). In descending order, they are upper, upper middle, lower middle, and lower sandstone members. Upper member consists of red-brown and purple, fine- to coarse-grained, well-sorted, highly contorted, gnarly bedded sandstone capped by nondisrupted, flat-bedded, gray sandstone. Upper middle member consists of rusty-red, fine- to coarse-grained, highly contorted, gnarly bedded sandstone. Lower middle member consists of purple “freckled” (reduction spots), fine-grained, well-sorted, low-angle cross-bedded sandstone with local contorted beds in upper part. Lower member consists of purplish-red, coarse-grained, flat-bedded, arkosic conglomeratic sandstone. All members cemented with silica, making sandstone as hard as metamorphic quartzite, but unit is not metamorphosed. Angular unconformity separates cliff of red-brown Shinumo Quartzite from underlying slope of red Hakatai Shale, marked at truncated beds of the Hakatai. The Shinumo increases in thickness from 1,132 ft (345 m) at eastern edge of map area to 1,540 ft (470 m) at Shinumo Creek, central part of map area' where usgs_sym='Ys';
UPDATE sources.grandcanyon SET strat_name='Hakatai Shale', unit_name='',age='Mesoproterozoic',descrip='Orange-red, purple, and red mudstone, shale, and sandstone.
Forms an upper cliff unit, a middle slope unit, and a lower slope unit. Upper cliff unit consists of pale-purple or lavender, fine- to coarse-grained, thin- to medium-bedded, cross-bedded sandstone. Forms gradational contact with underlying middle slope unit at distinct color change from purple to bright red. Middle slope unit is the most distinctive red-bed unit in the Grand Canyon, consisting of reddish-orange, thin-bedded, fine-grained mudstone, siltstone and sandy siltstone; includes nonred, spherical reduction spots (“freckles”) less than 10 cm in diameter. Gradational contact with underlying lower slope unit arbitrarily placed at red to purple color change. Lower slope unit consists of purple to reddish-purple, thin-bedded to laminated, fine-grained mudstone, siltstone, and sandy siltstone. Mudcracks, ripple marks, and tabular-planar cross-bedding are common in all units. Gradational contact with underlying Bass Formation in eastern part of map area; sharp but conformable contact in central part of map area. Overall thickness varies from about 445 ft (135 m) in eastern part of map area to nearly 985 ft (300 m) in Hakatai Canyon, central part of map area' where usgs_sym='Yh';
UPDATE sources.grandcanyon SET strat_name='Bass Formation', unit_name='',age='Mesoproterozoic',descrip='Red-brown and reddish-gray, ledge-forming dolomite, silty sandstone, and conglomerate. Includes basal Hotauta Conglomerate Member as defined by Dalton (1972). Consists of fine- to coarse-grained, thin- to medium-bedded dolomite, fine- to coarse-grained, thin-bedded sandstone, silty sandstone, conglomerate, and breccia. Dolomite is most common lithology in Shinumo Creek area (central part of map area), becoming mostly sandstone, siltstone, and conglomerate in Bright Angel Canyon and eastern part of map area. Dolomite beds contain biscuit-shaped biohermal stromatolite fossils and red chert; sandstone beds contain ripple marks, desiccation cracks, and intraformational breccia and conglomerate. The Hotauta is considered part of the Bass in most map areas because of its lensing characteristics. The Bass, including the Hotauta, gradually thickens from southeast to northwest across map area from about 260 to 300 ft (80 to 91 m). Hotauta Conglomerate Member—Red-brown and gray conglomerate of well-rounded to subangular pebbles and boulders of granite, gneiss, and schist derived from underlying Early Proterozoic igneous and metamorphic rocks. Clasts are cemented in red-brown, coarse-grained, gravelly sandstone matrix. Unconformable contact with underlying Early Proterozoic rocks called the “Greatest Angular Unconformity” (Noble, 1922), a hiatus lasting about 450 million years (Hendricks and Stevenson, 1990). Unit does not include diabase sills. Variable thickness 0–30 ft (0–10 m)' where usgs_sym='Yb';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Young granite and pegmatite',age='Calymmian',descrip='Granite plutons, stocks, dikes, and pegmatite. About 1.4 Ga (billion years old)' where usgs_sym='Xg';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Granite, granitic pegmatite, and aplite',age='Statherian',descrip='Granite plutons, stocks, and pegmatite and aplite dikes emplaced synchronously with peak metamorphism. About 1.7–1.66 Ga' where usgs_sym='Xgr';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Granodiorite complexes',age='Statherian',descrip='Gabbro-diorite-granodiorite complexes of probable volcanic
arc origin. About 1.74–1.71 Ga' where usgs_sym='Xgd';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Ultramafic rocks',age='Paleoproterozoic',descrip='Probable cumulate origin as supracrustal rocks' where usgs_sym='Xum';
UPDATE sources.grandcanyon SET strat_name='Vishnu Schist', unit_name='',age='Statherian',descrip='Quartz-mica schist, pelitic schist, and meta-arenites of metamorphosed, arc-basin, submarine sedimentary rocks. About 1.75 Ga. Locally inter-layered with Brahma (Xbr) and Rama (Xr)' where usgs_sym='Xv';
UPDATE sources.grandcanyon SET strat_name='Brahma Schist', unit_name='',age='Statherian',descrip='Consists of amphibolite, hornblende-biotite-plagioclase schist, biotite-
plagioclase schist, orthoamphibole-bearing schist and gneiss, and metamorphosed sulfide deposits. Mafic to intermediate-composition metavolcanic rocks. About 1.75 Ga. Locally interlayered with Rama Schist (Xr) and Vishnu Schist (Xv)' where usgs_sym='Xbr';
UPDATE sources.grandcanyon SET strat_name='Rama Schist', unit_name='',age='Statherian',descrip='Massive, fine-grained quartzofeldspathic schist and gneiss of probable felsic metavolcanic rocks. About 1.75 Ga. Locally interlayered with Brahma (Xbr) and Vishnu (Xv)' where usgs_sym='Xr';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Orthoamphibole-bearing gneiss',age='Paleoproterozoic',descrip='Regolith. An interval several meters thick of weathered detritus eroded from older plutonic rocks. Metamorphic monazite from pelitic schist containing garnet, kyanite, gedrite, sillimanite, and cordierite. Very small outcrops along Colorado River within Granite Gorge' where usgs_sym='Xo';
UPDATE sources.grandcanyon SET strat_name='', unit_name='Elves Chasm pluton',age='Orosirian',descrip='Oldest plutonic rocks, possible “basement” substrate. Contains mafic (hornblende-biotite tonalite) and intermediate-composition plutonic units (quartz diorite), including tabular amphibolite bodies that may be dikes. About 1.84 Ga' where usgs_sym='Xec';
update sources.grandcanyon set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.grandcanyon set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.grandcanyon set early_id=l.id,late_id=m.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pennsylvanian' and l.interval_name='Late Mississippian' and age='Late Pennsylvanian to Late Mississippian';
update sources.grandcanyon set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Devonian' and l.interval_name='Late Devonian' and age='Late Devonian and Middle Devonian';
update sources.grandcanyon set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Cambrian' and l.interval_name='Middle Cambrian' and age='Early Cambrian and Middle Cambrian';
update sources.grandcanyon set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age='Holocene and Pleistocene';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,34,unit_name,strat_name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.grandcanyon;
pg_dump -t sources.grandcanyon -C -O burwell | gzip > ~/Desktop/grandcanyon.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=34 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.grandcanyon_lines set line_type='monocline' where ltype ilike '%monocline%';
update sources.grandcanyon_lines set line_type='anticline' where ltype ilike '%anticline%';
update sources.grandcanyon_lines set line_type='syncline' where ltype ilike '%syncline%';
update sources.grandcanyon_lines set line_type='monocline' where ltype ilike '%monocline%';
update sources.grandcanyon_lines set line_type='thrust fault' where ltype ilike '%normal_reverse%';
update sources.grandcanyon_lines set line_type='normal fault' where ltype ilike '%high_angle_flt%';
update sources.grandcanyon_lines set line_type='normal' where ltype ilike '%fault_underwater%';
update sources.grandcanyon_lines set name=NULL where name='Xx';
update sources.grandcanyon_lines set name=initcap(name);

insert into lines.large (orig_id,source_id,name,type,geom) select gid,34,name,line_type,st_makevalid(geom) from sources.grandcanyon_lines;
pg_dump -t sources.grandcanyon_lines -C -O burwell | gzip > ~/Desktop/grandcanyon_lines.sql.gz


### endikai 36
update sources.endikai set name='Sudbury Dike Swarm', age='Paleoproterozoic', descrip='mafic intrusive dikes' where mapcode=14;
update sources.endikai set name='Mafic intrusive rocks', age='Paleoproterozoic', descrip='unnamed gabbroic dikes and sills' where mapcode=13;
update sources.endikai set name='Nipissing Diabase', age='Rhyacian', descrip='Mafic to Intermediate Intrusive Rocks (Nipissing dikes and sills); gabbro, medium to coarse grained', lith='gabbro, medium to coarse grained' where mapcode=12;
update sources.endikai set name='Bar River Formation', age='Paleoproterozoic', descrip='sandstone, quartz arenite, fine to medium grained, well sorted, massive bedded, occassionally rippled on bedding surfaces' where mapcode=11;
update sources.endikai set name='Gordon Lake Formation', age='Paleoproterozoic', descrip='sandstone, containing quartz and feldspar, very fine to fine grained, well sorted, pink weathering; Siltstone, well sorted, buff to red to green weathering, typically planar bedded although rarely massive or cross-bedded, occasionally rippled on bedding surfaces' where mapcode=10;
update sources.endikai set name='Lorrain Formation', age='Paleoproterozoic', descrip='Oligomictic conglomerate and sandstone, subrounded to rounded quartz pebble clasts, clast supported, moderately to thickly bedded; Polymictic conglomerate and sandstone, subrounded to rounded quartz-jasper pebble clasts, clast supported, moderately to thickly bedded; sandstone, quart arenite, medium grained, well sorted, typically massive bedded, may be planar to cross-bedded. Feldspathic sandstone, feldspathic wacke containing quartz, feldspar, medium to coarse grained.' where mapcode=9;
update sources.endikai set name='Gowganda Formation', age='Paleoproterozoic', descrip='Oligomictic conlogmerate, diamictite, pink to grey sandy matrix, subrounded to rounded granitic clasts, matrix supported, massive to thickly bedded; sandstone, feldspathic arkose, fine to medium grained, well sorted, salmon to grey weathering, massive to thickly bedded; siltstone to mudstone, commonly thinly bedded.' where mapcode=8;
update sources.endikai set name='Serpent Formation', age='Paleoproterozoic', descrip='Sandstone, quartz arenite, fine to medium grained, well sorted, massive to indistinctly bedded; well sorted to planar bedded.' where mapcode=7;
update sources.endikai set name='Espanola Formation', age='Paleoproterozoic', descrip='Calcareous siltstone, alternating grey and dark grey weathering, moderate to thickly bedded; limestone and siltstone, grey weathering, thinly interbedded.' where mapcode=6;
update sources.endikai set name='Bruce Formation', age='Paleoproterozoic', descrip='Polymictic conglomerate, medium-grained sandy matrix, poorly sorted, subangular to subrounded clasts, massive bedded.' where mapcode=5;
update sources.endikai set name='Matinenda Formation', age='Siderian', descrip='Sandstone, arkose, medium to coarse grained, poorly sorted, subangular grains, yellow-green weathering, massive to indistinctly bedded; Sandstone with quartz-pebble conglomerate beds, arkose, medium to coarse grained, poorly sorted, subangular grains, yellow-green weathering.' where mapcode=4;
update sources.endikai set name='Matachewan Dike Swarm', age='Siderian', descrip='Mafic intrusive rocks, gabbro, fine to medium grained, amphibole bearing; magnetic, palgioclase phyric in part.' where mapcode=3;
update sources.endikai set name='Ramsey-Algoma Granitoid Suite', age='Neoarchean', descrip='Felsic intrusive rocks; alkali feldspar granite, medium grained, amphibole bearing; biotite bearing; syenogranite, medium to coarse grained, amphibole bearing; granodiorite, medium to coarase grained, amphibole, biotite bearing; quartz monzonite, medium to coarse grained; grainte, medium to coarse grained, amphibole bearing, potassium feldspar phyric.' where mapcode=2;
update sources.endikai set name='Mafic Metavolcanic rocks', age='Paleoproterozoic', descrip='basalt; massive flow, fine grained to aphanitic; basalt flow, fine-grained to aphanitic groundmass, plagioclase phyric.' where mapcode=1;
update sources.endikai set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and early_id IS NULL;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,36,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.endikai;
pg_dump -t sources.endikai -C -O burwell | gzip > ~/Desktop/endikai.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=36 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,new_type,new_direction,descrip,geom) SELECT gid,36,name,new_type,new_direction,maptype,ST_MakeValid(geom) FROM sources.endikai_lines;

update sources.endikai_lines set new_direction='right-lateral' where maptype ilike '%dextral%' and new_type='strike-slip fault';
update sources.endikai_lines set maptype=NULL where maptype=new_type;
pg_dump -t sources.endikai_lines -C -O burwell | gzip > ~/Desktop/endikai_lines.sql.gz


###### denver 35

update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE denver_b_a ilike m.interval_name and early_id IS NULL;
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE denver_t_a ilike m.interval_name and late_id IS NULL;
update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE replace(denver_b_a,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE replace(denver_b_a,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE replace(denver_t_a,'Lower','Early') ilike m.interval_name and late_id IS NULL;
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE replace(denver_t_a,'Upper','Late') ilike m.interval_name and late_id IS NULL;
update sources.denver set early_id=late_id where late_id is not null and denver_b_a is null and early_id is null;
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Paleoproterozoic' and denver_t_a='Early Proterozoic';
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Mesoproterozoic' and denver_t_a='Middle Proterozoic';
update sources.denver set late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Neoproterozoic' and denver_t_a='Late Proterozoic';
update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Paleoproterozoic' and denver_b_a='Early Proterozoic';
update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Mesoproterozoic' and denver_b_a='Middle Proterozoic';
update sources.denver set early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name='Neoproterozoic' and denver_b_a='Late Proterozoic';

update sources.denver set denver_t_a='Middle Pleistocene' where denver_t_a='Middle Plesitocene';
update sources.denver set denver_b_a='Middle Pleistocene' where denver_b_a='Middle Plesitocene';
update sources.denver set denver_b_a='Late Pleistocene' where denver_b_a='Latest Pleistocene';
update sources.denver set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and denver_t_a='Holocene and Late Pleistocene';
update sources.denver set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Holocene' and denver_t_a='Latest Holocene';
update sources.denver set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleoproterozoic' and l.interval_name='Mesoproterozoic' and denver_t_a='Middle and Early Proterozoic';
update sources.denver set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Early Pleistocene' and denver_t_a='Early Pleistocence' and denver_b_a='Late Pliocene';
update sources.denver set denver_nam='water body', denver_desc=NULL where desc_='water body' and denver_nam is null;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,35,denver_nam,concat_ws('-',denver_b_a,denver_t_a),denver_des,late_id,early_id,st_makevalid(geom) FROM sources.denver;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=35 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


delete from sources.denver_lines where descriptio ilike 'contact-%';
delete from sources.denver_lines where descriptio ilike 'shoreline';
update sources.denver_lines set type='syncline' where descriptio ilike 'syncline%';
update sources.denver_lines set type='anticline' where descriptio ilike 'anticline%';
update sources.denver_lines set type='fault' where descriptio ilike 'fault%';
update sources.denver_lines set type='overturned syncline' where descriptio ilike 'overturned syncline%';
update sources.denver_lines set type='overturned anticline' where descriptio ilike 'overturned anticline%';
update sources.denver_lines set type='dike' where descriptio ilike '%dike%';
update sources.denver_lines set type='thrust fault' where descriptio ilike 'thrust%';
update sources.denver_lines set type='lava flows' where descriptio ilike 'PEdb--Potassic basalt (shoshonite) lava flows (Paleocene) of the Denver Formation';
insert into lines.large (orig_id,source_id,name,type,geom) select gid,35,descriptio,type,st_makevalid(geom) from sources.denver_lines;

## boulder 37
UPDATE sources.boulder set age='Precambrian' where age='Precambrian X';
UPDATE sources.boulder set age='Precambrian' where age='Precambrian Y';
UPDATE sources.boulder set age='Precambrian' where age='Precambrian Y Or X)';
update sources.boulder set descrip='breccia' where des='Brecciated rock' and descrip IS NULL;
update sources.boulder set late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
update sources.boulder set late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
update sources.boulder set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.boulder set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;

update sources.boulder set late_id=m.id from macrostrat.intervals m where m.interval_name='Holocene' and age ilike '%Holocene%';
update sources.boulder set late_id=m.id from macrostrat.intervals m where m.interval_name='Holocene' and age ilike '%Holocene%';
update sources.boulder set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('% And ',m.interval_name) and early_id IS NULL;
update sources.boulder set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name, ' And %') and late_id IS NULL;
update sources.boulder set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('% To ',m.interval_name) and early_id IS NULL;
update sources.boulder set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name, ' To %') and late_id IS NULL;
update sources.boulder set early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike concat('% To ',m.interval_name) and early_id IS NULL;
update sources.boulder set late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike concat(m.interval_name, ' To %') and late_id IS NULL;
update sources.boulder set late_id=m.id,early_id=m.id from macrostrat.intervals m where m.interval_name='Pleistocene' and age ilike '%Pleistocene%' and early_id is null and late_id is null;
update sources.boulder set late_id=m.id,early_id=m.id from macrostrat.intervals m where m.interval_name='Holocene' and age ilike '%Holocene%' and early_id is null and late_id=3;
update sources.boulder set late_id=m.id,early_id=m.id from macrostrat.intervals m where m.interval_name='Pliocene' and age ilike 'Pliocene?' and early_id is null and late_id is null;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,37,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.boulder;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=37 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


delete from sources.boulder_lines where name ilike '%Contact%';
insert into lines.large (orig_id,source_id,name,type,geom) select gid,37,name,'fault',st_makevalid(geom) from sources.boulder_lines;

########### marin_co  ---> 2016.12.12 changed to ca_marin_co
update sources.marin_co set name='Artificial fill',age='Quaternary',descrip='Of varying character, consisting of clay, silt, sand, rock fragments, organic material, and (or) man made debris. Distinguished on map only in southern Marin and San Francisco Counties; but present elsewhere, especially within unit Qmf.' where ptype='Qaf';
update sources.marin_co set name='Artificial fill over marine and marsh deposits',age='Quaternary',descrip='Mud similar to unit Qm overlain by artificial fill, the limits of which are not mapped. Landward boundary is historic margin of bay marshlands from Nichols and Wright (1971)' where ptype='Qmf';
update sources.marin_co set name='Beach sand',age='Quaternary',descrip='Well to moderately sorted; loose to soft' where ptype='Qs';
update sources.marin_co set name='Dune sand',age='Quaternary',descrip='Well sorted; loose to soft' where ptype='Qd';
update sources.marin_co set name='Marine and marsh deposits',age='Quaternary',descrip='Mud, including much organic material, silty mud, silt, and sand; very soft to soft where wet. Only exposed east of Tomales Bay' where ptype='Qm';
update sources.marin_co set name='Landslide deposits',age='Quaternary',descrip='Largely bedrock debris' where ptype='Qls';
update sources.marin_co set name='Slope debris and ravine fill',age='Quaternary',descrip='Angular rock fragments in sand, silt, and clay matrix; generally light yellow to reddish-brown. Only mapped in San Francisco' where ptype='Qsr';
update sources.marin_co set name='Alluvium',age='Quaternary',descrip='Sand, gravel, silt, and clay; loose to soft and friable' where ptype='Qal';
update sources.marin_co set name='Undifferentiated surficial deposits',age='Quaternary',descrip='Includes beach sand, marine deposits, artificial fill, alluvium, landslides, and, in South San Francisco quadrangle, some Colma Formation' where ptype='Qu';
update sources.marin_co set name='Volcanic gravel',age='Quaternary',descrip='Contains large angular blocks of rhyolite derived from unit Tsri; present only in northeast corner of Petaluma River quadrangle' where ptype='Qr';
update sources.marin_co set name='Older beach deposits',age='Quaternary',descrip='Predominantly well-sorted, medium- to coarse-grained, gray sand' where ptype='Qob';
update sources.marin_co set name='Older alluvium',age='Quaternary',descrip='Poorly sorted sandstone and conglomerate; poorly indurated; lens-shaped bedding irregularly present, crossbedding common; locally contains small wood fragments along San Andreas fault zone; includes thinly laminated siltstone or claystone with interbedded gravels' where ptype='Qoal';
update sources.marin_co set name='Marine and stream terrace deposits',age='Quaternary',descrip='Variably sorted and bedded sand, silt, and gravel; soft to poorly indurated. In the mapped area, this unit only crops out northwest of Stinson Beach' where ptype='Qt';
update sources.marin_co set name='Millerton Formation',age='Quaternary',descrip='Deeply weathered, poorly indurated, marine and freshwater clay, silt, gravel, and conglomerate; maximum thickness about 20 m; exposed along Tomales Bay' where ptype='Qmi';
update sources.marin_co set name='Colma Formation',age='Quaternary',descrip='Fine- to medium-grained sand with minor amounts of sandy silt, clay, and gravel as interbeds. Sand is well sorted, soft, and friable; occurs on Angel and Yerba Buena Islands and in San Francisco' where ptype='Qc';
update sources.marin_co set name='Merced Formation',age='early Quaternary and late Pliocene',descrip='Soft, buff-weathering, blue-gray siltstone with fine-grained silty sandstone in upper part; siltstone contains friable, fine-grained, clayey sandstone, some beds of shale pebble conglomerate, scattered calcareous concretions commonly containing fossils, and carbonized wood; sandstone is crossbedded and contains scattered layers of rounded pebbles and of shell fragments. Occurrence restricted to San Andreas Fault Zone' where ptype='QTm';
update sources.marin_co set name='Santa Cruz Mudstone',age='late Miocene',descrip='Thin- to thick-bedded and faintly laminated olive-gray to pale- yellowish-brown marine siliceous mudstone with thin elongate carbonate concretions' where ptype='Tsc';
update sources.marin_co set name='Monterey Shale',age='late and middle Miocene',descrip='Siliceous shale and minor chert; shale weathers white to gray or pinkish brown and is commonly laminated to thin bedded, variously micaceous, silty, porcelaneous, or cherty and locally contains calcareous concretions or sandstone or siltstone interbeds; chert is dark gray- brown and laminated, with thin shale and sandstone interbeds; fish scales, carbonaceous material, and molds of foraminifers, diatoms, and fish remains are variably present' where ptype='Tm';
update sources.marin_co set name='Wilson Grove Formation',age='Pliocene',descrip='Structureless to poorly bedded, firm sandstone, light gray where fresh, weathering grayish or pale yellowish orange; mostly fine-grained to very fine grained with moderate to good sorting; local thin pebble lenses near base, and, in western part of area, about 7 to 10 m of thick-bedded, coarse-grained to very coarse grained, locally pebbly sandstone that forms resistant outcrops' where ptype='Twg';
update sources.marin_co set name='Petaluma Formation',age='Pliocene',descrip='Siltstone and claystone member: Unbedded claystone, siltstone, and mudstone containing thick lenses of friable, cross-bedded, well-sorted sandstone and pebble conglomerate; pebbles consist of Franciscan lithologies, laminated siliceous shale and chert, and volcanic rock; unit includes a structureless vitric tuff bed about 3 to 8 m thick that consists largely of pumice lapilli and glass shards; brackish and fresh water molluscs occur locally, and vertebrate fossils of Hemphillian (early Pliocene and late Miocene) and Blancan (early Quaternary and late Pliocene) age have been found outside the map area' where ptype='Tps';
update sources.marin_co set name='Petaluma Formation',age='Pliocene',descrip='Gray claystone member—Gray claystone, unbedded to locally laminated with common thin interbeds of micritic ostracodal, or pisolitic limestone, and rare interbeds of tuffaceous mudstone. Ostracoda are abundant in some beds, fish remains are common, and thin-shelled mollusks are found locally' where ptype='Tpc';
update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Undifferentiated, includes rock near Burdell Mountain with a K-Ar age of 11.8 Ma (Mankinen, 1972).' where ptype='Tsv';
update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Rhyolite lava flows—Locally contains intercalated rhyolite tuff' where ptype='Tsr';
update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Rhyolite plugs and dikes—May in part be extrusive' where ptype='Tsri';
update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Andesite and basalt lava flows' where ptype='Tsa';
update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Andesite and basalt lava flows' where ptype='Tsa?';

update sources.marin_co set name='Sonoma Volcanics',age='Pliocene and Miocene',descrip='Pumiceous ash flow tuff—Locally partly welded, with intercalated bedded tuff' where ptype='Tst';
update sources.marin_co set name='Sandstone',age='Miocene',descrip='On Burdell Mountain: calcareous, fine-grained tuffaceous sandstone, locally containing fossiliferous medium- to coarse-grained pebbly sandstone at base. Near San Antonio Creek: calcareous, medium- and fine-grained sandstone and siltstone with locally abundant barnacle plates and molluscan fragments, and fossiliferous, very coarse-grained, pebbly sandstone' where ptype='Ts';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Sandstone and interbedded shale, with minor conglomerate; crops out in alternating sequence of largely medium-thick to very thick sandstone beds with generally minor interbedded shale and predominantly shale with interbedded thin to medium-thick sandstone beds; rock is locally severely sheared or brecciated but lacks tectonic inclusions of other rock types such as greenstone and chert which are common in unit fsr; thicker sandstone beds are medium- to coarse-grained arkosic wacke containing 2 to 25 percent detrital potassium feldspar, but commonly 2 to 5 percent, whereas thinner sandstone beds are fine grained, quartz rich wacke, and contain 0 to 2 percent detrital potassium feldspar; sandstone is light gray where fresh, weathering to buff colors, and shale is commonly dark gray; laumontite veins, calcite veins, and microscopic secondary prehnite and (or) pumpellyite are common in sandstone. Rocks of this unit typically form resistant topography. Excellent exposures occur in the quarry at Point San Pedro.' where ptype='Kfs';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Massive sandstone: Thick-bedded and massive graywacke sandstone interbedded with thin layers of fissile shale and fine-grained sandstone; some thick conglomerate lenses' where ptype='Kfss';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Thin-bedded sandstone and shale: Predominantly interbedded and laminated shale and fine-grained sandstone; beds generally 5 to 13 cm thick' where ptype='Kfsh';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Limestone and chert: Interbedded, thin-bedded gray limestone and black, red, green, and gray radiolarian chert. Beds are mostly less than 0.5 m thick. Restricted in study area to two small masses in the San Andreas Fault Zone between Olema and Bolinas. Foraminifera from this unit south of the study area indicate that the limestone formed near the equator during the Early (Barremian) and Late (Turonian) Cretaceous epochs (Wentworth and others, 1998a)' where ptype='Kfl';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Greenstone: Consists of pillow lava and less abundant tuff, breccia, and intrusive basalt, interlayered with pelagic limestone and diabase dikes.' where ptype='Kfg';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Chert: Red chert with shale interbeds. Locally altered and recrystallized, with manganese mineralization present in many outcrops. This unit crops out only in three lenses southwest of Hamilton Air Force Base' where ptype='Kfch';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Graywacke: Graywacke, shale, and some metagraywacke; sandstone contains 0 to rarely as much as 5 percent detrital potassium feldspar. Coherent graywacke masses are as large as several miles long, but distribution largely unknown, and only locally distinguished on map. In southern Marin County and parts of San Francisco, graywacke and shale are well-bedded, up to 300 m thick, and overlie chert and greenstone.' where ptype='Kfgwy';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Diabase: Finely crystalline mafic dike rock, thought to be a fragment of a sheeted dike complex (Wahrhaftig, 1984). This unit crops out only near Point Bonita' where ptype='Kfdb';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous and Jurassic',descrip='Metamorphic rocks: Variably sheared, containing blueschist minerals; chiefly metagraywacke with slight to moderated metamorphic fabric (textural zone 2 of Blake and others, 1967), but includes much metagreenstone (types II and III, metabasalt of Coleman and Lee (1963) largely distinguished as unit Jmgs), metachert, and minor amounts of metaconglomerate. Metagraywacke and minor slaty interbeds are similar to sandstone and shale of Kfs, Kfgwy, and fsr in color and bedding character, although bedding is commonly obscure. Rock is fractured and variably sheared, locally severely; tectonic inclusions, particularly of coarse-grained metamorphics and serpentinite, are common where unit is severely sheared. Severely sheared rock and metagraywacke that yields vermiculite on weathering form relatively subdued topography, whereas metagreenstone generally forms rugged mountains. Good exposures of these rocks occur in roadcuts along northeast side of Stafford Lake (west of Novato in the northeast corner of the San Geronimo quadrangle)' where ptype='KJfm';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous and Jurassic',descrip='Chert: Chert with shale interbeds. Chert is thin bedded, closely fractured, and parts along bedding planes; contains tests of radiolaria that range in age from early Jurassic (Tithonian) to Middle Cretaceous (Cenomanian) age (Murchey, 1984); crops out as irregularly shaped bodies as long as 4.5 km. In southern Marin County and parts of San Francisco, chert up to 100 m thick overlies pillow lava and is overlain conformably by a few feet of fine-grained, black shale that grades into overlying graywacke and shale.' where ptype='KJfch';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous and Jurassic',descrip='Greenstone and chert' where ptype='KJfgc';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Greenstone: Consists of pillow lava and less abundant tuff, breccia, and intrusive basalt, diabase, and rare gabbro. Local lenses of thin-bedded radiolarian chert are as thick as 30 m. Fresh rock is hard, relatively unsheared, and ranges from essentially structureless to strongly pillowed; deeply weathered in places; crops out in elongate masses as long as 14 km, which, with one exception, are aligned in a northwest-trending band 5 kilometers east of the San Andreas Fault Zone' where ptype='Jfg';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Metagreenstone: Ranges from greenstone with patchy occurrence of blue amphiboles to schistose rock containing well developed glaucophane and lawsonite (type II to type III metabasalt of Coleman and Lee, 1963); occurs in unit KJfm largely as the former, and in unit fsr largely as the latter in discrete masses as long as 1 mile.' where ptype='Jfmgs';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Metachert: Fine-grained banded chert with bands or layers defined by bluish colors indicating the presence of blue amphibole; occurs as small discrete masses in fsr and as small unmapped lenses' where ptype='Jfmch';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Metagreenstone and metachert: chert and greenstone interbedded' where ptype='Jfmgc';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Greenstone: Similar to unit Jfg, except crops out as small, discrete masses as long as 1.5 km. In southern Marin County and parts of San Francisco, crops out as well-bedded pillow lavas and minor intrusive diabase that forms lowest exposed portion of section; overlain by chert and graywacke and repeated several times by faulting (Wahrhaftig, 1984); smaller masses are hard and relatively unfractured, but larger masses typically are closely fractured or sheared, are softened by weathering, and bear distinctive red soil.' where ptype='Jfgs';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Metamorphic rocks: Chiefly gneissic, including glaucophane-garnet schist, eclogite, and garnet amphibolite (type IV metabasalt of Coleman and Lee, 1963). Shown to scale where possible.' where ptype='Jfmg';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Massive serpentinite: Hard, massive serpentine. Includes some partly serpentinized peridotite. This unit is mapped only in San Francisco' where ptype='Jspm';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Serpentinite: Including relatively fresh ultramafic rock; crops out as lenses and irregularly shaped masses, largely within and along boundaries of fsr; most serpentinite displays a prominent shear fabric' where ptype='sp';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Silica-carbonate rock: Hard, tough rock that crops out mostly along margins of serpentinite scbodies and as small discrete masses in severely sheared mélange locally contains minor cinnabar. Some parts of the rock may be Tertiary in age.' where ptype='sc';
update sources.marin_co set name='Franciscan Complex',age='Jurassic',descrip='Mélange: A tectonic mixture of variably sheared shale and sandstone containing (1) hard tectonic inclusions largely of greenstone, chert, graywacke, and their metamorphosed equivalents, plus exotic high-grade metamorphic rocks and serpentinite and (2) variably resistant masses of graywacke, greenstone, and serpentinite up to several miles in longest dimension, and including minor discrete masses of limestone too small to be shown. Blocks and resistant masses have survived the extensive shearing evident in the mélanges matrix, and range in abundance from less than 1 to 50 percent or more of the rock mass. The degree of shearing in the unit ranges from gouge to unsheared rock, with resistant masses relatively unsheared and matrix sheared. Severely sheared shale is abundant in areas where blocks are abundant. Fresh, relatively unsheared rock is hard, the larger resistant masses are pervasively fractured, and blocks are commonly tough and relatively unfractured. Sandstone is graywacke, grayish green where fresh, weathering to brown, commonly medium to coarse grained, containing abundant angular lithic grains and no detrital potassium feldspar, except rarely as much as 5 percent. Graywacke is locally veined with quartz and carbonate, and usually contains microscopic secondary pumpellyite. Topography of coherent masses resembles that of unit Kfs, whereas highly sheared matrix typically yields subdued, gently-rounded topography. Good exposures of both sheared matrix and relatively unsheared graywacke and shale occur at the crushed rock quarry just east of the intersection of State Highway 17 and U.S. Highway 101, in Greenbrae (Novato quadrangle)' where ptype='fsr';
update sources.marin_co set name='Great Valley Complex',age='Cretaceous and Jurassic',descrip='Undivided Great Valley complex shale, sandstone, and conglomerate: Interbedded shale, sandstone, and pebble conglomerate; crops out on Burdell Mountain and along San Antonio Road north of Burdell Mountain. Sandstone associated with Buchias and other fossils at these two localities contains more than 10 percent detrital potassium feldspar' where ptype='KJgv';

update sources.marin_co set name='Great Valley Complex: Novato Conglomerate',age='Cretaceous',descrip='Pebble to boulder conglomerate with abundant rhyolite clasts and less abundant dark chert and granitic clasts. Minor coarse sandstone lenses and interbeds contain more than 10 percent detrital potassium feldspar. The unit contains thin, vesicular basalt in outcrop east of Novato along Atherton Avenue, which joins State Highway 37 about 2.5 miles east of Highway 101 (Novato quadrangle). Sandstone with Buchias along Atherton Avenue contains 0 percent detrital potassium feldspar' where ptype='Kgvn';
update sources.marin_co set name='Great Valley Complex',age='Cretaceous and Jurassic',descrip='Sandstone and claystone: Sandstone and interbedded gray claystone, with rare thin sandstone beds and calcareous nodules, and dark gray, laminated, platy siltstone.' where ptype='KJgvs';
update sources.marin_co set name='Franciscan Complex',age='Cretaceous',descrip='Sandstone and interbedded shale' where ptype='fs?';
update sources.marin_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update sources.marin_co set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('% And ',m.interval_name) and early_id IS NULL;
update sources.marin_co set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name,' And %') and late_id IS NULL;
delete from sources.marin_co where ptype is null;
update sources.marin_co set name='water' where ptype='water' and name is null;
update sources.marin_co set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Late Miocene' and e.interval_name='Middle Miocene' and age ilike 'late and middle Miocene';
update sources.marin_co set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Pleistocene' and e.interval_name='Late Pliocene' and age ilike 'early Quaternary and late Pliocene';

pg_dump -t sources.marin_co -C -O burwell | gzip > ~/Desktop/marin_co.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,38,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.marin_co;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=38 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,new_type,descrip,geom) SELECT gid,38,new_type,ltype,ST_MakeValid(geom) FROM sources.marin_co_lines;
pg_dump -t sources.marin_co_lines -C -O burwell | gzip > ~/Desktop/marin_co_lines.sql.gz


#fix water
insert into marinc_co (gid,geom,name) select gid,geom,'water' from sources.ca_marin;

######## 39 santacruz
update sources.santacruz set name='Colluvium', age='Holocene',descrip='Unconsolidated, heterogeneous deposits of moderately to poorly sorted silt, sand, and gravel. Deposited by slope wash and mass movement. Minor fluvial reworking. Locally includes numerous landslide deposits and small alluvial fans. Contacts generally gradational. Locally grades into fluvial deposits. Generally more than 5 ft thick' where ptype='Qtl';
update sources.santacruz set name='Alluvial deposits, undifferentiated', age='Holocene',descrip='Unconsolidated, heterogeneous, moderately sorted silt and sand containing discontinuous lenses of clay and silty clay. Locally includes large amounts of gravel. May include deposits equivalent to both younger (Qyf) and older (Qof) flood-plain deposits in areas where these were not differentiated. Thickness highly variable; may be more than 100 ft thick near coast' where ptype='Qal';
update sources.santacruz set name='Basin deposits', age='Holocene',descrip='Unconsolidated, plastic, silty clay and clay rich in organic material. Locally contain interbedded thin layers of silt and silty sand. Deposited in a variety of environments including estuaries, lagoons, marsh-filled sloughs, flood basins, and lakes. Thickness highly variable; may be as much as 90 ft thick underlying some sloughs' where ptype='Qb';
update sources.santacruz set name='Beach sand', age='Holocene',descrip='Unconsolidated well-sorted sand. Local layers of pebbles and cobbles. Thin discontinuous lenses of silt relatively common in back-beach areas. Thickness variable, in part due to seasonal changes in wave energy; commonly less than 20 ft thick. May interfinger with either well-sorted dune sand or, where adjacent to coastal cliff, poorly-sorted colluvial deposits. Iron-and magnesium-rich heavy minerals locally from placers as much as 2 ft thick' where ptype='Qbs';
update sources.santacruz set name='Terrace deposits, undifferentiated', age='Pleistocene',descrip='Weakly consolidated to semiconsolidated heterogeneous deposits of moderately to poorly sorted silt, silty clay, sand, and gravel. Mostly deposited in a fluvial environment. Thickness highly variable; locally as much as 60 ft thick. Some of the deposits are relatively well indurated in upper 10 ft of weathered zone' where ptype='Qt';
update sources.santacruz set name='Eolian deposits of Sunset Beach', age='Pleistocene',descrip='Weakly consolidated, well-sorted, fine- to medium-grained sand. Forms an extensive coastal dune field. Thickness ranges from 5 to 80 ft' where ptype='Qes';
update sources.santacruz set name='Lowest emergent coastal terrace deposits', age='Pleistocene',descrip='Semiconsolidated, generally well-sorted sand with a few thin, relatively continuous layers of gravel. Deposited in nearshore high-energy marine environment. Grades upward into eolian deposits of Manresa Beach in southern part of county. Thickness variable; maximum approximately 40 ft. Unit thins to north where it ranges from 5 to 20 ft thick. Weathered zone ranges from 5 to 20 ft thick. As mapped, locally includes many small areas of fluvial and colluvial silt, sand, and gravel, especially at or near old wave-cut cliffs' where ptype='Qcl';
update sources.santacruz set name='Coastal terrace deposits, undifferentiated', age='Pleistocene',descrip='Semiconsolidated, moderately well sorted marine sand with thin, discontinuous gravel-rich layers. May be overlain by poorly sorted fluvial and colluvial silt, sand, and gravel. Thickness variable; generally less than 20 ft thick. May be relatively well indurated in upper part of weathered zone' where ptype='Qcu';
update sources.santacruz set name='Younger flood-plain deposits', age='Holocene',descrip='Unconsolidated, fine-grained, heterogeneous deposits of sand and silt, commonly containing relatively thin, discontinuous layers of clay. Gravel content increases toward the Santa Cruz Mountains and is locally abundant within channel and lower point-bar deposits in natural levees and channels of meandering streams. Thickness generally less than 20 ft' where ptype='Qyf';
update sources.santacruz set name='Older flood-plain deposits', age='Holocene',descrip='Unconsolidated, fine-grained sand, silt, and clay. More than 200 ft thick beneath parts of the Pajaro and San Lorenzo River flood plain. Lower parts of these thick fluvial aggradational deposits include large amounts of gravel, and serve a major ground-water aquifer beneath Pajaro Valley' where ptype='Qof';
update sources.santacruz set name='Alluvial fan deposits', age='Holocene',descrip='Unconsolidated, moderately to poorly sorted sand, silt, and gravel, with layers of silty clay. Generally coarsest nearest the mountain front. Thickness uncertain, but may locally be greater than 50 ft' where ptype='Qyfo';
update sources.santacruz set name='Dune sand', age='Holocene',descrip='Unconsolidated, well-sorted, fine- to medium-grained sand. Deposited as linear strip of coastal dunes. May be as much as 80 ft thick' where ptype='Qds';
update sources.santacruz set name='Abandoned channel fill deposits', age='Holocene',descrip='Unconsolidated, plastic, poorly sorted clay, silty clay, and silt. Deposited within channels on younger and older flood-plain deposits. Thickness generally less than 10 ft' where ptype='Qcf';
update sources.santacruz set name='Eolian deposits of Manresa Beach', age='Pleistocene',descrip='Weakly to moderately consolidated, moderately well sorted silt and sand. Deposited in extensive coastal dune field. Overlies fluvial terrace deposits (Qwf ). Locally grades conformably into underlying coastal terrace deposits (Qcu). Upper 10 to 20 ft is partially indurated owing to clay and iron oxide cementation in weathered zone. Moderate permeability and porosity except in soil zones, where generally low' where ptype='Qem';
update sources.santacruz set name='Fluvial facies', age='Pleistocene',descrip='Semiconsolidated, moderately to poorly sorted silt, sand, silty clay, and gravel. May be more than 200 ft thick. Gravel, approximately 50 ft thick, is generally present 50 ft below surface of deposit and is both a local aquifer and significant source of gravel. Upper 5 to 15 ft of unit is moderately indurated owing to clay and iron oxide cementation in weathered zone' where ptype='Qwf';
update sources.santacruz set name='Alluvial fan facies', age='Pleistocene',descrip='Semiconsolidated, moderately to poorly sorted,discontinuous layers of silty clay, silt, sand, and gravel. Deposited by streams, sheet flow, and debris flow on alluvial fans adjacent to Santa Cruz Mountains. Thickness variable; locally may be more than 50 ft thick' where ptype='Qof';
update sources.santacruz set name='Eolian facies', age='Pleistocene',descrip='Semiconsolidated, moderately well sorted eolian sand. Deposited conformably on top of coastal terrace deposits; undifferentiated, in western part of county. Thickness as much as 40 ft' where ptype='Qce';
update sources.santacruz set name='Aromas Sand, undivided', age='Pleistocene',descrip='Heterogeneous sequence of mainly eolian and fluvial sand, silt, clay, and gravel. Several angular unconformities present in unit, with older deposits more complexly jointed, folded, and faulted than younger deposits. Total thickness may be more than 800 ft.' where ptype='Qar';
update sources.santacruz set name='Aromas Sand: Eolian lithofacies', age='Pleistocene',descrip='Moderately well sorted eolian sand. Highly variable degree of consolidation owing to differential weathering. May be as much as 200 ft thick without intervening fluvial deposits. Several sequences may be present, separated by paleosols. Upper 10 to 20 ft of each dune sequence is oxidized and relatively indurated, with all primary structures destroyed by weathering. Lower part of each dune sequence below weathering zone may be essentially unconsolidated' where ptype='Qae';
update sources.santacruz set name='Aromas Sand: Fluvial lithofacies', age='Pleistocene',descrip='Semiconsolidated, heterogeneous, moderately to poorly sorted silty, clay, silt, sand, and gravel. Deposited by meandering and braided streams. Includes beds of relatively well sorted gravel ranging from 10 to 20 ft thick. Clay and silty clay layers, locally as much as 2 ft thick, occur in unit. Locally includes buried soils, high in expansive clays, as much as 14 ft thick' where ptype='Qaf';
update sources.santacruz set name='Continental deposits, undifferentiated', age='Pleistocene and Pliocene?',descrip='Semiconsolidated, fine-grained, oxidized sand and silt. Generally underlie fluvial lithofacies of Aromas Sand (Qaf). May represent highly weathered eolian deposits formed on Purisima Formation. Thickness approximately 300 ft' where ptype='QTc';
update sources.santacruz set name='Purisima Formation', age='Pliocene and late Miocene',descrip='Very thick bedded yellowish-gray tuffaceous and diatomaceous siltstone containing thick interbeds of bluish-gray, semifriable, fine-grained andesitic sandstone. As shown, includes Santa Cruz Mudstone east of Scotts Valley and north of Santa Cruz. Thickness approximately 3,000 ft in the Corralitos Canyon area' where ptype='Tp';
update sources.santacruz set name='Purisima Formation: massive sandstone', age='Pliocene and late Miocene',descrip='massive sandstone' where ptype='Tps';
update sources.santacruz set name='Santa Cruz Mudstone', age='late Miocene',descrip='Medium-to thick-bedded and faintly laminated, blocky-weathering, pale-yellowish-brown siliceous organic mudstone. As shown, includes Santa Margarita Sandstone along Glenwood syncline. Thickness at least 8,900 ft in the Texas Company Poletti well near Waddell Creek (Clark, 1981, p. 31)' where ptype='Tsc';
update sources.santacruz set name='Santa Margarita Sandstone', age='late Miocene',descrip='Very thick bedded to massive thickly crossbedded yellowish-gray to white friable granular medium-to fine-grained arkosic sandstone; locally calcareous and locally bituminous. Thickness 430 ft along Scotts Valley syncline (Clark, 1981, p. 25)' where ptype='Tsm';
update sources.santacruz set name='Monterey Formation', age='middle Miocene', descrip='Medium-to thick-bedded and laminated olive-gray to light-gray semisiliceous organic mudstone and sandy siltstone. Includes a few thick dolomite interbeds. Thickness about 2,675 ft on north limb of Scotts Valley syncline (Clark, 1981, p. 21)' where ptype='Tm';
update sources.santacruz set name='Lompico Sandstone', age='middle Miocene',descrip='Thick-bedded to massive yellowish-gray, medium- to fine-grained calcareous arkosic sandstone; locally friable. Maximum thickness 720 ft along Majors Creek (Clark, 1981, p. 18)' where ptype='Tlo';
update sources.santacruz set name='Lambert Shale', age='middle Miocene',descrip='Thin- to medium-bedded and faintly laminated olive-gray to dusky-yellowish-brown organic mudstone containing phosphatic laminae and lenses in lower part. Thickness about 1,500 ft along Mountain Charlie Gulch (Clark, 1981, p. 16)' where ptype='Tla';
update sources.santacruz set name='Vaqueros Sandstone', age='lower Miocene and Oligocene',descrip='Thick-bedded to massive yellowish-gray arkosic sandstone containing interbeds of olive-gray shale and mudstone. Thickness 4,500 ft along Bear Creek (Burchfiel, 1958)' where ptype='Tvq';
update sources.santacruz set name='Basalt', age='early Miocene',descrip='Spheroidal-weathering pillow basalt flows. Thickness as much as 200 ft along Zayante Road (Clark, 1981, p. 15)' where ptype='Tbs';
update sources.santacruz set name='Zayante Sandstone', age='Oligocene',descrip='Thick- to very thick-bedded, yellowish-orange arkosic sandstone containing thin interbeds of greenish and reddish siltstone and lenses and thick interbeds of pebble and cobble conglomerate. Thickness 1,800 ft along Lompico Creek (Clark, 1981, p. 14)' where ptype='Tz';
update sources.santacruz set name='San Lorenzo Formation', age='Oligocene and Eocene',descrip='mudstone and shale' where ptype='Tsl';
update sources.santacruz set name='San Lorenzo Formation: Rices Mudstone Member', age='Oligocene and Eocene',descrip='Olive-gray mudstone and
massive medium light-gray, very fine- to fine-grained arkosic sandstone; thick bed of glauconitic sandstone at base. Thickness 1,700 ft along Bear Creek (Brabb, 1964, p. 675)' where ptype='Tsr';
update sources.santacruz set name='San Lorenzo Formation: Twobar Shale Member', age='Eocene',descrip='Very thin bedded and laminated olive-gray shale. Thickness 790 ft along Kings Creek (Brabb, 1964, p. 671).' where ptype='Tst';
update sources.santacruz set name='Butano Sandstone: Upper sandstone member', age='Eocene',descrip='Thin-bedded to very thick-bedded medium-gray, fine-to medium-grained arkosic sandstone containing thin interbeds of medium-gray siltstone. Thickness about 3,200 ft (Clark, 1981, p. 8)' where ptype='Tbu';
update sources.santacruz set name='Butano Sandstone: Middle siltstone member', age='Eocene',descrip='Thin- to medium-bedded, nodular, olive-gray pyritic siltstone. Thickness about 700 ft (Clark, 1981, p. 8)' where ptype='Tbm';
update sources.santacruz set name='Butano Sandstone: Lower sandstone member', age='Eocene',descrip='Very thick-bedded to massive, yellowish-gray, granular, medium- to coarse-grained arkosic sandstone. Thickness as much as 5,000 ft (Clark, 1981, p. 11)' where ptype='Tbl';
update sources.santacruz set name='Butano Sandstone: Conglomerate', age='Eocene',descrip='Thick to very thick interbeds of sandy pebble conglomerate in lower part of lower sandstone member' where ptype='Tblc';
update sources.santacruz set name='Locatelli Formation', age='Paleocene',descrip='Nodular, olive-gray to pale yellowish-brown micaceous siltstone. Thickness 800-900 ft (Clark, 1981, p. 7)' where ptype='Tl';
update sources.santacruz set name='Locatelli Formation: Sandstone', age='Paleocene',descrip='Massive medium-gray, fine-to medium-grained arkosic sandstone locally at base. Maximum thickness 80 ft ;Clark, 1981, p. 7)' where ptype='Tlss';
update sources.santacruz set name='Siltstone and sandstone', age='Pliocene and upper Miocene',descrip='Very thick-bedded siltstone, sandstone, and minor conglomerate. Referred to the Etchegoin Formation by Dibblee and Brabb (1978) and to the Purisima Formation by Allen (1946), who indicated that it is nearly 10,000 ft thick. Only about 1,000 ft is exposed in Santa Cruz County' where ptype='Ts';
update sources.santacruz set name='Shale of Mount Pajaro area', age='Miocene and Oligocene',descrip='Medium- to thick-bedded, laminated, olive-gray to brownish-black semisiliceous shale, mudstone, and less abundant medium-bedded, very pale orange sandstone, tuffaceous sandstone, limestone, and conglomerate. Minimum thickness 4,300 ft (Osbun, 1975, p. 1 75)' where ptype='Tmp';
update sources.santacruz set name='Sandstone of Mount Madonna area', age='Eocene?',descrip='Mostly massive very pale-orange arkosic sandstone containing lesser amounts of brownish-black siliceous shale and mudstone. Thickness 1,300-2,250 ft (Simon), 1974, p. 45)' where ptype='Tmm';
update sources.santacruz set name='Mudstone of Maymens Flat area', age='Eocene and Paleocene',descrip='Massive dusky yellow-green and moderate red mudstone containing abundant planktonic foraminifers. In places, mudstone is glauconitic and sandy. Thickness 200-960 ft (Simoni), 1974, p. 36)' where ptype='Tms';
update sources.santacruz set name='Shale and sandstone of Nibbs Knob area', age='Late Cretaceous',descrip='Medium- to thin-bedded and rhythmically interbedded, olive-black shale and olive-gray sandstone (graywacke). Minor thin conglomerate lenses. Thickness 1,100-1,900 ft (Simoni, 1974, p. 31)' where ptype='Kgs';
update sources.santacruz set name='Conglomerate', age='Late Cretaceous',descrip='Consists predominately of well-rounded pebbles and cobbles of porphyritic volcanic rocks. Thickness 150-1,120 ft (Simoni, 1974, p. 25)' where ptype='Kcg';
update sources.santacruz set name='Quartz diorite', age='Cretaceous',descrip='Grades to granodiorite south and east of Ben Lomond Mountain' where ptype='qd';
update sources.santacruz set name='Granite and adamellite', age='Cretaceous',descrip='' where ptype='ga';
update sources.santacruz set name='Gneissic granodiorite', age='Cretaceous',descrip='' where ptype='gd';
update sources.santacruz set name='Hornblende-cummingtonite gabbro', age='Cretaceous',descrip='' where ptype='hcg';
update sources.santacruz set name='Metasedimentary rocks', age='Mesozoic or Paleozoic',descrip='Mainly pelitic schist and quartzite' where ptype='sch';
update sources.santacruz set name='Marble', age='Mesozoic or Paleozoic',descrip='Locally contains interbedded schist and calc-silicate rocks' where ptype='m';
update sources.santacruz set name='Diabase', age='',descrip='Age and stratigraphic relations unknown. Diagbase is structurally within sediments of Mount Pajaro area' where ptype='db';
update sources.santacruz set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update sources.santacruz set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('% and ',m.interval_name) and early_id IS NULL;
update sources.santacruz set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name,' and %') and late_id IS NULL;
update sources.santacruz set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Pleistocene' and e.interval_name='Pliocene' and age ilike 'Pleistocene and Pliocene?';
update sources.santacruz set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Pliocene' and e.interval_name='Late Miocene' and age ilike 'Pliocene and upper Miocene';
update sources.santacruz set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Eocene' and e.interval_name='Eocene' and age ilike 'Eocene?';
update sources.santacruz set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Mesozoic' and e.interval_name='Paleozoic' and age ilike 'Mesozoic or Paleozoic';
update sources.santacruz set name='water' where ptype='H2O';

pg_dump -t sources.santacruz -C -O burwell | gzip > ~/Desktop/santacruz.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,39,name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.santacruz;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=39 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,descrip,geom) SELECT gid,39,ltype,new_type,ST_MakeValid(geom) FROM sources.santacruz_lines;
pg_dump -t sources.santacruz_lines -C -O burwell | gzip > ~/Desktop/santacruz_lines.sql.gz



## 40 mt_trumbull
## see update.sql file for unit descriptions
update sources.mt_trumbull set age='Lower Permian' where age like 'Lower Permain';
update sources.mt_trumbull set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
update sources.mt_trumbull set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Middle Cambrian' and e.interval_name='Early Cambrian' and age ilike 'Middle and Lower(?) Cambrian';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Middle Triassic' and e.interval_name='Early Triassic' and age ilike 'Middle(?) and Lower Triassic';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Paleoproterozoic' and e.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Holocene' and e.interval_name='Pleistocene' and age ilike 'Holocene(?) and Pleistocene';
update sources.mt_trumbull set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('% and ',m.interval_name) and early_id IS NULL;
update sources.mt_trumbull set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name,' and %') and late_id IS NULL;
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Late Devonian' and e.interval_name='Middle Devonian' and age ilike 'Upper and Middle Devonian';

update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Pleistocene' and e.interval_name='Pliocene' and age ilike 'Pleistocene or Pliocene(?)';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Mississippian' and e.interval_name='Mississippian' and age ilike 'Upper and Lower Mississippian';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Pliocene' and e.interval_name='Paleocene' and age ilike 'Pliocene to lower Paleocene(?)';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Middle Miocene' and e.interval_name='Early Miocene' and age ilike 'Early to Middle Miocene';
update sources.mt_trumbull set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Mississippian' and e.interval_name='Late Pennsylvanian' and age ilike 'Upper Penn to Upper Mississippian';

pg_dump -t sources.mt_trumbull -C -O burwell | gzip > ~/Desktop/mt_trumbull.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,40,unit100k,strat_name,age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.mt_trumbull;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=40 and large.descrip IS NOT NULL and name ilike '%basalt%' and large.descrip ~* concat('\y',liths.lith,'\y') and liths.lith_class ilike 'igneous';
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=40 and large.descrip IS NOT NULL and name ilike '%dike%' and large.descrip ~* concat('\y',liths.lith,'\y') and liths.lith_class ilike 'igneous';

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=40 and large.descrip IS NOT NULL and name not ilike '%basalt%' and name not ilike '%dike%' and large.descrip ~* concat('\y',liths.lith,'\y') and liths.lith_class ilike 'sedimentary';

update sources.mt_trumbull_lines set flt_nm = NULL where flt_nm like 'xx';
update sources.mt_trumbull_lines set flt_nm=initcap(flt_nm) where flt_nm is not null;
update sources.mt_trumbull_lines set line_type='normal fault' where ltype100k like 'fault_normal%';
update sources.mt_trumbull_lines set line_type='anticline' where ltype100k like 'anticline%';
update sources.mt_trumbull_lines set line_type='monocline' where ltype100k like 'monocline%';
update sources.mt_trumbull_lines set line_type='syncline' where ltype100k like 'syncline%';
insert into lines.large (orig_id,source_id,name,type,geom) SELECT gid,40,flt_nm,line_type,st_makevalid(geom) from sources.mt_trumbull_lines;
pg_dump -t sources.mt_trumbull_lines -C -O burwell | gzip > ~/Desktop/mt_trumbull_lines.sql.gz

## so_africa 41
update sources.so_africa set descriptio=replace(descriptio, 'Quarzite', ' Quartzite');
update sources.so_africa set new_age='Carboniferous',new_age2='Jurassic' where uq_sacs_no=9;
update sources.so_africa set new_age='Kheisian',new_age2='Kheisian' where uq_sacs_no=6;
update sources.so_africa set new_age='Swazian',new_age2='Swazian' where uq_sacs_no=14;
update sources.so_africa set new_age='Swazian',new_age2='Swazian' where uq_sacs_no=14;
update sources.so_africa set new_age='Ordovician',new_age2='Devonian' where uq_sacs_no=71;
update sources.so_africa set new_age='Devonian',new_age2='Carboniferous' where uq_sacs_no=73;
update sources.so_africa set new_age=m.chrono_name from st_lithmar2012 m where m.code=uq_sacs_no and new_age is null;

update sources.so_africa set new_age='Swazian',new_age2='Swazian' where uq_sacs_no=14;
update sources.so_africa set early_id=m.id FROM macrostrat.intervals m WHERE new_age ilike m.interval_name;
update sources.so_africa set late_id=m.id FROM macrostrat.intervals m WHERE new_age2 ilike m.interval_name;
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Neoarchean' and e.interval_name='Mesoarchean' and new_age ilike 'RANDIAN';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Neoproterozoic' and e.interval_name='Neoproterozoic' and new_age ilike 'NAMIBIAN';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Rhyacian' and e.interval_name='Siderian' and new_age ilike 'VAALIAN';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Proterozoic' and e.interval_name='Proterozoic' and new_age ilike 'MOKOLIAN';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Archean' and e.interval_name='Archean' and new_age ilike 'SWAZIAN';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Grenville' and e.interval_name='Grenville' and new_age ilike 'Namaquan';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Statherian' and e.interval_name='Orosirian' and new_age ilike 'Kheisian';
update sources.so_africa set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Mesoproterozoic' and e.interval_name='Mesoproterozoic' and new_age ilike 'Namaquan';
update sources.so_africa set new_age='Vaalian',new_age2='Vaalian' where uq_sacs_no=301;
update sources.so_africa set new_age='Precambrian',new_age2='Precambrian' where uq_sacs_no=49;
update sources.so_africa set early_id=m.id FROM macrostrat.intervals m WHERE new_age ilike m.interval_name and early_id is null;
update sources.so_africa set late_id=m.id FROM macrostrat.intervals m WHERE new_age2 ilike m.interval_name and late_id is null;

update sources.so_africa set lithstrat=initcap(lithstrat) where lithstrat is not null;
update sources.so_africa set parent1=initcap(parent1) where parent1 is not null;
update sources.so_africa set new_age=initcap(new_age) where new_age is not null;
update sources.so_africa set new_age2=initcap(new_age2) where new_age2 is not null;
update sources.so_africa set lithrank=initcap(lithrank) where lithrank is not null;
update sources.so_africa set rank1=initcap(rank1) where rank1 is not null;
update sources.so_africa set parent2=initcap(parent2) where parent2 is not null;
update sources.so_africa set rank2=initcap(rank2) where rank2 is not null;
update sources.so_africa set rank3=initcap(rank3) where rank3 is not null;
update sources.so_africa set parent3=initcap(parent3) where parent3 is not null;
update sources.so_africa set parent1=NULL where parent1 like '*';
update sources.so_africa set rank1=NULL where rank1 like '*';
update sources.so_africa set parent2=NULL where parent2 like '*';
update sources.so_africa set rank2=NULL where rank2 like '*';
update sources.so_africa set parent3=NULL where parent3 like '*';
update sources.so_africa set rank3=NULL where rank3 like '*';

update sources.so_africa set age=new_age where new_age=new_age2;
update sources.so_africa set age=concat_ws(' - ',new_age,new_age2) where age is null and new_age is not null;
update sources.so_africa set early_id=NULL, late_id=NULL,age=NULL where descriptio ilike 'water';

update sources.so_africa set lithrank='Suite' where lithrank='Sui';
update sources.so_africa set lithrank='Subsuite' where lithrank='Sbsui';
update sources.so_africa set lithrank='Complex' where lithrank='Cplx';
update sources.so_africa set lithrank='Batholith' where lithrank='Bath';
update sources.so_africa set lithrank='Pluton' where lithrank='Plut';
update sources.so_africa set lithrank='Member' where lithrank='Memb';
update sources.so_africa set lithrank='Subgroup' where lithrank='Sbgrp';
update sources.so_africa set lithrank='Supergroup' where lithrank='Spgrp';
update sources.so_africa set lithrank='Group' where lithrank='Grp';
update sources.so_africa set lithrank='Formation' where lithrank='Fm';


update sources.so_africa set rank1='Suite' where rank1='Sui';
update sources.so_africa set rank1='Subsuite' where rank1='Sbsui';
update sources.so_africa set rank1='Complex' where rank1='Cplx';
update sources.so_africa set rank1='Batholith' where rank1='Bath';
update sources.so_africa set rank1='Pluton' where rank1='Plut';
update sources.so_africa set rank1='Member' where rank1='Memb';
update sources.so_africa set rank1='Subgroup' where rank1='Sbgrp';
update sources.so_africa set rank1='Supergroup' where rank1='Spgrp';
update sources.so_africa set rank1='Group' where rank1='Grp';


update sources.so_africa set rank2='Suite' where rank2='Sui';
update sources.so_africa set rank2='Subsuite' where rank2='Sbsui';
update sources.so_africa set rank2='Complex' where rank2='Cplx';
update sources.so_africa set rank2='Batholith' where rank2='Bath';
update sources.so_africa set rank2='Pluton' where rank2='Plut';
update sources.so_africa set rank2='Member' where rank2='Memb';
update sources.so_africa set rank2='Subgroup' where rank2='Sbgrp';
update sources.so_africa set rank2='Supergroup' where rank2='Spgrp';
update sources.so_africa set rank2='Group' where rank2='Grp';
update sources.so_africa set lithrank=NULL where lithrank ilike 'none';


update sources.so_africa set strat_name=concat_ws(' ', lithstrat,lithrank);
update sources.so_africa set strat_name=concat_ws(' of ', concat_ws(' ', lithstrat,lithrank),concat_ws(' ', parent1,rank1)) where lithrank like 'Member';
update sources.so_africa set combined_name=concat_ws(' of ',strat_name, concat_ws(' ',parent1,rank1), concat_ws(' ',parent2,rank2), concat_ws(' ',parent3,rank3)) where parent3 is not null;
update sources.so_africa set combined_name=concat_ws(' of ',strat_name, concat_ws(' ',parent1,rank1), concat_ws(' ',parent2,rank2)) where parent2 is not null and combined_name is null;
update sources.so_africa set combined_name=concat_ws(' of ',strat_name, concat_ws(' ',parent1,rank1)) where parent1 is not null and combined_name is null;
update sources.so_africa set strat_name=NULL where strat_name like '';
update sources.so_africa set combined_name=strat_name where combined_name is null;
update sources.so_africa set combined_name='Alluvium' where descriptio ilike 'alluvium%' and combined_name='';
update sources.so_africa set combined_name='Diabase' where descriptio ilike 'Diabase%' and combined_name='';
update sources.so_africa set combined_name='Diabase' where descriptio ilike 'Diabase%' and combined_name='';
update sources.so_africa set combined_name=NULL where combined_name='';


pg_dump -t sources.so_africa -C -O burwell | gzip > ~/Desktop/so_africa.sql.gz
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,41,combined_name,strat_name,age,descriptio,late_id,early_id,st_makevalid(geom) FROM sources.so_africa;
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=41 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');
update sources.so_africa_lines set name='thrust fault' where descriptio ilike '%thrust%';
update sources.so_africa_lines set name='fault' where descriptio ilike '%fault%' and name is null;
update sources.so_africa_lines set name='dike' where descriptio ilike '%dyke%' and name is null;
update sources.so_africa_lines set name='shear zone' where descriptio ilike 'shear zone' and name is null;
update sources.so_africa_lines set name='lineament' where descriptio ilike '%lineament%' and name is null;
update sources.so_africa_lines set name='bed' where descriptio ilike '%layer%' and name is null;
update sources.so_africa_lines set name='bed' where descriptio ilike '%reef%' and name is null;

insert into lines.medium (orig_id,source_id,name,type,geom) SELECT gid,41,descriptio,name,st_makevalid(geom) from sources.so_africa_lines;
pg_dump -t sources.so_africa_lines -C -O burwell | gzip > ~/Desktop/so_africa_lines.sql.gz


###### grand canyon http://geomaps.wr.usgs.gov/arizona/
# http://pubs.usgs.gov/of/2006/1217/
# handy grep command \s\(photo.*?\)

update temp2
set age = foo
FROM (
	select array_agg(m.interval_name) foo, code from macrostrat.intervals m, temp2 where named ~* concat('\y',interval_name,'\y') group by code
) a
where a.code = temp2.code
update temp2 set age=replace(age,'}','');
update temp2 set age=replace(age,'{','');
update temp2 set age=replace(age,'}','');
update temp2 set age=replace(age,',','-');
update temp2 set age=replace(age,'"','');

update temp2 set age='Late Cretaceous' where age='Late Cretaceous-Cretaceous';
update temp2 set age='Late Cretaceous' where age='Cretaceous-Late Cretaceous';

update temp2 set age='Holocene-Late Pleistocene' where age='Holocene-Late Pleistocene-Pleistocene';
	update temp2 set age='Middle Miocene' where age='Middle Miocene-Miocene';
		update temp2 set age='Middle Miocene' where age='Miocene-Middle Miocene';
update temp2 set age='Early Pleistocene-Middle Pleistocene' where named ilike '%(middle to early Pleistocene)';
update temp2 set age='Early Pleistocene' where named ilike '%(early Pleistocene)';
update temp2 set age='Proterozoic' where code ilike 'Pr%' and age is
update temp2 set age='Pleistocene' where age='Pleistocene-Early Pleistocene';
	update temp2 set age='Pleistocene' where age='Pleistocene-Middle Pleistocene';
	update temp2 set age='Unknown' where age='Unknown-Age Unknown';
update temp2 set age='Proterozoic' where code ilike 'Pr%' and age is null;
update temp2 set age='Triassic' where code ilike 'Tr%' and age is null;
update temp2 set age='Cretaceous' where code like 'K%' and age is null;
update temp2 set age='Quaternary' where code like 'Q%' and age is null;
	update temp2 set age='early Pliocene-late Miocene' where code in ('Tpbv','Tpbd','Tpbb') and age is null;
			update temp2 set age='Pliocene' where code in ('Tavc','Tavb','Tavr','Tavw') and age is null;
update temp2 set age='Miocene' where code in ('Tcr5','Tcr4','Tcr3','Tcr2','Tcr1') and age is null;
update temp2 set age='Paleocene' where code in ('Tsfs','Tsfc','Tsfl','Tsfb') and age is null;
update temp2 set age='Pliocene' where code in ('Tfu','Tfl','Tflc') and age is null;

update sources.sanberno set descrip=m.descrip,age=m.age from temp2 m where m.code like replace(ru_labl,'?','');
update sources.sanberno set descrip=trim(descrip);

update temp2 set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update temp2 set late_id=m.id FROM macrostrat.intervals m WHERE age ilike concat('%-',m.interval_name) and late_id IS NULL;
update temp2 set early_id=m.id FROM macrostrat.intervals m WHERE age ilike concat(m.interval_name,'-%') and early_id IS NULL;
update temp2 set late_id=m.id,early_id=e.id from macrostrat.intervals m,macrostrat.intervals e where m.interval_name='Cambrian-Ordovician' and e.interval_name='Neoproterozoic' and age ilike 'Late Proterozoic-Early Paleozoic';

update sources.sanberno set descrip=m.descrip,age=m.age,early_id=m.early_id,late_id=m.late_id from temp2 m where m.code like replace(ru_labl,'?','');
update sources.sanberno set ru_name='water body' where ru_name IS NULL and ru_labl ilike 'water body';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,42,concat_ws(': ',ru_name,subunit),age,descrip,late_id,early_id,st_makevalid(geom) FROM sources.sanberno;
pg_dump -t sources.sanberno -C -O burwell | gzip > ~/Desktop/sanberno.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=42 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.sanberno_lines set type='dike' where descr ilike 'dike%';
update sources.sanberno_lines set type='dike' where descr ilike '%dike%';
update sources.sanberno_lines set type='normal fault' where descr ilike '%normal%';
update sources.sanberno_lines set type='thrust fault' where descr ilike '%reverse slip%';
update sources.sanberno_lines set type='thrust fault' where descr ilike '%thrust%';
update sources.sanberno_lines set type='strike-slip fault',direction='dextral' where descr ilike 'Right-lateral%';
update sources.sanberno_lines set type='strike-slip fault',direction='sinistral' where descr ilike 'Left-lateral%';
update sources.sanberno_lines set type='fault',direction='dextral' where descr ilike '%right-oblique slip%' and type is null;
update sources.sanberno_lines set type='fault',direction='sinistral' where descr ilike '%left-oblique slip%' and type is null;
update sources.sanberno_lines set type='fault' where descr ilike '%fault%' and type is null;
update sources.sanberno_lines set type='suture' where descr ilike 'suture' and type is null;
update sources.sanberno_lines set type='zone' where descr ilike '%zone%' and type is null;

insert into lines.large (orig_id,source_id,name,type,direction,descrip,geom) SELECT gid,42,l_name,type,direction,descr,st_makevalid(geom) from sources.sanberno_lines;
pg_dump -t sources.sanberno_lines -C -O burwell | gzip > ~/Desktop/sanberno_lines.sql.gz



####### brazil
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Terreneuviano' and m.interval_name ilike 'Terreneuvian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Furongiano' and m.interval_name ilike 'Furongian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Mississipiano' and m.interval_name ilike 'Mississippian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Pensilvaniano' and m.interval_name ilike 'Pennsylvanian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Plioceno' and m.interval_name ilike 'Pliocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Holoceno' and m.interval_name ilike 'Holocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Pleistoceno' and m.interval_name ilike 'Pleistocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Mioceno' and m.interval_name ilike 'Miocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Plioceno' and m.interval_name ilike 'Pliocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Oligoceno' and m.interval_name ilike 'Oligocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Paleoceno' and m.interval_name ilike 'Paleocene';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Guadalupiano' and m.interval_name ilike 'Guadalupian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Lonpingiano' and m.interval_name ilike 'Lopingian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Cisuraliano' and m.interval_name ilike 'Cisuralian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Ludlowiano' and m.interval_name ilike 'Ludlow';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Landoveriano' and m.interval_name ilike 'Llandovery';

update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Jurássico' and m.interval_name ilike 'Early Jurassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Ordoviciano' and m.interval_name ilike 'Early Ordovician';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Devoniano' and m.interval_name ilike 'Early Devonian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Triássico' and m.interval_name ilike 'Early Triassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Cretáceo' and m.interval_name ilike 'Early Cretaceous';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Inferior' and periodo_ma ilike 'Cambriano' and m.interval_name ilike 'Early Cambrian';

update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Cambriano' and m.interval_name ilike 'Late Cambrian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Jurássico' and m.interval_name ilike 'Late Jurassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Ordoviciano' and m.interval_name ilike 'Late Ordovician';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Devoniano' and m.interval_name ilike 'Late Devonian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Triássico' and m.interval_name ilike 'Late Triassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Cretáceo' and m.interval_name ilike 'Late Cretaceous';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Superior' and periodo_ma ilike 'Cambriano' and m.interval_name ilike 'Late Cambrian';

update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Cambriano' and m.interval_name ilike 'Middle Cambrian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Jurássico' and m.interval_name ilike 'Middle Jurassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Ordoviciano' and m.interval_name ilike 'Middle Ordovician';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Devoniano' and m.interval_name ilike 'Middle Devonian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Triássico' and m.interval_name ilike 'Middle Triassic';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Cretáceo' and m.interval_name ilike 'Middle Cretaceous';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where epoca_max ilike 'Médio' and periodo_ma ilike 'Cambriano' and m.interval_name ilike 'Middle Cambrian';


update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Ediacarano' and m.interval_name ilike 'Ediacaran';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Toniano' and m.interval_name ilike 'Tonian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Sideriano' and m.interval_name ilike 'Siderian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Ectasiano' and m.interval_name ilike 'Ectasian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Riaciano' and m.interval_name ilike 'Rhyacian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Calimiano' and m.interval_name ilike 'Calymmian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Criogeniano' and m.interval_name ilike 'Cryogenian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Orosiriano' and m.interval_name ilike 'Orosirian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Estateriano' and m.interval_name ilike 'Statherian';
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where periodo_ma ilike 'Esteniano' and m.interval_name ilike 'Stenian';

update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where era_maxima ilike 'Neoarqueano' and m.interval_name ilike 'Neoarchean' and early_id is null;
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where era_maxima ilike 'Mesoarqueano' and m.interval_name ilike 'Mesoarchean' and early_id is null;
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where era_maxima ilike 'Paleoarqueano' and m.interval_name ilike 'Paleoarchean' and early_id is null;
update sources.brazil set early_id=m.id, age=m.interval_name from macrostrat.intervals m where era_maxima ilike 'Eoarqueano' and m.interval_name ilike 'Eoarchean' and early_id is null;

update sources.brazil set lith='Major::{igneous}' where classe_roc ilike 'Ígnea';
update sources.brazil set lith='Major::{metamorphic}' where classe_roc ilike 'Ígnea, Metamórfica';
update sources.brazil set lith='Major::{igneous, metasedimentary}' where classe_roc ilike 'Ígnea, Metamórfica, Sedimentar (ou Sedimentos)';
update sources.brazil set lith='Major::{igneous, metasedimentary}' where classe_roc ilike 'Ígnea, Sedimentar)';
update sources.brazil set lith='Major::{igneous}' where classe_roc ilike 'Ígnea, Sedimentar (ou Sedimentos)';
update sources.brazil set lith='Major::{igneous}' where classe_roc ilike 'Ígnea, Material superficial';

update sources.brazil set lith='Major::{sedimentary}' where classe_roc ilike 'Material superficial';
update sources.brazil set lith='Major::{sedimentary}' where classe_roc ilike 'Material superficial, Sedimentar';
update sources.brazil set lith='Major::{metamorphic}' where classe_roc ilike 'Metamórfica';
update sources.brazil set lith='Major::{igneous, metamorphic}' where classe_roc ilike 'Metamórfica, Ígnea';
update sources.brazil set lith='Major::{metamorphic}' where classe_roc ilike 'Metamórfica, Não definida';
update sources.brazil set lith='Major::{metamorphic,metasedimentary}' where classe_roc ilike 'Metamórfica, Sedimentar';
update sources.brazil set lith='Major::{metamorphic,metasedimentary}' where classe_roc ilike 'Metamórfica, Sedimentar (ou Sedimentos)';
update sources.brazil set lith='Major::{sedimentary}' where classe_roc ilike 'Sedimentar';
update sources.brazil set lith='Major::{sedimentary}' where classe_roc ilike 'Sedimentar (ou Sedimentos)';

update sources.brazil set use_name = concat_ws(' ',nome_unida,hierarquia) where hierarquia not ilike '%ão definid%' and nome_unida not ilike '% - %';
update sources.brazil set use_name = nome_unida where nome_unida  ilike '%-%';
update sources.brazil set use_name = nome_unida where nome_unida  ilike '%ão definid%';
update sources.brazil set use_name = cod_uni_es where use_name is null;
update sources.brazil set late_id=early_id

update sources.brazil set lith='Major::{igneous}' where classe_r_1 ilike 'Ígnea' and lith is null;
update sources.brazil set lith='Major::{metamorphic,igneous}' where classe_r_1 ilike 'Ígnea, Metamórfica';
update sources.brazil set lith='Major::{metamorphic}' where classe_r_1 ilike 'Metamórfica' and lith is null;
update sources.brazil set lith='Major::{sedimentary}' where classe_r_1 ilike 'Sedimentar%' and lith is null;
update sources.brazil set lith='Major::{sedimentary}' where bb_subcl_1 ilike 'Sedimento%' and lith is null;
update sources.brazil set lith='Major::{sedimentary}' where bb_subcl_1 ilike '%sedimento%' and lith is null;
update sources.brazil set lith='Major::{metasedimentary}' where classe_r_1 ilike 'Metamórfica, Sedimentar';

update sources.brazil set use_name_eng='colluvium and alluvium',early_id=3,late_id=3 where use_name='Depósitos colúvio-eluviais' and early_id is null;
update sources.brazil set use_name_eng='undifferentiated and unconsolidated sedimentary cover',early_id=3,late_id=3 where use_name='Coberturas sedimentares indiferenciadas Unidade' and early_id is null;
update sources.brazil set use_name_eng='undifferentiated and unconsolidated detrital cover',early_id=3,late_id=3 where use_name='Coberturas detríticas indiferenciadas' and early_id is null;

update sources.brazil set geom_mod=ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3) where ST_IsValid(geom) IS fALSE;

pg_dump -t sources.brazil -C -O burwell | gzip > ~/Desktop/brazil.sql.gz
INSERT INTO maps.medium (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) SELECT gid,43,use_name_eng,age,litotipo1_eng,late_id,early_id,ST_MakeValid(geom_mod) FROM sources.brazil where ST_GeometryType(geom_mod) is not null;
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=43 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');

# FUCK fixing duplicate error....
select u1.gid,u1.sigla_unid from sources.brazil u1, macrostrat_union u2 where ST_Contains(u2.geom,u1.geom_mod) and u2.id=2

# lines
INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,43,nome,type,new_type,new_direction,ST_MakeValid(geom) FROM sources.brazil_lines;
pg_dump -t sources.brazil_lines -C -O burwell | gzip > ~/Desktop/brazil_lines.sql.gz


###################

## DeltaUtah source_id 44
update sources.deltautah set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike REPLACE(age,'Lower','Early') and early_id IS NULL;
update sources.deltautah set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike REPLACE(age,'Upper','Late') and early_id IS NULL;
update sources.deltautah set late_id=m.id FROM macrostrat.intervals m WHERE REPLACE(age,'Lower','Early') ilike concat(m.interval_name, ' and %') and late_id IS NULL;
update sources.deltautah set late_id=m.id FROM macrostrat.intervals m WHERE REPLACE(age,'Upper','Late') ilike concat(m.interval_name, ' and %') and late_id IS NULL;
update sources.deltautah set early_id=m.id FROM macrostrat.intervals m WHERE REPLACE(age,'Upper','Late') ilike concat('% and ', m.interval_name) and early_id IS NULL;
update sources.deltautah set early_id=m.id FROM macrostrat.intervals m WHERE REPLACE(age,'Lower','Early') ilike concat('% and ', m.interval_name) and early_id IS NULL;

update sources.deltautah set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene-Middle Pleistocene';
update sources.deltautah set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Middle and lower Holocene';
update sources.deltautah set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Upper Holocene';
update sources.deltautah set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Upper and Middle Cambrian';
update sources.deltautah set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Late Pleistocene' and age ilike 'Late and Middle Pleistocene';


update sources.deltautah set lithology='Fine-grained lacustrine deposits--Grayish-tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less. Alluvium, pre-Lake Bonneville--Lenticular sand and sandy gravel beds that are pre-Lake Bonneville, but post-QTlf in age; located north of Delta but mostly covered by Lake Bonneville deposits (Qlf); 5 feet (1.5 m) are exposed; complete thickness unknown. Fine-grained lacustrine deposits of Sevier Desert--Brown and light-olive-gray, calcareous, lacustrine silt and silty clay with minor sand; offshore to deep-water sediments; Pliocene to middle Pleistocene in age; 0 to 870 or more feet (0-265+ m) thick.' where unitsymbol='Qlf/Qal3/QTlf';

update sources.deltautah set lithology='Dome-Chisholm-Howell Formations, undivided--Listed from top downward. Dome Limestone forms massive cliffs and is about 300 feet (90 m) thick in the Drum Mountains and 180 feet (55 m) thick in the Canyon Mountains. Chisholm Formation is interbedded, thin-bedded, fossiliferous (Glossopleura) limestone and olive shale, and is 205 feet (62 m) thick in the Drum Mountains and 247 feet (75 m) thick in the Canyon Mountains. Howell Limestone forms a massive cliff and is 330 feet (101 m) thick in the Drum Mountains, 303 feet (92 m) thick in the Canyon Mountains, and about 360 feet (110 m) thick in the northern Cricket Mountains.' where unitsymbol='Cdh';

update sources.deltautah set lithology='Lacustrine gravel--Shore-zone gravel of Lake Bonneville, Lake Gunnison, and Sevier Lake; chiefly silty, fine- to coarse-grained sand and gravel; gravel of Lakes Bonneville and Gunnison is late Pleistocene; gravel of Sevier Lake is Holocene; generally 0 to 30 feet (0-9 m) thick.' where unitsymbol='Qlg';

update sources.deltautah set lithology='Eolian dunes--Chiefly barchan, parabolic, dome, and transverse sand dunes that are active and not stabilized by vegetation; mostly tan, well-sorted, fine-grained quartz sand; also silt dunes downwind from playas; 3 to 35 feet (1-11 m) thick. Fine-grained lacustrine deposits--Grayish- tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less. Basalt of Deseret, Pot Mountain, Sunstone Knoll, Smelter Knolls, and Pahvant Butte --Basalt flows of probable middle and late Pleistocene age; 0 to 1,000 feet (0-300 m) thick.' where unitsymbol='Qed/Qlf/Qvb3';

update sources.deltautah set lithology='Fine-grained lacustrine deposits--Grayish- tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less. Deltaic sand and gravel--Deposited at the apexes of deltas of the Sevier and Beaver Rivers in Lake Bonneville then distributed by waves and currents; consists of silty, fine- to coarse-grained sand and gravel; 0 to 24 feet (0-7.3 m) thick.' where unitsymbol='Qlf/Qdg';

update sources.deltautah set lithology='Oak City Formation--Sandy, bouldery gravel, poorly to well cemented; forms dissected alluvial apron on west and south- west sides of Canyon-Pahvant-Range fault block; base not exposed; contains landslide blocks; estimated thickness 0 to 2,000 feet (0-600 m).' where unitsymbol='Toc';

update sources.deltautah set lithology='Eolian sand--Windblown sand in sheets, low irregular mounds, shrub-coppice dunes, and narrow northeast-trending ridges that are largely stabilized by vegetation; mostly silty, well-sorted, fine-grained quartz sand; 0 to 10 feet (0-3 m) thick. Larger blow-outs shown as closed depressions on map.' where unitsymbol='Qes';

update sources.deltautah set lithology='Ophir Formation--Upper half is thin-bedded limestone that contains interbeds of olive shale near the base and top; the upper shale contains Ehmaniella trilobites; the lower shaly interval bears Glossopleura trilobites.Lower half is sandy siltstone, and white, red, and brown quartzite with Skolithos tubes; total thickness 1,080 feet (329 m).' where unitsymbol='Cop';

update sources.deltautah set lithology='Tintic Quartzite--White and light-brownish- gray, dense, vitreous quartzite that weathers pale-reddish-brown; exposed on west side of Canyon Mountains near Oak City where it is so completely deformed that its thickness is not accurately known; estimated to be about 3,000 feet (950 m) thick.' where unitsymbol='Ct';

update sources.deltautah set lithology='Little Drum Formation--Interbedded andesitic tuffs and conglomerates that contain volcanic and quartzite clasts in various proportions; twelve members were mapped in the quadrangle where it is from 1,500 to 2,325 feet (450-708 m) thick; Ar/Ar ages 37.6 and 38.4 Ma but overlies Drum Mountains Rhyodacite.' where unitsymbol='Tld';

update sources.deltautah set lithology='Pioche Formation--Dark-green, micaceous, phyllitic siltstone interbedded with light-brown to greenish-black quartzite that locally contains abundant trace fossils; orange-weathering dolomite beds occur in uppermost Pioche; thickness 415 feet (127 m) in the Drum Mountains, about 800 feet (245 m) in the northern Cricket Mountains, and about 750 feet (228 m) in the Canyon Mountains.' where unitsymbol='Cp';

update sources.deltautah set lithology='Alluvium and colluvium, undifferentiated--Mixed alluvial and colluvial deposits that consist of fluvially reworked, coarse-grained colluvium and/or alluvium with a significant colluvium component; includes talus; mapped in and along the Canyon Mountains, Pahvant Range, Valley Mountains and in northeast corner of quadrangle; generally 0 to 50 feet (0-15 m) thick, but may be thicker locally.' where unitsymbol='Qac';

update sources.deltautah set lithology='Fine-grained lacustrine deposits--Grayish- tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less. Basalt of Deseret, Pot Mountain, Sunstone Knoll, Smelter Knolls, and Pahvant Butte--Basalt flows of probable middle and late Pleistocene age; 0 to 1,000 feet (0-300 m) thick.' where unitsymbol='Qlf/Qvb3';


update sources.deltautah set lithology='Basaltic tuff of Pahvant Butte--Gray, basaltic tuff and brown, orange, and yellow palagonite comprise the volcanic cone of Pahvant Butte; deposited during hydrovolcanic eruption in Lake Bonneville about 15,500 years ago, when lake was near its highest level; up to about 600 feet (180 m) thick.' where unitsymbol='Qvt';

update sources.deltautah set lithology='Lacustrine and alluvial deposits, undifferentiated--Mixed and reworked, gravelly lacustrine and alluvial deposits on piedmont slopes; grades from pebbly sand and silt to sandy pebble gravel; generally 0 to 12 feet (0-3.7 m) thick, but may be thicker locally.' where unitsymbol='Qla';

update sources.deltautah set lithology='Pogonip Group--Medium-gray, generally thin-bedded, silty to fine-sandy limestone with intraformational conglomerate beds common in the middle third; upper 320 feet (98 m) is interbedded, olive shale and thin-bedded, fossiliferous limestone; total thickness 1,684 feet (513 m).' where unitsymbol='Op';

update sources.deltautah set lithology='Mass movements, slides, and slumps-- Masses large enough to show on this map are found north of Horse Canyon and in Oak Creek Canyon in the Canyon Mountains, the Scipio Pass quadrangle, north of Lone Cedar Pass in the Valley Mountains, and in the Drum Mountains; masses north of Horse Canyon and in the Scipio Pass area may include older tectonically emplaced blocks; small, isolated slides or slumps are present in many mountainous areas, but are too small to show at 1:100,000 scale; up to 200 feet (60 m) thick.' where unitsymbol='Qms';

update sources.deltautah set lithology='Quaternary-Tertiary alluvial-fan deposits- -Poorly sorted silt, sand, and gravel, including boulders, that have, locally, a calcic soil with a stage IV carbonate morphology (early Pleistocene age) near the top of the deposit; 0 to 300 feet (0-90 m), or more, thick.' where unitsymbol='QTaf';

update sources.deltautah set lithology='Playa mud--Laminated, silty fine sand, silt, and clayey silt infused with various salts, gypsum, and calcium carbonate; thickness probably 20 feet (6 m) or less. Fine-grained lacustrine deposits--Grayish- tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less.' where unitsymbol='Qpm/Qlf';

update sources.deltautah set lithology='Wheeler-Swasey-Whirlwind Formations, undivided--Listed from top downward. Wheeler Shale is olive, platy, calcareous shale that is 910 feet (277 m) thick in the Drum Mountains and only about 100 feet (30 m) thick in the Canyon Mountains. Swasey Limestone is dark-gray, massive, cliff-forming limestone that is about 180 feet (55 m) thick in the Drum Mountains and 614 feet (186 m) in the Canyon Mountains. Whirlwind Formation is olive shale and thin-bedded limestone that bears Ehmaniella trilobites; it is about 140 feet (43 m) thick in both the Drum and Canyon Mountains.' where unitsymbol='Cww';

update sources.deltautah set lithology='Eolian dunes--Chiefly barchan, parabolic, dome, and transverse sand dunes that are active and not stabilized by vegetation; mostly tan, well-sorted, fine-grained quartz sand; also silt dunes downwind from playas; 3 to 35 feet (1-11 m) thick. Fine-grained lacustrine deposits--Grayish-tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less.' where unitsymbol='Qed/Qlf';

update sources.deltautah set lithology='Eolian dunes--Chiefly barchan, parabolic, dome, and transverse sand dunes that are active and not stabilized by vegetation; mostly tan, well-sorted, fine-grained quartz sand; also silt dunes downwind from playas; 3 to 35 feet (1-11 m) thick. Fine-grained lacustrine deposits--Grayish-tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less. Deltaic sand and gravel--Deposited at the apexes of deltas of the Sevier and Beaver Rivers in Lake Bonneville then distributed by waves and currents; consists of silty, fine- to coarse-grained sand and gravel; 0 to 24 feet (0-7.3 m) thick.' where unitsymbol='Qed/Qlf/Qdg';

update sources.deltautah set lithology='Eolian dunes--Chiefly barchan, parabolic, dome, and transverse sand dunes that are active and not stabilized by vegetation; mostly Fine-grained lacustrine deposits--Grayish-tan, tan, and light-gray, calcareous silts that are deep-water sediments of Lake Bonneville, Lake Gunnison (both late Pleistocene), and Sevier Lake (when it contained surface water in the Holocene); locally includes younger alluvium; thickness probably 10 feet (3 m) or less.' where unitsymbol='Qlf';

update sources.deltautah set lithology='Deltaic sand and gravel--Deposited at the apexes of deltas of the Sevier and Beaver Rivers in Lake Bonneville then distributed by waves and currents; consists of silty, fine- to coarse-grained sand and gravel; 0 to 24 feet (0-7.3 m) thick. Underflow-fan deposits--Thin-bedded to laminated, calcareous silt with minor interbedded very fine sand in thin beds that were deposited in the Lake Bonneville deltas of the Sevier River; 0 to 64 feet (0-20 m) thick.' where unitsymbol='Qdg/Qdf';

update sources.deltautah set lithology='Herkimer, Dagmar, and Teutonic Formations, undivided--Interbeds of dark- to medium-gray limestone mottled with light-olive-gray dolomite, white laminated dolomite, and oolitic and oncolitic limestone; at least 1,000 feet (300 m) thick; base not exposed where mapped in northern Pahvant Range.' where unitsymbol='Cht';

update sources.deltautah set lithology='Sevier River deposits in Mills Valley-- Moderately well-sorted sand, gravel, and mud of mixed sedimentary and volcanic clasts derived from the Sanpete Valley- Marysvale area; 0 to more than 20 feet (6 m) thick; early Pleistocene to Pliocene in age. Includes poorly sorted calcareous sand and silt to silty clay (QTab of Oviatt, 1992).' where unitsymbol='QTas';


pg_dump -t sources.deltautah -C -O burwell | gzip > ~/Desktop/deltautah.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,44,unitname,age,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.deltautah;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=44 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.large (orig_id,source_id,new_type,new_direction,descrip,geom) SELECT gid,44,new_type,new_direction,concat_ws('; ',concat_ws(' ',subtype,type),modifier),ST_MakeValid(geom) FROM sources.ut_delta_lines;
pg_dump -t sources.ut_delta_lines -C -O burwell | gzip > ~/Desktop/ut_delta_lines.sql.gz



##########
update sources.lissadellaustralia set era=initcap(trim(era));
update sources.lissadellaustralia set period=initcap(trim(period));
update sources.lissadellaustralia set period=REPLACE(period,'Palaeo','Paleo');
update sources.lissadellaustralia set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike REPLACE(period,'Lower','Early') and early_id IS NULL;
update sources.lissadellaustralia set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike REPLACE(period,'Upper','Late') and early_id IS NULL;
update sources.lissadellaustralia set early_id=m.id FROM macrostrat.intervals m WHERE REPLACE(period,'Lower','Early') ilike concat(m.interval_name, ' To %') and early_id IS NULL;
update sources.lissadellaustralia set early_id=m.id FROM macrostrat.intervals m WHERE REPLACE(period,'Upper','Late') ilike concat(m.interval_name, ' To %') and early_id IS NULL;
update sources.lissadellaustralia set late_id=m.id FROM macrostrat.intervals m WHERE REPLACE(period,'Upper','Late') ilike concat('% To ', m.interval_name) and late_id IS NULL;
update sources.lissadellaustralia set late_id=m.id FROM macrostrat.intervals m WHERE REPLACE(period,'Lower','Early') ilike concat('% To ', m.interval_name) and late_id IS NULL;
update sources.lissadellaustralia set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and period ilike 'Middle To Late Cambrian';
update sources.lissadellaustralia set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Statherian' and l.interval_name='Ectasian' and period ilike 'Carpentarian';

update sources.lissadellaustralia set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Neoproterozoic' and period ilike 'Neoproterozoic To Adelaidean';
update sources.lissadellaustralia set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mesoproterozoic' and l.interval_name='Neoproterozoic' and period ilike 'Mesoproterozoic To Adelaidean';

update sources.lissadellaustralia set use_name=unitname;
update sources.lissadellaustralia set use_name=lith_desc where use_name is null;

update sources.lissadellaustralia set lith_desc=REPLACE(lith_desc, 'Conglomaerate', 'Conglomerate');

pg_dump -t sources.lissadellaustralia -C -O burwell | gzip > ~/Desktop/lissadellaustralia.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,t_interval,b_interval,geom) SELECT gid,45,use_name,unitname,period,lith_desc,late_id,early_id,ST_MakeValid(geom) FROM sources.lissadellaustralia;

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=45 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

##### ut_seepridge 46
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene and Pliestocene?';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Campanian' and l.interval_name='Maastrichtian' and age ilike 'Upper Cretaceous, Maastrichtian and Campanian';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bridgerian' and l.interval_name='Bridgerian' and age ilike 'Eocene, Bridgerian';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Wasatchian' and l.interval_name='Bridgerian' and age ilike 'Eocene, Bridgerian and Wasatchian';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Uintan' and l.interval_name='Uintan' and age ilike 'Eocene, Uintan';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bridgerian' and l.interval_name='Uintan' and age ilike 'Eocene, Uintan and Bridgerian';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene and Pleistocene?';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Holocene';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Clarkforkian' and l.interval_name='Wasatchian' and age ilike 'Eocene and Paleocene?, Wasatchian and Clarkforkian';
update sources.ut_seepridge set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Holocene and Pleistocene';
update sources.ut_seepridge set unitname=NULL where unitsymbol='water';
pg_dump -t sources.ut_seepridge -C -O burwell | gzip > ~/Desktop/ut_seepridge.sql.gz
update sources.ut_seepridge set unitname='water' where unitsymbol='water';

select concat_ws('; ',thickness,color,genesis,morphology) from sources.ut_seepridge

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,46,unitname,age,concat_ws('; ',thickness,color,genesis,morphology),compositio,notes,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_seepridge;

INSERT INTO lines.large (orig_id,source_id,name,new_type,new_direction,descrip,geom) SELECT gid,46,name,new_type,new_direction,concat_ws('; ',concat_ws(' ',subtype,type),modifier),ST_MakeValid(geom) FROM sources.ut_seepridge_lines;
pg_dump -t sources.ut_seepridge_lines -C -O burwell | gzip > ~/Desktop/ut_seepridge_lines.sql.gz


## switzerland
update sources.switzerland set early_id=m.id, late_id=m.id from macrostrat.intervals m where m.interval_name=epochs_eng;
update sources.switzerland set early_id=m.id, late_id=m.id from macrostrat.intervals m where m.interval_name=periods_en and early_id IS NULL;
update sources.switzerland set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Paleozoic' and periods_en ilike 'Precambrian - Lower Paleozoic';
update sources.switzerland set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Permian' and l.interval_name='Cretaceous' and periods_en ilike 'Permian-Cretaceous';
update sources.switzerland set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleozoic' and l.interval_name='Paleozoic' and periods_en ilike 'Paleozoic';


update sources.switzerland set use_age=epochs_eng;
update sources.switzerland set use_age=periods_en where use_age is null;
update sources.switzerland set litho_engl='volcanic and pyrolclastic rocks' where litho_engl='Ogibikute';
update sources.switzerland set periods_en='Paleozoic' where periods_en IS NULL and leg_tek_3 ilike '%palaeozoische%';
update sources.switzerland set litho_engl='biogenic carbonate rocks and evaporite' where genese='Biogene Sedimentgesteine und Evaporite';
update sources.switzerland set litho_engl='biogenic carbonate rocks and evaporite' where genese='Biogene und klastische Sedimentgesteine, teils mit Evaporiten';
update sources.switzerland set litho_engl='Marl with weakly cemented sandstone, conglomerate' where lith_pet='Mergel mit schwach verfestigten Sandstein-,  Konglomerat- oder Gerlllagen';
update sources.switzerland set litho_engl='Marl to shaly limestones and intercalated sandstones' where lith_pet='Mergelschiefer bis Kalkphyllite mit Einlagerungen von Sandsteinen';
update sources.switzerland set litho_engl='Conglomerates to breccias with arkose and sandstones' where lith_pet='Konglomerate bis Brekzien mit Arkosen und Sandsteinen';
update sources.switzerland set litho_engl='Gneiss with abundant feldspar' where lith_pet='Gneise mit reichlich Feldspat';
update sources.switzerland set litho_engl='Granite in tonalite and Quartz syenite' where lith_pet='Granit mit bergngen in Quarzdiorit und Quarzsyenit';
update sources.switzerland set litho_engl='Quartzite' where lith_pet='Quarzite';
update sources.switzerland set litho_engl='Gneiss with abundant feldspar, sericite, epidote and chlorite' where lith_pet='Gneise mit reichlich Feldspat, verschiefert unter Serizit-, Epidot- und Chloritbildung';
update sources.switzerland set litho_engl='Biotite gneisses to muscovite mica schist' where lith_pet='Biotit- bis muskowitreiche Gneise und Glimmerschiefer';
update sources.switzerland set litho_engl='Granite with sericite, epidote and chlorite' where lith_pet='Granit mit Serizit, Epidot und Chlorit';
update sources.switzerland set litho_engl='conglomerate and breccia' where lith_pet='Serizitreiche Konglomerate und Brekzien';

update sources.switzerland set litho_engl='Shale to phyllite intercalated sandstones and breccia, conglomerate' where lith_pet='Tonschiefer bis Phyllite mit Einlagerungen von Sandsteinen und Brekzien bis Konglomeraten';
update sources.switzerland set litho_engl='Limestone to marble' where lith_pet='Kalksteine bis Kalkmarmore';
update sources.switzerland set litho_engl='Predominantly calcareous , porous rich sandstones with marl layers' where lith_pet='Vorwiegend kalkhaltige, porenreiche Sandsteine mit Mergellagen';
update sources.switzerland set litho_engl='Calareous phyllite and calcareous mica slate' where lith_pet='Kalkphyllite bis Kalkglimmerschiefer';

update sources.switzerland set litho_engl='Marl to calcareous phyllite with layers of volcanic tuff' where lith_pet='Mergelschiefer bis Kalkphyllite mit Lagen von vulkanischen Tuffsandsteinen';
update sources.switzerland set litho_engl='biotite gneiss and quartzite layers' where lith_pet='Biotit- bis muskowitreiche Gneise z.T. chloritfhrend, z.T. mit Kalksilikatfelsen oder mit Quarzitlagen (Hornfelse)';

update sources.switzerland set litho_engl='breccia and conglomerate' where lith_pet='Brekzien und Konglomerate';
update sources.switzerland set litho_engl='gravel and sand' where lith_pet='Kiese und Sande';
update sources.switzerland set litho_engl='Sandstone and marl layers with layers of low to medium lithified conglomerates' where lith_pet='Sandstein- und Mergellagen mit Lagen von schwach bis mittelstark verfestigten Konglomeraten';
update sources.switzerland set litho_engl='Marl with layers of cemnted sandstones' where lith_pet='Mergel mit Lagen von strker verfestigten Sandsteinen';
update sources.switzerland set litho_engl='quartz sandstone to sandy shale' where lith_pet='Quarzsandsteine bis sandige Tonschiefer';
update sources.switzerland set litho_engl='Conglomerates with sandstone and marl layers' where lith_pet='Konglomerate mit Sandstein- und Mergellagen';
update sources.switzerland set litho_engl='sandstone with interbedded marl' where lith_pet='Sandsteine mit Mergellagen';

update sources.switzerland set litho_engl='metamorphic rocks, mostly metasedimentary' where genese='Metamorphe Gesteine, meist Metasedimente';

update sources.switzerland set litho_engl='metamorphic rocks, mostly metasedimentary' where genese='Metamorphe Gesteine, meist Metasedimente';
update sources.switzerland set litho_engl='silty sand, clay, often calcareous' where lith_pet='Silte bis siltige Sande, oft tonig, meist kalkhaltig';

update sources.switzerland set litho_engl='amphibolite, diorite, hornblende gneiss' where lith_pet='Amphibolite mit bergngen in Diorite und in hornblendefhrende Gneise';
update sources.switzerland set litho_engl='siliciclastic sedimentary rocks' where genese='Klastische Sedimentgesteine';
update sources.switzerland set litho_engl='Predominantly calcareous , porous rich sandstones with marl layers' where lith_pet='Vorwiegend kalkhaltige, porenreiche Sandsteine mit Mergellagen';

update sources.switzerland set litho_engl='Solid, compact sandstone with layers of marl schist and calcareous phyllite' where lith_pet='Feste, kompakte Sandsteine mit Lagen von Mergelschiefern und Kalkphylliten';
update sources.switzerland set litho_engl='metaigneous rock, metagabbro, eclogite' where litho='Metagabbro, Eklogit' and litho_engl='Metamorphic Rock';
update sources.switzerland set litho_engl='slate metasedimentary rocks in basic igneous rocks, eclogites' where lith_pet='Grnschiefer mit bergngen in basische Eruptivgesteine, Eklogite' and litho='Sedimentgesteine';
update sources.switzerland set litho_engl='limestone with dolomite layers' where lith_pet='Kalksteine mit Dolomitlagen';

update sources.switzerland set litho_engl='limestone, often somewhat marly limestone' where lith_pet='Kalksteine, oft etwas mergelig';
update sources.switzerland set litho_engl='marl to calcareous phyllite and interbedded sandstone' where lith_pet='Mergelschiefer bis Kalkphyllite mit Einlagerungen von Sandsteinen';
update sources.switzerland set litho_engl='marl with layers of sandstone, sandy shellbeds' where lith_pet='Mergel mit Lagen von muschelreichen Sandsteinen bis Muschelbrekzien';
update sources.switzerland set litho_engl='Quarzite' where lith_pet='Quarzite';
update sources.switzerland set litho_engl='quartz sandstone to sandy shale' where lith_pet='Quarzsandsteine bis sandige Tonschiefer';
update sources.switzerland set litho_engl='radiolarian chert' where lith_pet='Radiolarite';
update sources.switzerland set litho_engl='gneiss and mica schist' where litho='Gneise und Glimmerschiefer' and litho_engl='metamorphic rocks, mostly metasedimentary';
update sources.switzerland set litho_engl='granodiorite and tonalite' where litho='Granodiorit, Tonalit' and litho_engl='metamorphic rocks, mostly metasedimentary';

update sources.switzerland set litho_engl='volcanic and pyroclastic, volcaniclastic rocks' where lith_pet='Vulkanite und Pyroklastika' and litho_engl='Sedimentary rocks';


INSERT INTO maps.medium (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) SELECT gid,49,genese,use_age,litho_engl,late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.switzerland;

insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=49 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.medium (orig_id,source_id,descrip,new_type,geom) SELECT gid,49,english_type,new_type,ST_MakeValid(geom) FROM sources.switzerland_lines;

pg_dump -t sources.switzerland_lines -C -O burwell | gzip > ~/Desktop/switzerland_lines.sql.gz


#### ut_logan
update sources.ut_logan set age_temp=REPLACE(age_temp,'Lower','Early');
update sources.ut_logan set early_id=m.id, late_id=m.id from macrostrat.intervals m where m.interval_name=age;
update sources.ut_logan set early_id=m.id, late_id=m.id from macrostrat.intervals m where m.interval_name=age_temp[1] and age_temp[2] IS NULL;
update sources.ut_logan set early_id=e.id from macrostrat.intervals e where e.interval_name=age_temp[2] and early_id is null;
update sources.ut_logan set late_id=e.id from macrostrat.intervals e where e.interval_name=age_temp[1] and late_id is null;

update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Ypresian' and l.interval_name='Lutetian' and age ilike 'middle and lower Eocene';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Lutetian' and l.interval_name='Bartonian' and age ilike 'middle Eocene';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Ypresian' and l.interval_name='Ypresian' and age ilike 'lower Eocene';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Triassic' and l.interval_name='Jurassic' and age ilike 'Jurassic? and Triassic?';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Early Ordovician' and age ilike 'Lower Ordovician and Upper and Middle Cambrian?';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Quaternary Ordovician' and age ilike 'Quaternary and (or) upper Tertiary';

update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene Ordovician' and age ilike 'Holocene or Pleistocene';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Moscovian' and l.interval_name='Early Permian' and age ilike 'Lower Permian and Upper and Middle Pennsylvanian';

update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Neoproterozoic' and l.interval_name='Neoproterozoic' and age ilike 'Late Proterozoic';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mesozoic' and l.interval_name='Mesozoic' and age ilike 'Mezozoic(?)';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and age ilike 'Upper and Middle Jurassic';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Ordovician' and l.interval_name='Middle Ordovician' and age ilike 'Middle and Lower Ordovician';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Ordovician' and l.interval_name='Late Ordovician' and age ilike 'Upper and Middle Ordovician';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Triassic' and l.interval_name='Triassic' and age ilike 'Upper and Lower Triassic';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Devonian' and l.interval_name='Late Devonian' and age ilike 'Upper and Middle Devonian';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mississippian' and l.interval_name='Late Devonian' and age ilike 'Lower Mississippian? and Upper Devonian';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Upper and Middle Cambrian';

update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mississippian' and l.interval_name='Mississippian' and age ilike 'Upper and Lower Mississippian';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Mississippian' and l.interval_name='Late Devonian' and age ilike 'Lower Mississipian? and Upper Devonian';
update sources.ut_logan set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Mississippian' and l.interval_name='Early Mississippian' and age ilike 'Lower Mississippian';

pg_dump -t sources.ut_logan -C -O burwell | gzip > ~/Desktop/ut_logan.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,47,unitname,age,loganlitho,notes,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_logan;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=47 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.large (orig_id,source_id,new_type,new_direction,descrip,geom) SELECT gid,47,new_type,new_direction,concat_ws('; ',concat_ws(' ',subtype,type),modifier),ST_MakeValid(geom) FROM sources.ut_logan_lines;
pg_dump -t sources.ut_logan_lines -C -O burwell | gzip > ~/Desktop/ut_logan_lines.sql.gz


#### hawaii mod
update sources.hawaii set real_interval = 'Holocene' where age_range ilike 'A.D.%';
update sources.hawaii set real_interval = 'Holocene' where rock_type ilike 'Manmade fill';
update sources.hawaii set real_interval = 'Holocene' where rock_type ilike 'Beach deposits';
update sources.hawaii set real_interval = NULL where rock_type ilike 'Open Water';
update sources.hawaii set real_interval = NULL where name ilike 'Open Water';
update sources.hawaii set real_interval = 'Holocene' where name ilike '%Younger%' and real_interval ilike 'Sedimentary rocks%';
update sources.hawaii set real_interval = 'Pleistocene to Holocene' where name ilike '%Older%' and real_interval ilike 'Sedimentary rocks%';
update sources.hawaii set real_interval = 'Quaternary' where real_interval ilike 'Sedimentary rocks%';
update sources.hawaii set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Pleistocene' and real_interval ilike 'Pleistocene to Holocene';
update sources.hawaii set early_id=m.id, late_id=m.id from macrostrat.intervals m where m.interval_name=real_interval;
update sources.hawaii set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Zanclean' and l.interval_name='Middle Pleistocene' and age_range ilike '0.15-3.85 Ma';


INSERT INTO maps.medium (orig_id,source_id,name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,48,name,concat_ws('; ', real_interval,age_range),rock_type,concat_ws('; ', lithology,compositio),late_id,early_id,ST_MakeValid(geom_valid) FROM sources.hawaii;
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=48 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=48 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.medium (orig_id,source_id,name,type,new_type,new_direction,descrip,geom) SELECT gid,48,name,type,new_type,new_direction,description,ST_MakeValid(geom) FROM sources.hawaii_lines;

pg_dump -t sources.hawaii_lines -C -O burwell | gzip > ~/Desktop/hawaii_lines.sql.gz


#### Glacier source_id 50
SELECT l.interval_name,e.interval_name,age from sources.glaciernationalparkgeology join macrostrat.intervals l on l.id=lat_id join macrostrat intervals e on e.id=early_id;
update sources.glaciernationalparkgeology set description=trim(replace(description,'(I-1508-F)',''));
update sources.glaciernationalparkgeology set description=trim(replace(description,'(I-1508-D)',''));

pg_dump -t sources.glaciernationalparkgeology -C -O burwell | gzip > ~/Desktop/glaciernationalparkgeology.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,50,glg_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.glaciernationalparkgeology;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=50 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,50,name,type,new_type,concat_ws('; ',age_text,plunge,notes),ST_MakeValid(geom) FROM sources.glacier_np_lines;
pg_dump -t sources.glacier_np_lines -C -O burwell | gzip > ~/Desktop/glacier_np_lines.sql.gz


##### rockymountainnationalparkgeology source_id
SELECT distinct l.interval_name,e.interval_name,age from sources.rockymountainnationalparkgeology join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

update sources.rockymountainnationalparkgeology set glg_name='water' where src_sym='water' and glg_name IS NULL;
pg_dump -t sources.rockymountainnationalparkgeology -C -O burwell | gzip > ~/Desktop/rockymountainnationalparkgeology.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,51,glg_name,age,description,mj_lith,late_id,early_id,ST_MakeValid(geom) FROM sources.rockymountainnationalparkgeology;


INSERT INTO lines.large (orig_id,source_id,type,new_type,descrip,geom) SELECT gid,51,subtype,new_type,concat_ws('; ',majorlith,positionalaccuracy),ST_MakeValid(geom) FROM sources.rockymtn_np_lines;

pg_dump -t sources.rockymtn_np_lines -C -O burwell | gzip > ~/Desktop/rockymtn_np_lines.sql.gz




### congareeNP source_id 52
update sources.congareenationalparkgeology set early_id=NULL, late_id=NULL age=NULL where glg_name ilike 'water';
SELECT distinct l.interval_name,e.interval_name,age from sources.congareenationalparkgeology join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,52,glg_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.congareenationalparkgeology;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=52 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,new_type,descrip,geom) SELECT gid,52,name,new_type,concat_ws('; ',subtype,position),ST_MakeValid(geom) FROM sources.congareenationalpark_lines;

pg_dump -t sources.congareenationalpark_lines -C -O burwell | gzip > ~/Desktop/congareenationalpark_lines.sql.gz



## brycecan

yonnationalparkgeology source_id 53
update sources.brycecanyonnationalparkgeology set glg_name='water' where src_sym='Water' and glg_name is null;
update sources.brycecanyonnationalparkgeology set notes=NULL where notes='NA';
SELECT distinct l.interval_name,e.interval_name,age from sources.brycecanyonnationalparkgeology join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,53,glg_name,age,description,notes,late_id,early_id,ST_MakeValid(geom) FROM sources.brycecanyonnationalparkgeology;

pg_dump -t sources.brycecanyonnationalparkgeology -C -O burwell | gzip > ~/Desktop/brycecanyonnationalparkgeology.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=53 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,type,new_type,new_direction,descrip,geom) SELECT gid,53,name,type,new_type,new_direction,concat_ws('; ',description,positionalaccuracy),ST_MakeValid(geom) FROM sources.brycecanyon_lines;

pg_dump -t sources.brycecanyon_lines -C -O burwell | gzip > ~/Desktop/brycecanyon_lines.sql.gz


## greatbasinnationalparkgeology source_id 54
SELECT distinct l.interval_name,e.interval_name,age from sources.greatbasinnationalparkgeology join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
pg_dump -t sources.greatbasinnationalparkgeology -C -O burwell | gzip > ~/Desktop/greatbasinnationalparkgeology.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,54,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.greatbasinnationalparkgeology;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=54 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


update sources.greatbasinnationalpark_lines set notes=NULL where notes='NA';
delete from sources.greatbasinnationalpark_lines where subtype='Contact/Fault' and type IS NULL;
delete from sources.greatbasinnationalpark_lines where notes='source data attribution for positional accuracy may be questionable';
delete from sources.greatbasinnationalpark_lines where notes='concealed contact between bedrock units that is underlying surficial deposits';

INSERT INTO lines.large (orig_id,source_id,type,new_type,new_direction,descrip,geom) SELECT gid,54,type,new_type,new_direction,concat_ws('; ',notes,positionalaccuracy),ST_MakeValid(geom) FROM sources.greatbasinnationalpark_lines;
pg_dump -t sources.greatbasinnationalpark_lines -C -O burwell | gzip > ~/Desktop/greatbasinnationalpark_lines.sql.gz


## twincities source_id 55
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,55,unitname,age,description,concat_ws('; ',terrane,subdivisio),late_id,early_id,ST_MakeValid(geom) FROM sources.twincitiesmngeology;
pg_dump -t sources.twincitiesmngeology -C -O burwell | gzip > ~/Desktop/twincitiesmngeology.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=55 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,55,new_type,ST_MakeValid(geom) FROM sources.twincitiesmn_lines;
pg_dump -t sources.twincitiesmn_lines -C -O burwell | gzip > ~/Desktop/twincitiesmn_lines.sql.gz



## ut_vernal source_id 56
update sources.ut_vernal set description=trim(description);
update sources.ut_vernal set unitname='water' where unitsymbol='water';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,56,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_vernal


update sources.ut_vernal set unitname='Cedar Mountain Formation and Morrison Formation' where unitname='Cedar Mountain and Morrison Formations';
update sources.ut_vernal set unitname='Moenkopi Formation and Dinwoody Formation' where unitname='Moenkopi and Dinwoody Formations';
update sources.ut_vernal set unitname='Park City Formation and Phosphoria Formation' where unitname='Park City and Phosphoria Formations';
update sources.ut_vernal set unitname='Chinle Formation, Moenkopi Formation, and Dinwoody Formation' where unitname='Chinle, Moenkopi, and Dinwoody Formations';
pg_dump -t sources.ut_vernal -C -O burwell | gzip > ~/Desktop/ut_vernal.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=56 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,56,name,concat_ws(' ',subtype,type)new_type,modifier,ST_MakeValid(geom) FROM sources.ut_vernal_lines;
pg_dump -t sources.ut_vernal_lines -C -O burwell | gzip > ~/Desktop/ut_vernal_lines.sql.gz


## ut_wahwahmtns source_id 57
update sources.ut_wahwahmtns set unitname='Dome Formation, Chisholm Formation, Howell Formation, undivided' where unitname='Dome-Chisholm-Howell Formations, undivided';
update sources.ut_wahwahmtns set unitname='Eureka Quartzite, Crystal Peak Formation, Watson Ranch Formation, undivided' where unitname='Eureka Formation, Crystal Peak Formation, Watson Ranch Formation, undivided';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,57,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_wahwahmtns;

pg_dump -t sources.ut_wahwahmtns -C -O burwell | gzip > ~/Desktop/ut_wahwahmtns.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=57 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,descrip,geom) SELECT gid,57,concat_ws(' ',subtype,type),new_type,modifier,ST_MakeValid(geom) FROM sources.ut_wahwahmtns_lines;
pg_dump -t sources.ut_wahwahmtns_lines -C -O burwell | gzip > ~/Desktop/ut_wahwahmtns_lines.sql.gz


## ut_smokymtns source_id 58
update sources.ut_smokymtns set unitname='water' where unitsymbol='water';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,58,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_smokymtns;
pg_dump -t sources.ut_smokymtns -C -O burwell | gzip > ~/Desktop/ut_smokymtns.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=58 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,58,name,modifier,new_type,ST_MakeValid(geom) FROM sources.ut_smokymtns_lines;
pg_dump -t sources.ut_smokymtns_lines -C -O burwell | gzip > ~/Desktop/ut_smokymtns_lines.sql.gz



## ut_richfield source_id 59
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,59,unitname,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_richfield;
pg_dump -t sources.ut_richfield -C -O burwell | gzip > ~/Desktop/ut_richfield.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=59 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,59,notes,concat_ws(' ', subtype,type),new_type,modifier,ST_MakeValid(geom) FROM sources.ut_richfield_lines;
pg_dump -t sources.ut_richfield_lines -C -O burwell | gzip > ~/Desktop/ut_richfield_lines.sql.gz


## ut_tulevalley source_id 60
update sources.ut_tulevalley set unitname='Dome Formation, Chisholm Formation, Howell Formation, undivided' where unitname='Dome-Chisholm-Howell Formations, undivided';
update sources.ut_tulevalley set unitname='Eureka Quartzite, Crystal Peak Formation, Watson Ranch Formation, undivided' where unitname='Eureka-Crystal Peak-Watson Ranch Formations, undivided';
update sources.ut_tulevalley set unitname='Wheeler Shale, Swasey Limestone, Whirlwind Formation, undivided' where unitname='Weeler-Swasey-Whirlwind Formations, undivided';
update sources.ut_tulevalley set unitname='Marjum Formation or Pierson Cove Formation' where unitname='Marjum or Pierson Cove Formation';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,60,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_tulevalley;
pg_dump -t sources.ut_tulevalley -C -O burwell | gzip > ~/Desktop/ut_tulevalley.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=60 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,descrip,geom) SELECT gid,60,concat_ws(' ', subtype,type),new_type,modifier,ST_MakeValid(geom) FROM sources.ut_tulevalley_lines;
pg_dump -t sources.ut_tulevalley_lines -C -O burwell | gzip > ~/Desktop/ut_tulevalley_lines.sql.gz

## ut_provo source_id 61
update sources.ut_provo set unitname='Cedar Mountain Formation and Morrison Formation, undivided' where unitname='Cedar Mountain and Morrison Formations, undivided';
update sources.ut_provo set unitname='Cole Canyon Formation through Teutonic Formation ?' where unitname='Cole Canyon through Teutonic Formations?';
update sources.ut_provo set unitname='Twin Creek Limestone, Rich Member, Sliderock Member and Gypsum Spring Member' where unitname='Creek Limestone, Rich, Sliderock and Gypsum Spring Members';
update sources.ut_provo set unitname='Curtis Formation and Entrada Formation, undivided' where unitname='Curtis and Entrada Formations, undivided';
update sources.ut_provo set unitname='Deseret Limestone (?)' where unitsymbol='Mde?';
update sources.ut_provo set unitname='Fitchville Formation and Pinyon Peak Formation, undivided' where unitname='Fitchville and Pinyon Peak formations, undivided';
update sources.ut_provo set unitname='Gardison Formation and Fitchville Formation, undivided' where unitname='Gardison and Fitchville formations, undivided';
update sources.ut_provo set unitname='Great Blue Limestone, Long Trail Shale Member and lower limestone members' where unitname='Great Blue Limestone, Long Trail Shale and lower limestone members';
update sources.ut_provo set unitname='Twin Creek Limestone: Watton Canyon Member, Boundary Ridge Member, Rich Member, Sliderock Member, and Gypsum Spring Member' where unitname='Twin Creek Limestone, Watton Canyon, Boundary Ridge, Rich, Sliderock, and Gypsum Spring Members';
update sources.ut_provo set unitname='Twin Creek Limestone, Giraffe Creek Member and Leeds Creek Member' where unitname='Twin Creek Limestone, Giraffe Creek and Leeds Creek Members';

SELECT distinct l.interval_name,e.interval_name,age from sources.ut_provo join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,61,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_provo;
pg_dump -t sources.ut_provo -C -O burwell | gzip > ~/Desktop/ut_provo.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=61 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,descrip,geom) SELECT gid,61,concat_ws(' ', subtype,type),new_type,modifier,ST_MakeValid(geom) FROM sources.ut_provo_lines;
pg_dump -t sources.ut_provo_lines -C -O burwell | gzip > ~/Desktop/ut_provo_lines.sql.gz


# ut_manti source_id 62
update sources.ut_manti set unitname='Crazy Hollow Formation',description=concat(description, ' Formation of Spieker (1949).') where unitname='Crazy Hollow Formation of Spieker (1949)';
update sources.ut_manti set unitname='Bald Knoll Formation',description=concat(description, ' Formation of Gilliland (1951).') where unitname='Bald Knoll Formation of Gilliland (1951)';
update sources.ut_manti set unitname='Goldens Ranch Formation',description=concat(description, ' Formation of Muessig (1951).') where unitname='Goldens Ranch Formation of Muessig (1951)';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,62,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_manti;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=62 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ut_manti -C -O burwell | gzip > ~/Desktop/ut_manti.sql.gz


INSERT INTO lines.large (orig_id,source_id,type,new_type,descrip,geom) SELECT gid,62,concat_ws(' ', subtype,type),new_type,modifier,ST_MakeValid(geom) FROM sources.ut_manti_lines;
pg_dump -t sources.ut_manti_lines -C -O burwell | gzip > ~/Desktop/ut_manti_lines.sql.gz


## mexico source 63
INSERT INTO maps.medium (orig_id,source_id,age,lith,t_interval,b_interval,geom) SELECT gid,63,age,type,late_id,early_id,ST_MakeValid(geom) FROM sources.mexico;
SELECT distinct l.interval_name,e.interval_name,age from sources.mexico join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=63 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.medium (orig_id,source_id,type,new_type,new_direction,descrip,geom) SELECT gid,63,concat_ws(' ', type,entity),new_type,new_direction,accuracy,ST_MakeValid(geom) FROM sources.mexico_lines;
pg_dump -t sources.mexico_lines -C -O burwell | gzip > ~/Desktop/mexico_lines.sql.gz



## co_denver source 64
update sources.co_denver set name='Dawson Formation and Arapahoe Formation' where name='Dawson and Arapahoe Formations';
update sources.co_denver set name='Morrison Formation, Ralston Creek Formation, and Lykins Formation, undifferentiated' where name='Morrison, Ralston Creek, and Lykins Formations, undifferentiated';
SELECT distinct l.interval_name late,e.interval_name ear,age from sources.co_denver join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,64,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.co_denver;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=64 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.co_denver -C -O burwell | gzip > ~/Desktop/co_denver.sql.gz

### ut_dutchjohn source 65
SELECT distinct l.interval_name,e.interval_name,age from sources.ut_dutchjohn join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
update sources.ut_dutchjohn set unitname='Chinle Formation, Moenkopi Formation, and Dinwoody Formation' where unitname='Chinle, Moenkopi, and Dinwoody Formations';
update sources.ut_dutchjohn set unitname='Cedar Mountain Formation and Morrison Formation' where unitname='Cedar Mountain and Morrison Formations';
update sources.ut_dutchjohn set unitname='Park City Formation and Phosphoria Formation' where unitname='Park City and Phosphoria Formations';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,65,unitname,age,litho,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_dutchjohn;
pg_dump -t sources.ut_dutchjohn -C -O burwell | gzip > ~/Desktop/ut_dutchjohn.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=65 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,new_type,new_direction,descrip,geom) SELECT gid,65,name,new_type,new_direction,concat_ws('; ',concat_ws(' ',subtype,type),modifier),ST_MakeValid(geom) FROM sources.ut_dutchjohn_lines;

pg_dump -t sources.ut_dutchjohn_lines -C -O burwell | gzip > ~/Desktop/ut_dutchjohn_lines.sql.gz


# ut_huntington source 66
update sources.ut_huntington set unitname='Bluecastle Sandstone Member and mudstone member of Price River Formation' where unitname='Bluecastle Sandstone Memeber and mudstone member of Price River Formation';
update sources.ut_huntington set unitname='Farrer Formation and Nelsen Formation' where unitname='Farrer and Nelsen Formations';
update sources.ut_huntington set unitname='Tununk Member of Mancos Shale' where unitname='Tununk Memeber of Mancos Shale';
update sources.ut_huntington set unitname='Blue Gate Member of Mancos Shale' where unitname='Blue Gate Memeber of Mancos Shale';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,66,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_huntington;
pg_dump -t sources.ut_huntington -C -O burwell | gzip > ~/Desktop/ut_huntington.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=66 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,new_type,descrip,geom) SELECT gid,66,new_type,modifier,ST_MakeValid(geom) FROM sources.ut_huntington_lines;
pg_dump -t sources.ut_huntington_lines -C -O burwell | gzip > ~/Desktop/ut_huntington_lines.sql.gz


# ut_nephi source 67
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,67,unitname,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_nephi;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=67 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.ut_nephi set unitname='Goldens Ranch Formation' where unitname='Goldens Ranch Formation of Muessig';
update sources.ut_nephi set unitname='North Horn Formation' where unitname='North Horn Foramation';
update sources.ut_nephi set unitname='Woodside Formation' where unitname='Woodside Foramation';

pg_dump -t sources.ut_nephi -C -O burwell | gzip > ~/Desktop/ut_nephi.sql.gz


INSERT INTO lines.large (orig_id,source_id,new_type,descrip,geom) SELECT gid,67,new_type,concat_ws('; ',notes,modifier),ST_MakeValid(geom) FROM sources.ut_nephi_lines;
pg_dump -t sources.ut_nephi_lines -C -O burwell | gzip > ~/Desktop/ut_nephi_lines.sql.gz


# pakistan_westcentral source_id 68
INSERT INTO maps.medium (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,68,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.pakistan_westcentral;
pg_dump -t sources.pakistan_westcentral -C -O burwell | gzip > ~/Desktop/pakistan_westcentral.sql.gz
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=68 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');


update sources.pakistan_westcentral_lines set descriptio=type where descriptio is null and type is not like 'dike';
update sources.pakistan_westcentral_lines set type=NULL where tye is not like 'dike';

INSERT INTO lines.medium (orig_id,source_id,type,new_type,new_direction,descrip,geom) SELECT gid,68,type,new_type,new_direction,descriptio,ST_MakeValid(geom) FROM sources.pakistan_westcentral_lines;
pg_dump -t sources.pakistan_westcentral_lines -C -O burwell | gzip > ~/Desktop/pakistan_westcentral_lines.sql.gz


# dc_geology source_id 69
select distinct mapunit,name,description from sources.dc_bedrock where early_id is null and late_id is null;
update sources.dc_bedrock set name=mapunit where name is null and mapunit='Sinkhole';
update sources.dc_bedrock set clastlith=concat('clasts composed of ',clastlith) where clastlith is not null;
update sources.dc_bedrock set cement=concat('cemented by ',cement) where cement is not null;

update sources.dc_bedrock set fossil='trilobites, brachiopods, bryozoans, crinoids' where fossil='trilobites, brachiopods, bryoz, cri';
update sources.dc_bedrock set fossil=NULL where fossil='NR';
update sources.dc_bedrock set fossil=NULL where fossil='';
update sources.dc_bedrock set fossil='No fossils' where fossil='No';
update sources.dc_bedrock set resource=concat('used for ',resource) where resource is not null;
update sources.dc_bedrock set bedding=concat(bedding,' bedded') where bedding is not null;
update sources.dc_bedrock set name=rockclass where name is null and rockclass='Unconsolidated Sediments'
update sources.dc_bedrock set foliation=concat_ws(' ',foliation,'folation') where foliation not in ('none','not foliated','joints') and foliation is not null;

update sources.dc_bedrock set geochronall= concat_ws(' ',geochrondate, '±',geochronerror,geochrontech) where geochrondate is not null and geochronerror is not null;
update sources.dc_bedrock set name='informal Lower Cambrian member' where mapunit='Csqu';
update sources.dc_bedrock set name='informal Late Cambrian-Early Ordovician carbonate member' where mapunit='OCgu';
update sources.dc_bedrock set name='Lower Cambrian melange' where mapunit like 'Clo';

update sources.dc_bedrock set strat_name='Accotink Schist' where name='Accotink Schist';
update sources.dc_bedrock set strat_name='Adamstown Member' where name='Adamstown Member';
update sources.dc_bedrock set strat_name='Antietam Formation' where name='Antietam Formation';
update sources.dc_bedrock set strat_name='Aquia Formation' where name='Aquia Formation';
update sources.dc_bedrock set strat_name='Araby Formation' where name='Araby Formation';
update sources.dc_bedrock set strat_name='Bacons Castle Formation' where name='Bacons Castle Formation';
update sources.dc_bedrock set strat_name='Ball Mountain Formation' where name='Ball Mountain Formation';
update sources.dc_bedrock set strat_name='Balls Bluff Member' where name='Balls Bluff Member';
update sources.dc_bedrock set strat_name='Battle Mountain Alkali Feldspar Granite' where name='Battle Mountain Alkali Feldspar Granite';
update sources.dc_bedrock set strat_name='Bear Island Granodiorite' where name='Bear Island Granodiorite';
update sources.dc_bedrock set strat_name='Benevola Member' where name='Benevola Member';
update sources.dc_bedrock set strat_name='Big Spring Station Member' where name='Big Spring Station Member';
update sources.dc_bedrock set strat_name='Bolivar Heights Member' where name='Bolivar Heights Member';
update sources.dc_bedrock set strat_name='Accotink Schist' where name='Accotink Schist';
update sources.dc_bedrock set strat_name='Brightseat Formation' where name='Brightseat Formation';
update sources.dc_bedrock set strat_name='Bunker Hill Formation' where name='Bunker Hill Formation';
update sources.dc_bedrock set strat_name='Buzzard Knob Member' where name='Buzzard Knob Member';
update sources.dc_bedrock set strat_name='Calvert Formation' where name='Calvert Formation';
update sources.dc_bedrock set strat_name='Cash Smith Formation' where name='Cash Smith Formation';
update sources.dc_bedrock set strat_name='Catharpin Creek Formation' where name='Catharpin Creek Formation';
update sources.dc_bedrock set strat_name='Catoctin Formation' where name='Catoctin Formation';
update sources.dc_bedrock set strat_name='Cavetown Member' where name='Cavetown Member';
update sources.dc_bedrock set strat_name='Chambersburg Limestone' where name='Chambersburg Limestone';
update sources.dc_bedrock set strat_name='Charlottesville Formation' where name='Charlottesville Formation';
update sources.dc_bedrock set strat_name='Chewsville Member' where name='Chewsville Member';
update sources.dc_bedrock set strat_name='Chopawamsic Formation' where name='Chopawamsic Formation';
update sources.dc_bedrock set strat_name='Clarendon Granite' where name='Clarendon Granite';
update sources.dc_bedrock set strat_name='Conococheague Limestone' where name='Conococheague Limestone';
update sources.dc_bedrock set strat_name='Dale City Quartz Monzonite' where name='Dale City Quartz Monzonite';
update sources.dc_bedrock set strat_name='Dargan Member' where name='Dargan Member';
update sources.dc_bedrock set strat_name='Eastover Formation' where name='Eastover Formation';
update sources.dc_bedrock set strat_name='Elbrook Formation' where name='Elbrook Formation';
update sources.dc_bedrock set strat_name='Everona Limestone Member' where name='Everona Limestone Member';
update sources.dc_bedrock set strat_name='Falls Run Granite Gneiss' where name='Falls Fun Granite Gneiss';
update sources.dc_bedrock set strat_name='Falmouth Intrusive Suite' where name='Falmouth Intrusive Suite';
update sources.dc_bedrock set strat_name='Flint Hill Gneiss' where name='Flint Hill Gneiss';
update sources.dc_bedrock set strat_name='Fort Duncan Member' where name='Fort Duncan Member';
update sources.dc_bedrock set strat_name='Garrisonville Mafic Complex' where name='Garrisonville Mafic Complex';
update sources.dc_bedrock set strat_name='Goose Creek Member' where name='Goose Creek Member';
update sources.dc_bedrock set strat_name='Groveton Member' where name='Groveton Member';
update sources.dc_bedrock set strat_name='Guilford Granite' where name='Guilford Granite';
update sources.dc_bedrock set strat_name='Harpers Formation' where name='Harpers Formation';
update sources.dc_bedrock set strat_name='Hickory Grove Basalt' where name='Hickory Grove Basalt';
update sources.dc_bedrock set strat_name='Holly Corner Gneiss' where name='Holly Corner Gneiss';
update sources.dc_bedrock set strat_name='Indian Run Formation' where name='Indian Run Formation';
update sources.dc_bedrock set strat_name='Kensington Tonalite' where name='Kensington Tonalite';
update sources.dc_bedrock set strat_name='Lake Barcroft Metasandstone' where name='Lake Barcroft Metasandstone';
update sources.dc_bedrock set strat_name='Laurel Formation' where name='Laurel Formation';
update sources.dc_bedrock set strat_name='Laurel Mills Granite' where name='Laurel Mills Granite';
update sources.dc_bedrock set strat_name='Leesburg Member' where name='Leesburg Member';
update sources.dc_bedrock set strat_name='Lime Kiln Member' where name='Lime Kiln Member';
update sources.dc_bedrock set strat_name='Loch Raven Schist' where name='Loch Raven Schist';
update sources.dc_bedrock set strat_name='Grove Member' where name='lower Grove Member';
update sources.dc_bedrock set strat_name='Lunga Reservoir Formation' where name='Lunga Reservoir Formation';
update sources.dc_bedrock set strat_name='Marburg Formation' where name='Marburg Formation';
update sources.dc_bedrock set strat_name='Marlboro Clay' where name='Marlboro Clay';
update sources.dc_bedrock set strat_name='Marshall Metagranite' where name='Marshall Metagranite';
update sources.dc_bedrock set strat_name='Martinsburg Formation' where name='Martinsburg Formation';
update sources.dc_bedrock set strat_name='Maryland Heights Member' where name='Maryland Heights Member';
update sources.dc_bedrock set strat_name='Midland Formation' where name='Midland Formation';
update sources.dc_bedrock set strat_name='Millbrook Quarry Member' where name='Millbrook Quarry Member';
update sources.dc_bedrock set strat_name='Monumental Mills Formation' where name='Monumental Mills Formation';
update sources.dc_bedrock set strat_name='Mount Zion Church Basalt' where name='Mount Zion Church Basalt';
update sources.dc_bedrock set strat_name='Mountain Run Member' where name='Mountain Run Member';
update sources.dc_bedrock set strat_name='Nanjemoy Formation' where name='Nanjemoy Formation';
update sources.dc_bedrock set strat_name='Occoquan Granite' where name='Occoquan Granite';
update sources.dc_bedrock set strat_name='New Market Limestone; Row Park Limestone' where name='New Market and Row Park Limestone';
update sources.dc_bedrock set strat_name='Oella Formation' where name='Oella Formation';
update sources.dc_bedrock set strat_name='Old Mill Branch Metasiltstone Member' where name='Old Mill Branch Metasiltstone Member';
update sources.dc_bedrock set strat_name='Owens Creek Member' where name='Owens Creek Member';
update sources.dc_bedrock set strat_name='Pinesburg Station Dolomite' where name='Pinesburg Station Dolomite';
update sources.dc_bedrock set strat_name='Piney Branch Complex' where name='Piney Branch Complex';
update sources.dc_bedrock set strat_name='Po River Metamorphic Suite' where name='Po River Metamorphic Suite';
update sources.dc_bedrock set strat_name='Poolesville Member' where name='Poolesville Member';
update sources.dc_bedrock set strat_name='Potomac Formation' where name='Potomac Formation';
update sources.dc_bedrock set strat_name='Potomac Formation' where name='Potomac Formation - clay dominated';
update sources.dc_bedrock set strat_name='Potomac Formation' where name='Potomac Formation - sand dominated';
update sources.dc_bedrock set strat_name='Prettyboy Schist' where name='Prettyboy Schist';
update sources.dc_bedrock set strat_name='Purcell Branch Formation' where name='Purcell Branch Formation';
update sources.dc_bedrock set strat_name='Quantico Formation' where name='Quantico Formation';
update sources.dc_bedrock set strat_name='Rapidan Member' where name='Rapidan Member';
update sources.dc_bedrock set strat_name='Red Run Member' where name='Red Run Member';
update sources.dc_bedrock set strat_name='Reston Member' where name='Reston Member';
update sources.dc_bedrock set strat_name='Rockdale Run Formation' where name='Rockdale Run Formation';
update sources.dc_bedrock set strat_name='Rocky Springs Station Member' where name='Rocky Springs Station Member';
update sources.dc_bedrock set strat_name='Sander Basalt' where name='Sander Basalt';
update sources.dc_bedrock set strat_name='Severn Formation' where name='Severn Formation';
update sources.dc_bedrock set strat_name='Station Hills Phyllite Member' where name='Station Hills Phyllite Member';
update sources.dc_bedrock set strat_name='Stonehenge Limestone' where name='Stonehenge Limestone';
update sources.dc_bedrock set strat_name='Stoufferstown Member' where name='Stoufferstown Member';
update sources.dc_bedrock set strat_name='Swains Mountain Formation' where name='Swains Mountain Formation';
update sources.dc_bedrock set strat_name='Sykesville Formation' where name='Sykesville Formation';
update sources.dc_bedrock set strat_name='Ta River Metamorphic Suite' where name='Ta River Metamorphic Suite';
update sources.dc_bedrock set strat_name='Tomstown Formation' where name='Tomstown Formation';
update sources.dc_bedrock set strat_name='True Blue Formation' where name='True Blue Formation';
update sources.dc_bedrock set strat_name='Turkey Run Formation' where name='Turkey Run Formation';
update sources.dc_bedrock set strat_name='Tuscarora Creek Member' where name='Tuscarora Creek Member';
update sources.dc_bedrock set strat_name='Sams Creek Member' where name='unknown Sams Creek Member';
update sources.dc_bedrock set strat_name='Urbana Formation' where name='Urbana Formation';
update sources.dc_bedrock set strat_name='Wakefield Marble' where name='Wakefield Marble';
update sources.dc_bedrock set strat_name='Waterfall Formation' where name='Waterfall Formation';
update sources.dc_bedrock set strat_name='Weverton Quartzite' where name='Weverton Quartzite';
update sources.dc_bedrock set strat_name='Yorkshire Formation' where name='Yorkshire Formation';
update sources.dc_bedrock set strat_name='Yorktown Formation' where name='Yorktown Formation';
update sources.dc_bedrock set strat_name='Yorktown Formation' where name='Yorkown of Maryland';
update sources.dc_bedrock set strat_name='Yorktown Formation' where name='Yorktown of Virginia';
update sources.dc_bedrock set strat_name='Everona Limestone Member' where name='Everona Limestone Member of the True Blue Formation';
update sources.dc_bedrock set strat_name='Cobbler Mountain Alkali Feldspar Quartz Syenite' where name='Cobbler Mountain alkali feldspar quartz syenite';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,lith,t_interval,b_interval,geom) SELECT gid,69,name,age,description,concat_ws('; ',color,bedding,clastlith,concat_ws(' ',foliationrank, foliation),fossil,mineral,origin,geochronall,resource),rockname,late_id,early_id,ST_MakeValid(geom) FROM sources.dc_bedrock;

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=69 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=69 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.dc_bedrock -C -O burwell | gzip > ~/Desktop/dc_bedrock.sql.gz

INSERT INTO lines.large (orig_id,source_id,type,new_type,geom) SELECT gid,69,type,new_type,ST_MakeValid(geom) FROM sources.dc_lines;
pg_dump -t sources.dc_lines -C -O burwell | gzip > ~/Desktop/dc_lines.sql.gz

update sources.dc_bedrock set name=concat_ws(' ',name,namerank) WHERE name in ('Charlottesville','Stoufferstown','Groveton','Poolesville','Ball Mountain','Sykesville','Dargan','Cavetown','Calvert','Potomac','Owens Creek','Brightseat','Antietam','Cash Smith','Monumental Mills','Rockdale Run','Catharpin Creek','Leesburg','Swains Mountain','Purcell Branch','Turkey Run','Lime Kiln','Yorkshire','Urbana','Severn','Maryland Heights','Goose Creek','Goose Creek','Yorktown','Laurel','Fort Duncan','Adamstown','Indian Run','Reston','Bunker Hill','Bolivar Heights','Balls Bluff','Catoctin','Nanjemoy','Buzzard Knob','Waterfall','Martinsburg','Mountain Run','True Blue','Tomstown','Chopawamsic','Aquia','Oella','Chewsville','Harpers','Elbrook','Midland','Marburg','Benevola','Lunga Reservoir','Millbrook Quarry','Araby','Big Spring Station','Quantico','Eastover','Rocky Springs Station','Red Run','Rapidan','Tuscarora Creek');

update sources.dc_bedrock set name=concat_ws(' ',name,namerank) WHERE name in ('Bacons Castle','lower Grove','Old Mill Branch Metasiltstone','unknown Sams Creek','Station Hills Phyllite');
update sources.dc_bedrock set name=concat_ws(' ',name,namerank) WHERE name in ('Chicamuxen Church');


update maps.large set name=dc_bedrock.name from sources.dc_bedrock where source_id=69 and orig_id=gid;

# dc_geology source_id 70
update sources.dc_surficial set early_id=10, late_id=4, age='Pleistocene and Pliocene' WHERE age='Cambrian' and description like 'Colluvium (Pleis%';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,lith,t_interval,b_interval,geom) SELECT gid,70,name,age,description,concat_ws('; ',color,bedding,clastlith,concat_ws(' ',foliationrank, foliation),fossil,mineral,origin,geochronall,resource),rockname,late_id,early_id,ST_MakeValid(geom) FROM sources.dc_surficial;

update sources.dc_surficial set name=concat_ws(' ',name,namerank) where name in ('Omar','Shirley','Poquoson','Lynnhaven','Charles City','Ravens Crest','Sedgefield','Maryland Point','Chicamuxen Church');
update maps.large set name=dc_surficial.name from sources.dc_surficial where source_id=70 and orig_id=gid;

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=70 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=70 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.dc_surficial -C -O burwell | gzip > ~/Desktop/dc_surficial.sql.gz

update sources.dc_surficial set name='Unconsolidated Sediments' where name is null;

update sources.dc_surficial set strat_name='Ravens Crest Formation' where name='Ravens Crest Formation';
update sources.dc_surficial set strat_name='Sedgefield Member' where name='Sedgefield Member';
update sources.dc_surficial set strat_name='Charles City Formation' where name='Charles City Formation';
update sources.dc_surficial set strat_name='Maryland Point Formation' where name='Maryland Point Formation';
update sources.dc_surficial set strat_name='Lynnhaven Member' where name='Lynnhaven Member';
update sources.dc_surficial set strat_name='Windsor Formation' where name='Windsor Formation and (or) Moorings unit';
update sources.dc_surficial set strat_name='Chicamuxen Church Formation' where name='Chicamuxen Church Formation';
update sources.dc_surficial set strat_name='Poquoson Member' where name='Poquoson Member';
update sources.dc_surficial set strat_name='Lynnhaven Memeber; Poquoson Member' where name='Lynnhaven and Poquoson Members, undivided';
update sources.dc_surficial set strat_name='Omar Formation' where name='Omar Formation';
update sources.dc_surficial set strat_name='Tabb Formation' where name='Tabb Formation, undivided';
update sources.dc_surficial set strat_name='Shirley Formation' where name='Shirley Formation';

# texas_mexico source_id 71
update sources.texas_mexico set name='water' where symbol='water' and name is null;
delete from sources.texas_mexico where gid=1;
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,71,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.texas_mexico;
pg_dump -t sources.texas_mexico -C -O burwell | gzip > ~/Desktop/texas_mexico.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=71 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,geom) SELECT gid,71,type,new_type,ST_MakeValid(geom) FROM sources.texas_mexico_lines;

pg_dump -t sources.texas_mexico_lines -C -O burwell | gzip > ~/Desktop/texas_mexico_lines.sql.gz


# ca_cambria source_id 72
update sources.ca_cambria set late_id=NULL,early_id=NULL where age='Historic';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,72,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_cambria;
pg_dump -t sources.ca_cambria -C -O burwell | gzip > ~/Desktop/ca_cambria.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=72 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,type,new_type,geom) SELECT gid,72,type,new_type,ST_MakeValid(geom) FROM sources.ca_cambria_lines;
pg_dump -t sources.ca_cambria_lines -C -O burwell | gzip > ~/Desktop/ca_cambria_lines.sql.gz



# blackhills source_id 73
UPDATE sources.blackhills set age=concat_ws('-',youngestage,oldestage) where youngestage!=oldestage;
UPDATE sources.blackhills set age=youngestage where youngestage=oldestage;
update sources.blackhills set age=NULL where age='n/a';
update sources.blackhills set name=unit where name='n/a';

SELECT distinct l.interval_name,e.interval_name,age from sources.blackhills join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,73,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.blackhills;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=73 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.blackhills -C -O burwell | gzip > ~/Desktop/blackhills.sql.gz


update sources.blackhills_lines set name=NULL where name='none';
INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,73,name,type,new_type,concat_ws('; ',descrip,accuracy),ST_MakeValid(geom) FROM sources.blackhills_lines;
pg_dump -t sources.blackhills_lines -C -O burwell | gzip > ~/Desktop/blackhills_lines.sql.gz


# world_basins source id
pg_dump -t sources.world_basins -C -O burwell | gzip > ~/Desktop/world_basins.sql.gz
https://gka.github.io/palettes/#colors=honeydew,lightgreen,green,darkgreen|steps=7|bez=1|coL=1
https://gka.github.io/palettes/#colors=lightyellow,orange,deeppink,darkred|steps=7|bez=1|coL=1
http://cng.seas.rochester.edu/CNG/docs/x11color.html

select * from sources.world_basins;
select distinct tellus_bas,sub_regime,subreg_grp,hex_color from sources.world_basins order by subreg_grp,sub_regime;

update sources.world_basins set hex_color='#b0c4de' where sub_regime='Passive Margin';
update sources.world_basins set hex_color='#b0c4de' where sub_regime='Passive Margin with Inversion';
update sources.world_basins set hex_color='#9aa2cf' where sub_regime='Intracratonic Sag';
update sources.world_basins set hex_color='#9aa2cf' where sub_regime='Post-rift Sag with Inversion';
update sources.world_basins set hex_color='#9aa2cf' where sub_regime='Post-rift Sag';
update sources.world_basins set hex_color='#8b0000' where sub_regime='Rift';
update sources.world_basins set hex_color='#b81b34' where sub_regime='Intracratonic Wrench';
update sources.world_basins set hex_color='#429b39' where subreg_grp='Convergent (Continent-Continent) Basin';

# az_peachsprings source id
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,74,name,age,description,classification,late_id,early_id,ST_MakeValid(geom) FROM sources.az_peachsprings;
update sources.az_peachsprings set classification=lithology where classification is null;
pg_dump -t sources.az_peachsprings -C -O burwell | gzip > ~/Desktop/az_peachsprings.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=74 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

delete from sources.az_peachsprings_lines where ltype='basalt_flow_direction';
update sources.az_peachsprings_lines set name=NULL where name='xx';
update sources.az_peachsprings_lines set pttype=NULL where pttype='xx';
update sources.az_peachsprings_lines set pttype=NULL where pttype='bar_and_ball';
update sources.az_peachsprings_lines set descrip='normal fault location certain' where ltype='fault_normal_certain';
update sources.az_peachsprings_lines set descrip='anticline location certain' where ltype='anticline_certain';
update sources.az_peachsprings_lines set descrip='anticline location concealed' where ltype='anticline_concealed';
update sources.az_peachsprings_lines set descrip='diabase intrusive rocks' where ltype='diabase_intrusive_rocks';
update sources.az_peachsprings_lines set descrip='normal fault location concealed' where ltype='fault_normal_concealed';
update sources.az_peachsprings_lines set descrip='reverse fault location certain' where ltype='fault_reverse_certain';
update sources.az_peachsprings_lines set descrip='reverse fault location concealed' where ltype='fault_reverse_concealed';
update sources.az_peachsprings_lines set descrip='thrust fault location certain' where ltype='fault_thrust_certain';
update sources.az_peachsprings_lines set descrip='monocline location certain' where ltype='monocline_certain';
update sources.az_peachsprings_lines set descrip='monocline location concealed' where ltype='monocline_concealed';
update sources.az_peachsprings_lines set descrip='syncline location certain' where ltype='syncline_certain';
update sources.az_peachsprings_lines set descrip='syncline location concealed' where ltype='syncline_concealed';

INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,74,name,new_type,new_type,descrip,ST_MakeValid(geom) FROM sources.az_peachsprings_lines;
pg_dump -t sources.az_peachsprings_lines -C -O burwell | gzip > ~/Desktop/az_peachsprings_lines.sql.gz


update sources.az_peachsprings_lines set name=initcap(name) where name is not null;


# az_mohave source id
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,75,name,age,description,classification,late_id,early_id,ST_MakeValid(geom) FROM sources.az_mohave;
pg_dump -t sources.az_mohave -C -O burwell | gzip > ~/Desktop/az_mohave.sql.gz

delete * from sources.az_mohave_lines where ltype100k='basalt_flow_direction';
update sources.az_mohave_lines set flt_nm=NULL where flt_nm='xx';
update sources.az_mohave_lines set pttype=NULL where pttype='xx';
update sources.az_mohave_lines set flt_nm=initcap(flt_nm) where flt_nm is not null;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=75 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


update sources.az_mohave_lines set comments='location certain' where ltype100k ilike '%_certain';
update sources.az_mohave_lines set comments='concealed' where ltype100k ilike '%_concealed';
update sources.az_mohave_lines set comments='concealed' where ltype100k ilike '%_concealed';
update sources.az_mohave_lines set comments='location inferred' where ltype100k ilike '%_inferred';
update sources.az_mohave_lines set comments='approximately located' where ltype100k ilike '%_approximate';


INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,75,flt_nm,new_type,new_type,comments,ST_MakeValid(geom) FROM sources.az_mohave_lines;

pg_dump -t sources.az_mohave_lines -C -O burwell | gzip > ~/Desktop/az_mohave_lines.sql.gz


# saipan source id 76
INSERT INTO maps.medium (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,76,glg_name,age,concat_ws('; ',mj_lith,description),late_id,early_id,ST_MakeValid(geom) FROM sources.saipan;
pg_dump -t sources.saipan -C -O burwell | gzip > ~/Desktop/saipan.sql.gz
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=76 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.medium (orig_id,source_id,name,new_type,descrip,geom) SELECT gid,76,label,new_type,concat('location ',positionalaccuracy) ,ST_MakeValid(geom) FROM sources.saipan_lines;
pg_dump -t sources.saipan_lines -C -O burwell | gzip > ~/Desktop/saipan_lines.sql.gz


# spain source_id 77
INSERT INTO maps.medium (orig_id,source_id,descrip,lith,comments,age,t_interval,b_interval,geom) SELECT gid,77,description,lower(lithology),domain,age,late_id,early_id,ST_MakeValid(geom) FROM sources.spain;
pg_dump -t sources.spain -C -O burwell | gzip > ~/Desktop/spain.sql.gz
INSERT INTO lines.medium (orig_id,source_id,type,new_type,geom) SELECT gid,77,type,new_type,ST_MakeValid(geom) FROM sources.spain_lines;
pg_dump -t sources.spain_lines -C -O burwell | gzip > ~/Desktop/spain_lines.sql.gz
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=77 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');


# wi_sauk source_id 78
update sources.wi_sauk set descrip=trim(descrip);
update sources.wi_sauk set use_name=strat_name;
update sources.wi_sauk set descrip=NULL where name='Water';
update sources.wi_sauk set use_name=name where use_name is null;
update sources.wi_sauk set age='Pleistocene' where name not like 'Water' and name not like 'Tauls' and age is null;
update sources.wi_sauk set age='Cambrian' where descrip ilike 'Parfreys Glen Formation%' and age is null;
update sources.wi_sauk set strat_name='Wonewoc Formation and Eau Claire Formation' where strat_name='Wonewoc and Eau Claire Formations';
update sources.wi_sauk set strat_name='Oneota Formation and Rountree Formation' where strat_name='Oneota and Rountree Formations';
update sources.wi_sauk set use_name='Wonewoc Formation and Eau Claire Formation' where use_name='Wonewoc and Eau Claire Formations';
update sources.wi_sauk set use_name='Oneota Formation and Rountree Formation' where use_name='Oneota and Rountree Formations';

update sources.wi_sauk set use_name='Baraboo Quartzite' where symbol like 'Pb_S';
update sources.wi_sauk set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleoproterozoic' and l.interval_name='Paleoproterozoic' and symbol like 'Pb_s';
update maps.large set name=use_name,t_interval=late_id,b_interval=early_id from sources.wi_sauk where source_id=78 and orig_id=gid and symbol='Pb_S';

update sources.wi_sauk set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name=age and l.interval_name=age;
update sources.wi_sauk set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleoproterozoic' and l.interval_name='Paleoproterozoic' and age='Early Proterozoic';

INSERT INTO maps.large (orig_id,source_id,name,descrip,age,t_interval,b_interval,geom) SELECT gid,78,use_name,descrip,age,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_sauk;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=78 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.wi_sauk_lines set new_type='anticline' where symbol='Anticline';
update sources.wi_sauk_lines set new_type='moraine' where symbol='Moraine';
update sources.wi_sauk_lines set new_type='fault' where symbol='Fault';
select distinct symbol from sources.wi_sauk_lines where symbol not in ('River cutbank','Block stream','Subsummit terrace','Direction of meltwater flow','Anticline arrow','Possible shore-ice collapse trench')
INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,78,new_type,ST_MakeValid(geom) FROM sources.wi_sauk_lines where symbol not in ('River cutbank','Block stream','Subsummit terrace','Direction of meltwater flow','Anticline arrow','Possible shore-ice collapse trench');

# ut_westwater source_id 79
SELECT distinct l.interval_name,e.interval_name,age from sources.ut_westwater join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,79,unitname,age,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_westwater;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=79 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ut_westwater -C -O burwell | gzip > ~/Desktop/ut_westwater.sql.gz

INSERT INTO lines.large (orig_id,source_id,name,type,new_type,descrip,geom) SELECT gid,79,notes,type,new_type,modifier,ST_MakeValid(geom) FROM sources.ut_westwater_lines;
pg_dump -t sources.ut_westwater_lines -C -O burwell | gzip > ~/Desktop/ut_westwater_lines.sql.gz

# ut_price source_id 80
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,80,unitname,age,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_price;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=80 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ut_price -C -O burwell | gzip > ~/Desktop/ut_price.sql.gz

pg_dump -t sources.ut_price_lines -C -O burwell | gzip > ~/Desktop/ut_price_lines.sql.gz
INSERT INTO lines.large (orig_id,source_id,name,new_type,descrip,geom) SELECT gid,80,notes,new_type,modifier,ST_MakeValid(geom) FROM sources.ut_price_lines;

# ut_panguitch source_id 81
update sources.ut_panguitch set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age_strat,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.ut_panguitch set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age_strat,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Pliocene' and age_strat ilike 'Pliocene to Miocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bathonian' and l.interval_name='Bathonian' and age_strat ilike 'Middle Jurassic, Bathonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Pliocene' and age_strat ilike 'early Pliocene to late Miocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pleistocene/Oligocene to Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to late Pleistocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Albian' and l.interval_name='Cenomanian' and age_strat ilike 'Cretaceous, Cenomanian to Albian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Lutetian' and l.interval_name='Priabonian' and age_strat ilike 'late and middle Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pleistocene/Late Cretaceous';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Pleistocene' and age_strat ilike 'late and middle Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to late Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Early Jurassic' and l.interval_name='Middle Jurassic' and age_strat ilike 'Middle to Early Jurassic';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bathonian' and l.interval_name='Callovian' and age_strat ilike 'Middle Jurassic, Callovian to Bathonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Pleistocene' and age_strat ilike 'lower? Pleistocene to Pliocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pleistocene/Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Eocene' and l.interval_name='Eocene' and age_strat ilike 'Eocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Pliocene' and age_strat ilike 'Pliocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Turonian' and l.interval_name='Turonian' and age_strat ilike 'Late Cretaceous, Turonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Late Pleistocene' and age_strat ilike 'late to middle? Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Middle Pleistocene' and age_strat ilike 'middle? Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Paleocene' and l.interval_name='Eocene' and age_strat ilike 'Eocene and Paleocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Turonian' and l.interval_name='Santonian' and age_strat ilike 'Late Cretaceous, Santonian to Turonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Late Pleistocene' and age_strat ilike 'late Pleistocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Pleistocene' and age_strat ilike 'Pleistocene? to Miocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Campanian' and l.interval_name='Campanian' and age_strat ilike 'Late Cretaceous, middle? Campanian?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Pleistocene' and age_strat ilike 'middle to early Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Historical to Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'late Holocene? to late Pleistocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Quaternary' and age_strat ilike 'Quaternary and Late Tertiary';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Lutetian' and l.interval_name='Lutetian' and age_strat ilike 'late middle Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Pleistocene' and age_strat ilike 'Pleistocene to Pliocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Campanian' and l.interval_name='Campanian' and age_strat ilike 'Late Cretaceous, middle? Campanian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Santonian' and l.interval_name='Santonian' and age_strat ilike 'Late Cretaceous, late Santonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Priabonian' and l.interval_name='Miocene' and age_strat ilike 'early Miocene and late Oligocene to late Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene and upper Pleistocene/Holocene to upper Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to middle Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Turonian' and l.interval_name='Santonian' and age_strat ilike 'Late Cretaceous, Santonian to late Turonian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'middle Holocene? to late Pleistocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Priabonian' and l.interval_name='Oligocene' and age_strat ilike 'early Oligocene to late Eocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Gelasian' and l.interval_name='Calabrian' and age_strat ilike 'early Plesitocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pliestocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene and late Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pliestocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to middle? Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliestocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pliocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pliocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Cenomanian' and l.interval_name='Cenomanian' and age_strat ilike 'Late Cretaceous, Cenomanian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Santonian' and l.interval_name='Maastrichtian' and age_strat ilike 'Late Cretaceous, Maastrichtian? to Santonian?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Campanian' and l.interval_name='Campanian' and age_strat ilike 'Late Cretaceous, middle? Campanian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Coniacian' and l.interval_name='Santonian' and age_strat ilike 'Late Cretaceous, Santonian to late Coniacian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Cenomanian' and l.interval_name='Turonian' and age_strat ilike 'Late Cretaceous, Turonian to Cenomanian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Late Pleistocene' and age_strat ilike 'late? Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene and late Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Middle Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to middle? Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Pleistocene' and l.interval_name='Holocene' and age_strat ilike 'Holocene to Pleistocene';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Bajocian' and l.interval_name='Bajocian' and age_strat ilike 'Middle Jurassic, Bajocian';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Miocene' and l.interval_name='Miocene' and age_strat ilike 'Miocene?';
update sources.ut_panguitch set early_id=m.id,late_id=l.id FROM macrostrat.intervals m, macrostrat.intervals l WHERE m.interval_name='Holocene' and l.interval_name='Holocene' and age_strat ilike 'Historical';


INSERT INTO maps.large (orig_id,source_id,name,age,lith,comments,t_interval,b_interval,geom) SELECT gid,81,unitname,age_strat,compositio,concat_ws('; ',genesis,notes),late_id,early_id,ST_MakeValid(geom) FROM sources.ut_panguitch;
insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=81 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.ut_panguitch -C -O burwell | gzip > ~/Desktop/ut_panguitch.sql.gz

update sources.ut_panguitch_lines set new_type='marker bed' where feature ilike 'Bed%';
update sources.ut_panguitch_lines set new_type='dike' where feature ilike 'Dike%';

pg_dump -t sources.ut_panguitch_lines -C -O burwell | gzip > ~/Desktop/ut_panguitch_lines.sql.gz
INSERT INTO lines.large (orig_id,source_id,name,type,new_type,new_direction,geom) SELECT gid,81,featurenam,feature,new_type,new_direction,ST_MakeValid(geom) FROM sources.ut_panguitch_lines;

http://ngmdb.usgs.gov/ngm-bin/ngm_search_dbi.pl?src_page=ngm_compsearch.pl&searchopt=undefined&key_search=&Title=national+park&Author=&Map+Number=&geologictheme=geolgenbed%3Bgeolgen&g_center=&g_zoom=&cqtype=None&State=&bc_ul=&bc_lr=&publisher_list=usgs&scale=&scale2=&datebgn=&dateend=&format=digital&dig_sub=&dig_sub=&dig_sub=&dig_sub=data


### ca_oakland 82
SELECT distinct l.interval_name,e.interval_name,age from sources.ut_westwater join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;


##
delete from sources.ca_oakland where gid in (2770,2769,310,2771,2693);
insert into sources.ca_oakland select * from from sources.oaklandgeology where gid in (2769,2770,310,2693,2771);
## reinserted some water to keep overlaps from happening

update sources.ca_oakland set descrip=title,title=gruping where descrip is null and gruping='Great Valley Complex';
update sources.ca_oakland set title='water' where ptype='H2O' and title is null;
	update sources.ca_oakland set descrip=title,title='Franciscan Complex' where descrip is null and title ilike 'Franciscan complex%';
update sources.ca_oakland set descrip='upper sandstone and shale member',title='Briones Sandstone' where descrip is null and title ilike 'Briones Sandstone, upper sandstone and shale member';
update sources.ca_oakland set descrip='lower sandstone and siltstone member',title='Briones Sandstone' where descrip is null and title ilike 'Briones Sandstone, lower sandstone and siltstone member';
update sources.ca_oakland set descrip='G member of Wagner (1978), conglomerate',title='Briones Sandstone' where descrip is null and title ilike 'Briones Sandstone, G member of Wagner (1978), conglomerate';
update sources.ca_oakland set descrip='interflow sedimentary rocks',title='Moraga Formation' where descrip is null and title ilike 'Moraga Formation, interflow sedimentary rocks';
update sources.ca_oakland set descrip=title,title=null where descrip is null and title ilike 'Unnamed%';
update sources.ca_oakland set descrip=title,title=null where descrip is null and title ilike 'Mudstone%';
update sources.ca_oakland set title=gruping,descrip=concat_ws('. ',title,descrip) where gruping='Franciscan Complex';
update sources.ca_oakland set title=gruping,descrip=concat_ws('. ',title,descrip) where gruping='Great Valley Complex' and title not ilike '%Formation%' and title not like 'Coast Range%' and title not like 'Pinehurst Shale' and title not like 'Oakland Conglomerate' and title not like 'Neroly %';
update sources.ca_oakland set descrip=concat_ws('. ',title,descrip),title=NULL where title ilike '%unnamed%';
update sources.ca_oakland set title='Oakland Conglomerate',descrip='Great Valley Complex; conglomerate' where descrip ilike '%Oakland Congl%';
update sources.ca_oakland set title='Great Valley Complex',descrip=concat_ws('. ',title,descrip) where title ilike 'Coast Range ophiolite%' and gruping='Great Valley Complex';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,82,title,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_oakland_unioned;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=82 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ca_oakland -C -O burwell | gzip > ~/Desktop/ca_oakland.sql.gz

insert into sources.ca_oakland_unioned select descrip,age,gruping,title,early_id,late_id,geom,gid from sources.oaklandgeology where gid in (2769,2770,310,2693,2771);
update sources.ca_oakland_unioned set title='water' where early_id IS NULL;

update sources.ca_oakland_lines set ltype='f.a., overturned anticline, approx. located' where ltype='f.a., f.a., overturned anticline, a';
update sources.ca_oakland_lines set ltype=replace(ltype,'@','');
update sources.ca_oakland_lines set ltype=replace(ltype,'s.s.','strike-slip');
update sources.ca_oakland_lines set ltype=replace(ltype,'f.a.','fold axis');
update sources.ca_oakland_lines set name='Hayward Fault zone' where gid in (615,696,2671,1625,3140,2045,2067,2055,1648,1625,1561,1558);
update sources.ca_oakland_lines set name='Moraga Fault' where gid in (1613,1818,1855,1665,1660,1657,287,337,3009);
update sources.ca_oakland_lines set name='Miller Creek Fault' where gid in (985,1059,1571,912,1575,1004);
update sources.ca_oakland_lines set name='Palomares Fault' where gid in (629,735);
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,82,name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_oakland_lines where geom is not null;
pg_dump -t sources.ca_oakland_lines -C -O burwell | gzip > ~/Desktop/ca_oakland_lines.sql.gz

# source_id 83 ca_point_reyes

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,83,name,age,descrip,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_point_reyes;
insert into sources.ca_point_reyes_lines SELECT gid+27,prgeolid,ltype,sel,symb,geom from sources.ca_point_reyes_faults;
update sources.ca_point_reyes_lines set new_type='anticline' where ltype ilike '%anticline%';
update sources.ca_point_reyes_lines set new_type='syncline' where ltype ilike '%syncline%';
update sources.ca_point_reyes_lines set new_type='fault' where ltype ilike '%fault%';

update sources.ca_point_reyes_lines set new_type='strike-slip fault',new_direction='right-lateral',name='San Andreas Fault' where gid in (58,85,108,137,166,60.97,143,178,41,106,112,123,187,34,64,71,102,107)
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,83,name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_point_reyes_lines;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=83 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

# source_id 84 ca_yosemite
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,84,name,age,descrip,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_yosemite;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=84 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
insert into maps.map_liths select large.map_id,liths.id,'name' from macrostrat.liths, maps.large WHERE large.source_id=84 and large.name IS NOT NULL and large.name ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,84,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_yosemite_lines;


# source_id 85 nv_las_vegas_cleaned
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,85,name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.nv_las_vegas_cleaned;
update sources.nv_las_vegas_cleaned set descrip='Light-gray to light-brown unconsolidated silt, sandy silt, silty sand, and mud; locally light-greenish-gray mud. Minor resistant light-gray calcare­ous mud that is partially cemented with calcite which weathers to curving and branching to platy nodules.' where unit='Qsu';

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,85,descriptio,new_type,new_direction,ST_MakeValid(geom) FROM sources.nv_las_vegas_lines;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=85 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

# source_id 86
update sources.ca_contracosta set description=name,name=NULL where name ilike 'Unnamed%' and description is null;
update sources.ca_contracosta set name=NULL,description='Tuffaceous sandstone and tuff containing pumice fragments.' where name='Tuff';
update sources.ca_contracosta set name=NULL,description='Shale and claystone, minor sandstone.' where name='Shale and claystone';
update sources.ca_contracosta set name=NULL,description='Siltstone and shale, upper member.' where name='Unnamed sandstone and shale, Upper member';
update sources.ca_contracosta set name=NULL,description='Glauconitic sandstone' where name='Unnamed sandstone and shale, Lower member';
update sources.ca_contracosta set name=NULL,description='Brown pebbly sandstone, conglomerate and siltstone.' where name='Unnamed conglomerate';
update sources.ca_contracosta set name=NULL where name ilike 'Unnamed%';
update sources.ca_contracosta set name=NULL,description='Massive, light gray, fine to medium-grained sandstone.' where name='Sandstone';
update sources.ca_contracosta set description=name,name=NULL where name='Mudstone, shale, and siltstone' and description is null;

update sources.ca_contracosta set name='Franciscan Complex',description='melange, sedimentary and volcaniclastic rocks' where name='Franciscan Complex, melange';
update sources.ca_contracosta set name='Franciscan Complex',description='hard graywacke and shale' where name='Franciscan Complex, hard graywacke and shale';
update sources.ca_contracosta set name='Franciscan Complex',description='greenstone' where name='Franciscan Complex, greenstone';
update sources.ca_contracosta set name='Franciscan Complex',description='chert' where name='Franciscan Complex, chert';
update sources.ca_contracosta set name='Franciscan Complex',description='basalt and chert' where name='Franciscan Complex, basalt and chert';

update sources.ca_contracosta set name='Markley Formation - Lower Member',description='lower siltstone bed' where name='Markley Formation - Lower Member, Lower siltstone bed';
update sources.ca_contracosta set name='Markley Formation - Upper Member',description='upper siltstone bed' where name='Markley Formation - Lower Member, Upper siltstone bed';
update sources.ca_contracosta set name='Great Valley sequence',description='Siltstone with minor shale, claystone, and sandstone' where name='Great Valley sequence, Siltstone with minor shale, claystone, and sandstone';

update sources.ca_contracosta set name='Great Valley sequence',description='Massive sandstone, minor siltstone' where name='Great Valley sequence, Massive sandstone, minor siltstone';
update sources.ca_contracosta set name='Great Valley sequence',description='Gray, massive quartz arenite' where name='Great Valley sequence, Gray, massive quartz arenite';
update sources.ca_contracosta set name='Franciscan Complex',description='sandstone (graywacke)' where name='Franciscan Complex, sandstone (graywacke)';
update sources.ca_contracosta set name=NULL,description='basalt' where name='basalt';

update sources.ca_contracosta set name='Briones Formation',description='Lower sandstone and siltstone member' where name='Briones Formation, Lower sandstone and siltstone member';
update sources.ca_contracosta set name='Briones Formation',description='Upper sandstone and shale member' where name='Briones Formation, Upper sandstone and shale member';

update sources.ca_contracosta set name='Coast Range Ophiolite',description='Pillow basalt, basalt breccia, and minor diabase' where name='Coast Range Ophiolite, Pillow basalt, basalt breccia, and minor diabase';
update sources.ca_contracosta set name='Escobar Sandstone of Weaver (1953)',description='sandstone and shale member' where name='Escobar Sandstone of Weaver (1953), sandstone and shale member';
update sources.ca_contracosta set name='Escobar Sandstone of Weaver (1953)',description='basal shale member' where name='Escobar Sandstone of Weaver (1953), basal shale member';
update sources.ca_contracosta set name=NULL,description='Light gray to white diatomite with minor brown shale.' where name='Diatomite';
update sources.ca_contracosta set name=NULL where name='Tuffaceous sandstone';
update sources.ca_contracosta set name=NULL,description='Greenish gray shale' where name='Greenish gray shale';


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,86,name,age,description,grouping,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_contracosta;
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,86,name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_contracosta_lines;

pg_dump -t sources.ca_contracosta_lines -C -O burwell | gzip > ~/Desktop/ca_contracosta_lines.sql.gz
pg_dump -t sources.ca_contracosta -C -O burwell | gzip > ~/Desktop/ca_contracosta.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=86 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

### source_id 88 ca_southsanfran
delete from sources.ca_southsanfran where gid IN (758,716,1180,1122,530,646);
update sources.ca_southsanfran set name=grouping where name='Sheared rocks' and grouping is not null;
update sources.ca_southsanfran set name='Franciscan Complex serpentinite' where name='Serpentinite' and grouping is not null;
update sources.ca_southsanfran set name='Franciscan Complex',age='Cretaceous and Jurassic',late_id=33,early_id=48 where gid in (990,1000);
update sources.ca_southsanfran set name='water' where name is null and ptype='water';
update sources.ca_southsanfran set early_id=3,late_id=3 where late_id is null and name='water';
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,88,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_southsanfran;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=88 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

update sources.ca_southsanfran_lines set ltype=replace(ltype,'f.a.','fold axis');
update sources.ca_southsanfran_lines set new_direction='right-lateral' where name ilike 'San And%';
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,88,name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_southsanfran_lines;

pg_dump -t sources.ca_southsanfran -C -O burwell | gzip > ~/Desktop/ca_southsanfran.sql.gz
pg_dump -t sources.ca_southsanfran_lines -C -O burwell | gzip > ~/Desktop/ca_southsanfran_lines.sql.gz

### source_id 89 joshuatree
update sources.joshuatree set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and early_id IS NULL;
update sources.joshuatree set early_id=m.id,late_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and early_id IS NULL;
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age ilike 'Cretaceous and Jurassic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age ilike 'Cretaceous and Jurassic?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age ilike 'Cretaceous or Jurassic?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age ilike 'Cretaceous or Jurassic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Jurassic' and age ilike 'Jurassic?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Jurassic' and l.interval_name='Late Jurassic' and age ilike 'Late(?) Jurassic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Mesoproterozoic' and l.interval_name='Neoproterozoic' and age ilike 'Mesoproterozoic or Neoproterozoic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Mesoproterozoic' and l.interval_name='Mesoproterozoic' and age ilike 'Mesozoic and (or) Proterozoic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleoproterozoic' and l.interval_name='Mesoproterozoic' and age ilike 'Mesoproterozoic or Paleoproterozoic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Proterozoic' and l.interval_name='Mesozoic' and age ilike 'Mesozoic and (or) Proterozoic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Proterozoic' and l.interval_name='Mesozoic' and age ilike 'Mesozoic and Proterozoic (?)';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Proterozoic' and l.interval_name='Mesozoic' and age ilike 'Mesozoic or Proterozoic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Proterozoic' and l.interval_name='Proterozoic' and age ilike 'Proterozoic?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age ilike 'Pleistocene and (or) Pliocene';

update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Miocene' and l.interval_name='Quaternary' and age ilike 'Quaternary and (or) Tertiary';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age ilike 'Quaternary or Tertiary; Pleistocene or Pliocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age ilike 'Quaternary(?) and Tertiary; Pleistocene(?) and Pliocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Quaternary, Anthropocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Quaternary, Holocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Quaternary, Holocene/Pleistocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pleistocene' and l.interval_name='Pleistocene' and age ilike 'Quaternary, Pleistocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Pleistocene' and l.interval_name='Middle Pleistocene' and age ilike 'Quaternary, Pleistocene, middle?';

update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Pleistocene' and l.interval_name='Middle Pleistocene' and age ilike 'Quaternary, Pleistocene, middle? and (or) lower?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Pleistocene' and l.interval_name='Middle Pleistocene' and age ilike 'Quaternary, Pleistocene, middle? and lower?';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age ilike 'Tertiary, Cretaceous, or Jurassic';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Eocene' and l.interval_name='Eocene' and age ilike 'Tertiary, Eocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Miocene' and l.interval_name='Late Miocene' and age ilike 'Tertiary, late and middle Miocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Miocene' and l.interval_name='Middle Miocene' and age ilike 'Tertiary, middle Miocene';
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pliocene' and l.interval_name='Pliocene' and age ilike 'Tertiary, Pliocene?';


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,89,unitname,age,descrip,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.joshuatree;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=89 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


insert into sources.joshuatree_faults (gid,geologicfe,earthmater,identityex,observabil,name,decriptor,geneticcla,geom) select gid+7000,geologicfe,geologicge,identityex,observabil,dikegroup,descriptor,geologicfr,geom from sources.joshuatree_dikes;
update sources.joshuatree_faults set new_type='strike-slip fault' where geneticcla like '%strike-slip%';
update sources.joshuatree_faults set new_type='thrust fault' where geneticcla like '%thrust%';
update sources.joshuatree_faults set new_type='normal fault' where geneticcla like '%normal%';
update sources.joshuatree_faults set new_type='thrust fault' where geneticcla like '%reverse%';
update sources.joshuatree_faults set new_type='fault' where new_type is null and geologicfe like 'fault%';
update sources.joshuatree_faults set new_type='dike' where new_type is null and geologicfe like 'dike%';
update sources.joshuatree_faults set new_direction='right-lateral' where  geneticcla like '%right-lateral%';
update sources.joshuatree_faults set new_direction='left-lateral' where geneticcla like '%left-lateral%';

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,new_type,new_direction,geom) SELECT gid,89,name,concat_ws(' ',descriptor,geologicfe),concat_ws('; ',identityex,observabil,sciencenot),new_type,new_direction,ST_MakeValid(geom) FROM sources.joshuatree_faults;

pg_dump -t sources.joshuatree_faults -C -O burwell | gzip > ~/Desktop/joshuatree_faults.sql.gz
pg_dump -t sources.joshuatree -C -O burwell | gzip > ~/Desktop/joshuatree.sql.gz


### ca_sanmateo 	source_id 90
SELECT distinct l.interval_name,e.interval_name,age from sources.ut_westwater join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
delete from sources.ca_sanmateo where gid IN (3554,3809,3620,3622);
update sources.ca_sanmateo set name='water' where name is null and ptype='H2O';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,90,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_sanmateo;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=90 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,90,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_sanmateo_lines;

update sources.ca_sanmateo_lines set name='San Andreas Fault' where gid in (1324,1327,3399,3586,1146,3750,1651,3837,2632,2773,5656,4446,4458,3309);

pg_dump -t sources.ca_sanmateo_lines -C -O burwell | gzip > ~/Desktop/ca_sanmateo_lines.sql.gz
pg_dump -t sources.ca_sanmateo -C -O burwell | gzip > ~/Desktop/ca_sanmateo.sql.gz

# ca_sanjose 91
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,91,name,age,description,block,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_sanjose;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,91,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_sanjose_lines;

pg_dump -t sources.ca_sanjose_lines -C -O burwell | gzip > ~/Desktop/ca_sanjose_lines.sql.gz
pg_dump -t sources.ca_sanjose -C -O burwell | gzip > ~/Desktop/ca_sanjose.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=91 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

# ca_sanjose 92
update sources.ca_northeastsanfran_lines set ltype=REPLACE(ltype,'f.a.','fold axis');

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,92,name,age,description,assemblage,late_id,early_id,ST_MakeValid((ST_Dump(geom)).geom) FROM sources.ca_northeastsanfran;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,92,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_northeastsanfran_lines;

pg_dump -t sources.ca_northeastsanfran -C -O burwell | gzip > ~/Desktop/ca_northeastsanfran.sql.gz
pg_dump -t sources.ca_northeastsanfran_lines -C -O burwell | gzip > ~/Desktop/ca_northeastsanfran_lines.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=92 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

# ca_northofsanfran source_id 93
update sources.ca_northofsanfran set name='water' where name is null and ptype='water';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,93,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_northofsanfran;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,93,faultname,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_northofsanfran_lines;

pg_dump -t sources.ca_northofsanfran_lines -C -O burwell | gzip > ~/Desktop/ca_northofsanfran_lines.sql.gz
pg_dump -t sources.ca_northofsanfran -C -O burwell | gzip > ~/Desktop/ca_northofsanfran.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=93 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#94 germany
update sources.germany set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Namurian' and l.interval_name='Namurian' and age ilike '%Namurian%';
update sources.germany set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Stephanian' and l.interval_name='Stephanian' and age ilike '%Stephanian%';
update sources.germany set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Westphalian' and l.interval_name='Westphalian' and age ilike '%Westphalian%';

INSERT INTO maps.small (orig_id,source_id,name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,94,name_eng,age,lithology,genesis,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.germany;
insert into maps.map_liths select small.map_id,liths.id,'lith' from macrostrat.liths, maps.small WHERE small.source_id=94 and small.lith IS NOT NULL and small.lith ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.small (orig_id,source_id,descrip,new_type,geom) SELECT gid,94,type,new_type,ST_MakeValid(geom) FROM sources.germany_lines;

#95 sweden
INSERT INTO maps.small (orig_id,source_id,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,95,age,lithology,concat_ws('; ',tect_unit,subunit),late_id,early_id,ST_MakeValid(geom) FROM sources.sweden;
insert into maps.map_liths select small.map_id,liths.id,'lith' from macrostrat.liths, maps.small WHERE small.source_id=95 and small.lith IS NOT NULL and small.lith ~* concat('\y',liths.lith,'\y');


pg_dump -t sources.sweden -C -O burwell | gzip > ~/Desktop/sweden.sql.gz

INSERT INTO lines.small (orig_id,source_id,descrip,new_type,geom) SELECT gid,95,concat_ws('; ',REPLACE(REPLACE(legend_en,' Tag points to upthrown block',''),' Tag points to downthrown block',''),lithology),new_type,ST_MakeValid(geom) FROM sources.sweden_lines;
pg_dump -t sources.sweden_lines -C -O burwell | gzip > ~/Desktop/sweden_lines.sql.gz


pg_dump -C --clean --no-owner -T sources.etopo1 -U john -h localhost -p 5432 burwell | gzip > /Volumes/database/backups/09.11.16.burwell.sql.gz


# 96 ca_alameda
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,96,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_alameda where gid not in (6);
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=96 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ca_alameda -C -O burwell | gzip > ~/Desktop/ca_alameda.sql.gz


INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,96,fname,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_alameda_lines;
pg_dump -t sources.ca_alameda_lines -C -O burwell | gzip > ~/Desktop/ca_alameda_lines.sql.gz


# 97 ar_jasper
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,97,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ar_jasper;
pg_dump -t sources.ar_jasper -C -O burwell | gzip > ~/Desktop/ar_jasper.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=97 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,97,descriptio,new_type,new_direction,ST_MakeValid(geom) FROM sources.ar_jasper_lines;
pg_dump -t sources.ar_jasper_lines -C -O burwell | gzip > ~/Desktop/ar_jasper_lines.sql.gz

# 98 ar_ponca
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,98,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ar_ponca;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=98 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.ar_ponca -C -O burwell | gzip > ~/Desktop/ar_ponca.sql.gz

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,98,name,description,new_type,new_direction,ST_MakeValid(geom) FROM sources.ar_ponca_lines;
pg_dump -t sources.ar_ponca_lines -C -O burwell | gzip > ~/Desktop/ar_ponca_lines.sql.gz

#99 az_prescott
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,99,name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.az_prescott;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=99 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.az_prescott -C -O burwell | gzip > ~/Desktop/az_prescott.sql.gz

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,99,type,new_type,new_direction,ST_MakeValid(geom) FROM sources.az_prescott_lines where new_type is not null;
pg_dump -t sources.az_prescott_lines -C -O burwell | gzip > ~/Desktop/az_prescott_lines.sql.gz

#100 wi_lacrosse
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,100,name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_lacrosse;
pg_dump -t sources.wi_lacrosse -C -O burwell | gzip > ~/Desktop/wi_lacrosse.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=100 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#101 nm_tularosa
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,101,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.nm_tularosa;
pg_dump -t sources.nm_tularosa -C -O burwell | gzip > ~/Desktop/nm_tularosa.sql.gz

update sources.nm_tularosa_lines set new_type='fault' where type='fault/dike';
update sources.nm_tularosa_lines set new_type='fault' where type='caldera margin';
update sources.nm_tularosa_lines set description = 'location inferred' where description is null and accuracy='inferred';
update sources.nm_tularosa_lines set description = 'concealed' where description is null and accuracy='concealed';
update sources.nm_tularosa_lines set description = 'approximately located' where description is null and accuracy='approximate';

INSERT INTO lines.large (orig_id,source_id,type,descrip,new_type,geom) SELECT gid,101,concat_ws(' ',faulttype,type),description,new_type,ST_MakeValid(geom) FROM sources.nm_tularosa_lines where new_type is not null;
pg_dump -t sources.nm_tularosa_lines -C -O burwell | gzip > ~/Desktop/nm_tularosa_lines.sql.gz

#102 ca_north_santabarb
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name) where member='Gould Shale Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Saltos Shale Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Painted Rock Sandstone Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Live Oak Sandstone Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Metralla Sandstone Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Piedra Blanca Sandstone Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Quail Canyon Sandstone Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Soda Lake Shale Member';
update sources.ca_north_santabarb set ru_name=concat_ws(' of ',member,ru_name), member=NULL where member='Uvas Conglomerate Member';

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,102,ru_name,age,description,member,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_north_santabarb;

pg_dump -t sources.ca_north_santabarb -C -O burwell | gzip > ~/Desktop/ca_north_santabarb.sql.gz

update sources.ca_north_santabarb_lines set name=NULL where name='**IM**';
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,102,name,descr,new_type,ST_MakeValid(geom) FROM sources.ca_north_santabarb_lines where new_type is not null;
pg_dump -t sources.ca_north_santabarb_lines -C -O burwell | gzip > ~/Desktop/ca_north_santabarb_lines.sql.gz

#103 new_river_gorge
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,103,name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.new_river_gorge;
pg_dump -t sources.new_river_gorge -C -O burwell | gzip > ~/Desktop/new_river_gorge.sql.gz
INSERT INTO lines.large (orig_id,source_id,name,new_type,geom) SELECT gid,103,notes,new_type,ST_MakeValid(geom) FROM sources.new_river_gorge_lines where new_type is not null;
pg_dump -t sources.new_river_gorge_lines -C -O burwell | gzip > ~/Desktop/new_river_gorge_lines.sql.gz

#104 wi_southeast
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,104,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_southeast;
pg_dump -t sources.wi_southeast -C -O burwell | gzip > ~/Desktop/wi_southeast.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=104 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,104,new_type,ST_MakeValid(geom) FROM sources.wi_southeast_lines;
pg_dump -t sources.wi_southeast_lines -C -O burwell | gzip > ~/Desktop/wi_southeast_lines.sql.gz

update maps.large set name='Thiensville Formation and Lake Church Formation, undifferentiated' where name='Theinsville Formation and Lake Church Formation, undifferentiated' where source_id=104;

update maps.large set name='Thiensville Formation' where name='Theinsville Formation' and source_id=104;
update sources.wi_southeast set name='Thiensville Formation' where name='Theinsville Formation';


#105 wv_gauley_river
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,105,name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wv_gauley_river;
pg_dump -t sources.wv_gauley_river -C -O burwell | gzip > ~/Desktop/wv_gauley_river.sql.gz
INSERT INTO lines.large (orig_id,source_id,name,new_type,geom) SELECT gid,105,name,new_type,ST_MakeValid(geom) FROM sources.wv_gauley_river_lines;
pg_dump -t sources.wv_gauley_river_lines -C -O burwell | gzip > ~/Desktop/wv_gauley_river_lines.sql.gz

#106 wy_rock_springs
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,106,name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_rock_springs where name is not null;
pg_dump -t sources.wy_rock_springs -C -O burwell | gzip > ~/Desktop/wy_rock_springs.sql.gz

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,106,name,type,new_type,ST_MakeValid(geom) FROM sources.wy_rock_springs_lines;
pg_dump -t sources.wy_rock_springs_lines -C -O burwell | gzip > ~/Desktop/wy_rock_springs_lines.sql.gz

update sources.wy_rock_springs_points set new_strike=strike+90;
update sources.wy_rock_springs_points set new_strike=new_strike-360 where new_strike>360;
INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,106,point_type,new_strike,dip,strike,ST_MakeValid(geom) FROM sources.wy_rock_springs_points where type not like 'C_Cone';
pg_dump -t sources.wy_rock_springs_points -C -O burwell | gzip > ~/Desktop/wy_rock_springs_points.sql.gz

#107 wi_sheboygan
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,t_interval,b_interval,geom) SELECT gid,107,name,agedisplay,desc_,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_sheboygan;
pg_dump -t sources.wi_sheboygan -C -O burwell | gzip > ~/Desktop/wi_sheboygan.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=107 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#108 san_salvador
update sources.san_salvador set unit=replace(unit,'of the', 'of');
update sources.san_salvador set unit='Undifferentiated rocks',description=comments,comments=NULL where description='Undifferentiated rocks' and unit is null;
update sources.san_salvador set unit=description,description=NULL where description='Unlithified' and unit IS NULL;
update sources.san_salvador set unit='Undifferentiated Pleistocene' where unit='Undifferentiated rocks';
update sources.san_salvador set description='predominately carbonate sand' where unit='Unlithified';
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,108,unit,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.san_salvador;
pg_dump -t sources.san_salvador -C -O burwell | gzip > ~/Desktop/san_salvador.sql.gz

update sources.san_salvador set unit=replace(unit,'Plesitocene','Pleistocene')
update maps.large set name=replace(name,'Plesitocene','Pleistocene') where source_id=108;

#109 devils_tower
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,109,name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.devils_tower;
pg_dump -t sources.devils_tower -C -O burwell | gzip > ~/Desktop/devils_tower.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=109 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,109,name,type,new_type,ST_MakeValid(geom) FROM sources.devils_tower_lines;
pg_dump -t sources.devils_tower_lines -C -O burwell | gzip > ~/Desktop/devils_tower_lines.sql.gz

#110 ar_hasty
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,110,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ar_hasty;
pg_dump -t sources.ar_hasty -C -O burwell | gzip > ~/Desktop/ar_hasty.sql.gz


INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,110,descriptio,new_type,ST_MakeValid(geom) FROM sources.ar_hasty_lines;
pg_dump -t sources.ar_hasty_lines -C -O burwell | gzip > ~/Desktop/ar_hasty_lines.sql.gz


INSERT INTO points.points (orig_id,source_id,point_type,comments,strike,dip,dip_dir,geom) SELECT gid,110,point_type,descriptio,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.ar_hasty_points where point_type is not NULL;
pg_dump -t sources.ar_hasty_points -C -O burwell | gzip > ~/Desktop/ar_hasty_points.sql.gz

#111 wa_sanjuan_island
UPDATE sources.wa_sanjuan_island set name='water' where name is null and glg_sym='water';
SELECT distinct l.interval_name,e.interval_name,age from sources.wa_sanjuan_island join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,111,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wa_sanjuan_island;
pg_dump -t sources.wa_sanjuan_island -C -O burwell | gzip > ~/Desktop/wa_sanjuan_island.sql.gz


INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,111,concat_ws(' ',replace(accuracy,'known or certain','known'),plunge,type),new_type,ST_MakeValid(geom) FROM sources.wa_sanjuan_island_lines;
pg_dump -t sources.wa_sanjuan_island_lines -C -O burwell | gzip > ~/Desktop/wa_sanjuan_island_lines.sql.gz



#112 ca_los_angeles
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,112,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_los_angeles;
pg_dump -t sources.ca_los_angeles -C -O burwell | gzip > ~/Desktop/ca_los_angeles.sql.gz

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,112,l_name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_los_angeles_lines;
pg_dump -t sources.ca_los_angeles_lines -C -O burwell | gzip > ~/Desktop/ca_los_angeles_lines.sql.gz


#113 honduras
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,113,unit,strat_name,age,lithology,lith,description,late_id,early_id,ST_MakeValid(geom) FROM sources.honduras;
pg_dump -t sources.honduras -C -O burwell | gzip > ~/Desktop/honduras.sql.gz

insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=113 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');

#114 venezuela
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,lith,t_interval,b_interval,geom) SELECT gid,114,name,strat_name,age,lith,late_id,early_id,ST_MakeValid(geom) FROM sources.venezuela;
insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=114 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');
pg_dump -t sources.venezuela -C -O burwell | gzip > ~/Desktop/venezuela.sql.gz

INSERT INTO lines.medium (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,114,type,new_type,new_direction,ST_MakeValid(geom) FROM sources.venezuela_lines;

pg_dump -t sources.venezuela_lines -C -O burwell | gzip > ~/Desktop/venezuela_lines.sql.gz

#115 ca_san_diego
SELECT distinct l.interval_name late,e.interval_name early,age from sources.ca_san_diego join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,115,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_san_diego where gid!=533;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,115,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_san_diego_lines;

INSERT INTO points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,115,strike,dip,new_direction,ST_MakeValid(geom) FROM sources.ca_san_diego_lines;

#116 ca_long_beach
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,116,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_long_beach;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=116 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.ca_long_beach -C -O burwell | gzip > ~/Desktop/ca_long_beach.sql.gz
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,116,feature_na,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_long_beach_lines;
pg_dump -t sources.ca_long_beach_lines -C -O burwell | gzip > ~/Desktop/ca_long_beach_lines.sql.gz

update sources.ca_long_beach_lines set new_direction='right-lateral' where ref_ltype ilike '%right lateral%';
update sources.ca_long_beach_lines set feature_na='Palos Verdes Fault Zone' where feature_na='PVFZ';
update sources.ca_long_beach_lines set ltype=replace(ltype,'f.a.','fold axis');

# strike,dip,dip_dir,point_type,certainty,comments,geomo,orig_id,source_id
INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,geom) SELECT gid,116,strike,dip,dip_dir,point_type,ST_MakeValid(geom) FROM sources.ca_long_beach_points where point_type is not null;
pg_dump -t sources.ca_long_beach_points -C -O burwell | gzip > ~/Desktop/ca_long_beach_points.sql.gz

#117 guam
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,117,concat_ws(', ',mapunit,formation),strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.guam;
pg_dump -t sources.guam -C -O burwell | gzip > ~/Desktop/guam.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=117 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#118 nova scotia
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,118,unit_name,strat_name,age_desc,description,late_id,early_id,ST_MakeValid(geom) FROM sources.nova_scotia;
insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=118 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.nova_scotia -C -O burwell | gzip > ~/Desktop/nova_scotia.sql.gz

INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,118,name,gcode_desc,new_type,ST_MakeValid(geom) FROM sources.nova_scotia_lines;
pg_dump -t sources.nova_scotia_lines -C -O burwell | gzip > ~/Desktop/nova_scotia_lines.sql.gz

update maps.medium set medium.name=s.name from sources.nova_scotia s where orig_id=gid and source_id=118;
update sources.joshuatree set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Pleistocene' and l.interval_name='Holocene' and age ilike 'Quaternary, Holocene/Pleistocene';

#119 ar_hotsprings_np
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,119,glg_name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ar_hotsprings_np;
pg_dump -t sources.ar_hotsprings_np -C -O burwell | gzip > ~/Desktop/ar_hotsprings_np.sql.gz

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,119,concat_ws('; ',type,age),new_type,new_direction,ST_MakeValid(geom) FROM sources.ar_hotsprings_np_lines;
pg_dump -t sources.ar_hotsprings_np_lines -C -O burwell | gzip > ~/Desktop/ar_hotsprings_np_lines.sql.gz

# strike,dip,dip_dir,point_type,certainty,comments,geom,orig_id,source_id
INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,119,strike,dip,dip_dir,point_type,type,ST_MakeValid(geom) FROM sources.ar_hotsprings_np_points;
pg_dump -t sources.ar_hotsprings_np_points -C -O burwell | gzip > ~/Desktop/ar_hotsprings_np_points.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=119 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#120 ar_buffalo_nriver
UPDATE sources.ar_buffalo_nriver set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
UPDATE sources.ar_buffalo_nriver set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
UPDATE sources.ar_buffalo_nriver set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
UPDATE sources.ar_buffalo_nriver set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'?','') ilike m.interval_name and late_id IS NULL;


update sources.ar_buffalo_nriver set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Morrowan' and l.interval_name='Morrowan' and age ilike 'Lower Pennsylvanian, Morrowan';
update sources.ar_buffalo_nriver set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Atokan' and l.interval_name='Atokan' and age ilike 'Middle Pennsylvanian, Atokan';
update sources.ar_buffalo_nriver set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Osagean' and l.interval_name='Meramecian' and age ilike 'Upper to Lower Mississippian, Meramecian to Osagean';
update sources.ar_buffalo_nriver set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Kinderhookian' and l.interval_name='Osagean' and age ilike 'Lower Mississippian, Osagean to Kinderhookian';
update sources.ar_buffalo_nriver set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Chesterian' and l.interval_name='Chesterian' and age ilike 'Upper Mississippian, Chesterian';

update sources.ar_buffalo_nriver set descrip='Unconsolidated silt, sand, and gravel. Active-channel gravel deposits are composed of subangular to rounded Paleozoic rock clasts of mixed lithology along drainages, and interspersed with bedrock exposures (not mapped). Low terraces of light-brown, fine sand to reddish-brown silt are present adjacent to streams and underlie smooth land surfaces that are 10–15 ft above base-flow level of streams. As thick as 15 ft' where unit='Qal';
update sources.ar_buffalo_nriver set descrip='Unconsolidated sand and gravel of Buffalo River. Terrace deposits are principally light-brown fine sand and have smooth upper surfaces that are about 20 ft above the base-flow level of river. Channel gravel is subangular to rounded and composed of clasts of Paleozoic sandstone, chert, and sparse dolostone and limestone; unmapped bedrock exposures are interspersed along channel. As thick as 20 ft' where unit='Qty';
update sources.ar_buffalo_nriver set descrip='Unconsolidated sand and gravel deposits adjacent to Buffalo River. Deposits are poorly exposed and are principally brown-weathered, fine sand but include basal zones of subrounded gravel containing pebbles to cobbles of Paleozoic sandstone and chert. Both basal strath and upper deposit surfaces are flat to gently sloping and are 30–45 ft and 65–100 ft above the base-flow level of river, respectively. Thickness 15–50 ft' where unit='Qtm';
update sources.ar_buffalo_nriver set descrip='Unconsolidated gravel and sand deposits adjacent to Buffalo River. Deposits are poorly exposed and are principally lag gravel of brown-weathered, subrounded to rounded, pebble- to cobble-sized clasts of Paleozoic sandstone and chert in a sandy matrix, locally overlain by fine sand, silt, and clay. Basal strath and upper deposit surfaces are flat to gently sloping and are 65–120 ft and 100–160 ft above the base-flow level of river, respectively. Thickness 15–50 ft' where unit='Qto1';
update sources.ar_buffalo_nriver set descrip='Poorly exposed, unconsolidated gravel and sand deposits adjacent to Buffalo River. Deposits are principally a lag of weathered, rounded to well-rounded clasts of Paleozoic sandstone and chert in a sandy matrix. Basal strath and upper deposit surfaces are flat to gently sloping and are 130–245 ft and 160–280 ft above the base-flow level of river, respectively. Thickness 5–45 ft' where unit='Qto2';
update sources.ar_buffalo_nriver set descrip='Unconsolidated deposits of subrounded to angular blocks as large as 20 ft in diameter, commonly in an orange-brown silty clay matrix. Blocks are mostly derived from the basal sandstone of the upper part of the Bloyd Formation or the Cane Hill Member of the Hale Formation. Deposits have fan-like morphology and were mapped where sufficiently thick to mask typical ledge-flat topography of underlying bedrock. Smaller, thinner colluvial deposits elsewhere were not mapped. Thickness as great as 60 ft' where unit='Qc';
update sources.ar_buffalo_nriver set descrip='Large slide blocks of limestone, sandstone, and shale derived from the Lower Pennsylvanian Bloyd Formation through the Upper Mississippian Fayetteville Shale. Upper parts of slides are semi-coherent stratigraphic sequences that are back tilted into hillsides and down-dropped relative to bedrock. Lower parts of slides root in deformed lower part of Fayetteville Shale' where unit='Ql';
update sources.ar_buffalo_nriver set descrip='Remnant erosional blocks of Upper Mississippian Batesville Sandstone (Mbv) in sinkholes and along faults within the underlying main body of the Upper and Lower Mississippian Boone Formation (Mb) in eastern part of map area. Deposits are characterized by tabular sandstone blocks with moderately rounded edges 1 to 4 ft in diameter and interspersed with chert. Deposits interpreted to be related to late-stage karst development' where unit='Qbx';
update sources.ar_buffalo_nriver set descrip='Alternating shale, siltstone, and sandstone intervals underlying highest hills of map area. Where exposed, shale throughout unit is fissile and dark gray to black. Siltstone is thin bedded with ripple cross-lamination. Sandstone intervals vary from common tan, very fine to fine-grained, ripple to planar bedded to less common white, medium- to coarse-grained, medium planar-bedded with sparse white quartz pebbles. Thickness as much as 100 ft' where unit='Pa';
update sources.ar_buffalo_nriver set descrip='Dominantly sandstone with interbedded siltstone and shale. Upper part of sequence contains dark-gray to black shale and siltstone beds that form topographic flats interbedded with sandstone beds that form ledges. Upper sandstone intervals are 5–20 ft thick and vary from orange-brown, fine- to coarse-grained with local quartz pebbles, and medium to thick planar bedded to crossbedded, to tan or olive, fine- to very fine grained, ripple cross-laminated to planar bedded. Base of unit is crossbedded sandstone as thick as 80 ft that forms prominent cliffs. This basal sandstone is white to light-brown, fine- to medium-grained quartz arenite that has a sharp erosional base and is commonly a composite of several tabular and trough-crossbed sets. Sandstone contains local concentrations of white quartz pebbles and casts of wood fragments. Rocks of the upper part of the Bloyd Formation were originally assigned to the now abandoned Winslow Formation by Purdue and Miser (1916). Zachry (1977) concluded that the basal sandstone was a time-equivalent unit with the Woolsey Member of the Bloyd Formation farther west and designated it informally as the “middle Bloyd sandstone.” Thickness 200–300 ft' where unit='Pbu';
update sources.ar_buffalo_nriver set descrip='Sequence of predominantly dark-gray to black shale and siltstone with thin beds of sandstone and limestone; poorly exposed under moderate to steep hillslopes. Siltstone is medium to dark gray, fissile, and moderately bioturbated. Medium beds of rippled, very fine grained sandstone are locally exposed as ledges. Coarse bioclastic limestone is reddish gray, weathers dark brown, and is present in lower part of sequence. Thickness 90–120 ft' where unit='Pbl';
update sources.ar_buffalo_nriver set descrip='Brown to reddish-brown, fine- to medium-grained, thick-bedded, calcite-cemented sandstone. Locally contains quartz pebbles in its base and thin interbeds of fossiliferous limestone. Beds are planar or crossbedded, and crossbeds may have bi-directional dips. Weathered sandstone forms rounded surfaces. Sandstone forms steep hillslopes or ledges that are commonly covered by slope debris from overlying units. Thickness 10–60 ft' where unit='Phg';
update sources.ar_buffalo_nriver set descrip='Interbedded sequence of shale, siltstone, and sandstone. Most of unit is poorly exposed dark-gray fissile shale and thin-bedded siltstone that form gentle to moderately steep slopes. Upper part locally contains rippled, thin-bedded, very-fine and fine-grained sandstone intervals as thick as 5 ft. Lower part includes 10-ft-thick sandstone interval that changes downward from olive-brown, very fine-grained, thin-bedded sandstone with ripple cross-lamination to reddish-brown, medium- to thick-bedded, very-fine grained to medium-grained sandstone with trough crossbeds. Lower sandstone contains sparse casts of wood fragments and conglomerate lenses with quartz pebbles and angular to subrounded clasts of shale, siltstone, and sandstone. Unit unconformably overlies the Pitkin Limestone or Fayetteville Shale. Thickness 80–240 ft' where unit='Phc';
update sources.ar_buffalo_nriver set descrip='Generally medium- to dark-gray, fetid limestone; commonly forms a prominent ledge or steep slope. Limestone in medium to thick wavy beds varies from micrite at base to coarse grained and locally oolitic near top. Limestone beds may contain abundant crinoids, brachiopods, corals, and bryozoan Archimedes. Basal contact with the Fayetteville Shale is conformable. Thickness 0–100 ft' where unit='Mp';
update sources.ar_buffalo_nriver set descrip='Brown to light-gray, well-indurated, calcite-cemented sandstone and siltstone. The Wedington caps a steep slope and is commonly separated from the overlying Pitkin Limestone by a topographic bench. Sandstone is very fine grained and is present in thick to thin planar beds with internal parallel laminations and locally developed low-angle crossbeds. Sandstone grades downward into siltstone beds that are ripple cross-laminated and bioturbated. The Wedington grades downward into main body. Thickness 0–40 ft' where unit='Mfw';
update sources.ar_buffalo_nriver set descrip='Below the Wedington Sandstone Member, the Fayetteville Shale is poorly exposed black shale that locally contains thin, rippled beds of olive-brown siltstone near its top. The lower part of the Fayetteville crops out along stream gullies where it consists of black fissile shale that may contain medium- to light-gray, fetid septarian concretions as large as 2 ft in diameter. The Fayetteville Shale is susceptible to landslides. Thickness 10–460 ft' where unit='Mf';
update sources.ar_buffalo_nriver set descrip='Fine-grained to very fine-grained, light- to medium-brown, calcite-cemented sandstone with sparse interbedded limestone. Thin to medium beds are typically parallel laminated; low-angle crossbeds common in upper part of unit. Sandstone commonly contains burrows on bedding planes and breaks into thin flat blocks. One or more discontinuous, 1- to 3-ft-thick, medium- to dark-gray, fetid, fossiliferous limestone beds are commonly interbedded with sandstone; limestone beds contain crinoids and brachiopods. Both sandstone and limestone beds may contain 2- to 10-mm-diameter oxidized pyrite framboids that weather to reddish-brown spheres. Where stripped of the overlying Fayetteville Shale, the top of the Batesville forms topographic flats. Unit hosts sinkholes formed by collapse into dissolution cavities in the underlying Boone Formation. Thickness 5–60 ft' where unit='Mbv';
update sources.ar_buffalo_nriver set descrip='Mediumto thick-bedded, chert-bearing bioclastic limestone. Limestone is light- to medium-gray on fresh surfaces and generally coarsely crystalline with interspersed crinoid ossicles. A 1- to 3-ft-thick bed of oolitic limestone is common in upper part of unit. Beds of dense, fine-grained limestone are present in upper one-third of unit. Beds are typically parallel and planar to wavy, but channel fills are locally present in lower part of unit. Chert content varies vertically and laterally within the Boone and forms lenticular to anastomosing lenses. Chert-rich horizons are generally poorly exposed but produce abundant float of white-weathered chert on hillslopes. Chert in uppermost part of unit contains prominent brachiopod molds. Thickness 310–350 ft' where unit='Mb';
update sources.ar_buffalo_nriver set descrip='Thin- and wavy-bedded bioclastic limestone containing ubiquitous 3- to 6-mm-wide crinoid fragments in a finely crystalline matrix. Limestone is commonly pink to red on fresh surfaces due to hematite in matrix, but color varies depending on hematite concentration. Lenticular red to pink chert nodules are locally present in upper part. Contact with overlying main body of Boone Formation is gradational and marked by increase in chert and thicker beds upward. Middle to lower part of St. Joe Limestone Member contains greenish-gray shale interbeds. Base of St. Joe is a 0.3- to 8-ft-thick, very fine to fine-grained, moderately sorted, tan sandstone containing phosphate pebbles. Unit unconformably overlies Silurian rocks, Cason Shale, Fernvale Limestone, Plattin Limestone, St. Peter Sandstone, or upper part of Everton Formation. Total thickness of member is 10–50 ft' where unit='Mbs';
update sources.ar_buffalo_nriver set descrip='Medium- to massive-bedded, light-pink, light-gray, and red micrite to coarsely crystalline limestone of the Lafferty Limestone, St. Clair Limestone, and Brassfield Limestone. Lafferty Limestone only observed as a dense micrite whereas St. Clair and Brassfield Limestones are more often medium to coarsely crystalline fossiliferous limestone and contain pyrite framboids and calcite-filled vugs. Preserved in structural lows in the eastern portion of the map area. Cumulative thickness up to 95 ft, although no more than 60 ft observed in any one location' where unit='Su';
update sources.ar_buffalo_nriver set descrip='Green, tan, black, and blue-green, poorly exposed, fissile shale and siltstone that is occasionally dolomitic. Contains phosphate-replaced fossils and abundant, polished phosphate nodules from sand to pebble size and oxidized pyrite framboids. Outcrop limited to eastern part of map area. Thickness 0–15 ft' where unit='Ocs';
update sources.ar_buffalo_nriver set descrip='Thick- to massive-bedded, coarsely crystalline bioclastic limestone. Limestone is light gray to pink on fresh surfaces and contains abundant 3- to 10-mm-wide cylindrical to barrel-shaped crinoid ossicles in a coarsely crystalline matrix. Thickness 0–20 ft' where unit='Of';
update sources.ar_buffalo_nriver set descrip='Thin- to medium-planar-bedded, fine-grained, dense limestone locally interbedded with calcarenite. Characteristically, dense, very fine grained, medium-gray limestone that breaks with conchoidal fracture and weathers to very light gray, thin, tabular blocks. Locally in upper part contains interbeds of laminated, tan to light-gray, fine-grained to very fine grained, limey to dolomitic calcarenite as thick as 10 ft; calcarenite has fetid odor when freshly broken. Thickness 0–100 ft' where unit='Opl';
update sources.ar_buffalo_nriver set descrip='Very fine-grained, grayish-yellow sandstone interbedded with blue-green siltstone, shale, and sparse dolostone. Sandstone is calcite-cemented arenite containing well-rounded quartz grains. Upper part of unit, as thick as 25 ft, is sandstone interbedded with blue-green fissile shale, thin-bedded siltstone, and sparse 0.5- to 3-ft-thick beds of brown-gray, fine crystalline dolostone; shale, siltstone, and dolostone interval is commonly marked by zone of slumped sandstone blocks on hillslopes. Main part of unit contains a sequence of 1- to 2-ft-thick sandstone beds overlying a massive basal sandstone ledge as thick as 20 ft. Bioturbation is common in most sandstone beds and includes cylindrical burrows (Skolithos) perpendicular to bedding that weather to distinctive straw-like forms. Basal sandstone is crossbedded, contains inclined fractures, and discordantly overlies Everton Formation. Thickness 0–70 ft' where unit='Osp';
update sources.ar_buffalo_nriver set descrip='Interbedded dolostone, sandstone, and limestone. Limestone is finely crystalline, light gray, thick bedded, locally fossiliferous, and is present in intervals as thick as 20 ft. Dolostone is light to dark gray, finely to medium crystalline, laminated and medium- to thick-bedded and commonly contains sandstone stringers. Sandstone is arenite composed of well-sorted, well-rounded, fine to medium quartz grains. Sandstone is light tan to white in planar, medium to thick beds and is variably cemented by dolomite or calcite; sandstone locally grades into sandy dolostone or limestone. Limestone interbedded with limy sandstone and lesser dolostone at top of unit composes Jasper Member of Glick and Frezon (1953). Dolostone and dolomitic sandstone underlying Jasper Member make up most of upper part of Everton. Base of upper part of Everton is marked by base of Newton Sandstone Member (McKnight, 1935), a planar, medium-bedded quartz arenite composed of well-sorted, well-rounded, fine to medium quartz grains. Newton Sandstone Member is 10–100 ft thick. Upper part of Everton Formation is 110–200 ft thick' where unit='Oeu';
update sources.ar_buffalo_nriver set descrip='Interbedded dolostone, sandstone, and limestone. Limestone is restricted to upper part of unit and is interbedded with dolostone and sandstone. Limestone is light gray, finely crystalline, thin to medium bedded, commonly laminated, and contains sparse stromatolite hemispheres as large as 1 ft in diameter. Dolostone, present throughout unit, is light gray to grayish brown, finely to medium crystalline, thin to thick bedded, and commonly laminated, and it commonly contains stromatolites. Sandstone is light-tan to white quartz arenite, composed of well-sorted, well-rounded, fine to medium grains, variably cemented by dolomite or calcite. Sandstone intervals, composed of planar, thin to medium beds as thick as 6 ft, are present throughout unit. Sandstone also forms lenses and stringers within limestone and dolostone intervals. Light- to dark-brownish-gray dolostone and sandy dolostone interspersed with sandstone are predominant in lower part of unit. Collapse breccia with clasts of planar laminated dolostone and dolomitic sandstone is present. Unit is 140–250 ft thick' where unit='Oel';
update sources.ar_buffalo_nriver set descrip='Fine-grained, thin-bedded, argillaceous dolostone with dark-gray shale interbeds. Dolostone beds are medium to thin, wavy, and commonly laminated and stromatolitic. Yellowish gray on fresh surfaces. Weathers to thin, platy blocks. Unit is about 200 ft thick in the only complete section exposed in Hemmed-In Hollow in the western part of the area' where unit='Op';
update sources.ar_buffalo_nriver set descrip='Brownish-gray dolomite with sparse chert nodules. Chert composed of concentric, alternating dark-gray and white bands within elongate nodules that are concentrated in dolomite beds in the upper part of the formation. Only the upper 20–30 ft of unit are exposed along Hemmed-In Hollow (Ponca quadrangle) in the western part of the map area' where unit='Oc';

update sources.ar_buffalo_nriver set strat_name='Boone Formation' where unit='Mb';
update sources.ar_buffalo_nriver set strat_name='St. Joe Limestone Member' where unit='Mbs';
update sources.ar_buffalo_nriver set strat_name='Batesville Sandstone' where unit='Mbv';
update sources.ar_buffalo_nriver set strat_name='Fayetteville Shale' where unit='Mf';
update sources.ar_buffalo_nriver set strat_name='Wedington Sandstone Member' where unit='Mfw';
update sources.ar_buffalo_nriver set strat_name='Pitkin Limestone' where unit='Mp';
update sources.ar_buffalo_nriver set strat_name='Cotter Dolomite' where unit='Oc';
update sources.ar_buffalo_nriver set strat_name='Cason Shale' where unit='Ocs';
update sources.ar_buffalo_nriver set strat_name='Everton Formation' where unit='Oel';
update sources.ar_buffalo_nriver set strat_name='Everton Formation' where unit='Oeu';
update sources.ar_buffalo_nriver set strat_name='Powell Dolomite' where unit='Op';
update sources.ar_buffalo_nriver set strat_name='Plattin Limestone' where unit='Opl';
update sources.ar_buffalo_nriver set strat_name='St. Peter Sandstone' where unit='Osp';
update sources.ar_buffalo_nriver set strat_name='Atoka Formation' where unit='Pa';
update sources.ar_buffalo_nriver set strat_name='Bloyd Formation' where unit='Pbl';
update sources.ar_buffalo_nriver set strat_name='Bloyd Formation' where unit='Pbu';
update sources.ar_buffalo_nriver set strat_name='Cane Hill Member' where unit='Phc';
update sources.ar_buffalo_nriver set strat_name='Praire Grove Member' where unit='Phg';
update sources.ar_buffalo_nriver set strat_name='Fernvale Limestone' where unit='Of';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,120,descriptio,strat_name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.ar_buffalo_nriver;

update sources.ar_buffalo_nriver_lines set new_type='anticline',new_direction='' where descriptio like 'Anticline %';
update sources.ar_buffalo_nriver_lines set new_type='monocline',new_direction='' where descriptio like 'Monocline %';
update sources.ar_buffalo_nriver_lines set new_type='fault',new_direction='' where descriptio like 'Fault %';
update sources.ar_buffalo_nriver_lines set new_type='normal fault',new_direction='' where descriptio like 'Normal fault %';
update sources.ar_buffalo_nriver_lines set new_type='strike-slip fault',new_direction='right-lateral' where descriptio like '%right-lateral, strike-%';
update sources.ar_buffalo_nriver_lines set new_type='strike-slip fault',new_direction='left-lateral' where descriptio like '%left-lateral, strike-%';
update sources.ar_buffalo_nriver_lines set new_type='thrust fault',new_direction='' where descriptio like 'Reverse %';
update sources.ar_buffalo_nriver_lines set new_type='strike-slip fault',new_direction='right-lateral' where descriptio like 'Strike-slip fault, right-lateral%';
update sources.ar_buffalo_nriver_lines set new_type='syncline',new_direction='' where descriptio like 'Syncline %';
update sources.ar_buffalo_nriver_lines set new_type='thrust fault',new_direction='' where descriptio='Thrust %';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
update sources.ar_buffalo_nriver_lines set new_type='',new_direction='' where descriptio='';
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,120,fault_name,descriptio,new_type,new_direction,ST_MakeValid(geom) FROM sources.ar_buffalo_nriver_lines;

pg_dump -t sources.ar_buffalo_nriver_lines -C -O burwell | gzip > ~/Desktop/ar_buffalo_nriver_lines.sql.gz
pg_dump -t sources.ar_buffalo_nriver -C -O burwell | gzip > ~/Desktop/ar_buffalo_nriver.sql.gz

#121 mn_washington_co
# HAD to fix a buch of typos in lithology

UPDATE sources.mn_washington_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_washington_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_washington_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_washington_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'?','') ilike m.interval_name and late_id IS NULL;
update sources.mn_washington_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Ordovician' and l.interval_name='Late Ordovician' and age ilike 'Middle to Upper Ordovician';
update sources.mn_washington_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Middle to Upper Cambrian';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,t_interval,b_interval,geom) SELECT gid,121,descript,descript,age,trim(trailing ', ' from concat('Major:: {',main_lith,'}, ',second_lith)),late_id,early_id,ST_MakeValid(geom) FROM sources.mn_washington_co;
pg_dump -t sources.mn_washington_co -C -O burwell | gzip > ~/Desktop/mn_washington_co.sql.gz

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,121,descriptn,ST_MakeValid(geom) FROM sources.mn_washington_co_lines;
pg_dump -t sources.mn_washington_co_lines -C -O burwell | gzip > ~/Desktop/mn_washington_co_lines.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=121 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

## source_id 122 mn_houston_co
update sources.mn_houston_co set major_lith=lower(major_lith),litho_modi=lower(litho_modi),minor_lith=lower(minor_lith);
update sources.mn_houston_co set strat_name=descriptn;
update sources.mn_houston_co set strat_name='Platteville Formation; Glenwood Formation' where descriptn='Platteville and Glenwood Formations';

UPDATE sources.mn_houston_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_houston_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_houston_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_houston_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'?','') ilike m.interval_name and late_id IS NULL;
update sources.mn_houston_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Ordovician' and l.interval_name='Late Ordovician' and age ilike 'Middle to Upper Ordovician';
update sources.mn_houston_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Middle to Upper Cambrian';
SELECT distinct l.interval_name late,e.interval_name early,age from sources.mn_houston_co join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

update sources.mn_houston_co set descrip_long='Limestone interbedded with shale. The limestone is yellowish-gray to yellowish-brown, shaley, fossiliferous, and fine-grained with thin and crinkly bedding. The shale is green to gray and calcareous. Exposures weather to a serrated profile because of the alternating shale beds. Unit forms ledges where it caps small plateaus in southwest Houston County. Thickness exceeds 80 feet (24 meters) locally.' where map_label='Oc';
update sources.mn_houston_co set descrip_long='Fossiliferous green-gray shale with thin interbeds of yellowish-gray fossiliferous limestone. Limestone beds are more abundant at the base. The maximum thickness ranges from 30 to 35 feet (9 to 11 meters).' where map_label='Od';
update sources.mn_houston_co set descrip_long='The Platteveille Formation is fossiliferous, thin- to medium-bedded, light gray to tan, finely crystalline limestone with thin gray shale partings. Quartz sand grains and dark phosphate clasts are present at the base. Unit forms ledges where it caps small plateaus in southwest Houston County. Maximum thickness ranges from 25 to 30 feet (8 to 9 meters). The Glenwood Formation is sandy, green-gray shale. It contains dark phosphatic grains throughout. Thin, fine- to coarse-grained, quartzose sandstone lenses are common. The maximum thickness ranges from 3 to 6 feet (1 to 2 meters).' where map_label='Opg';
update sources.mn_houston_co set descrip_long='Mostly fine- to medium-grained, poorly cemented, white to orange, quartzose sandstone. Sand grains are moderately- to well-rounded and well-sorted. The sandstone is structureless, and less commonly, shows subtle cross stratification. The lower St. Peter Sandstone is more feldspathic and shaley, but this part of the formation is not exposed in the region. There is an unconformity at the basal contact with the Shakopee Formation (Smith and others, 1993). The uppermost surface is generally iron crusted and burrowed. The St. Peter Sandstone is commonly exposed along hill slopes that are capped by the Platteville and Glenwood Formations. The maximum thickness of the St. Peter Sandstone ranges from 70 to 90 feet (21 to 27 meters).' where map_label='Os';
update sources.mn_houston_co set descrip_long='Tan to gray dolostone, sandy dolostone, and sandstone divided into two members (Austin, 1971). The Willow River Member is composed of thin- to medium-bedded dolomite, sandy dolomite, and thin quartz sandstone and minor shale beds. The dolostone and sandy dolostone beds contain an oomoldic texture as well as oolites and stromatolite fossils. Chert nodules are common. The Willow River Member is generally 60 to 80 feet (18 to 24 meters) thick. The New Richmond Member represents the basal 15 to 40 feet (5 to 12 meters) of the Shakopee Formation. It is composed mainly of fine- to medium-grained quartzose sandstone with low-angle cross bedding and can be locally cemented by quartz or stained reddish-brown by hematite. There is an unconformity at the contact with the underlying Oneota Dolomite (Smith and others, 1993). The maximum thickness of the Shakopee Formation is 90 to 120 feet (27 to 37 meters).' where map_label='Ops';
update sources.mn_houston_co set descrip_long='The Oneota Dolomite is divided into two members. The Hager City Member is composed of medium to thick, irregular tabular beds of dolostone and silty dolostone. The dolostone is light tan to light gray and fine-grained crystalline, and may be intraclastic in the lowermost part. It contains white to gray chert nodules and calcite filled vugs throughout, though they are more common in the upper and lowermost parts. The uppermost part may also be brecciated near the contact with the overlying Shakopee Formation. The upper and lower thirds of the Hager City Member contain stromatolitic and thrombolitic microbial textures. The intervening section consists of medium sized beds that are internally structureless or faintly laminated. The thickness of the Hager City Member is 145 to 160 feet (44 to 49 meters). The underlying Coon Valley Member consists of interbedded sandstone, sandy dolostone, dolostone, and minor shale. It commonly contains stromatolites, oolites, and an oomoldic texture. The thickness of the Coon Valley Member is about 20 to 50 feet (6 to 15 meters). There is an unconformity at the base with the contact of the Jordan Sandstone that contains pebbles of Precambrian rocks up to two centimeters in diameter (Runkel and others, 1999, 2007). The maximum thickness of the Oneota Dolomite is 170 to 200 feet (52 to 61 meters).' where map_label='Opo';
update sources.mn_houston_co set descrip_long='Dominantly whitish-tan to orange, very fine- to coarse-grained, quartzose, friable sandstone. Characterized by coarsening-upward sequences of two interlayered facies (Runkel, 1994), which are not separated on the map. They are medium- to coarse-grained, commonly bioturbated, with trough or tabular cross stratification and a fine-grained, feldspathic, burrow-mottled facies with hummocky cross stratification. The maximum thickness of the formation is 80 to 100 feet (24 to 30 meters).' where map_label='Cj';
update sources.mn_houston_co set descrip_long='Mostly well-cemented, thin to medium beds of tan to gray to pink siltstone, dolomitic siltstone, very fine-grained sandstone, and very thin shale. The very fine-grained sandstone is common in the upper 20 feet (6 meters) of the unit. Glauconite is present throughout, but more common in the lower 30 feet (9 meters) of the formation. Intraclastic beds are present near the top and at the base of the unit. Small scale hummocky cross stratification and small and large diameter horizontal burrow traces can be found throughout the formation. The contact with the underlying Lone Rock Formation is marked by the base of an intraclastic conglomerate with rounded flat pebbles and cobbles of siltstone and sandstone. The maximum thickness is 60 to 70 feet (18 to 21 meters).' where map_label='Cs';
update sources.mn_houston_co set descrip_long='Formerly referred to as the Franconia Formation (Mossler, 2008). Fine-grained, glauconite-rich, feldspathic sandstone and siltstone with interbedded green and gray shale and pink to tan, sandy, glauconitic dolostone. It is composed of three members: in ascending order, the Birkmose, Tomah, and the Reno Members. The Birkmose Member is a glauconitic sandstone with a well cemented, intraclastic, reddish-brown dolomite bed. The Tomah Member consists of interbedded sandstone and shale with very little glauconite. The Reno Member is composed of bioturbated, glauconitic sandstone with thin beds of flat pebble conglomerate, especially in the upper 40 feet (12 meters). Hummocky cross stratification is common throughout the formation. High-angle trough and planar cross stratification and extensive bioturbation are common in the upper half of the formation and in the lowest 15 feet (5 meters) of the formation. Generally the Lone Rock Formation is coarser-grained and more poorly cemented than the St. Lawrence Formation. The Lone Rock Formation conformably overlies the Wonewoc Sandstone. The maximum thickness of the formation is 135 to 150 feet (41 to 46 meters).' where map_label='Clr';
update sources.mn_houston_co set descrip_long='Formerly referred to as the Ironton and Galesville Sandstones (Mossler, 2008). Fine- to very coarse-grained, weakly cemented, quartzose sandstone. The upper 40 feet (12 meters) are more poorly sorted than the lower part and contain coarser-grained sandstone grains and abundant shale beds. White, brown, or black fossil shell fragments (phosphatic brachiopods) are locally common in the upper 10 to 15 feet (3 to 5 meters) of the formation. A subtle disconformity exists within the formation and is locally capped by a pebbly, coarse- to very coarse-gained sandstone bed that lies roughly in the middle of the formation, though it is almost unrecognizable in the field (Runkel and others, 1998). The lower 60 to 80 feet (18 to 24 meters) of the Wonewoc Sandstone is well to moderately sorted, fine- to medium-grained, quartz sandstone with minor shale, siltstone, and very fine-grained sandstone beds. It has trough cross stratification and minor glauconite. The lower part locally intertongues with the feldspathic, very fine-grained, quartz sandstone of the underlying Eau Claire Formation. The maximum thickness of the formation is 110 to 130 feet (34 to 40 meters).' where map_label='Cw';
update sources.mn_houston_co set descrip_long='Gray to greenish-gray to purple shale, tan to gray siltstone, and very fine- to fine-grained sandstone. Gray to black fossil shell fragments are common (phosphatic brachiopods). The sandstone is variably glauconitic. The formation coarsens upward, with sandstone becoming increasingly abundant. The upper 10 to 20 feet (3 to 6 meters) are mostly very fine-grained sandstone and siltstone. The maximum thickness ranges from 115 to 150 feet (35 to 46 meters).' where map_label='Ce';
update sources.mn_houston_co set descrip_long='Not exposed in the county. Mostly white to yellow, fine- to very coarse-grained, friable, quartzose sandstone. The top of the Mt. Simon Sandstone is marked locally by a thin iron stained sandstone that contains abundant black fossil shell fragments (phosphatic brachiopods). Variegated beds of feldspathic-rich shale, siltstone, and very fine-grained sandstone are common, particularly in the upper two-thirds of the formation. Pebble conglomerate or pebbly sandstone is common in the lower 50 feet (15 meters) of the formation, especially in the lowest few feet. Limited subsurface data indicate that the Mt. Simon Sandstone is 300 to 350 feet (91 to 107 meters) thick.' where map_label='Cm';
update sources.mn_houston_co set descrip_long='Not exposed in the county; shown only on the cross sections. Samples from deep water wells near La Crescent, and Winona and Lewiston to the north, penetrated the Mt. Simon Sandstone and intersected Precambrian rock. Drill core indicate that these rocks are granitic to tonalitic gneiss of probable Proterozoic and Archean ages. Geophysical data indicate a broad range of metamorphic and igneous rock units are present beneath the Paleozoic strata (Jirsa and others, 2012).' where map_label='pC';

update sources.mn_houston_co set primary_lith=concat_ws(' ',major_lith,litho_modi);
update sources.mn_houston_co set secondary_lith=concat('Minor:: {',minor_lith,'}') where minor_lith is not null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,122,descriptn,strat_name,age,trim(trailing ', ' from concat('Major:: {',primary_lith,'}, ',secondary_lith)),descrip_long,late_id,early_id,ST_MakeValid(geom) FROM sources.mn_houston_co;

pg_dump -t sources.mn_houston_co -C -O burwell | gzip > ~/Desktop/mn_houston_co.sql.gz
pg_dump -t sources.mn_houston_co_lines -C -O burwell | gzip > ~/Desktop/mn_houston_co_lines.sql.gz

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,122,descriptn,ST_MakeValid(geom) FROM sources.mn_houston_co_lines;

#source_id 123 mn_winona_co
update sources.mn_winona_co set major_lith=lower(major_lith),litho_modi=lower(litho_modi),minor_lith=lower(minor_lith);
update sources.mn_winona_co set strat_name=descriptn;
update sources.mn_winona_co set strat_name='Platteville Formation; Glenwood Formation' where descriptn='Platteville and Glenwood Formations';
UPDATE sources.mn_winona_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_winona_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Upper','Late') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_winona_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'Lower','Early') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_winona_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(age,'?','') ilike m.interval_name and late_id IS NULL;
update sources.mn_winona_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Ordovician' and l.interval_name='Late Ordovician' and age ilike 'Middle to Upper Ordovician';
update sources.mn_winona_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age ilike 'Middle to Upper Cambrian';

update sources.mn_winona_co set descrip_long='Limestone interbedded with shale. The limestone is yellowish-gray to yellowish-brown, shaley, fossiliferous,
and fine-grained with thin and crinkly bedding. The shale is green to gray and calcareous. Exposures weather to a serrated profile because of the alternating shale beds.Unit forms ledges where it caps small plateaus in southwest Winona County. Thickness exceeds 70 feet (21 meters) locally.' where map_label='Oc';

update sources.mn_winona_co set descrip_long='Fossiliferous green-gray shale with thin interbeds of yellowish-gray fossiliferous limestone. Limestone beds are more abundant at the base. The maximum thickness ranges from 30 to 40 feet (9 to 12 meters).' where map_label='Od';
update sources.mn_winona_co set descrip_long='The Platteville Formation is fossiliferous, thin- to medium-bedded, light gray to tan, finely crystalline limestone with thin gray shale partings. Quartz sand grains and dark phosphate clasts are present at the base. Unit forms ledges where it caps small plateaus in southwest Winona County. Maximum thickness ranges from 20 to 25 feet (6 to 8 meters). The Glenwood Formation is sandy, green-gray shale. It contains dark phosphatic grains throughout. Thin, fine-to coarse-grained, quartzose sandstone lenses are common. The maximum thickness ranges from 3 to 6 feet (1 to 2 meters).' where map_label='Opg';
update sources.mn_winona_co set descrip_long='Mostly fine- to medium- grained, poorly cemented, white to orange, quartzose sandstone. Sand grains are moderately- to well-rounded and well-sorted. The sandstone is generally structureless, and less commonly, shows subtle cross stratification. The lower St. Peter Sandstone is more feldspathic and shaley, but this part of the formation is not exposed in the region. There is an unconformity at the basal contact with the Shakopee Formation (Smith and others, 1993). The uppermost surface is generally iron crusted and burrowed. The St. Peter Sandstone is commonly exposed along hill slopes that are capped by the Platteville and Glenwood Formations. The maximum thickness of the St. Peter Sandstone ranges from 70 to 90 feet (21 to 27 meters).' where map_label='Os';
update sources.mn_winona_co set descrip_long='Tan to gray dolostone, sandy dolostone, and sandstone divided into two members (Austin, 1971). The Willow River Member is composed of thin- to medium-bedded dolomite, sandy dolomite, and thin quartz sandstone and minor shale beds. The dolostone and sandy dolostone beds contain an oomoldic texture as well as oolites and stromatolite fossils. Chert nodules are common. The Willow River Member is generally 60 to 80 feet (18 to 24 meters) thick. The New Richmond Member represents the basal 15 to 40 feet (5 to 12 meters) of the Shakopee Formation. It is composed mainly of fine- to medium-grained quartzose sandstone with low-angle cross bedding and can be locally cemented by quartz or stained reddish-brown by hematite. The lowermost New Richmond Member may locally contain less than 10 feet (3 meters) of oolitic sandy dolostone and sandstone beds known as the Prairie Island facies and is present in the western part of Winona County. There is an unconformity at the contact with the underlying Oneota Dolomite (Smith and others, 1993). The maximum thickness of the Shakopee Formation is 90 to 120 feet (27 to 37 meters).' where map_label='Ops';
update sources.mn_winona_co set descrip_long='The Oneota Dolomite is divided into two members. The Hager City Member is composed of medium to thick, irregular tabular beds of dolostone and silty dolostone. The dolostone is light tan to light gray and fine-grained crystalline, and may be intraclastic in the lowermost part. It contains white to gray chert nodules and calcite filled vugs throughout, though they are more common in the upper and lowermost parts. The uppermost part may also be brecciated near the contact with the overlying Shakopee Formation. The upper and lower thirds of the Hager City Member contain stromatolitic and thrombolitic microbial textures. The intervening section consists of beds of medium thickness that are internally structureless or faintly laminated. The thickness of the Hager City Member is 145 to 160 feet (44 to 49 meters). The underlying Coon Valley Member consists of interbedded sandstone, sandy dolostone, dolostone, and minor shale. It commonly contains stromatolites, oolites, and an oomoldic texture. The thickness of the Coon Valley Member is about 15 to 50 feet (6 to 15 meters). There is an unconformity at the base with the contact of the Jordan Sandstone that contains pebbles of Precambrian rocks up to two centimeters in diameter (Runkel and others, 1999, 2007). The maximum thickness of the Oneota Dolomite is 160 to 180 feet (49 to 55 meters).' where map_label='Opo';
update sources.mn_winona_co set descrip_long='Dominantly whitish-tan to orange, very fine- to coarse-grained, quartzose, friable sandstone. Characterized by coarsening-upward sequences of two interlayered facies (Runkel, 1994), which are not separated on the map. They are medium- to coarse-grained, commonly bioturbated, with trough or tabular cross stratification and a fine-grained, feldspathic, burrow-mottled facies with hummocky cross stratification. The maximum thickness of the formation is 80 to 100 feet (24 to 30 meters).' where map_label='Cj';
update sources.mn_winona_co set descrip_long='Mostly well-cemented, thin to medium beds of tan to gray to pink siltstone, dolomitic siltstone, very fine-grained sandstone, and very thin shale. The very fine-grained sandstone is common in the upper 20 feet (6 meters) of the unit. Glauconite is present throughout, but more common in the lower 30 feet (9 meters) of the formation. Intraclastic beds are present near the top and at the base of the unit. Small-scale hummocky cross stratification and small and large diameter horizontal burrow traces can be found throughout the formation. The contact with the underlying Lone Rock Formation is marked by the base of an intraclastic conglomerate with rounded flat pebbles and cobbles of siltstone and sandstone. The maximum thickness is 60 to 70 feet (18 to 21 meters).' where map_label='Cs';
update sources.mn_winona_co set descrip_long='Formerly referred to as the Franconia Formation (Mossler, 2008). Fine-grained, glauconite-rich, feldspathic sandstone and siltstone with interbedded green and gray shale and pink to tan, sandy, glauconitic dolostone. It is composed of three members: in ascending order, the Birkmose, Tomah, and the Reno Members. The Birkmose Member is a glauconitic sandstone with a well cemented, intraclastic, reddish-brown dolomite bed. The Tomah Member consists of interbedded sandstone and shale with very little glauconite. The Reno Member is composed of bioturbated, glauconitic sandstone with thin beds of flat pebble conglomerate, especially in the upper 40 feet (12 meters). Hummocky cross stratification is common throughout the formation. High-angle trough and planar cross stratification and extensive bioturbation are common in the upper half of the formation and in the lowest 15 feet (5 meters) of the formation. Generally the Lone Rock Formation is coarser-grained and more poorly cemented than the St. Lawrence Formation. The Lone Rock Formation conformably overlies the Wonewoc Sandstone. The maximum thickness of the formation is 150 to 160 feet (46 to 49 meters).' where map_label='Clr';
update sources.mn_winona_co set descrip_long='Formerly referred to as the Ironton and Galesville Sandstones (Mossler, 2008). Fine- to very coarse-grained, weakly cemented, quartzose sandstone. The upper 40 feet (12 meters) are more poorly sorted than the lower part and contain coarser-grained sandstone grains and abundant shale beds. White, brown, or black fossil shell fragments (phosphatic brachiopods) are locally common in the upper 10 to 15 feet (3 to 5 meters) of the formation. A subtle disconformity exists within the formation and has been noted to be locally capped by a pebbly, coarse- to very coarse-grained sandstone bed that lies roughly in the middle of the formation, though it is almost unrecognizable in the field (Runkel and others, 1998). The lower 60 to 80 feet (18 to 24 meters) of the Wonewoc Sandstone is well to moderately sorted, fine- to medium-grained, quartz sandstone with minor shale, siltstone, and very fine-grained sandstone beds. It has trough cross stratification and minor glauconite. The lower part locally intertongues with the feldspathic, very fine-grained, quartz sandstone of the underlying Eau Claire Formation. The maximum thickness of the Wonewoc Formation is 100 to 120 feet (30 to 37 meters).' where map_label='Cw';
update sources.mn_winona_co set descrip_long='Gray to greenish-gray to purple shale, tan to gray siltstone, and very fine- to fine-grained sandstone. Gray to black fossil shell fragments are common (phosphatic brachiopods). The sandstone is variably glauconitic. The formation coarsens upward, with sandstone becoming increasingly abundant. The upper 10 to 20 feet (3 to 6 meters) are mostly very fine-grained sandstone and siltstone. The maximum thickness ranges from 110 to 130 feet (34 to 40 meters).' where map_label='Ce';
update sources.mn_winona_co set descrip_long='Not exposed in the county. Mostly white to yellow, fine- to very coarse-grained, friable, quartzose sandstone. The top of the Mt. Simon Sandstone is marked locally by a thin iron stained sandstone that contains abundant black fossil shell fragments (phosphatic brachiopods). Variegated beds of feldspathic-rich shale, siltstone, and very fine-grained sandstone are common, particularly in the upper two-thirds of the formation. Pebble conglomerate or pebbly sandstone is common in the lower 50 feet (15 meters) of the formation, especially in the lowest few feet. Limited subsurface data indicate that the Mt. Simon Sandstone is as much as 300 to 350 feet (91 to 107 meters) thick.' where map_label='Cm';
update sources.mn_winona_co set primary_lith=concat_ws(' ',major_lith,litho_modi);
update sources.mn_winona_co set secondary_lith=concat('Minor:: {',minor_lith,'}') where minor_lith is not null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,123,descriptn,strat_name,age,trim(trailing ', ' from concat('Major:: {',primary_lith,'}, ',secondary_lith)),descrip_long,late_id,early_id,ST_MakeValid(geom) FROM sources.mn_winona_co;

insert into sources.mn_winona_co_lines (gid,name,geom) select gid+8,'fault',geom from sources.mn_winona_co_faults;
INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,123,name,ST_MakeValid(geom) FROM sources.mn_winona_co_lines;

pg_dump -t sources.mn_winona_co -C -O burwell | gzip > ~/Desktop/mn_winona_co.sql.gz
pg_dump -t sources.mn_winona_co_lines -C -O burwell | gzip > ~/Desktop/mn_winona_co_lines.sql.gz


#source_id 124 mn_redwood_co
UPDATE sources.mn_redwood_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE era ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_redwood_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(era,'Upper','Late') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_redwood_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(era,'Lower','Early') ilike m.interval_name and late_id IS NULL;
UPDATE sources.mn_redwood_co set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(era,'?','') ilike m.interval_name and late_id IS NULL;
update sources.mn_redwood_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleoarchean' and l.interval_name='Neoarchean' and era ilike 'Neoarchean to Paleoarchean';

update sources.mn_redwood_co set descriptn='Franklin diabase dike',major_lith='diabase',era='Paleoproterozoic',descrip_long='A closely spaced pair of anastomosing, west– northwest-trending diabase dikes exposed south of Franklin. Dikes vary in width from 100 to more than 150 feet (30 to 46 meters), and locally appear from outcrop distribution to merge and bifurcate. Collectively, these dikes produce an irregular, linear, aeromagnetic low implying reversed magnetic polarity, which is substantiated by polarity measurements of samples (Chandler, unpub. data). Samples yielded a Pb-Pb zircon age of 2,067.3 ± 0.7 Ma (Schmitz and others, 2006). The dikes and adjacent gneissic wall rocks (unit Amg) are quarried locally and crushed for construction aggregate.' where maplabel='Ppf'

UPDATE sources.mn_redwood_co set secondary_lith=concat('Minor:: {',minor_lith,'}') where minor_lith is not null;
insert into sources.mn_redwood_co (gid,label,maplabel,geom) select gid+221,maplabel,maplabel,geom from sources.mn_redwood_co_surficial where maplabel='KP';
update sources.mn_redwood_co set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Cenomanian' and l.interval_name='Turonian' and label='KP'
update sources.mn_redwood_co set major_lith='clay,mudstone,shale' where label='KP';
update sources.mn_redwood_co set minor_lith='sandstone,lignite' where label='KP';

update sources.mn_redwood_co set strat_name='Cedar Mountain Complex' where label in ('Pcm','Pcd');
update sources.mn_redwood_co set strat_name='Sacred Heart Granite' where label in ('Asg','Asa');
update sources.mn_redwood_co set strat_name='Morton Gneiss' where label in ('Amg','Amp','Amn','Amt','Ama');

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,124,unit_name,strat_name,era,trim(trailing ', ' from concat('Major:: {',major_lith,'}, ',secondary_lith)),descrip_long,terrane_ag,late_id,early_id,ST_MakeValid(geom) FROM sources.mn_redwood_co;

insert into sources.mn_redwood_co_faults (gid,line_type,geom) select gid+69,line_type,geom from sources.mn_redwood_co_folds where line_type in ('syncline','anticline');
insert into sources.mn_redwood_co_faults (gid,line_type,geom) select gid+950,'dike',geom from sources.mn_redwood_co_dikes;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,124,description,line_type,ST_MakeValid(geom) FROM sources.mn_redwood_co_lines;

pg_dump -t sources.mn_redwood_co -C -O burwell | gzip > ~/Desktop/mn_redwood_co.sql.gz
pg_dump -t sources.mn_redwood_co_lines -C -O burwell | gzip > ~/Desktop/mn_redwood_co_lines.sql.gz

#125 colombia
update sources.colombia set name=ugintegrad;
INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,125,ugintegrad,trim(strat_name),age,trim(description),comments,late_id,early_id,ST_MakeValid(geom) FROM sources.colombia;

INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,125,nombrefall,trim(description),trim(new_type),ST_MakeValid(geom) FROM sources.colombia_lines where tectonica is null;
pg_dump -t sources.colombia -C -O burwell | gzip > ~/Desktop/colombia.sql.gz
pg_dump -t sources.colombia_lines -C -O burwell | gzip > ~/Desktop/colombia_lines.sql.gz

insert into maps.map_liths select medium.map_id,liths.id,'descrip' from macrostrat.liths, maps.medium WHERE medium.source_id=125 and medium.descrip IS NOT NULL and medium.descrip ~* concat('\y',liths.lith,'\y');

#126 tanzania_oldonyo
update sources.tanzania_oldonyo set lithology=null where gid=392;
update sources.tanzania_oldonyo set strat_name='Gelai Sandstone' where strat_name='Gelai sandstone';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,126,unit_name,strat_name,age,description,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.tanzania_oldonyo;

update sources.tanzania_oldonyo_lines set new_type='fracture' where descriptio ilike '%crack%' and new_type is null;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,126,concat_ws('; ',descriptio,age,note),new_type,ST_MakeValid(ST_Force2D(geom)) FROM sources.tanzania_oldonyo_lines;
pg_dump -t sources.tanzania_oldonyo_lines -C -O burwell | gzip > ~/Desktop/tanzania_oldonyo_lines.sql.gz
pg_dump -t sources.tanzania_oldonyo -C -O burwell | gzip > ~/Desktop/tanzania_oldonyo.sql.gz

#127 wy_laramie
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,127,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_laramie;
SELECT distinct l.interval_name late,e.interval_name early,age from sources.wy_laramie join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,127,ltype,new_type,ST_MakeValid(geom) FROM sources.wy_laramie_lines;
pg_dump -t sources.wy_laramie -C -O burwell | gzip > ~/Desktop/wy_laramie.sql.gz
pg_dump -t sources.wy_laramie_lines -C -O burwell | gzip > ~/Desktop/wy_laramie_lines.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=127 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


#128 co_grandjunction
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,128,name,strat_name,age,description,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.co_grandjunction;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,128,type,new_type,ST_MakeValid(geom) FROM sources.co_grandjunction_lines;
pg_dump -t sources.co_grandjunction_lines -C -O burwell | gzip > ~/Desktop/co_grandjunction_lines.sql.gz
pg_dump -t sources.co_grandjunction -C -O burwell | gzip > ~/Desktop/co_grandjunction.sql.gz

insert into maps.map_liths select large.map_id,liths.id,'lith' from macrostrat.liths, maps.large WHERE large.source_id=128 and large.lith IS NOT NULL and large.lith ~* concat('\y',liths.lith,'\y');

#129 wy_sheridan
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,129,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_sheridan;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,129,faults,new_type,ST_MakeValid(geom) FROM sources.wy_sheridan_lines;

pg_dump -t sources.wy_sheridan -C -O burwell | gzip > ~/Desktop/wy_sheridan.sql.gz
pg_dump -t sources.wy_sheridan_lines -C -O burwell | gzip > ~/Desktop/wy_sheridan_lines.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=129 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#130 ma_glouster
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,130,name,strat_name,age,descriptio,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ma_glouster where gid!=4;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,130,descriptio,new_type,ST_MakeValid(geom) FROM sources.ma_glouster_lines;
pg_dump -t sources.ma_glouster -C -O burwell | gzip > ~/Desktop/ma_glouster.sql.gz
pg_dump -t sources.ma_glouster_lines -C -O burwell | gzip > ~/Desktop/ma_glouster_lines.sql.gz

#131 ca_oceanside
SELECT distinct l.interval_name late,e.interval_name early,age from sources.ca_oceanside join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

update sources.ca_oceanside set name='Old paralic deposits' where name=' ';
update sources.ca_oceanside set name=ptype where name is null;
update sources.ca_oceanside set hierarchy=NULL where hierarchy ilike '%facies%';
update sources.ca_oceanside set hierarchy=strat_name,strat_name=hierarchy where hierarchy ilike '% Member';
update sources.ca_oceanside set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Pleistocene' and l.interval_name='Late Pleistocene' and age like 'Late to Middle Pleistocene' and early_id is null;
delete from sources.ca_oceanside_lines where ltype ilike '%contact%';
update sources.ca_oceanside_lines set new_type='slide' where ltype ilike 'block glide arrow';
update sources.ca_oceanside_lines set new_type='slump' where ltype ilike 'slump arrow';
update sources.ca_oceanside_lines set new_type='landslide' where ltype ilike 'landslide arrow';
update sources.ca_oceanside_lines set new_type='flow' where ltype ilike 'sediment flow arrow';
update sources.ca_oceanside_lines set new_type='flow' where ltype ilike 'active channel transport arrow';
update sources.ca_oceanside_lines set new_type='scarp' where ltype ilike 'slump scarp';
update sources.ca_oceanside_lines set new_type='scarp' where ltype ilike 'erosional scarp';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,131,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_oceanside;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,131,ltype,new_type,ST_MakeValid(geom) FROM sources.ca_oceanside_lines where new_type is not null;
INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,131,strike,dip,dip_dir,point_type,pttype,ST_MakeValid(geom) FROM sources.ca_oceanside_points where point_type is not null;

pg_dump -t sources.ca_oceanside_points -C -O burwell | gzip > ~/Desktop/ca_oceanside_points.sql.gz
pg_dump -t sources.ca_oceanside -C -O burwell | gzip > ~/Desktop/ca_oceanside.sql.gz
pg_dump -t sources.ca_oceanside_lines -C -O burwell | gzip > ~/Desktop/ca_oceanside_lines.sql.gz
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=131 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

#132 co_greatsanddunes
update sources.co_greatsanddunes set strat_name=name where name like '%Formation';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,132,name,strat_name,age,description,lithology,late_id,early_id,ST_MakeValid(geom) FROM sources.co_greatsanddunes;
pg_dump -t sources.co_greatsanddunes -C -O burwell | gzip > ~/Desktop/co_greatsanddunes.sql.gz
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,132,descriptio,new_type,ST_MakeValid(geom) FROM sources.co_greatsanddunes_lines;
pg_dump -t sources.co_greatsanddunes_lines -C -O burwell | gzip > ~/Desktop/co_greatsanddunes_lines.sql.gz


#133 gmus2 (!)
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Proterozoic' from macrostrat.intervals e where e.interval_name='Proterozoic' and unit_link='WApCA;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Proterozoic' from macrostrat.intervals e where e.interval_name='Proterozoic' and unit_link='CApCAc;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Proterozoic' from macrostrat.intervals e where e.interval_name='Proterozoic' and unit_link='CApCA2;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Precambrian' from macrostrat.intervals e where e.interval_name='Precambrian' and unit_link='CApCA1;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Precambrian' from macrostrat.intervals e where e.interval_name='Precambrian' and unit_link='CAgrpCA?;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Precambrian' from macrostrat.intervals e where e.interval_name='Precambrian' and unit_link='CAgrpCA4;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Precambrian' from macrostrat.intervals e where e.interval_name='Precambrian' and unit_link='CAgrpCA3;0';
update sources.gmus2 set early_id=e.id,late_id=e.id,age='Proterozoic' from macrostrat.intervals e where e.interval_name='Proterozoic' and unit_link='CAgrpCA1;0';

select * from maps.medium where source_id=133 and lith like '%detrital%';
update maps.medium set lith=replace(lith,'detrital','alluvium') where lith like '%detrital%' and source_id=133;


insert into maps.map_liths select medium.map_id,liths.id,'lith' from macrostrat.liths, maps.medium WHERE medium.source_id=133 and medium.lith IS NOT NULL and medium.lith ~* concat('\y',liths.lith,'\y');

WITH arr as (SELECT age_min,string_to_array(age_min,' - ') rr,age_max,string_to_array(age_max,' - ') ss from sources.gmus2) select arr.rr[array_length(arr.rr, 1)] minage, arr.ss[array_length(arr.rr, 1)] maxage from arr where arr.age_min not like arr.age_max

WITH arr as (SELECT age_min,string_to_array(age_min,' - ') rr from sources.gmus2) update sources.gmus2 set agemin=arr.rr[array_length(arr.rr, 1)] from arr;

update sources.gmus2 set agemax_text=agemax[array_length(agemax,1)];
update sources.gmus2 set agemin_text=agemin[array_length(agemin,1)];
update sources.gmus2 set agemin_text=replace(agemin_text,'-',' ');
update sources.gmus2 set agemax_text=replace(agemax_text,'-',' ');

update sources.gmus2 set agemax_text='Darriwilian' where agemax_text='Darriwillian';
update sources.gmus2 set agemin_text='Darriwilian' where agemin_text='Darriwillian';
update sources.gmus2 set agemax_text='Proterozoic' where agemax_text='preCambrian Proterozoic';
update sources.gmus2 set agemin_text='Proterozoic' where agemin_text='preCambrian Proterozoic';
update sources.gmus2 set agemax_text='Paleogene' where agemax_text='Tertiary Paleogene';
update sources.gmus2 set agemin_text='Paleogene' where agemin_text='Tertiary Paleogene';
update sources.gmus2 set agemax_text='Neogene' where agemax_text='Tertiary Neogene';
update sources.gmus2 set agemin_text='Neogene' where agemin_text='Tertiary Neogene';
update sources.gmus2 set agemax_text='Archean' where agemax_text='preCambrian Archean';
update sources.gmus2 set agemin_text='Archean' where agemin_text='preCambrian Archean';
update sources.gmus2 set agemax_text='Precambrian' where agemax_text='preCambrian';
update sources.gmus2 set agemin_text='Precambrian' where agemin_text='preCambrian';
update sources.gmus2 set agemax_text='Olenekian' where agemax_text='Olenikian';
update sources.gmus2 set agemin_text='Olenekian' where agemin_text='Olenikian';
update sources.gmus2 set agemax_text='Lochkovian' where agemax_text='Lockhovian';
update sources.gmus2 set agemin_text='Lochkovian' where agemin_text='Lockhovian';

update sources.gmus2 set early_id=m.id from macrostrat.intervals m where agemax_text like interval_name;
update sources.gmus2 set late_id=m.id from macrostrat.intervals m where agemin_text like interval_name;

update gmus_attributes set strat_unit=replace(strat_unit,'Fm.','Formation');
update gmus_attributes set strat_unit=replace(strat_unit,'FM','Formation');
update gmus_attributes set strat_unit=replace(strat_unit,'Ss','Sandstone');
update gmus_attributes set unit_name=concat_ws(': ',strat_unit,unit_name), strat_unit=unit_name where strat_unit='Fleming Formation';

update sources.gmus2 set other_lith=concat('Incidental:{',incidental,'}') where incidental is not null;
update sources.gmus2 set minor_lith=concat('Minor:{',concat_ws(',',minor1,minor2,minor3,minor4,minor5),'}') where minor1 is not null;
update sources.gmus2 set major_lith=concat('Major:{',concat_ws(',',major1,major2,major3),'}') where major1 is not null;

INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,comments,lith,t_interval,b_interval,geom) SELECT gid,133,unit_name,strat_name,age,descrip,unit_comments,concat_ws(', ',major_lith,minor_lith,other_lith),late_id,early_id,ST_MakeValid(geom) FROM sources.gmus2 where gid not in (288902,186298,23907,42514,65416,108537,275356,73157,111999,68398,73556,164533,156234,197989,156316,54986,54381,289469);
UPDATE maps.medium set descrip=comments where descrip is null and comments is not null and source_id=133;
update maps.medium set comments=trim(concat(maps.medium.comments,' Original map source: ',m.reference)) from sources.gmus2 m where source_id=133 and gid=orig_id and reference not like 'Polygons%' and reference not like 'SGMC%' and reference not like 'When using%';

update sources.gmus2_lines set line_name=misc where misc ilike '% anticline';
update sources.gmus2_lines set line_name=misc where misc ilike '% nose';
update sources.gmus2_lines set line_name=misc where misc ilike '%Hamilton-King City-Quitman';
update sources.gmus2_lines set line_name=misc where misc ilike '% fault';
update sources.gmus2_lines set line_name=misc where misc ilike '% arch';
update sources.gmus2_lines set line_name=misc where misc ilike '% zone';
update sources.gmus2_lines set line_name=misc where misc ilike '% complex';
update sources.gmus2_lines set line_name=misc where misc ilike '% system';
update sources.gmus2_lines set line_name=misc where misc ilike '% structure';
update sources.gmus2_lines set line_name=misc where misc ilike '% structures';
update sources.gmus2_lines set line_name=misc where misc ilike '% graben';
update sources.gmus2_lines set line_name=misc where misc ilike '% fold';
update sources.gmus2_lines set line_name=misc where misc ilike '% anticline';
update sources.gmus2_lines set line_name=misc where misc ilike '% uplift';
update sources.gmus2_lines set line_name=misc where misc ilike '% terrace';
update sources.gmus2_lines set line_name='King anticline' where misc='King antilcline';
update sources.gmus2_lines set line_name=misc where misc ilike '% terrace';
update sources.gmus2_lines set line_name=misc where misc ilike '% axis';
update sources.gmus2_lines set line_name=misc where misc ilike '% monocline';
update sources.gmus2_lines set line_name=misc where misc ilike '% grabon';
update sources.gmus2_lines set line_name=misc where misc ilike '% monocline';
update sources.gmus2_lines set line_name=misc where misc ilike '% lineament';
update sources.gmus2_lines set line_name=misc where misc ilike '% discontinuity';
update sources.gmus2_lines set line_name=misc where misc ilike '% monocline';
update sources.gmus2_lines set line_name=misc where misc ilike '% vein';
update sources.gmus2_lines set line_name=misc where misc ilike '% dome';
update sources.gmus2_lines set line_name=misc where misc ilike '% block';
update sources.gmus2_lines set line_name=misc where misc ilike '% trend';
update sources.gmus2_lines set line_name=misc where misc ilike '% escarpment';


INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,133,line_name,descrip_mod,new_type,ST_MakeValid(geom) FROM sources.gmus2_lines where new_type is not null;

pg_dump -t sources.gmus2_lines -C -O burwell | gzip > ~/Desktop/gmus2_lines.sql.gz
pg_dump -t sources.gmus2 -C -O burwell | gzip > ~/Desktop/gmus2.sql.gz
pg_dump -t sources.al_greenwood -C -O burwell | gzip > ~/Desktop/al_greenwood.sql.gz

#134 wi_wood
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,134,name,strat_name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_wood;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=134 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');
INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,134,new_type,ST_MakeValid(geom) FROM sources.wi_wood_lines;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,134,strike,dip,dip_dir,point_type,maptext,ST_MakeValid(geom) FROM sources.wi_wood_points where point_type is not null;

#135 wi_marathon
update sources.wi_marathon set strat_name=NULL where strat_name='Wolf River batholith';
update sources.wi_marathon set strat_name=initcap(strat_name);
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,135,name,strat_name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_marathon;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=135 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,135,maptext,new_type,ST_MakeValid(geom) FROM sources.wi_marathon_lines;

SELECT distinct l.interval_name late,e.interval_name early,age from sources.ca_oceanside join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

#source_id 136 laketahoe
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,136,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.laketahoe;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,136,ltype,new_type,ST_MakeValid(geom) FROM sources.laketahoe_lines where new_type is not null;
INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,136,strike,dip,dip_dir,point_type,pttype,ST_MakeValid(geom) FROM sources.laketahoe_point where point_type is not null;

#137 al_greenwood
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,137,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.al_greenwood;
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,137,name,linetype,new_type,ST_MakeValid(geom) FROM sources.al_greenwood_lines where new_type is not null;
INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,137,strike,dip,dip_dir,point_type,lower(pointtype),ST_MakeValid(geom) FROM sources.al_greenwood_points where point_type is not null;

pg_dump -t sources.al_greenwood -C -O burwell | gzip > ~/Desktop/al_greenwood.sql.gz
pg_dump -t sources.al_greenwood_lines -C -O burwell | gzip > ~/Desktop/al_greenwood_lines.sql.gz
pg_dump -t sources.al_greenwood_points -C -O burwell | gzip > ~/Desktop/al_greenwood_points.sql.gz

#138 ca_napa
update sources.ca_napa set strat_name='Sonoma Volcanics' where strat_name is null and (ptype_100k in ('PMsvb','Tt','Mt','Pgisl') or ptype_100k like 'Psv%' or ptype_100k like 'Tsv%' or ptype_100k like 'Msv%');
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,138,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_napa;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,138,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_napa_lines where new_type is not null;

update sources.ca_napa_lines set new_type = NULL where ltype like 'landslide arrow';
update sources.ca_napa_lines set new_type = 'strike-slip fault',new_direction='right-lateral' where ltype like 'strike-slip fault, RL';
update sources.ca_napa_points set point_type=NULL where pttype='shear';
ALTER TABLE sources.ca_napa_lines ADD COLUMN gid SERIAL PRIMARY KEY;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,138,strike,dip,dip_dir,point_type,lower(pttype),ST_MakeValid(geom) FROM sources.ca_napa_points where point_type is not null;
pg_dump -t sources.ca_napa -C -O burwell | gzip > ~/Desktop/ca_napa.sql.gz
pg_dump -t sources.ca_napa_lines -C -O burwell | gzip > ~/Desktop/ca_napa_lines.sql.gz
pg_dump -t sources.ca_napa_points -C -O burwell | gzip > ~/Desktop/ca_napa_points.sql.gz

#139 ca_monterey
update sources.ca_monterey set strat_name='Santa Margarita Sandstone' where name='Santa Margarita Sandstone';
update sources.ca_monterey set strat_name='Santa Cruz Mudstone' where name='Santa Cruz Mudstone';
update sources.ca_monterey set strat_name='Quien Sabe Volcanics' where name like 'Quien Sabe Volcanics%';
update sources.ca_monterey set strat_name='Pinnacles Volcanics' where name='Pinnacles Volcanic Formation';
update sources.ca_monterey set strat_name='Vaqueros Sandstone' where name='Vaqueros Sandstone';
update sources.ca_monterey set strat_name='Tres Pinos Sandstone' where name='Tres Pinos Sandstone';
update sources.ca_monterey set strat_name='Aromas Sand' where name like 'Aromas Sand%';
update sources.ca_monterey set strat_name='Cantua Sandstone' where name like 'Cantua Sandstone';
update sources.ca_monterey set name='tectonic disturbance' where name is null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,139,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_monterey;


update sources.ca_monterey_lines set new_type='thrust fault' where ltype like 'thrust fault%';
update sources.ca_monterey_lines set new_type='thrust fault' where ltype like 'thrust fault%';
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,139,ltype,new_type,NULL,ST_MakeValid(geom) FROM sources.ca_monterey_lines where new_type is not null;


pg_dump -t sources.ca_monterey -C -O burwell | gzip > ~/Desktop/ca_monterey.sql.gz
pg_dump -t sources.ca_monterey_lines -C -O burwell | gzip > ~/Desktop/ca_monterey_lines.sql.gz


#140 catalunya50k
pg_dump -t sources.catalunya50k -C -O burwell | gzip > ~/Desktop/catalunya50k.sql.gz
pg_dump -t sources.catalunya50k_lines -C -O burwell | gzip > ~/Desktop/catalunya50k_lines.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,140,claslitoed_en,strat_name,age,concat(descripcio,' English : ',descripcio_en),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.catalunya50k;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,140,description,new_type,ST_MakeValid(geom) FROM sources.catalunya50k_lines where new_type is not null;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=140 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


SELECT distinct l.interval_name late,e.interval_name early,age from sources.ca_oceanside join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=135 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');


#141 nv_beatty
SELECT distinct l.interval_name late,e.interval_name early,age from sources.nv_beatty join macrostrat.intervals l on l.id=late_id join macrostrat.intervals e on e.id=early_id;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,141,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.nv_beatty;
insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=141 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,141,ltype,new_type,ST_MakeValid(geom) FROM sources.nv_beatty_lines where new_type is not null;

pg_dump -t sources.nv_beatty -C -O burwell | gzip > ~/Desktop/nv_beatty.sql.gz
pg_dump -t sources.nv_beatty_lines -C -O burwell | gzip > ~/Desktop/nv_beatty_lines.sql.gz

#142 ca_santabarbara
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,142,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_santabarbara;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,142,ltype,new_type,ST_MakeValid(geom) FROM sources.ca_santabarbara_lines where new_type is not null;

INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,142,point_type,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.ca_santabarbara_points where point_type is not null and dip >0;

pg_dump -t sources.ca_santabarbara -C -O burwell | gzip > ~/Desktop/ca_santabarbara.sql.gz
pg_dump -t sources.ca_santabarbara_lines -C -O burwell | gzip > ~/Desktop/ca_santabarbara_lines.sql.gz
pg_dump -t sources.ca_santabarbara_points -C -O burwell | gzip > ~/Desktop/ca_santabarbara_points.sql.gz

#ca_westernsonoma DUPLICATE
update sources.ca_westernsonoma set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Turonian' and l.interval_name='Campanian' and age='Late Cretaceous, Turonian to Campanian';
update sources.ca_westernsonoma set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Eocene' and l.interval_name='Maastrichtian' and age='late Eocene to Late Cretaceous, Maastrichtian';
update sources.ca_westernsonoma set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Albian' and l.interval_name='Cenomanian' and age='Late and Early Cretaceous, Cenomanian and (or) late Albian';
update sources.ca_westernsonoma set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Eocene' and l.interval_name='Turonian' and age='late Eocene to Late Cretaceous, Turonian';
update sources.ca_westernsonoma set strat_name='Anchor Bay Member' where strat_name='Anchor Bay member—';
update sources.ca_westernsonoma set strat_name=initcap(strat_name);
update sources.ca_westernsonoma set strat_name='Franciscan Complex' where strat_name='Franciscan Complex Coastal Belt';
update sources.ca_westernsonoma set strat_name='German Rancho Formation; Gualala Formation' where name='Undifferentiated German Rancho and Gualala Formations';


#143 wi_brown
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,143,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_brown;
pg_dump -t sources.wi_brown -C -O burwell | gzip > ~/Desktop/wi_brown.sql.gz

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,143,description,new_type,ST_MakeValid(geom) FROM sources.wi_brown_lines where new_type is not null;
pg_dump -t sources.wi_brown_lines -C -O burwell | gzip > ~/Desktop/wi_brown_lines.sql.gz

#144 ca_elcajon
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,144,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_elcajon;
pg_dump -t sources.ca_elcajon -C -O burwell | gzip > ~/Desktop/ca_elcajon.sql.gz

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,144,ltype,new_type,ST_MakeValid(geom) FROM sources.ca_elcajon_lines where new_type is not null;
pg_dump -t sources.ca_elcajon_lines -C -O burwell | gzip > ~/Desktop/ca_elcajon_lines.sql.gz

#points flawed need revised in this source not inserted
INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,144,point_type,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.ca_elcajon_points where point_type is not null and dip >0;

insert into maps.map_liths select large.map_id,liths.id,'descrip' from macrostrat.liths, maps.large WHERE large.source_id=144 and large.descrip IS NOT NULL and large.descrip ~* concat('\y',liths.lith,'\y');

pg_dump -t sources.ca_elcajon_lines -C -O burwell | gzip > ~/Desktop/ca_elcajon_lines.sql.gz


#145 ca_providencemountains
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,145,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_providencemountains;


update sources.ca_providencemountains_lines set descrip='anticline, location certain' where ltype='anticline_certain';
update sources.ca_providencemountains_lines set descrip='fault scarp' where ltype='fault_scarp';
update sources.ca_providencemountains_lines set descrip='fault, location inferred' where ltype='fault_inferred';
update sources.ca_providencemountains_lines set descrip='fault, concealed' where ltype='fault_concealed';
update sources.ca_providencemountains_lines set descrip='fault, locaiton certain' where ltype='fault_certain';
update sources.ca_providencemountains_lines set descrip='normal fault, location concealed' where ltype='fault_normal_concealed';
update sources.ca_providencemountains_lines set descrip='normal fault, location certain' where ltype='fault_normal_certain';
update sources.ca_providencemountains_lines set descrip='slide block contact' where ltype='slide_block_contact';
update sources.ca_providencemountains_lines set descrip='strike-slip fault, location certain' where ltype='fault_strike-slip_certain';
update sources.ca_providencemountains_lines set descrip='plunging syncline, location certain' where ltype='syncline_plunging_certain';
update sources.ca_providencemountains_lines set descrip='syncline, location certain' where ltype='syncline_certain';
update sources.ca_providencemountains_lines set descrip='concealed reverse fault' where ltype='fault_reverse_concealed';
update sources.ca_providencemountains_lines set descrip='reverse fault, location certain' where ltype='fault_reverse_certain';

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,145,descrip,new_type,ST_MakeValid(geom) FROM sources.ca_providencemountains_lines where new_type is not null;


pg_dump -t sources.ca_providencemountains -C -O burwell | gzip > ~/Desktop/ca_providencemountains.sql.gz
pg_dump -t sources.ca_providencemountains_lines -C -O burwell | gzip > ~/Desktop/ca_providencemountains_lines.sql.gz


scp -P 2200 ~/Desktop/ca_providencemountains.sql.gz shananp@teststrata.geology.wisc.edu:~/Desktop/ca_providencemountains.sql.gz


#146 in_bartholomew
update sources.in_bartholomew_descriptions set use_age=trim(split_part(age,',',2));
UPDATE sources.in_bartholomew_descriptions set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE use_age ilike m.interval_name and late_id IS NULL;
update sources.in_bartholomew_descriptions set late_id=145,early_id=1035 where use_age='Kinderhookian-Chautauquan';

update sources.in_bartholomew_descriptions set strat_name=name;
update sources.in_bartholomew_descriptions set strat_name=trim(split_part(strat_name,',',1)) where strat_name like '%,%';
update sources.in_bartholomew_descriptions set strat_name=trim(replace(strat_name,' and ', ';'));
update sources.in_bartholomew_descriptions set strat_name=trim(replace(strat_name,' undifferentiated', ''));
update sources.in_bartholomew set unit_name=fullname,early_id=m.early_id, late_id=m.late_id,descrip=m.description,strat_name=m.strat_name,age=m.age from sources.in_bartholomew_descriptions m where in_bartholomew.mapunit=m.mapunit;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,146,unit_name,strat_name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.in_bartholomew;


pg_dump -t sources.in_bartholomew -C -O burwell | gzip > ~/Desktop/in_bartholomew.sql.gz


#147 europe_5m
ALTER TABLE "sources"."europe_5m" DROP COLUMN "age";

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Cryogenian' and l.interval_name='Ediacaran' and agename='Cadomian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Paleozoic' and l.interval_name='Late Paleozoic' and agename='Variscan';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Ordovician' and l.interval_name='Early Devonian' and agename='Caledonian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Cretaceous' and l.interval_name='Cenozoic' and agename='Alpine';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Triassic' and l.interval_name='Middle Triassic' and agename='Early - Middle Triassic';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Archean' and l.interval_name='Paleoproterozoic' and agename='Archean - Proterozoic I';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Cambrian' and l.interval_name='Middle Cambrian' and agename='Early - Middle Cambrian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Devonian' and l.interval_name='Middle Devonian' and agename='Early - Middle Devonian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Jurassic' and l.interval_name='Middle Jurassic' and agename='Early - Middle Jurassic';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Ordovician' and l.interval_name='Middle Ordovician' and agename='Early - Middle Ordovician';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Early Permian' and l.interval_name='Permian' and agename='Early - Middle Permian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Cambrian' and l.interval_name='Middle Ordovician' and agename='Late Cambrian - Middle Ordovician';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Carboniferous' and l.interval_name='Permian' and agename='Late Carboniferous - Middle Permian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Devonian' and agename='Proterozoic III - Devonian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Cambrian' and agename='Proterozoic III - Cambrian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleocene' and l.interval_name='Eocene' and agename='Palaeocene - Eocene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and agename='Middle - Late Cambrian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Proterozoic' and l.interval_name='Paleozoic' and agename='Proterozoic - Palaeozoic';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Carboniferous' and l.interval_name='Early Permian' and agename='Carboniferous - Middle Permian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Cretaceous' and l.interval_name='Paleocene' and agename='Cretaceous - Palaeocene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Cretaceous' and l.interval_name='Paleogene' and agename='Cretaceous - Palaeogene';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Carboniferous' and l.interval_name='Early Permian' and agename='Carboniferous - Middle Permian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Cretaceous' and l.interval_name='Paleogene' and agename='Late Cretaceous - Palaeogene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleogene' and l.interval_name='Miocene' and agename='Palaeogene - Miocene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Permian' and l.interval_name='Paleogene' and agename='Permian - Palaeogene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleozoic' and l.interval_name='Triassic' and agename='Palaeozoic - Triassic';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleozoic' and l.interval_name='Mesozoic' and agename='Palaeozoic - Mesozoic';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleogene' and l.interval_name='Pleistocene' and agename='Palaeogene - Pleistocene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Jurassic' and l.interval_name='Paleogene' and agename='Jurassic - Palaeogene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Paleogene' and l.interval_name='Neogene' and agename='Palaeogene - Neogene';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Precambrian' and l.interval_name='Paleozoic' and agename='Precambrian - Palaeozoic';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Early Cambrian' and agename='Proterozoic III - Early Cambrian';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Middle Cambrian' and agename='Proterozoic III - Middle Cambrian';

update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Ordovician' and agename='Proterozoic III - Ordovician';
update sources.europe_5m set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Neoproterozoic' and l.interval_name='Silurian' and agename='Proterozoic III - Silurian';


update sources.europe_5m set portr_petr='plutonic' where portr_petr='undifferentiated' and portr_igne like 'plutoni%';
update sources.europe_5m set portr_petr='volcanic' where portr_petr='undifferentiated' and portr_igne like 'volcani%';
update sources.europe_5m set portr_petr=NULL where portr_petr='undifferentiated';
update sources.europe_5m set descrip=portr_mari where descrip is null and portr_mari is not null;

update sources.europe_5m set lith=concat('Major:{',portr_petr,'}, Minor{',concat_ws(',',portr_pe_1,portr_pe_2,portr_pe_3),'}') where portr_pe_2 is not null;
update sources.europe_5m set lith=portr_petr where portr_pe_2 is null and portr_petr is not null;
update sources.europe_5m set lith=NULL where portr_petr is null;

update sources.europe_5m set lith=concat('Major:{',portr_pe_1,'}, Minor{',concat_ws(',',portr_pe_2,portr_pe_3),'}') where portr_pe_1 is not null and portr_pe_1 not like 'undifferentiated' and lith is null and portr_pe_2 is not null;
update sources.europe_5m set lith=portr_pe_1 where lith is null;
update sources.europe_5m set lith=concat_ws(', ',portr_pe_2,portr_pe_3) where lith is null;
update sources.europe_5m set lith='metamorphic' where lith='' and descrip like '%metamorphic';
update sources.europe_5m set lith='basalt' where lith='' and portr_igne like '%ophiolite%';
update sources.europe_5m set lith='basalt' where lith='' and portr_iceo like '%ophiolite%';
update sources.europe_5m set lith=NULL where lith='';

update sources.europe_5m set descrip='anatexis rhyolite' where descrip='anatexis';
update sources.europe_5m set name=descrip where descrip is not null;
update sources.europe_5m set descrip=NULL where descrip=name;
update sources.europe_5m set descrip=genelement where genelement not like name and descrip is null;
update sources.europe_5m set strat_name='Kisgerecse Marl Formation; Lókút Radiolarite Formation' where regname like 'Kisgerecse Marl Fm, Lókút Radiolarite Formation and several  limestone formations';
update sources.europe_5m set strat_name='Graffa More Formation; Keadew Formation; Moygara Formation' where regname like 'Graffa More, Keadew, Moygara Formations';
update sources.europe_5m set strat_name='Booley Bay Formation; Cahore Group; Bray Group' where regname like 'Booley Bay Formation; Cahore Group; Bray Group';
update sources.europe_5m set strat_name='Cadeby Formation' where regname like 'Cadeby Formation';
update sources.europe_5m set strat_name='Maritsa Formation' where regname like 'Maritsa Formation';
update sources.europe_5m set strat_name='Frolosh Formation; Struma-Diorite Formation' where regname like 'Frolosh Formation and Struma-Diorite Formations';
update sources.europe_5m set strat_name='Eriksfjord Formation' where regname like 'Eriksfjord Formation';
update sources.europe_5m set strat_name='Eriksfjord Formation' where regname like 'Eriksfjord Formation';

update sources.europe_5m set strat_name='Annagh Gneiss Complex; Rhinns Complex; Rosslare Complex; Corvanaghan Formation' where regname like 'Annagh Gneiss Complex; Rhinns Complex; Rosslare Complex; Slishwood Division; Corvanaghan Formation';
update sources.europe_5m set strat_name='Mecsek Coal Formation' where regname like 'Mecsek Coal Formation and limestone and marl formations';
update sources.europe_5m set strat_name='Brusartsi Formation' where regname like 'Brusartsi Formation';
update sources.europe_5m set strat_name='Hallstatt Limestone; Pötchen Limestone; Wetterstein Limestone; Tornaszentandrás Shale' where regname like 'Hallstatt Limestone Fm, Pötchen Limestone Fm, Wetterstein Limestone Fm, Tornaszentandrás Shale Fm, etc.';
update sources.europe_5m set strat_name='Lábatlan Sandstone; Bersek Marl; Vértessomló Siltstone' where regname like 'Lábatlan Sandstone Fm, Bersek Marl Fm, Vértessomló Siltstone Fm';
update sources.europe_5m set strat_name='Mecsekjánosi Basalt; Magyaregregy Conglomerate; Hidasivölgy Marl;Apátvarasd Limestone' where regname like 'Mecsekjánosi Basalt Fm, Magyaregregy Conglomerate Fm, Hidasivölgy Marl Fm, Apátvarasd Limestone Fm';
update sources.europe_5m set strat_name='Gánt Bauxite' where regname like 'Gánt Bauxite Fm';
update sources.europe_5m set strat_name='Tinnye Fm, Kozárd Fm, Sajóvölgy Fm, Szilágy Clay Marl Fm, Rákos Limestone Fm, Hidas Lignite Fm, Baden Clay Fm, Ligeterdõ Gravel' where regname like 'Tinnye Fm, Kozárd Fm, Sajóvölgy Fm, Szilágy Clay Marl Fm, Rákos Limestone Fm, Hidas Lignite Fm, Baden Clay Fm, Ligeterdõ Gravel';
update sources.europe_5m set strat_name='Hauptdolomit Fm, Dachstein Limestone Fm' where regname like 'Hauptdolomit Fm, Dachstein Limestone Fm etc.';
update sources.europe_5m set strat_name='Tapolca Basalt Fm, Kecel Basalt Fm' where regname like 'Tapolca Basalt Fm, Kecel Basalt Fm';
update sources.europe_5m set strat_name='Szécsény Schlier Fm, Mány Fm, Csatka Fm, Hárshegy Sandstone, Buda Marl' where regname like 'Szécsény Schlier Fm, Mány Fm, Csatka Fm, Hárshegy Sandstone, Buda Marl, etc.';
update sources.europe_5m set strat_name='Velence Granite' where regname like 'Velence Granite Fm';
update sources.europe_5m set strat_name='Tokaj Volcanite; Gyulakeszi Rhyolite Tuff; Tar Dacite Tuff; Galgavölgy Rhyolite Tuff' where regname like 'Tokaj Volcanite Fm, Gyulakeszi Rhyolite Tuff Fm, Tar Dacite Tuff Fm, Galgavölgy Rhyolite Tuff Fm';
update sources.europe_5m set strat_name='Nadap Andesite' where regname like 'Nadap Andesite Fm';
update sources.europe_5m set strat_name='Tinnye Fm, Kozárd Fm, Sajóvölgy Fm, Szilágy Clay Marl Fm, Rákos Limestone Fm, Hidas Lignite Fm, Baden Clay Fm, Ligeterdõ Gravel' where regname like 'Tinnye Fm, Kozárd Fm, Sajóvölgy Fm, Szilágy Clay Marl Fm, Rákos Limestone Fm, Hidas Lignite Fm, Baden Clay Fm, Ligeterdõ Gravel';
update sources.europe_5m set strat_name='Hauptdolomit Fm, Dachstein Limestone Fm' where regname like 'Hauptdolomit Fm, Dachstein Limestone Fm etc.';
update sources.europe_5m set strat_name='Tapolca Basalt Fm, Kecel Basalt Fm' where regname like 'Tapolca Basalt Fm, Kecel Basalt Fm';
update sources.europe_5m set strat_name='Szécsény Schlier Fm, Mány Fm, Csatka Fm, Hárshegy Sandstone, Buda Marl' where regname like 'Szécsény Schlier Fm, Mány Fm, Csatka Fm, Hárshegy Sandstone, Buda Marl, etc.';
update sources.europe_5m set strat_name='Velence Granite' where regname like 'Velence Granite Fm';
update sources.europe_5m set strat_name='Tokaj Volcanite; Gyulakeszi Rhyolite Tuff; Tar Dacite Tuff; Galgavölgy Rhyolite Tuff' where regname like 'Tokaj Volcanite Fm, Gyulakeszi Rhyolite Tuff Fm, Tar Dacite Tuff Fm, Galgavölgy Rhyolite Tuff Fm';
update sources.europe_5m set strat_name='Nadap Andesite' where regname like 'Nadap Andesite Fm';

update sources.europe_5m set strat_name='Szentlélek; Nagyvisnyó Limestone; Perkupa Anhidrite' where regname like 'Szentlélek Fm, Nagyvisnyó Limestone Fm, Perkupa Anhidrite Fm';
update sources.europe_5m set strat_name='Nagyalföld Variegated Clay; Tihany Fm, Zagyva Fm, Újfalu Sandstone, Algyõ Fm, Szolnok Sandstone, Endrõd Marl' where regname like 'Nagyalföld Variegated Clay Fm, Tihany Fm, Zagyva Fm, Újfalu Sandstone Fm, Algyõ Fm, Szolnok Sandstone Fm, Endrõd Marl Fm, Tihany';
update sources.europe_5m set strat_name='Lökvölgy Shale, Vaskapu Sandstone, Bányahegy Radiolarite, Telekesoldal Complex, Telekesvölgy Complex, Szarvaskõ Basalt' where regname like 'Lökvölgy Shale Fm, Vaskapu Sandstone Fm, Bányahegy Radiolarite Fm, Telekesoldal Complex, Telekesvölgy Complex, Szarvaskõ Basalt';
update sources.europe_5m set strat_name='Kõszárhegy Slate, Lovas Slate, Kékkút Limestone, Litéri Metabasalt' where regname like 'Kõszárhegy Slate Fm, Lovas Slate Fm. Kékkút Limestone Fm, Litéri Metabasalt Fm.';
update sources.europe_5m set strat_name='Szabadbattyán Limestone, Füle Conglomerate' where regname like 'Szabadbattyán Limestone Fm, Füle Conglomerate';
update sources.europe_5m set strat_name='Mátra Andesite; Pásztori Trachite' where regname like 'Mátra Andesite Fm, Pásztori Trachite Fm,';
update sources.europe_5m set strat_name='Tata Limestone, Zirc Limestone, Pénzeskút Marl, Tés Clay, Alsópere Bauxite, Harsányhegy Limestone, Bisse Marl' where regname like 'Tata LimestoneFm, Zirc Limestone Fm, Pénzeskút Marl Fm, Tés Clay Fm, Alsópere Bauxite Fm, Harsányhegy Limestone Fm, Bisse Marl F';
update sources.europe_5m set strat_name='Padrag Marl, Szõc Limestone, Szépvölgy Limestone' where regname like 'Padrag Marl Fm, Szõc Limestone Fm, Szépvölgy Limestone Fm, etc.';
update sources.europe_5m set strat_name='Bar Basalt' where regname like 'Bar Basalt Fm';
update sources.europe_5m set strat_name='Balatonfelvidék Sandstone, Cserdi, Boda Siltstone, Kõvágószõlõs Sandstone' where regname like 'Balatonfelvidék Sandstone Fm, Cserdi Fm, Boda Siltstone Fm, Kõvágószõlõs Sandstone Fm';
update sources.europe_5m set strat_name='Polány Marl, Ugod Limestone, Ajka Coal, Halimba Bauxite' where regname like 'Polány Marl Fm, Ugod Limestone Fm, Ajka Coal Fm, Halimba Bauxite Fm';
update sources.europe_5m set strat_name='Szinva Metabasalt, Létrás Metabasalt, Szentistvánhegy Metaandesite' where regname like 'Szinva Metabasalt Fm, Létrás Metabasalt Fm, Szentistvánhegy Metaandesite Fm';
update sources.europe_5m set strat_name='Padrag Marl, Szõc Limestone, Szépvölgy Limestone' where regname like 'Padrag Marl Fm, Szõc Limestone Fm, Szépvölgy Limestone Fm, etc.';
update sources.europe_5m set strat_name='Bar Basalt' where regname like 'Bar Basalt Fm';
update sources.europe_5m set strat_name='Balatonfelvidék Sandstone, Cserdi, Boda Siltstone, Kõvágószõlõs Sandstone' where regname like 'Balatonfelvidék Sandstone Fm, Cserdi Fm, Boda Siltstone Fm, Kõvágószõlõs Sandstone Fm';
update sources.europe_5m set strat_name='Polány Marl, Ugod Limestone, Ajka Coal, Halimba Bauxite' where regname like 'Polány Marl Fm, Ugod Limestone Fm, Ajka Coal Fm, Halimba Bauxite Fm';
update sources.europe_5m set strat_name='Szinva Metabasalt, Létrás Metabasalt, Szentistvánhegy Metaandesite' where regname like 'Szinva Metabasalt Fm, Létrás Metabasalt Fm, Szentistvánhegy Metaandesite Fm';
update sources.europe_5m set strat_name='Malàguide Complex' where regname like 'Malàguide Complex';
update sources.europe_5m set strat_name='Mórágy Complex' where regname like 'Mórágy Complex';
update sources.europe_5m set strat_name='Alpujarride Complex' where regname like 'Alpujarride Complex';
update sources.europe_5m set strat_name='Beja-Acebuched Complex; Morais-Braganca Complex' where regname like 'Beja-Acebuched and Morais-Braganca Complexes';
update sources.europe_5m set strat_name='Brendan Igneous Complex' where regname like 'Brendan Igneous Complex';
update sources.europe_5m set strat_name='Bui Ignous Complex' where regname like 'Bui Ignous Complex';
update sources.europe_5m set strat_name='Esquisto-Graovaquisco Complex' where regname like 'Esquisto-Graovaquisco Complex';
update sources.europe_5m set strat_name='Ivrea Verbano Complex' where regname like 'Ivrea Verbano Complex';
update sources.europe_5m set strat_name='Lizard Ophiolite Complex' where regname like 'Lizard Ophiolite Complex';
update sources.europe_5m set strat_name='Unst/Fetlar Ophiolite Complex' where regname like 'Unst/Fetlar Ophiolite Complex';
update sources.europe_5m set strat_name='Vlasina Complex' where regname like 'Vlasina Complex';
update sources.europe_5m set strat_name='Ograzden Complex' where regname like 'Ograzden Complex';
update sources.europe_5m set strat_name='Xisto-Grauvaquico Complex' where regname like 'Xisto-Grauvaquico Complex';
update sources.europe_5m set strat_name='Veleta Complex' where regname like 'Veleta Complex';
update sources.europe_5m set strat_name='Mulhacén Complex' where regname like 'Mulhacén Complex';
update sources.europe_5m set strat_name='Rhum Central Complex' where regname like 'Rhum Central Complex';

update sources.europe_5m set strat_name='Tyrone Igneous Complex' where regname like 'Tyrone Ophiolite, part of Tyrone Igneous Complex';
update sources.europe_5m set strat_name='Osogovo Complex' where regname like 'Osogovo Complex';
update sources.europe_5m set strat_name='Ordenes Complex; Morais Complex' where regname like 'Ordenes and Morais Complex';
update sources.europe_5m set strat_name='Independence Fjord Group' where regname like 'Krummedal succession in East Greenland and Independence Fjord Group in North East Greenland';
update sources.europe_5m set strat_name='Silistra Group' where regname like 'Silistra Group';
update sources.europe_5m set strat_name='Mandritsa Group' where regname like 'Mandritsa Group';
update sources.europe_5m set strat_name='Topolovgrad Group; East Tracian Group' where regname like 'Topolovgrad and East Tracian Groups';
update sources.europe_5m set strat_name='Clackmannan Group' where regname like 'Clackmannan Group';

update sources.europe_5m set strat_name='Advat Group' where regname like 'Advat Group';
update sources.europe_5m set strat_name='Dingle Group' where regname like 'Dingle Group (Siluro-Devonian )';
update sources.europe_5m set strat_name='Yam Suf Group' where regname like 'Yam Suf Group';
update sources.europe_5m set strat_name='Magurski Group' where regname like 'Magurski Group of the flysch belt, Belokarpatská Unit';
update sources.europe_5m set strat_name='Mount Scopus Group' where regname like 'Mount Scopus Group';
update sources.europe_5m set strat_name='Dunquin Group' where regname like 'Dunquin Group';
update sources.europe_5m set strat_name='Caherbla Group; Beltra Group' where regname like 'Caherbla Group; Beltra Group';

update sources.europe_5m set strat_name='Connemara Group; Ribband Group; Tagoat Group; Duncannon Group' where regname like 'S Mayo trough; S Connemara Group; SW Curlew Mountains; Tyrone; Longford-Down massif; Ribband Group; Tagoat Group; Duncannon Grp.';
update sources.europe_5m set strat_name='Ramon Group' where regname like 'Ramon Group';
update sources.europe_5m set strat_name='Bray Group' where regname like 'Bray Group (Quelle: Review Ireland)';
update sources.europe_5m set strat_name='Karrat Group' where regname like 'Karrat Group and Graenseland succesion';
update sources.europe_5m set strat_name='Kurnub Group' where regname like 'Kurnub Group';
update sources.europe_5m set strat_name='Judea Group' where regname like 'Judea Group';
update sources.europe_5m set strat_name='Magurski Group' where regname like 'Magurski Group of the flysch belt, Racanská Unit';
update sources.europe_5m set strat_name='Grahilovo Group; Veleka Group' where regname like 'Grahilovo and Veleka Groups';
update sources.europe_5m set strat_name='Eleonore Bay Supergroup' where regname like 'Eleonore Bay Supergroup';
update sources.europe_5m set strat_name='Dalradian Supergroup' where regname like 'Dalradian Supergroup';
update sources.europe_5m set strat_name='Torridonian Supergroup' where regname like 'Torridonian Supergroup';
update sources.europe_5m set strat_name=REPLACE(strat_name,'Fm,','Formation;');
update sources.europe_5m set strat_name=REPLACE(strat_name,'Fm','Formation');
update sources.europe_5m set strat_name=REPLACE(strat_name,',',';');
update sources.europe_5m set strat_name=trim(strat_name);
update sources.europe_5m set descrip=concat(portr_meta,' metamorphic') where descrip is null and portr_meta is not null;


INSERT INTO maps.small (orig_id,source_id,name,strat_name,age,lith,descrip,t_interval,b_interval,geom) SELECT gid,147,name,strat_name,agename,lith,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.europe_5m;

update sources.europe_5m_lines set new_type='fault' where portr_line like 'fault%';
update sources.europe_5m_lines set new_type='impact structure' where portr_line like 'impact structure';
update sources.europe_5m_lines set new_type='thrust fault' where portr_line like 'thrust%';
update sources.europe_5m_lines set new_type='normal fault' where portr_line like 'gravity fault';


update sources.europe_5m_lines set new_type='strike-slip fault' where portr_line like 'strike/slip fault%';
update sources.europe_5m_lines set new_type='strike-slip fault',new_direction='right-lateral' where portr_line like 'strike/slip fault dextral';
update sources.europe_5m_lines set new_type='strike-slip fault',new_direction='left-lateral' where portr_line like 'strike/slip fault sinistral';
update sources.europe_5m_lines set new_type='strike-slip fault' where portr_line like 'transform%';
update sources.europe_5m_lines set new_type='fold' where portr_line like 'fold belt';

INSERT INTO lines.small (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,147,portr_line,new_type,new_direction,ST_MakeValid(geom) FROM sources.europe_5m_lines where new_type is not null;



#wy_kemmerer 148
update sources.wy_kemmerer set description='aeolian sand' where name ilike '%sand%' and description is null;
update sources.wy_kemmerer set age='Holocene' where g_unit='Qs',early_id=3,late_id=3;
delete from sources.wy_kemmerer where g_unit in ('black','blue') and name is null and g_id is null;
update sources.wy_kemmerer set strat_name='Wasatch Formation',age='lower Eocene',early_id=481,late_id=481 where age is null and g_sym='ls';
update sources.wy_kemmerer set early_id=e.id,late_id=l.id,age='Holocene' FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Holocene' and l.interval_name='Holocene' and name='Sand Dune' and age is null;


INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,148,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_kemmerer;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,148,ltype,new_type,ST_MakeValid(geom) FROM sources.wy_kemmerer_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_kemmerer_lines -C -O burwell | gzip > ~/Desktop/wy_kemmerer_lines.sql.gz
pg_dump -t sources.wy_kemmerer -C -O burwell | gzip > ~/Desktop/wy_kemmerer.sql.gz

#wy_cheyenne 149
update sources.wy_cheyenne set g_nam=replace(g_nam,'Quaternry','Quaternary');
update sources.wy_cheyenne set g_nam=replace(g_nam,'Quaternnary','Quaternary');
update sources.wy_cheyenne set g_nam=replace(g_nam,'Quternary','Quaternary');

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,149,g_nam,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_cheyenne;
pg_dump -t sources.wy_cheyenne -C -O burwell | gzip > ~/Desktop/wy_cheyenne.sql.gz


#150 wi_juneaucounty
update sources.wi_juneaucounty set strat_name=replace(strat_name,',',';');

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,150,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_juneaucounty;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,150,maptext,new_type,ST_MakeValid(geom) FROM sources.wi_juneaucounty_lines where new_type is not null and geom is not null;

pg_dump -t sources.wi_juneaucounty -C -O burwell | gzip > ~/Desktop/wi_juneaucounty.sql.gz
pg_dump -t sources.wi_juneaucounty_lines -C -O burwell | gzip > ~/Desktop/wi_juneaucounty_lines.sql.gz

#151 lake_meade
update sources.lake_mead set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and age='Upper and Middle Cambrian';
update sources.lake_mead set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Oligocene' and l.interval_name='Early Miocene' and age='middle and lower Miocene and upper Oligocene';
update sources.lake_mead set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Pliocene' and l.interval_name='Early Pleistocene' and age='early Pleistocene to late Pliocene';
update sources.lake_mead set strat_name=NULL where strat_name like 'Boulder Wash';
update sources.lake_mead set strat_name=NULL where strat_name like '%Wash';
update sources.lake_mead set strat_name='Horse Spring Formation' where strat_name like 'Horse Spring';
update sources.lake_mead set name='Horse Spring(?) rocks in Overton Arm' where name='Horse Spring';
update sources.lake_mead set strat_name=NULL where strat_name like 'Overton Arm';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,151,name,strat_name,age,descrip,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.lake_mead;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,151,ltype100k,new_type,new_direction,ST_MakeValid(geom) FROM sources.lake_mead_lines where new_type is not null;

pg_dump -t sources.lake_mead  -C -O burwell | gzip > ~/Desktop/lake_mead.sql.gz

update sources.lake_mead_lines set new_type='thrust fault' where new_type='reverse fault';
update sources.lake_mead_lines set new_direction='right-lateral' where ltype100k like '%_rl%';
update sources.lake_mead_lines set new_direction='left-lateral' where ltype100k like '%_ll%';

#152 wy_casper
update sources.wy_casper set strat_name='Madison Limestone', name='Madison Limestone', description='Alternating units of light-tan to gray cherty limestone and dolomite. Upper part bluish-gray limestone with karst surface at the top. Lower part mainly dolomite and dolomitic limestone. The entire formation is fossilferous; spiriferoid brachiopods and solitary tetracorals are the most common. Sando and Sandberg (1987) included the lowermost part of the Madison Limestone in their Mississippian and Devonian Englewood Formation. Thickness ranges from 100 to 400 feet (30 to 120 meters), thinning towar the south (thickness modified from Love and others, 1979).',age='Upper and Lower Mississippian' where g_nam='Mm';

update sources.wy_casper set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Mississippian' and l.interval_name='Mississippian' and age='Upper and Lower Mississippian';

update sources.wy_casper set strat_name='Meeteetse Formation; Lewis Shale', name='Meeteetse Formation and Lewis Shale undivided', description='Meeteetse Fm: Light-gray friable sandstone interbedded with dark-gray carbonaceous shale and yellowish-colored bentonitic claystone. Thickness about 400 to 600 feet (120 to 180 meters).
Lewis Shale: Dark-gray shale with thin laminae of light-gray siltstone; fine-grained sandstone in upper half of unit. Upper 15 feet grades into light-colored sandstone of the Fox Hills Formation. Contact with Fox Hills placed at 6-inch-thick bentonite layer. Thickness about 1000 feet (300 meters). Descriptions and thicknesses modified from Love and others, 1979.',age='Late Cretaceous' where g_nam='Kml' and name is null;

update sources.wy_casper set early_id=e.id,late_id=l.id FROM macrostrat.intervals e, macrostrat.intervals l WHERE e.interval_name='Late Cretaceous' and l.interval_name='Late Cretaceous' and age='Late Cretaceous';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,152,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_casper where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,152,description,new_type,ST_MakeValid(geom) FROM sources.wy_casper_lines where new_type is not null;

pg_dump -t sources.wy_casper_lines  -C -O burwell | gzip > ~/Desktop/wy_casper_lines.sql.gz
pg_dump -t sources.wy_casper  -C -O burwell | gzip > ~/Desktop/wy_casper.sql.gz

#153 wi_piercestcroix
update sources.wi_piercestcroix set strat_name='Prairie du Chien Group' where strat_name='Prairie Du Chien Group';
update sources.wi_piercestcroix set strat_name=NULL where strat_name='Washington Road Sandstone';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,153,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wi_piercestcroix;

update sources.wi_piercestcroix_lines set new_type=NULL where new_type='contact' or new_type='boundary';
update sources.wi_piercestcroix_lines set description=concat('location ', lower(d_featacc),'; ',d_detail);
update sources.wi_piercestcroix_lines set name=NULL;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,153,description,new_type,ST_MakeValid(geom) FROM sources.wi_piercestcroix_lines where new_type is not null;

pg_dump -t sources.wi_piercestcroix_lines  -C -O burwell | gzip > ~/Desktop/wi_piercestcroix_lines.sql.gz
pg_dump -t sources.wi_piercestcroix  -C -O burwell | gzip > ~/Desktop/wi_piercestcroix.sql.gz

#154 global2
INSERT INTO maps.tiny (orig_id,source_id,name,strat_name,age,lith,comments,t_interval,b_interval,geom) SELECT gid,154,agerxtp,strat_name,use_age,metamorph,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.global2;

INSERT INTO lines.tiny (orig_id,source_id,descrip,new_type,new_direction,geom) SELECT gid,154,concat_WS('; ',ageftp,fdisp),new_type,new_direction,ST_MakeValid(geom) FROM sources.global2_lines where new_type is not null;

#155 wy_rattlesnakehills
update sources.wy_rattlesnakehills set description=replace(description,'scattere ','scattered ');
update sources.wy_rattlesnakehills set strat_name='Flathead Sandstone; Gros Ventre Formation',description='Flathead Sandstone consists of buff to red sandstone in the upper part, resistant arkoskic pebble conglomeratic with interbedded sandstone at bottom, and a separating middle layer of nonresistant siltstone (520 feet thick). Gros Ventre Formation consists of about 280 feet of nonresistant reddish orange to red interbedded very fine grained sandstone, siltstone, and shale.' where ptype='^u';
update sources.wy_rattlesnakehills set description=concat('Tertiary volcanics: ',lower(name)) where description is null and ptype like 'T%';
update sources.wy_rattlesnakehills set strat_name='Bug Formation' where strat_name ilike '%Bug Form%';
update sources.wy_rattlesnakehills set description='Includes mica schists, ultramafic schists (serpentinites, talc-chlorite schists, actinolite schist), amphibole schist, and other mafic schists and geneiss, metagreywacke, metabasalt, quartzite,iron formation, and metasedimentary-metaigneous rocks.' where description is null and ptype like 'sc,%';
update sources.wy_rattlesnakehills_lines set new_type=lower(new_type);

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,155,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_rattlesnakehills;

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,155,new_type,ST_MakeValid(geom) FROM sources.wy_rattlesnakehills_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_rattlesnakehills_lines  -C -O burwell | gzip > ~/Desktop/wy_rattlesnakehills_lines.sql.gz
pg_dump -t sources.wy_rattlesnakehills  -C -O burwell | gzip > ~/Desktop/wy_rattlesnakehills.sql.gz

#156 az_fredonia
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,156,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.az_fredonia;

update sources.az_fredonia_lines set ltype=replace(ltype,'_certain','; location certain');
update sources.az_fredonia_lines set ltype=replace(ltype,'_approximate','; location approximate');
update sources.az_fredonia_lines set ltype=replace(ltype,'_concealed','; concealed');
update sources.az_fredonia_lines set ltype=replace(ltype,'_inferred','; inferred');
update sources.az_fredonia_lines set ltype=replace(ltype,'fault_normal','normal fault');
update sources.az_fredonia_lines set ltype=replace(ltype,'_',' ');
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,156,ltype,new_type,ST_MakeValid(geom) FROM sources.az_fredonia_lines where new_type is not null;
pg_dump -t sources.az_fredonia_lines  -C -O burwell | gzip > ~/Desktop/az_fredonia_lines.sql.gz
pg_dump -t sources.az_fredonia  -C -O burwell | gzip > ~/Desktop/az_fredonia.sql.gz

INSERT INTO points.points (orig_id,source_id,comments,point_type,strike,dip,dip_dir,geom) SELECT gid,156,pttype,point_type,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.az_fredonia_points where point_type is not null;
pg_dump -t sources.az_fredonia_points  -C -O burwell | gzip > ~/Desktop/az_fredonia_points.sql.gz

#157 wy_lander
update sources.wy_lander set name=descriptio where name is null;
update sources.wy_lander set name=g_sym where name is null;
update sources.wy_lander set strat_name='Ervay Member; Tosi Chert Member; Retort Phosphatic Shale Member' where strat_name='Ervay Member; Tosi Chert; Retort Phosphatic Shale Member';
update sources.wy_lander set description=regexp_replace(description, '\r|\n', ' ', 'g');
update sources.wy_lander set description='The Muddy Sandstone is a prominent gray, fine- to coarse- grained, cliff-forming sandstone, containing sporadically distributed chert pebbles, dark minerals, and chalky grains overlain by softer sandstones and dark-gray to black shales. The Thermopolis Shale is composed of soft, black, fissile shale with thin bentonite layers often found near the top and bottom of the formation.' where description is null and name='Muddy Sandstone and Thermopolis Shale undivided';
update sources.wy_lander set description='The Chugwater Group includes from top to base, the Popo Agie Formation, Crow Mountain Sandstone, Alcova Limestone, and Red Peak Formation in areas of steep dips where these units could not be mapped separately. The Dinwoody Formation is made up of gray to greenish-gray, fine-grained, sandy, dolomitic siltstone, silty greenish-gray shale, and thin, slabby sandstone.' where name='Chugwater Group and Dinwoody Formation undivided';
update sources.wy_lander set description='The Lyons Valley Member of the Popo Agie Formation consists of purple and ocher siltstone, analcime-rich claystone, and analcimolite (Pipiringos, 1968). The Brynt Draw Member of the Popo Agie Formation consists of approximately 20 feet (m) of pale-red to purplish-red, calcareous, silty claystone and locally reddish-gray to grayish-yellow, calcareous, silty sandstone. The uppermost part consists of dolomitic (?) siltstone containing lime-cemented siltstone pebbles (Pipringos, 1968). The Crow Mountain Sandstone is a hematite-stained (Brocka, 2007), reddish-brown, very fine to fine-grained, limey, argillaceous, thin-bedded to massive sandstone, interbedded with reddish-brown, fissile, slightly calcareous shale and sandy siltstone. Thickness of the Crow Mountain is approximately 189 feet (58 m) thick (Rohrer, 1973).' where name='Popo Agie Formation and Crow Mountain Sandstone undivided';
update sources.wy_lander set description='The Red Peak Formation is composed of hematite-stained, red to reddish-brown, commonly calcareous, thin to thick-bedded, interbedded and intergradational siltstone, sandstone, and shale. The Dinwoody Formation is made up of gray to greenish-gray, fine-grained, sandy, dolomitic siltstone, silty greenish-gray shale, and thin, slabby sandstone.' where description is null and name='Red Peak and Dinwoody Formations undivided';
update sources.wy_lander set description='The Tensleep Sandstone is composed of gray to buff to brown, cross-bedded, fine- to medium-grained, calcareous, cliff- forming sandstone (Brocka, 2007). The upper part of the Amsden is a variable sequence of red and green shales and sandy shales sometimes containing hematite nodules (Keefer and Van Lieu, 1966) and white, light- gray, red, and purple hard, cherty and sandy dolomites interbedded with red and green shale, limestone, and sandstone (Agatston, 1957) ranging in thickness from 80 feet (24 m) (Keefer and Van Lieu, 1966) to 200 feet (61 m) (Agatston, 1957). The base of the Amsden consists of red, gray, and white fine- to medium- grained, cross-bedded to massive, cliff-forming sandstone. In outcrop, appearance is similar to the Tensleep Sandstone.' where description is null and name='Tensleep Sandstone and Amsden Formation undivided';
update sources.wy_lander set description='Consists of Bighorn Dolomite (Ordovician) and undifferntial Cambrian formations composed of sandstone, limestone, and shale.' where description is null and name='Ordovician and Cambrian rocks undifferentiated';
update sources.wy_lander set description='In some areas along the flank of the Wind River Range, these two formations are subdivided and mapped as three separate units composed of different members of each formation. Each member of the Phosphoria and Park City formations, with the exception of the Grandeur Member of the Park City, were not thick enough to map separately at the 1:100,000 scale. The units consist of dolomite, cherty dolomite, chert, and shale.' where description is null and name='Phosphoria and Park City formations undivided';
update sources.wy_lander set description='The Cloverly Formation consists of buff to gray to brown, fine-grained, cross-bedded, slabby sandstone with interbedded variegated shales and siltstones overlying a pebble conglomerate at the base. The Morrison Formation consists of red, maroon, green, and brown claystone, mudstone, and siltstone, with interspersed lenses of coarser channel sandstones underlain by coarser-grained deposits of poorly sorted silty sandstone containing interbeds or channel deposits of coarse-grained, cross-bedded sandstone. Total thickness for both units is approximately 350 feet (110 m)' where name='Cloverly and Morrison formations undivided';
update sources.wy_lander set age='Upper Cretaceous',description='The Mowry Shale consists of black to dark-gray, hard siliceous shale, containing a few beds of thin, gray to brown, fine- to medium-grained sandstone. The formation weathers to distinctive bare, silver-gray ridges with bands of vegetation along interspersed bentonite beds (Cobban, 1957). Thickness varies from 430 to 500 feet (130 to 150 m).',early_id=late_id,strat_name='Mowry Shale',name='Mowry Shale' where g_sym='Kmr';
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,157,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_lander;

update sources.wy_lander_lines set description=NULL where description=name;
update sources.wy_lander_lines set new_type=lower(new_type);
update sources.wy_lander_lines set new_type='fault' where new_type='wolf point fault';
update sources.wy_lander_lines set new_type='thrust fault' where gid in (269,366,3,268,267,274,359,360,32,31,39,38,33);
update sources.wy_lander_lines set name='Clear Creek Fault' where name like 'Atlantic%';
update sources.wy_lander_lines set new_type='normal fault' where name like 'Clear Creek%';

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,157,name,description,new_type,ST_MakeValid(geom) FROM sources.wy_lander_lines where new_type is not null and geom is not null;
pg_dump -t sources.wy_lander_lines  -C -O burwell | gzip > ~/Desktop/wy_lander_lines.sql.gz
pg_dump -t sources.wy_lander  -C -O burwell | gzip > ~/Desktop/wy_lander.sql.gz

#158 wy_douglas
update sources.wy_douglas set description=replace(description,'30? x 60?','30x60');
update sources.wy_douglas set strat_name='Madison Limestone; Flathead Sandstone',name='Mississippian and Cambrian rocks, undivided' where name like 'Mississippian and Cambrian%';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,158,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_douglas;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,158,flt_name,new_type,ST_MakeValid(geom) FROM sources.wy_douglas_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_douglas_lines  -C -O burwell | gzip > ~/Desktop/wy_douglas_lines.sql.gz
pg_dump -t sources.wy_douglas  -C -O burwell | gzip > ~/Desktop/wy_douglas.sql.gz


#159 wy_evanston
update sources.wy_evanston set strat_name='Allen Hollow Member; Coalville Member; Chalk Creek Member' where name='Allen Hollow, Coalville, and Chalk Creek Members of Hale (1960), undivided';
update sources.wy_evanston set strat_name='Bridger Formation' where g_sym='Tbuw' and strat_name is null;
update sources.wy_evanston set strat_name='Bridger Formation' where g_sym='Tbg' and strat_name is null;
update sources.wy_evanston set strat_name='Wasatch Formation' where g_sym='Tw1' and strat_name is null;
update sources.wy_evanston set strat_name='Bridger Formation' where g_sym='1' and strat_name is null;
update sources.wy_evanston set strat_name='Bridger Formation' where g_sym='2' and strat_name is null;
update sources.wy_evanston set comments=replace(comments,' ,',',');
update sources.wy_evanston set comments=replace(comments,' .','.');
update sources.wy_evanston set description='Predominantly light-tan to white, fine- to medium -grained, parallel-bedded to crossbedded, cliff-forming sandstone containing some brown shale layers. Sandstone units show bedding and fauna indicative of marine shoreline deposition; minor channeling in upper parts. About 79 to 115 feet (24 to 35 m ) thick' where g_nam='Oyster Ridge Sandstone Member' and g_sym='Kfl';

update sources.wy_evanston set description='Allen Hollow Member: Dark-gray to greenish-brown marine shale; sandstone and siltstone beds in upper part. Middle Turonian age based on Collignoniceras woolgari fauna (Hale, 1960). Largely covered; about 302 feet (92 m) thick. Coalville: Dark-greenish-gray shale and tan, fine-grained, flaggy to crossbedded and ripple-marked, bioturbated sandstone. Contains brackish-water to marine fauna of early Turonian age (Cobban and Reeside, 1952; Merewether and others, 1984). Thickness about 79 to 151 feet (24 to 46 m ). Chalk Creek: Gray, greenish-gray, and brown, largely nonmarine shale, bentonitic shale, tuff and tuffaceous sandstone; carbonaceous shale; coal; and tan, fine- to coarse-grained, platy to crossbedded, locally bioturbated sandstone. Basal part interfingers with Aspen Formation (unit Ka) near Cumberland Gap; Cenomanian age based on molluscan fauna and stratigraphic position (M’Gonigle, 1982; Cobban and Kennedy, 1989). Thickness about 984 to 1312 feet (300 to 400 m)' where g_sym='Kfl' and description is null;
update sources.wy_evanston set description='aeolian silt' where description is null and name='Loess';
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,159,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_evanston;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,159,concat_WS('; ',g_name,p_acc),new_type,ST_MakeValid(geom) FROM sources.wy_evanston_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_evanston_lines  -C -O burwell | gzip > ~/Desktop/wy_evanston_lines.sql.gz
pg_dump -t sources.wy_evanston  -C -O burwell | gzip > ~/Desktop/wy_evanston.sql.gz

#160 ca_carizoplain
update sources.ca_carizoplain set strat_name='Franciscan Complex' where name like 'Franciscan %';
update sources.ca_carizoplain set description=strat_name,strat_name=NULL where strat_name like 'Conglomerate';
update sources.ca_carizoplain set description=strat_name,strat_name=NULL where strat_name like 'Sandstone, clay shale, and minor conglomerate';
update sources.ca_carizoplain set description=trim(lower(description));
update sources.ca_carizoplain set description=replace(description,'clayshale','claystone');
	update sources.ca_carizoplain set description='alluvium' where name='Alluvium, surficial sediments';
	update sources.ca_carizoplain set description='sandstone' where name='Avenal Sandstone';
	update sources.ca_carizoplain set description='conglomerate' where name='Basal conglomerate lens, Temblor Formation';
	update sources.ca_carizoplain set description='basalt' where name='Basalt, extrusive and intrusive rocks';
	update sources.ca_carizoplain set description='diatomite' where name='Belridge Diatomite Member (Mohnian Stage)';
	update sources.ca_carizoplain set description='shale' where name='Bitterwater Creek Shale (Mohnian Stage)';
	update sources.ca_carizoplain set description='sandstone' where name='Branch Canyon Sandstone';
	update sources.ca_carizoplain set description='sandstone' where name='Buttonbed Sandstone Member (Relizian Stage)';
	update sources.ca_carizoplain set description='siliciclastic' where name='Caliente Formation, Terrestrial (Heminfordian to Arikareean)';
	update sources.ca_carizoplain set description='siliciclastic' where name='Carneros Sandstone Member (Saucesian Stage)';
	update sources.ca_carizoplain set description='clay shale' where name='Clay shale, Temblor Formation';
	update sources.ca_carizoplain set description='shale' where name='Devilwater Shale Member (Luisian Stage)';
	update sources.ca_carizoplain set description='sandstone' where name='Etchegoin Formation, blue sandstone';
	update sources.ca_carizoplain set description='gray sandstone and siltstone' where name='Etchegoin Formation, gray sandstone and siltstone';
	update sources.ca_carizoplain set description='gneiss' where name='Gneissic rocks';
	update sources.ca_carizoplain set description='shale' where name='Gould Shale Member (mostly Relizian and Luisian Stages)';
	update sources.ca_carizoplain set description='granite' where name='Granitic rocks';
	update sources.ca_carizoplain set description='shale' where name='Grendal Shale Member';
	update sources.ca_carizoplain set description='claystone' where name='Hex Claystone';
	update sources.ca_carizoplain set description='gabbro' where name='Hornblende quartz gabbro';
	update sources.ca_carizoplain set description='shale' where name='Kreyenhagen Shale, undifferentiated';
	update sources.ca_carizoplain set description='colluvium' where name='Landslide rubble, surficial sediments';
	update sources.ca_carizoplain set description='sandstone, claystone' where name='Lodo Formation';
	update sources.ca_carizoplain set description='argilliceous and siliceous shale',name='lower part of Monterey Shale' where name='lower part, argilliceous and siliceous shale';
	update sources.ca_carizoplain set description='shale' where name='McLure Shale Member (mostly Mohnian Stage)';
	update sources.ca_carizoplain set description='shale' where name='Media Shale Member (Relizian and Saucesian Stages)';
	update sources.ca_carizoplain set description='shale' where name='Morales Formation Valley sediments';
	update sources.ca_carizoplain set description='mudstone,sandstone' where name='Morales Formation Valley sediments';
	update sources.ca_carizoplain set description='alluvium' where name='Older alluvium';
	update sources.ca_carizoplain set description='sandstone' where name='Paso Robles Formation';
	update sources.ca_carizoplain set description='clay, silt, sand' where name='Playa clay, surficial sediments';
	update sources.ca_carizoplain set description='sandstone' where name='Point of Rock Sandstone';
	update sources.ca_carizoplain set description='sandstone' where name='Quail Canyon Sandstone';
	update sources.ca_carizoplain set description='claystone and sandstone' where name='Quatal Formation, terrestrial claystone and sandstone';
	update sources.ca_carizoplain set description='shale' where name='Reef Ridge Shale';
	update sources.ca_carizoplain set description='shale' where name='Saltos Shale Member (Saucesian and Relizian Stages)';
	update sources.ca_carizoplain set description='mudstone' where name='San Joaquin Formation, mostly mudstone';
	update sources.ca_carizoplain set description='sandstone' where name='Sandstone lenses, Montery Shale';
	update sources.ca_carizoplain set description='sandstone' where name='Sandstone, Santa Margarita Formation';
	update sources.ca_carizoplain set description='sandstone' where name='Sandstone, Temblor Formation';
	update sources.ca_carizoplain set description='conglomerate and breccia' where name='Santa Margarita Formation, conglomerate and breccia';
	update sources.ca_carizoplain set description='sandstone' where name='Santa Margarita Formation, sandstone';
	update sources.ca_carizoplain set description='Serpentine and serpentined peridotite' where name='Serpentine and serpentined peridotite';
	update sources.ca_carizoplain set description='shale and sandstone',name='Monterey Shale: shale and sandstone unit' where name='shale and sandstone unit (Relizian and Luisian Stages)';
	update sources.ca_carizoplain set description='conglomerate' where name='Simmler Formation, mostly conglomerate';
	update sources.ca_carizoplain set description='sandstone' where name='Simmler Formation, mostly sandstone';
	update sources.ca_carizoplain set description='shale' where name='Soda Lake Shale Member';
	update sources.ca_carizoplain set description='sandstone,claystone',name='Temblor Formation, undivided lower members' where name='Temblor Formation, undivided lower members, sandstone and claystone. (Zemorrian Stage)';
	update sources.ca_carizoplain set description='siliciclastic' where name='Tulare Formation';
	update sources.ca_carizoplain set description='sandstone and siltstone' where name='Unnamed marine sediments, sandstone and siltstone';
	update sources.ca_carizoplain set description='sandstone' where name='Unnamed sandstone';
	update sources.ca_carizoplain set description='siliciclastic' where name='Unnamed valley sediment';
	update sources.ca_carizoplain set description='shale' where name='Upper part of Santos Shale Member (Saucesian Stage)';
	update sources.ca_carizoplain set description='siliceous shale',name='Monterey Shale: upper part (Mohnian Stage)' where name='upper part, siliceous shale (Mohnian Stage)';
	update sources.ca_carizoplain set description='clay shale',name='Vaqueros Formation, clay shale' where name='Vaqueros Formation, clay shae';
	update sources.ca_carizoplain set description='sandstone' where name='Vaqueros Formation, sandstone';
	update sources.ca_carizoplain set description='clay shale' where name='Wagonwheel Formation, clay shale unit (Refugian Stage)';
	update sources.ca_carizoplain set description='sandstone' where name='Wagonwheel Formation, sandstone unit (Refugian Stage)';
	update sources.ca_carizoplain set description='shale' where name='Welcome Shale Member';
	update sources.ca_carizoplain set description='shale' where name='Whiterock Bluff Shale Member (Relizian and Luisian Stages)';
		update sources.ca_carizoplain set strat_name='Point of Rocks Sandstone' where name='Point of Rock Sandstone';
		update sources.ca_carizoplain set strat_name=replace(strat_name,'Montery Shale','Monterey Shale');
		update sources.ca_carizoplain set description=replace(description,'grawacke','graywacke');
		update sources.ca_carizoplain set description='sandstone' where name='Painted Rock Sandstone Member (Sauceian Stage)';
		update sources.ca_carizoplain set description=trim(lower(description));
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,lith,t_interval,b_interval,geom) SELECT gid,160,concat_WS(': ',hierarchy,name),strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ca_carizoplain;

update sources.ca_carizoplain_lines set ltype=replace(ltype,'f.a.','fold axis');
update sources.ca_carizoplain_lines set new_type=NULL where new_type='scratch';
update sources.ca_carizoplain_lines set name='Gold Hill Fault' where gid in (237,338,358,394,7067);
update sources.ca_carizoplain_lines set name='San Andreas Fault',new_type='strike-slip fault' where gid in (7051,7059,7068,7092,7099,7116,7129,7158,7215,7266,7278,4371,826,7320,7358,7393,7399,5011,7415,5141,7424,7426,7431,5446,2953,2958,5813,6027,6178,6241,5434,6452,6634,6658,6694,6764,6788,2395);
update sources.ca_carizoplain_lines set name='Rinconada Fault' where gid in (6024,6041,6061,6116,6217,6227,4656,4545,4513,4486,4474,4450,4822,1071,1080,1090,1099,1469,1516,1522,1540,1552,5714,5750,5914,5954,5975,6024,6041,6061,6116,6217,6227,6346);
update sources.ca_carizoplain_lines set name='Recruit Pass Fault' where gid in (6100,6176,5981,5951,1676,5894,5817,1640,6176,1844,1849,1859,1864,6308);
update sources.ca_carizoplain_lines set name='Whiterock Fault' where gid in (1979,1871,2021,2033,2068,2080,2094,);
update sources.ca_carizoplain_lines set new_direction='right-lateral' where new_type='strike-slip fault';
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,160,name,ltype,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_carizoplain_lines where new_type is not null and geom is not null;

pg_dump -t sources.ca_carizoplain_lines  -C -O burwell | gzip > ~/Desktop/ca_carizoplain_lines.sql.gz
pg_dump -t sources.ca_carizoplain  -C -O burwell | gzip > ~/Desktop/ca_carizoplain.sql.gz
pg_dump -t sources.ca_carizoplain_points  -C -O burwell | gzip > ~/Desktop/ca_carizoplain_points.sql.gz

INSERT INTO points.points (orig_id,source_id,comments,point_type,strike,dip,dip_dir,geom) SELECT gid,160,pttype,point_type,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.ca_carizoplain_points where point_type is not null;

#161 florissant
update sources.florissant set name='Holocene alluvium',age='Holocene',description='alluvium' where glg_sym='Qal';
update sources.florissant set name='Quaternary colluvium',age='Holocene to Pleistocene',description='Thin gravels mantling slopes, composed of granular grus derived from the Pikes Peak Granite, rhyolitic gravel derived from the Wall Mountain Tuff, and shale, mudstone, sandstone, and silicified wood. fragments derived from the Florissant Formation. Unconformity at the unit''s base.' where glg_sym='Qc';
update sources.florissant set name='Pleistocene gravels',age='Pleistocene',description='Thick gravels mainly composed of granular grus derived from the Pikes Peak Granite. Also includes scattered fragments of Wall Mountain Tuff and silicified wood. Vertebrate fossils rare, including a mammoth (Cockerell, 1907). Unconformity at the unit''s base. (Evanoff, 1992 Map).' where glg_sym='Qg';
update sources.florissant set name='Florissant Formation, unit 5',strat_name='Florissant Formation',age='Eocene',description='Pumice-rich white sandstones and conglomerates, structureless to locally trough crossbedded. Numerous pink pumice clasts near top. Near south entrance includes poorly sorted brown pumiceous sandstones interbedded with scattered lenticular mudstones and shales. Contains locally abundant fingernail clams, rare plant and lymnaeid snail fossils. Maximum measured thickness 22.8 m. Lacustrine at base, fluvial at top. (Evanoff, 1992 Map).' where glg_sym='Tf5';
update sources.florissant set name='Florissant Formation, unit 4',strat_name='Florissant Formation',age='Eocene',description='Gray to greenish brown paper shales and blocky mudstones; interbedded with planar, thin yellow to white pumiceous sandstone beds. Near the south entrance this unit is represented by fossiliferous gray to yellowish brown sandstones interbedded with cherty stromatolites. Fossils include leaves, insects, ostracodes, fish scales, and fingernail clams. Maximum measured thickness 5.6 m in the northwest corner of the monument; unit thins to the south. Lacustrine. (Evanoff, 1992 Map).' where glg_sym='Tf4';
update sources.florissant set name='Florissant Formation, unit 3',strat_name='Florissant Formation',age='Eocene',description='Yellowish-gray conglomerate with subangular to rounded clasts of tuff, quartz, and andesite. Locally contains blocks of andesite, pumiceous sandstones and blocky mudstone. Unit typically graded, otherwise structureless to crudely horizontally bedded. Fossils include scattered fingernail clams near top. Maximum thickness 7.9 m measured near Lodge stump (E of Scudder pit). Unit thins to the north and is not present in the northwest corner of the monument. Represents a volcanigenic debris-flow deposit. (Evanoff, 1992 Map)' where glg_sym='Tf3';
update sources.florissant set name='Florissant Formation, unit 2',strat_name='Florissant Formation',age='Eocene',description='Interbedded brown paper shales, grayish brown blocky mudstones, thin yellowish pumiceous sandstones, and thin granular pumice conglomerates. Contains abundant plant fossils with less abundant insects and planorbid snails. Most of the fossil quarries in the monument occur in the this unit. Maximum thickness 9 m. Lacustrine. (Evanoff, 1992 Map).' where glg_sym='Tf2';
update sources.florissant set name='Florissant Formation, unit 1',strat_name='Florissant Formation',age='Eocene',description='Tan to gray blocky tuffaceous mudstones interbedded with yellowish gray pumiceous sandstones and rare arkosic sandstone ribbons. The arkosic sandstones typically have abundant trough crossbedding. Fossil include stumps and logs of gymnosperms and angiosperms, scattered leaves and rare mammal bones. Bottom contact poorly exposed, with a maximum measured thickness of 10.4 m. Fluvial with a volcanigenic mudflow deposit at the top.' where glg_sym='Tf1';
update sources.florissant set name='Eocene boulder conglomerate',age='Eocene',description='Lenticular boulder conglomerate composed primarily of large rounded blocks of Pikes Peak Granite, and secondarily of gneiss and rhyolite cobbles and boulders. Rhyolite clasts are rounded to subangular and were derived from the Wall Mountain Tuff. Contains scattered silicified wood fragments. Unit is interbedded with Tf1, and rests on surface cut into the Wall Mountain Tuff and the Pikes Peak Granite. Probable equivalent of the Tallahassee Creek Conglomerate exposed south of Wrights Reservoir (Wobus and Epis, 1978) secondary ref. Maximum thickness about 15 m. Fluvial and debris-flow deposit. (Evanoff, 1992 Map).' where glg_sym='Tb';
update sources.florissant set name='Wall Mountain Tuff',strat_name='Wall Mountain Tuff',age='Priabonian',description='Rhyolitic welded tuff, brownish gray to dark gray. Contains abundant sanidine and less abundant biotite, argillized plagioclase, and magnetite. Weathers to large angular to subangular blocks. Mantles sides of the Florissant paleovalley, and is as thick as 15 m in lower exposures. Age of this tuff is 36.6 +/- 0.06 Ma based on 40Ar/39Ar dating (McIntosh and others, 1992). (Evanoff, 1992 Map).' where glg_sym='Twm';
update sources.florissant set name='Pikes Peak Granite',strat_name='Pikes Peak Granite',age='Stenian',description='Medium to coarsely crystalline reddish granite and quartz monzanite. Contains abundant perthitic microcline, quartz, and biotite. Weathers into rounded tors and boulders, and into granular grus. Age is 1041 +/- 13 Ma based on Rb/Sr isochron (Hedge, 1970). (Evanoff, 1992 Map).' where glg_sym='PCg';

update sources.florissant set early_id=m.id,late_id=m.id from macrostrat.intervals m where age=interval_name;
update sources.florissant set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pleistocene' and l.interval_name='Holocene' and age='Holocene to Pleistocene';

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,161,new_type,ST_MakeValid(geom) FROM sources.florissant_lines where new_type is not null and geom is not null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,161,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.florissant;

pg_dump -t sources.florissant -C -O burwell | gzip > ~/Desktop/florissant.sql.gz
pg_dump -t sources.florissant_lines -C -O burwell | gzip > ~/Desktop/florissant_lines.sql.gz

#162 wi_ashland
update sources.wi_ashland set descrip='Dolomite and dolomitic marble. Tan to white.  Generally thick bedded, commonly with lenses or thin beds of chert.  Most primary textures obliterated by metamorphism but domal structures preserved in cherty layers are probably algal mounds.  Coarse rosettes of tremolite are common along cherty beds.  In central part of map area, unit is mostly breccia of chert fragments in a cherty or sandy matrix or monolithic conglomerate with subrounded pebbles of chert.' where symbol='Xb';
update sources.wi_ashland set descrip='Quartzite, gray to red. Mostly fine- to medium-grained, and well-bedded quartz arenite.  Near base is mostly conglomerate composed of clasts of Early Proterozoic metasedimentary rocks.' where symbol='Yb';
update sources.wi_ashland set descrip='Basalt at western edge of map area.  Known from extensive exposures to west but not exposed in map area.' where symbol='Ycw';
update sources.wi_ashland set descrip='Red, brown, and white feldspathic sandstone, generally thick-bedded and commonly crossbedded.  Rare interbeds of red shale and conglomerate.' where symbol='Ych';
update sources.wi_ashland set descrip='Red to brown conglomerate, sandstone, and siltstone. Conglomerates are generally massive to crudely bedded and contain rounded clasts of mostly felsic volcanic rocks as much as 50 cm in diameter.  Sandstones are mostly lithic arenites, commonly trough crossbedded with dominantly volcanic grains. Conglomerates are mostly near the base and finer grained rocks are higher in section. Contains some interbedded basalt flows near base in Michigan' where symbol='Yc';
update sources.wi_ashland set descrip='White to tan quartz arenite, generally thin-bedded.  Crossbeddng and ripple marks are common.' where symbol='Yde';
update sources.wi_ashland set descrip='Red, brown, and tan sandstone with minor shale and conglomerate beds.  Mostly fine- to medium-grained feldspathic and lithic arenite, commonly micaceous.  Well bedded and commonly crossbedded.' where symbol='Yf';
update sources.wi_ashland set unit_name='Freda Sandstone: conglomeratic facies',descrip='Interbedded red and brown conglomerate and sandstone.  Conglomerate beds are massive, immature, and poorly sorted units with clasts of volcanic and intrusive rocks.  Clasts vary from well rounded to subangular and consist mostly of mafic and felsic volcanic rocks in roughly equal proportion. Sandstone interbeds are typical of the Freda Sandstone.' where symbol='Yfc';
update sources.wi_ashland set descrip='Unit defined and traced by exploration drilling and prominent aeromagnetic anomaly. Exposures are lacking. Upper part mostly irregularly bedded magnetite and hematite beds interlayered with dark-gray to black chert. Lower part is even-bedded carbonate and silicate iron-formation.' where symbol='Xif';
update sources.wi_ashland set descrip='Strongly ferruginous unit consisting of interbeds of two lithologies: (1) thick- and commonly irregularly bedded, white, gray, and red chert, commonly granular or oolitic. Ferruginous layers consist of hematite, magnetite, and lesser iron carbonate and iron silicate minerals, (2) thinly and regularly bedded, gray-green, cherty carbonate-silicate-magnetite iron-formation.  Metamorphism is progressively more intense from east to west.  West of Upson, Wis., originally carbonate-bearing units are generally converted to iron-silicate and magnetite beds.  East of Upson, the iron-formation contains masses of earthy limonite and hematite previously mined as iron ore.' where symbol='Xi';
update sources.wi_ashland set descrip='Red to brown conglomerate with sandstone interbeds. Mostly lithic arenite.  Conglomerate clasts are mostly iron-formation and vein quartz. Conglomerates are massive to crudely bedded. Sandstone is generally well-bedded, in part, crossbedded.' where symbol='Yj';
update sources.wi_ashland set descrip='Two thick rhyolite units occur near the top of the formation.  The uppermost flow is a massive, pink, quartz- and plagioclase-phyric rhyolite, generally devoid of internal texture.  The stratigraphically lower unit is distinctly flow-banded, pink, quartz-phyric rhyolite.' where symbol='Ykf';
update sources.wi_ashland set descrip='Lava flows mostly of andesite, but includes basalt and felsite.  Purple, brown, or reddish colors predominate.  Flows range from 9 to 60 m thick, and most have autobrecciated and vesicular tops.  A few flows are glomeroporphyritic or have abundant platy porphyroblasts of pink plagioclase as much as 4 cm in diameter' where symbol='Yk';
update sources.wi_ashland set descrip='Pink, massive, medium- to coarse-grained granitic rocks.  Equigranular to porphyritic.  Biotite- and hornblende-bearing in places.  Contains border zone rich in country rock xenoliths.' where symbol='Ymgr';
update sources.wi_ashland set descrip='Brick-red to pink, fine- to medium-grained granophyre and ferrodiorite. Small phenocrysts of plagioclase in graphic-textured matrix of K-feldspar and quartz.  Ferrodiorite is commonly hornblende-bearing.' where symbol='Ymgp';
update sources.wi_ashland set descrip='Dark-gray to black. Plagioclase laths up to 1 cm, commonly strongly oriented. Olivine generally abundant and apatite is common accessory. Abundant opaque minerals in places.' where symbol='Ymf';
update sources.wi_ashland set descrip='Plagioclase-rich gabbro in which olivine is generally more abundant than pyroxene. Forms basal zone of Mineral Lake and Potato River intrusions.' where symbol='Ymo';
update sources.wi_ashland set descrip='Medium- to coarse-grained rocks containing more than 85 percent plagioclase. Accessory minerals are clinopyroxene, orthopyroxene, minor hornblende, apatite, and opaque minerals. Mapped as separate unit only in Potato River intrusion.' where symbol='Yma';
	update sources.wi_ashland set descrip='Gabbro, anorthositic gabbro, gabbroic anorthosite-Coarse-grained, generally 80 to 90 percent plagioclase (An55 to An60), lesser clinopyroxene, orthopyroxene, and rare olivine. Plagioclase crystals commonly show preferred orientation.' where symbol='Ymg';
	update sources.wi_ashland set descrip='Metamorphosed diabase and gabbro. Generally massive with well-preserved igneous textures.  Most pyroxenes have been converted to actinolite, hornblende, and biotite.  Occurs as sills in Early Proterozoic strata and as abundant dikes cutting Archean rocks.  The latter are not shown on the map' where symbol='Xmd';
	update sources.wi_ashland set descrip='Siltstone, shale, sandstone,  mostly gray to black, some red units. In Michigan basal beds are locally mineralized with chalcocite.  Becomes interbedded with red sandstone and conglomerate near its pinch-out near Mellen, Wis.' where symbol='Yn';
	update sources.wi_ashland set descrip='Red, brown, and white feldspathic sandstone, crossbedded in part.  Rare interbeds of red shale and conglomerate.' where symbol='Yo';
	update sources.wi_ashland set descrip='Gray, gray-green, and reddish-brown argillite, siltstone, quartzite, and conglomerate.  Locally has thin basal conglomerate containing clasts of Archean and older Early Proterozoic strata.  Remainder of the unit is a generally coarsening-upward sequence of thin-bedded siltstone to fine sandstone near base and massive to crossbedded, white to pink quartzite near top.  Locally includes dolomite and chert breccia of underlying Bad River Dolomite where that unit is too thin to show separately.' where symbol='Xp';
	update sources.wi_ashland set descrip='Massive, purplish rhyolite containing small quartz and plagioclase phenocrysts.  Outcrops are present only at Copper Peak and Chippewa Falls on the Black River in Michigan.' where symbol='Ypr';
	update sources.wi_ashland set descrip='Mostly gray, grayish red, or purple andesite flows.  Average flow thickness about 8 m.  Aphanitic to sparsely porphyritic with plagioclase phenocrysts.  Flows are pahoehoe or autobrecciated and commonly sparsely vesicular.  Vesicles filled with chlorite, epidote, quartz, and calcite.' where symbol='Ypa';
update sources.wi_ashland set descrip='Basalt and minor andesite.  Medium- to dark-gray and gray-green.  Average flow thickness 11 to 13 m. Flow tops are commonly grayish-red to grayish-red-purple and fragmental to vesicular.  Numerous conglomerate and sandstone beds between flows are composed of volcanic fragments.  Pebbles and cobbles are mostly well-rounded clasts of rhyolite and lesser basalt' where symbol='Ypl';
update sources.wi_ashland set descrip='Medium- to coarse-grained, pink, granitic rocks, commonly with coarse pegmatoidal patches.  Massive to weakly foliated and, in part, porphyritic with K-feldspar phenocrysts. Also includes biotite and hornblende gneiss and migmatite probably derived from the adjacent volcanic units.' where symbol='Wp';
update sources.wi_ashland set descrip='Felsic schist and pyroclastic rocks. Variably metamorphosed rhyolite and rhyodacite.  Original textures are poorly preserved, but fragmental textures in some outcrops indicate unit is at least partly pyroclastic.  Where least metamorphosed consists of quartz, plagioclase and K-feldspar with minor biotite, chlorite, epidote, and calcite.  Pyrite is locally abundant.  Most of unit is more highly metamorphosed and is quartz-feldspar-biotite-garnet schist.' where symbol='Wrf';
update sources.wi_ashland set descrip='Olivine gabbro, gabbro, quartz gabbro--Mostly medium- to coarse-grained olivine-bearing gabbro in which both olivine and some plagioclase have cumulus textures.  Grades to gabbro without olivine and to quartz-bearing gabbro.' where symbol='Yrp';
update sources.wi_ashland set descrip='Serpentinized peridotite--Dark-gray to black. Olivine and lesser magnetite have cumulus textures and are surrounded by anhedral plagioclase and pyroxene.  Most olivine grains are largely converted to serpentine.' where symbol='Yrs';
update sources.wi_ashland set descrip='Basalt and andesite, olive-gray to dark-greenish-gray. Commonly strongly chloritized.  Generally fine-grained and massive, but more felsic flows have plagioclase phenocrysts.  Flows generally 3 to 14 m thick.  Basal flows are thicker (35-50 m) than higher flows and generally pillowed.  Flow tops are pahoehoe and sparsely vesicular.  Vesicles are filled with chlorite, epidote, quartz, and calcite.  In western half of map area flows are strongly metamorphosed to hornblende and pyroxene hornfels in which granoblastic texture obliterates original igneous textures.  Where most strongly metamorphosed, segregations and veinlets of granophyric granite are abundant.' where symbol='Ys';
	update sources.wi_ashland set descrip='Quartz-rich graywacke and argillite. Gray, greenish-gray, and brown. Thin- to thick-bedded, commonly graded-bedded. Ripple marks and cross laminations also common. Ferruginous black chert, black pyritic slate, and feruginous conglomerate near base.' where symbol='Xt';
	update sources.wi_ashland set descrip='Includes enclaves of highly metamorphosed basalt within Mellen Intrusive Complex and volcanic units at depth in cross sections where formational contacts cannot be projected with confidence.' where symbol='Yv';
	update sources.wi_ashland set descrip='Unexposed unit known from exploration drilling to be chloritic schist, probably mafic volcanic or volcanogenic sedimentary rocks.' where symbol='Xv';
update sources.wi_ashland set lith=concat('Major:: {',major_lith, '}') where major_lith IS NOT NULL;
update sources.wi_ashland set lith=concat(lith, ',Minor:: {',concat_WS(',',minor1_lit,minor2_lit),'}') where minor1_lit IS NOT NULL;
	update sources.wi_ashland set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Paleoproterozoic' and prov_age='Early Proterozoic';
	update sources.wi_ashland set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Neoarchean' and prov_age='Late Archean';
	update sources.wi_ashland set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Mesoproterozoic' and prov_age='Middle Proterozoic';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,162,unit_name,strat_name,prov_age,descrip,lith,concat_WS('; ',prov_orign,env_formtn,lower(tect_setng)),late_id,early_id,ST_MakeValid(geom) FROM sources.wi_ashland;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,162,type,new_type,ST_MakeValid(geom) FROM sources.wi_ashland_lines where new_type is not null and geom is not null;

update sources.wi_ashland_points set point_type='bedding' where symbol='201';
update sources.wi_ashland_points set point_type='foliation' where symbol='202';
update sources.wi_ashland_points set point_type='overturned bedding' where symbol='219';
update sources.wi_ashland_points set point_type='bedding' where symbol='221';
	update sources.wi_ashland_points set point_type='foliation' where symbol='222';
	update sources.wi_ashland_points set point_type='foliation' where symbol='224';
	update sources.wi_ashland_points set point_type='foliation' where symbol='225';

INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,160,point_type,azimuth::int,incline::int,dip_dir,ST_MakeValid(geom) FROM sources.wi_ashland_points where point_type is not null;

pg_dump -t sources.wi_ashland_points -C -O burwell | gzip > ~/Desktop/wi_ashland_points.sql.gz
pg_dump -t sources.wi_ashland_lines -C -O burwell | gzip > ~/Desktop/wi_ashland_lines.sql.gz
pg_dump -t sources.wi_ashland -C -O burwell | gzip > ~/Desktop/wi_ashland.sql.gz


## wy_rawlins
update sources.wy_rawlins set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Quaternary' and age='Tertiary/Quaternary? or Pleistocene?';
update sources.wy_rawlins set name=g_unit where name is null;
update sources.wy_rawlins set description='Cloverly: Gray to brown fine- to coarse-grained sandstone, purple claystones and black shale beds in middle, and a basal tan to white sandstone and chert conglomerate; Morrison: Pale-green, olive-green, blue-green to maroon, and chalky white variegated calcareous and bentonite claystones interbedded with thin drab limestones and buff, non-resistant sandstones; Sundance: Variegated gray sandstone and siltstone, with greenish sandy shale in the lower part of the section and limestones in the upper part' where g_unit='KJs' and description is null;

update sources.wy_rawlins_lines set new_type=lower(new_type);
update sources.wy_rawlins_lines set new_type='fault' where new_type is null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,174,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_rawlins where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,174,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_rawlins_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_rawlins_lines -C -O burwell | gzip > ~/Desktop/wy_rawlins_lines.sql.gz
pg_dump -t sources.wy_rawlins -C -O burwell | gzip > ~/Desktop/wy_rawlins.sql.gz

#wy_torrington
update sources.wy_torrington set strat_name='Hartville Formation' where g_unit like 'PIPh%' and strat_name is null and name like '%Hartville%';
update sources.wy_torrington set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Eoarchean' and age='Lower Archean';
update sources.wy_torrington set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Paleoproterozoic' and age='Lower Proterozoic';
update sources.wy_torrington set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Mesoproterozoic' and age='Middle Proterozoic';
update sources.wy_torrington set early_id=e.id,late_id=l.id from macrostrat.intervals e,macrostrat.intervals l where e.interval_name='Neoarchean' and l.interval_name='Paleoproterozoic' and age='Lower Proterozoic or Upper Archean';
update sources.wy_torrington set early_id=e.id,late_id=l.id from macrostrat.intervals e,macrostrat.intervals l where e.interval_name='Neoarchean' and l.interval_name='Paleoproterozoic' and age='Lower Proterozoic to Upper Archean';
update sources.wy_torrington set name='water' where g_nam='water' and name is null;
update sources.wy_torrington set description='Interbedded maroon, pink, and gray siltstone and claystone; gray, brown and buff limestone; pink dolomite; and thin gray sandstone beds. Thickness 0 to 370 feet (0 to 113 m)' where description is null and g_unit='IPMh4-6';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,175,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_torrington where geom is not null;

update sources.wy_torrington_lines set new_type=lower(new_type);
update sources.wy_torrington_lines set new_type='dike', descrip='Mesproterozoic metadiabase' where fld_nam='Ym';
update sources.wy_torrington_lines set name='Gray Rocks Anticline' where gid IN (231);
update sources.wy_torrington_lines set name='Hartville Fault' where gid IN (281,277,72,40);
update sources.wy_torrington_lines set name='Wheatland Whalen Fault System' where gid IN (331,330,327,322,292,362,364,213,53,30,153,155,62,63,222,159,31,33,173,256,251,183,19,161,162,23,286,21,289,290,355,354,356,357,175,157,29,329,292,363,358,359,323,324,325,52,346);
update sources.wy_torrington_lines set name='Broom Creek Syncline' where gid IN (247,236);
update sources.wy_torrington_lines set name='Sawmill Anticline' where gid IN (228);
update sources.wy_torrington_lines set name='Cassa Anticline' where gid IN (246);

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,175,name,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_torrington_lines where new_type is not null and geom is not null;

pg_dump -t sources.wy_torrington_lines -C -O burwell | gzip > ~/Desktop/wy_torrington_lines.sql.gz
pg_dump -t sources.wy_torrington -C -O burwell | gzip > ~/Desktop/wy_torrington.sql.gz

#wy_baggs
update sources.wy_baggs set name='ultramafic' where name='Ultramfic';
update sources.wy_baggs set name=concat('mafic intrusive rocks ~1800 Ma: ',lower(name)),description=lower(name) where description is NULL and g_unit like 'Xs%';
update sources.wy_baggs set name=concat('mafic intrusive rocks ~1700-2300 Ma: ',lower(name)),description=lower(name) where description is NULL and g_unit like 'Xn%';
update sources.wy_baggs set description='diabase rocks' where description='diabasic rocks';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,177,name,strat_name,age,descrip,comments,late_id,early_id,ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3) FROM sources.wy_farson where geom is not null;

update sources.wy_baggs_lines set new_type=lower(new_type);
update sources.wy_baggs_lines set descrip=type where name=descrip;
update sources.wy_baggs_lines set descrip=NULL where descrip='thrust_2';
update sources.wy_baggs_lines set descrip='concealed' where descrip='Concealed_thrust2';
update sources.wy_baggs_lines set name=null, descrip=name where name='concealed';
update sources.wy_baggs_lines set name='Middlewood Anticline' where gid in (148,147,439,436,441,440);
update sources.wy_baggs_lines set name='Upper Sage Creek Anticline' where gid in (145,144);
update sources.wy_baggs_lines set name='Lake Valley Anticline' where gid in (142);
update sources.wy_baggs_lines set name='Dad Arch' where gid in (128,133,131,132,130,129,134,135,136);

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,176,name,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_baggs_lines where new_type is not null and geom is not null;

update sources.wy_baggs_points set point_type=NULL where dip=0 and type not like 'strike_dip';
INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,176,point_type,strike::int,dip::int,rotation::int,ST_MakeValid(geom) FROM sources.wy_baggs_points where point_type is not null;

pg_dump -t sources.wy_baggs_points -C -O burwell | gzip > ~/Desktop/wy_baggs_points.sql.gz
pg_dump -t sources.wy_baggs_lines -C -O burwell | gzip > ~/Desktop/wy_baggs_lines.sql.gz
pg_dump -t sources.wy_baggs -C -O burwell | gzip > ~/Desktop/wy_baggs.sql.gz

#179 gumo
update sources.gumo set strat_name='Cutoff Shale' where help_id='Pbc';
update sources.gumo set strat_name='Bone Spring Limestone' where help_id in ('Pbv');
update sources.gumo set strat_name='Victorio Peak Limestone' where help_id in ('Pbl');
update sources.gumo set strat_name='Getaway Limestone Member' where help_id='Pdc1';
update sources.gumo set strat_name='South Wells Limestone Member' where help_id='Pdc2';
update sources.gumo set strat_name='Manzanita Limestone Member' where help_id='Pdc3';
update sources.gumo set strat_name='Manzanita Limestone Member' where help_id='Pdc3a';
update sources.gumo set strat_name='Hegler Limestone Member' where help_id='Pdb4';
update sources.gumo set strat_name='Lamar Limestone Member' where help_id='Pdb8';
update sources.gumo set strat_name='Pinery Limestone Member' where help_id='Pdb5';
update sources.gumo set strat_name='Rader Limestone Member' where help_id='Pdb6';
update sources.gumo set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.gumo set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');
update sources.gumo set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name='Holocene' and age='Recent';
update sources.gumo set lith=concat(lith,'; silt and mud') where name='alkali flats';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,179,name,strat_name,age,lith,late_id,early_id,ST_MakeValid(geom) FROM sources.gumo where geom is not null;

update sources.gumo_lines set flt_nm=NULL where flt_nm='NA';
update sources.gumo_lines set flt_nm=initcap(flt_nm);
update sources.gumo_lines set new_type='normal fault';
insert into sources.gumo_lines (gid,help_id,geom,new_type,descrip) SELECT gid+1481,help_id,geom,'bed','Cherry Canyon Formation: quartzite, known or certain' from sources.gumo_geolines;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,179,flt_nm,descrip,new_type,ST_MakeValid(geom) FROM sources.gumo_lines where new_type is not null and geom is not null;

update sources.gumo_points set point_type='bedding' where atd_type<=10;
update sources.gumo_points set dip_dir=atd_st+90;
update sources.gumo_points set dip_dir=dip_dir-360 where dip_dir>360;
update sources.gumo_points set atd_st=0 where atd_type=4;
update sources.gumo_points set strike=atd_st,dip=atd_dp;
INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,179,point_type,strike::int,dip::int,dip_dir::int,ST_MakeValid(geom) FROM sources.gumo_points where point_type is not null;

pg_dump -t sources.gumo_points -C -O burwell | gzip > ~/Desktop/gumo_points.sql.gz
pg_dump -t sources.gumo_lines -C -O burwell | gzip > ~/Desktop/gumo_lines.sql.gz
pg_dump -t sources.gumo -C -O burwell | gzip > ~/Desktop/gumo.sql.gz

#180 ontario_pz
update sources.ontario_pz set group_=NULL where group_=' ';
update sources.ontario_pz set formation=NULL where formation=' ';
update sources.ontario_pz set member=NULL where member=' ';
update sources.ontario_pz set descript_full=NULL where descript_full=' ';
update sources.ontario_pz set formation=NULL where formation='Precambrian';
update sources.ontario_pz set group_='Clinton Group; Cataract Group' where group_='Clinton-Cataract Group';
update sources.ontario_pz set group_='Cobalt Group',formation=NULL where orig_lithology like '%Cobalt Group%' and group_ is null;
update sources.ontario_pz set formation=replace(formation,',',' Formation; ');
update sources.ontario_pz set member=NULL where member in ('lower member','middle member','upper member') or member like 'Facies%';
update sources.ontario_pz set formation=concat(formation,' Formation') where formation is not null;
update sources.ontario_pz set formation=replace(formation,',','; ') where formation is not null;
update sources.ontario_pz set formation=replace(formation,';',' Formation; ') where formation is not null;
update sources.ontario_pz set formation=replace(formation,'; ',';');
update sources.ontario_pz set strat_name=formation;
update sources.ontario_pz set strat_name=group_ where strat_name is null;

update sources.ontario_pz set member=concat(member, ' Member') where member is not null and member not like 'Lithofacies%';
update sources.ontario_pz set member=replace(member,';',' Member') where member like '%;%';
update sources.ontario_pz set member=replace(member,'/',' Member; ');
update sources.ontario_pz set member=NULL where member like 'Lithofacies%';
update sources.ontario_pz set strat_name=member where member is not null;
update sources.ontario_pz set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.ontario_pz set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');
delete from sources.ontario_pz where gid in (1413,1647,1622,938,705,537,337,181,179,177,8,3,7,321,336,1267,1524,180) and orig_unit='wat';
update sources.ontario_pz set geom=ST_Transform(geom,4326);
update sources.ontario_pz set omit_poly='T' where gid in (4,879,890,889,1024,888,688,687,686,321,887,888,889,890,879,685,515,325,326,178,2,984,1244,357,174,128,962,961);

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,180,unit_name,strat_name,age,orig_lithology,descript_full,late_id,early_id,ST_MakeValid(geom) FROM sources.ontario_pz where geom is not null and omit_poly!='T';

INSERT INTO lines.large (orig_id,source_id,new_type,geom) SELECT gid,180,new_type,ST_MakeValid(geom) FROM sources.ontario_pz_lines where new_type is not null and geom is not null;




CREATE TABLE sources.ontario_pz_mod AS
select unit_name, strat_name, age, orig_lithology, descript_full, late_id, early_id, (ST_Dump(ST_Union(ST_MakeValid(geom)))).geom as geom
FROM sources.ontario_pz
where geom is not null and omit_poly!='T'
GROUP BY unit_name, strat_name, age, orig_lithology, descript_full, late_id, early_id;
ALTER TABLE sources.ontario_pz_mod ADD COLUMN gid SERIAL PRIMARY KEY;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,180,unit_name,strat_name,age,orig_lithology,descript_full,late_id,early_id,ST_MakeValid(geom) FROM sources.ontario_pz_mod where geom is not null;


#181 wy_gillette
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,181,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_gillette where geom is not null;

#182 wy_lancecreek
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,182,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_lancecreek where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,182,name,new_type,ST_MakeValid(geom) FROM sources.wy_lancecreek_lines where new_type is not null and geom is not null;

#183 wy_kinneyrim
update sources.wy_kinneyrim set description='Interbedded gray and tan, fine- to coarse-grained sandstone; gray and brown siltstone; gray, brown and green mudstone; gray and brown shale; brown oil shale; gray or white tuff; limestone and dolomite. Thickness 0 to 689 feet (0 to 210 m)' where strat_name='Hartt Cabin Bed';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,183,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_kinneyrim where geom is not null;

update sources.wy_kinneyrim_lines set new_type=lower(new_type);
update sources.wy_kinneyrim_lines set type='marker bed',new_type='bed' where new_type='marker bed';
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,183,type,new_type,ST_MakeValid(geom) FROM sources.wy_kinneyrim_lines where new_type is not null and geom is not null;

#184
update sources.ontario_pz set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.ontario_pz set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');

#187 wy_recluse
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,187,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_recluse where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,187,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_recluse_lines where new_type is not null and geom is not null;

update sources.wy_recluse set new_geom=ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3);
with T AS (SELECT gid, ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3) g from sources.wy_recluse) update sources.wy_recluse set new_geom=T.g from T where T.gid=wy_recluse.gid;

#188 wy_midwest
UPDATE sources.wy_midwest set name=g_nam where name is null;
update sources.wy_midwest_lines set new_type=lower(new_type);

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,188,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_midwest where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,188,flt_name,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_midwest_lines where new_type is not null and geom is not null;

#189 bc_fernie
update sources.bc_fernie set max_age=age_max,min_age=age_min,age=tag_age,descrip=unit_notes1,strat_name=initcap(m.map_unit) from bc_data m where m.label=bc_fernie.label;

update sources.bc_fernie set strat_name='Gateway Formation',age='Mesoproterozoic',descrip='green and greenish-grey, micaceous siltstone, argillite, dolomitic argillite, dolomite, and quartz arenite; some interbeds of red and purplish-red argillaceous and micaceous siltstone and argillite in the lower part (equivalent to Mount Shields Formation of Harrison et al. (1992))' where map_unit='Gateway Fm';
update sources.bc_fernie set strat_name=initcap(m.parent2) from bc_data m where m.label=bc_fernie.label and strat_name is null;
update sources.bc_fernie set max_age='Tournaisian' where max_age='Tournasian';
update sources.bc_fernie set min_age='Tournaisian' where min_age='Tournasian';
update sources.bc_fernie set max_age='Griesbachian' where max_age='Greisbachian';
update sources.bc_fernie set min_age='Griesbachian' where min_age='Greisbachian';
update sources.bc_fernie set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name=replace(max_age,'Upper','Late') and l.interval_name=replace(min_age,'Upper','Late');
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name=replace(min_age,'Upper','Late');
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name=replace(max_age,'Upper','Late');
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name=replace(min_age,'Lower','Early');
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name=replace(max_age,'Lower','Early');
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Neoproterozoic' and max_age='Upper Proterozoic';
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Famennian' and max_age='Upper Famennian';
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Albian' and max_age='Middle-Upper Albian';
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Arenigian' and max_age='Arenig';
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Caradocian' and max_age='Lower Caradoc';
update sources.bc_fernie set early_id=e.id from macrostrat.intervals e where e.interval_name='Caradocian' and max_age='Caradoc';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Neoproterozoic' and min_age='Upper Proterozoic';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Famennian' and min_age='Upper Famennian';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Albian' and min_age='Middle-Upper Albian';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Arenigian' and min_age='Arenig';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Caradocian' and min_age='Lower Caradoc';
update sources.bc_fernie set late_id=e.id from macrostrat.intervals e where e.interval_name='Caradocian' and min_age='Caradoc';
update sources.bc_fernie set age='Cretaceous' where map_unit='Cretaceous trachyte';
update sources.bc_fernie set strat_name='Harrogate Formation; Burnais Formation; Cedared Formation' where strat_name='Harrogate, Burnais, And Cedared Formations';
update sources.bc_fernie set strat_name='Gladstone Formation; Cadomin Formation' where strat_name='Gladstone And Cadomin Formations';
update sources.bc_fernie set strat_name='Mist Mountain Formation; Morrissey Formation' where strat_name='Mist Mountain And Morrissey Formations';
update sources.bc_fernie set strat_name='Windsor Mountain Formation; Elko Formation; Gordon Shale; Flathead Sandstone' where strat_name='Windsor Mountain, Elko, Gordon, And Flathead Formations';
update sources.bc_fernie set strat_name='Fernie Formation' where strat_name is null and map_unit='Fernie Fm';
update sources.bc_fernie set strat_name='Fairholme Group; Palliser Formation' where strat_name is null and map_unit='Fairholme Gp and Palliser Fm';
update sources.bc_fernie set strat_name='Fairholme Group; Sassenach Formation; Alexo Formation' where strat_name is null and map_unit='Fairholme Gp, Sassenach and Alexo fms';
update sources.bc_fernie set strat_name='Exshaw Formation; Banff Formation' where strat_name is null and map_unit='Exshaw, Banff Fms';
update sources.bc_fernie set strat_name='Blairmore Group',descrip='coarse, igneous-clast, braided-fluvial conglomerate' where strat_name is null and map_unit='Blairmore conglomerate';
update sources.bc_fernie set strat_name='Cardium Formation; Blackstone Formation' where strat_name='Cardium And Blackstone Formations';
update sources.bc_fernie set strat_name='Purcell Supergroup',descrip='Fault slices of uncertain stratigraphic postion within the Purcell Supergroup. Includes siltstone, argillite, dolomite, quartz arenite and basalt volcanic flows.',age='Mesoproterozoic' where map_unit='Note 2';

update sources.bc_fernie set descrip='Undivided Wapiabi, Cardium and Blackstone formations. Gray to black marine shale, siltstone, sandstone and argillaceous limestone' where descrip='Undivided' and map_unit='Alberta Gp';
update sources.bc_fernie set descrip='Undivided Fairholme Group and Palliser Formation. Includes dolomite, silty limestone, calcareous shale.' where descrip='Undivided' and map_unit='Fairholme Gp and Palliser Fm';
update sources.bc_fernie set descrip='trachyte' where map_unit='Cretaceous trachyte';
update sources.bc_fernie set descrip='Consolidated and unconsolidated debris (colluvium) from landslides' where map_unit='Quaternary sediment' and descrip='Consolidated and unconsolidated debris from landslides';
update sources.bc_fernie set min_age='Meoproterozoic',max_age='Meoproterozoic',age='Meoproterozoic', descrip='Thrust duplex zone comprising thin slices of Haig, Brook, Tombstone, and Waterton formations. Includes limestone, dolomite, argillaceous limestone and dolomite.' where map_unit='Note 1' and age is null;
update sources.bc_fernie set min_age='Mesoproterozoic',max_age='Mesoproterozoic',age='Mesoproterozoic', descrip='Thrust duplex zone comprising thin slices of Haig, Brook, Tombstone, and Waterton formations. Includes limestone, dolomite, argillaceous limestone and dolomite.',strat_name='Haig Formation; Brook Formation; Tombstone Formation; Waterton Formations' where map_unit='Note 1';
update sources.bc_fernie set min_age='Mesoproterozoic',max_age='Mesoproterozoic',age='Mesoproterozoic' where map_unit='gabbro plug';
update sources.bc_fernie set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name=replace(age,'Upper','Late') and l.interval_name=replace(age,'Upper','Late') and early_id is null;
update sources.bc_fernie set use_name=map_unit;
update sources.bc_fernie set use_name='Thrust duplex zone' where use_name='Note 1';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,189,map_unit,strat_name,age,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.bc_fernie where geom is not null;

insert into sources.bc_fernie_lines (gid,feature,subfeature,attitude,confidence,generation,name,hwall_dir,geom) select gid,feature,subfeature,attitude,confidence,generation,name,arrow_dir,geom from sources.bc_fernie_folds;

update sources.bc_fernie_lines set name=initcap(name);
update sources.bc_fernie_lines set new_type='normal fault' where subfeature='normal';
update sources.bc_fernie_lines set new_type='strike-slip fault',new_direction='right-lateral' where subfeature like 'dextral%';
update sources.bc_fernie_lines set new_type='strike-slip fault',new_direction='left-lateral' where subfeature like 'sinistral%';
update sources.bc_fernie_lines set new_type='syncline' where subfeature='syncline';
update sources.bc_fernie_lines set new_type='anticline' where subfeature='anticline';
update sources.bc_fernie_lines set new_type='fault' where subfeature='unknown';
update sources.bc_fernie_lines set new_type='thrust fault' where subfeature='thrust';
update sources.bc_fernie_lines set new_type='thrust fault' where subfeature='back-thrust';

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,189,name,concat_ws('; ',activity,generation,concat('location ',confidence)),new_type,new_direction,ST_MakeValid(geom) FROM sources.bc_fernie_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,point_type,comments,strike,dip,dip_dir,geom) SELECT gid,189,subfeature,attitude,strike::int,dip::int,dip_dir::int,ST_MakeValid(geom) FROM sources.bc_fernie_points where subfeature is not null;

pg_dump -t sources.bc_fernie_points -C -O burwell | gzip > ~/Desktop/bc_fernie_points.sql.gz
pg_dump -t sources.bc_fernie_lines -C -O burwell | gzip > ~/Desktop/bc_fernie_lines.sql.gz
pg_dump -t sources.bc_fernie -C -O burwell | gzip > ~/Desktop/bc_fernie.sql.gz


#190 africa
update sources.africa set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(strati,'Upper','Late');
update sources.africa set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(strati,'Lower','Early');
update sources.africa set early_id=m.id FROM macrostrat.intervals m WHERE split_part(strati,' to ',1) ilike concat('%',m.interval_name,'%') and early_id IS NULL;
update sources.africa set late_id=m.id FROM macrostrat.intervals m WHERE split_part(strati,' to ',2) ilike concat('%',m.interval_name,'%') and late_id IS NULL;
update sources.africa set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Mesoarchean' and l.interval_name='Neoarchean' and strati='Mesoarchean (to Neoarchean ?)';
update sources.africa set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Mesoarchean' and l.interval_name='Neoarchean' and strati='Mesoarchean (to Neoarchean ?)';
update sources.africa set litho='Metamorphic rocks, with Orosirian metamorphism (Tuareg Shield)' where litho='With Orosirian metamorphism (Tuareg Shield)';
update sources.africa set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Orosirian' and l.interval_name='Statherian' and strati='Orosirian to Statherian';
update sources.africa set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Precambrian' and l.interval_name='Paleozoic' and strati='Precambrian to Paleozoic';
update sources.africa set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Triassic' and l.interval_name='Early Jurassic' and strati='Triassic to Lower Jurassic';

update sources.africa_lines set new_type='normal fault' where descr ilike '%normal%';
update sources.africa_lines set new_type='thrust fault' where descr ilike '%thrust%';
update sources.africa_lines set new_type='fault' where descr ilike '%fault%' and new_type is null;
update sources.africa_lines set descr=lower(descr);
update sources.africa_lines set descr=null where descr=new_type;
update sources.africa set litho=lower(litho);
pg_dump -t sources.africa_lines -C -O burwell | gzip > ~/Desktop/africa_lines.sql.gz
pg_dump -t sources.africa -C -O burwell | gzip > ~/Desktop/africa.sql.gz

INSERT INTO lines.small (orig_id,source_id,descrip,new_type,geom) SELECT gid,190,descr,new_type,ST_MakeValid(geom) FROM sources.africa_lines where new_type is not null and geom is not null;

INSERT INTO maps.small (orig_id,source_id,age,lith,t_interval,b_interval,geom) SELECT gid,190,strati,litho,late_id,early_id,ST_MakeValid(geom) FROM sources.africa where geom is not null;

#191 iran
update sources.iran set strat_name=split_part(descriptio,' (',2) where descriptio ilike '%Fm%' or descriptio ilike '%Complex%' or descriptio ilike '%Limestone%' or descriptio ilike '%Granite%' or descriptio ilike '%Dolomite%' or descriptio ilike '%shale%' or descriptio ilike '%formation%' or descriptio ilike '%Complex%';
update sources.iran set strat_name=NULL where strat_name='';
update sources.iran set strat_name=replace(strat_name,')','');
update sources.iran set strat_name='Kahar Formation; Kalmard Formation' where strat_name='Kahar Formation ; Morad Series And Kalmard Formation';
update sources.iran set strat_name='Barreh Koshan Complex; Rutchan Complex' where strat_name='Barreh Koshan Complex And Rutchan Complex';
update sources.iran set strat_name='Darian Formation; Fahlian Formation' where strat_name='Darian And Fahlian Fms.';
update sources.iran set strat_name='Kermanshah Radiolarite; Neyzar Radiolarite' where strat_name='Kermanshah And Neyzar Radiolarites';
update sources.iran set strat_name='Kuhbanan Formation; Kalshaneh Formation' where strat_name='Kuhbanan And Kalshaneh Formation';
update sources.iran set strat_name='Kamsefid Sandstone' where strat_name='E.G. Ruk, Nargakan, Mashkid Units And Kamsefid Sandstone';
update sources.iran set strat_name=NULL where strat_name='Phyllite And Sandstone';
update sources.iran set strat_name='Bajgan Metamorphic Complex; Deyader Complex' where strat_name='Bajgan Metamorphic Complex And Deyader Complex';
update sources.iran set strat_name='Darreh-Zanjir Formation' where strat_name='Including: Darreh-Zanjir Formation';
update sources.iran set strat_name='Kashafrud Formation; Bashcalateh Shale' where strat_name='Kashafrud Formation, Locally Including  Bashcalateh Shale';
update sources.iran set strat_name='Khanehkat Formation; Neyriz Formation' where strat_name='Khanehkat And Neyriz Formation';
update sources.iran set strat_name=NULL where strat_name like '%Intercalation';
update sources.iran set strat_name='Bajgan Metamorphic Complex; Deyader Complex' where strat_name='Bajgan Metamorphic Complex And Deyader Complex';
update sources.iran set strat_name=NULL where strat_name like '%Unit';
update sources.iran set strat_name=NULL where strat_name like '%Units';
update sources.iran set strat_name=NULL where strat_name like '%Sediments';
update sources.iran set strat_name=NULL where strat_name like 'Fusulinid Limestone, Locally Crystaline Limestone';
update sources.iran set strat_name='Esfandiar Limestone' where strat_name='Equi. Of Esfandiar Limestone';
update sources.iran set strat_name='Darreh-Zanjir Formation' where strat_name='Including: Darreh-Zanjir Formation';
update sources.iran set strat_name='Kashafrud Formation; Bashcalateh Shale' where strat_name='Kashafrud Formation, Locally Including  Bashcalateh Shale';
update sources.iran set strat_name='Khanehkat Formation; Neyriz Formation' where strat_name='Khanehkat And Neyriz Formation';
update sources.iran set strat_name=NULL where strat_name='Probably Equi. Of Durkan Complex';
update sources.iran set strat_name=NULL where strat_name like '% Series';
update sources.iran set strat_name='Sibzar Dolomite; Bahram Formation' where strat_name like 'Sibzar Dolomite & Bahram Formation';
update sources.iran set strat_name='Sorkh Shale' where strat_name like 'Sorkh Shale Equivalant';
update sources.iran set strat_name=NULL where strat_name like 'Upperttuff Member';
update sources.iran set strat_name=NULL where strat_name like 'Wild Flysch';
update sources.iran set strat_name='Doran Granite' where descriptio ilike '%Doran Granite%';
update sources.iran set strat_name='Gachsaran Formation; Mishan Formation; Aghajari Formation' where descriptio ilike 'Fars Group%' and strat_name is null;
update sources.iran set strat_name='Shir Kuh Granite; Shah Kuh Granite' where descriptio ilike '%Shir Kuh Granite and Shah Kuh Granite%' and strat_name is null;
update sources.iran set strat_name='Kazhdumi Formation; Sarvak Formation; Surgah Formation; Ilam Formaton' where descriptio ilike '%Kazhdumi, Sarvak, Surgah and Ilam%' and strat_name is null;
update sources.iran set strat_name='Lalun Sandstone' where descriptio ilike '%LALUN SANDSTONE%' and strat_name is null;
update sources.iran set strat_name='Kerman Conglomerate' where descriptio ilike '%KERMAN CONGLOMERATE%' and strat_name is null;
update sources.iran set strat_name='Asmari Formation; Shahbazan Formation' where descriptio ilike '%Undivided Asmari and Shahbazan Formation%' and strat_name is null;
update sources.iran set strat_name='Pabdeh Formation Gurpi Formation' where descriptio ilike '%Undifferentiated Pabdeh and Gurpi Formations%';
update sources.iran set strat_name='Asmari Formation; Jahrum Formation' where descriptio ilike '%Undivided Asmari and Jahrum Formation, regardless to  the disconformity separates them%';
update sources.iran set strat_name='Khami Group; Bangestan Group' where descriptio ilike '%Jurassic to Cretaceous undivided sedimentary rocks including Khami and Bangestan Groups%';

update sources.iran set descriptio=trim(split_part(descriptio,' (',1)) where strat_name is not null;

update sources.iran set early_id=m.id FROM macrostrat.intervals m WHERE trim(split_part(age,'-',1)) ilike concat('%',m.interval_name,'%') and early_id IS NULL;
update sources.iran set late_id=m.id FROM macrostrat.intervals m WHERE trim(split_part(age,'-',2)) ilike concat('%',m.interval_name,'%') and late_id IS NULL;

update sources.iran set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.iran set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');

update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Triassic' and l.interval_name='Middle Triassic' and age='Early-Middle Triassic';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Cretaceous' and l.interval_name='Turonian' and age='Early-Middle Cretaceous';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Jurassic' and l.interval_name='Middle Jurassic' and age='Early-Middle Jurassic';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Jurassic' and l.interval_name='Cretaceous' and age='Late Mesozoic';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and age='Middle-Late Jurassic';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Triassic' and l.interval_name='Late Triassic' and age='Middle-Late Triassic';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Precambrian' and l.interval_name='Precambrian' and age='PreCambrian';
update sources.iran set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Proterozoic' and l.interval_name='Cambrian' and age='Proterozoic_Paleozoic';
update sources.iran set age=NULL where age='No Data';
update sources.iran set strat_name=NULL where strat_name='Lower Shale Member';

pg_dump -t sources.iran -C -O burwell | gzip > ~/Desktop/iran.sql.gz
pg_dump -t sources.iran_lines -C -O burwell | gzip > ~/Desktop/iran_lines.sql.gz

INSERT INTO lines.medium (orig_id,source_id,descrip,new_type,geom) SELECT gid,191,layer,new_type,ST_MakeValid(geom) FROM sources.iran_lines where new_type is not null and geom is not null;

INSERT INTO maps.medium (orig_id,source_id,age,descrip,strat_name,t_interval,b_interval,geom) SELECT gid,191,age,descriptio,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.iran where geom is not null;

#192 wy_bill
update sources.wy_bill set description=trim(description);

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,192,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_bill where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,new_type,geom) SELECT gid,192,flt_name,new_type,ST_MakeValid(geom) FROM sources.wy_bill_lines where new_type is not null and geom is not null;

#193 ut_lynndyl
update sources.ut_lynndyl set strat_name='Great Blue Limestone; Humbug Formation; Deseret Limestone' where strat_name='Great Blue And Humbug Formation; Deseret Limestone';
update sources.ut_lynndyl set strat_name=initcap(strat_name);
	#had to fix a bunch of arbitrary newlines in descriptions

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,193,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_lynndyl where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,193,description,new_type,ST_MakeValid(geom) FROM sources.ut_lynndyl_lines where new_type is not null and geom is not null;

pg_dump -t sources.ut_lynndyl -C -O burwell | gzip > ~/Desktop/ut_lynndyl.sql.gz
pg_dump -t sources.ut_lynndyl_lines -C -O burwell | gzip > ~/Desktop/ut_lynndyl_lines.sql.gz

#194 wy_renojunction
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,194,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_renojunction where geom is not null;

#195 wy_buffalo
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,195,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_buffalo where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,195,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_buffalo_lines where new_type is not null and geom is not null;

#196 wy_kaycee
update sources.wy_kaycee set description='Lance Formation: Light gray to light yellowish gray fine- to medium-grained lenticular sandstone interbedded with dark gray shales. Thickness 1500 to 3325 feet. Fox Hills Sandstone: Brownish gray to yellow brown sandstone interbedded with siltstone and dark sandy shale.' where name='Lance Formation and Fox Hills Sandstone undivided';
update sources.wy_kaycee set description='Granitic gneiss composed of quartz, plagioclase, biotite, and microcline. Intruded with quartz diorite and amphibolite dikes. Description modified from Hin richs and others (1990) and Palmquist (1961)' where name='Granitic gneiss';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,196,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_kaycee where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,196,descrip,new_type,ST_MakeValid(geom) FROM sources.wy_kaycee_lines where new_type is not null and geom is not null;

#197 wy_nwecastle
update sources.wy_newcastle set strat_name=replace(strat_name,'Fouche','Fourche');
update sources.wy_newcastle set name=replace(name,'Fouche','Fourche');
update sources.wy_newcastle set strat_name=replace(strat_name,'Fall Formation','Fall River Formation');
update sources.wy_newcastle set name=replace(name,'Fall Formation','Fall River Formation');
update sources.wy_newcastle_lines set new_type=lower(new_type),description=lower(description);
update sources.wy_newcastle_lines set name='Fanny Peak Monocline' where gid in (168);
update sources.wy_newcastle_lines set name='Black Hills Monocline' where gid in (169);

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,197,name,description,new_type,ST_MakeValid(geom) FROM sources.wy_newcastle_lines where new_type is not null and geom is not null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,197,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_newcastle where geom is not null;

#198 md_western
update sources.md_western set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(geologic_1,'Upper','Late');
update sources.md_western set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(geologic_1,'Lower','Early');
update sources.md_western set strat_name=map_unit;
update sources.md_western set strat_name='Rose Hill Formation; Keefer Formation' where strat_name='Rose Hill-Keefer Formations (undivided)';
update sources.md_western set strat_name='Conemaugh Group' where strat_name='Conemaugh Group (Undivided)';
update sources.md_western set strat_name='Needmore Shale; Marcellus Shale' where strat_name='Needmore-Marcellus Shales';
update sources.md_western set strat_name='Keyser Formation; Helderberg Formation' where strat_name='Keyser-Helderberg Formations (undivided)';
update sources.md_western set strat_name='McKenzie Formation; Bloomsburg Formation' where strat_name='McKenzie-Bloomsburg Formations (undivided)';
update sources.md_western set strat_name='Harrell Formation; Brallier Formation; Sherr Formation' where strat_name='Harrell-Brallier-Sherr Formations (undivided)';

update sources.md_western_lines set notes=initcap(notes);
update sources.md_western_lines set new_type='reverse fault' where label like 'High%';

update sources.md_western set descrip_long='Medium to dark gray, fissile shale at the base, overlain by medium gray, silty shale and thinly interbedded medium-grained sandstone; and then by thick- bedded, medium-grained, fining-upward sandstone at the top of the formation. The Martinsburg is up to 5,000 feet thick in the Washington County (1,500 m).' where label_1='*m';
update sources.md_western set descrip_long='Medium to dark gray, fissile shale at the base, overlain by medium gray, silty shale and thinly interbedded medium-grained sandstone; and then by thick- bedded, medium-grained, fining-upward sandstone at the top of the formation. The Martinsburg is up to 5,000 feet thick in the Washington County (1,500 m).' where label_1='Om';
update sources.md_western set descrip_long='Light-gray, fine- to medium-grained, medium-bedded, dense sandstone. Locally, sandstone layers are interbedded with thin, gray shale. The thickness of the Tuscarora Sandstone varies from less than 50 feet in Washington County to up to 380 feet in w estern Allegany County (15-115 m).' where label_1='St';
update sources.md_western set descrip_long='The Rose Hill Formation (Sr) consists of pale olive-gray to pale reddish gray, fissile shale. Shales are locally interbedded with fine-grained, thinly laminated to cross-laminated sandstone. The Rose Hill is overlain by the Keefer Sandstone (Sk), a light gray to tan, fine to medium-grained, thin- to medium- bedded, bioturbated sandstone, that is mapped separately in eastern Allegany and western Washington counties. The approximate thickness of the Rose Hill Formation and Keefer Formation combined is 300 feet (90 m).' where label_1='Srk';
update sources.md_western set descrip_long='Interbedded, greenish gray, calcareous shale and medium to dark gray, thinly bedded, fossiliferous limestone (Sm, McKenzie Formation), overlain by interbedded, reddish gray to brownish gray, fine-grained sandstone and hackly shale to mudrock (Sb, Bloomsburg). The McKenzie Formation is up to 300 feet thick (90 m), and the Bloomsburg Formation rarely exceeds 100 feet (30 m) in thickness.' where label_1='Smb';
update sources.md_western set descrip_long='The Keyser Limestone consists of light gray, coarsely crystalline crinoidal limestone in the lower 50 feet (15 m), becoming, medium to dark gray, medium- to thick-bedded, nodular, fossiliferous limestone containing dark gray chert nodules. The upper Keyser is thin -bedded, cherty, fossiliferous limestone. The Keyser is up to 300 feet thick in western Washington County and thins to approxim ately 200 feet in thickness in western Allegany County (60-90 m).
The Helderberg Limestone consists of medium gray, medium-bedded, cherty, crinoidal limestone (New Creek Member) ; overlain in western Washington County by a light gray, cross-bedded calcareous sandstone (Elbow Ridge Sandstone ); then a me dium-gray fossiliferous limestone containing beds of brown-weathering chert (Corriganville Limestone); which is succeeded by interbedded, cherty, dark-gray limestone, and dark calcareous shale (Licking Creek Member); and topped by a thin, black, brittle shale (Mandata Shale). The Helderberg Limestone is 150 to 180 feet thick in western Maryland (30-55 m).' where label_1='KDkh';
update sources.md_western set descrip_long='Interbedded, medium to dark gray, siliceous shale and sandy and cherty limestone near the base (Shriver Shale Member); overlain by tan fine-grained, calcareous sandstone, and then by light gray, medium- to coarse-grained, thin- to thick-bedded, calcareous sandstone at the top (Ridgely Member). The Oriskany is approximately 50 feet thick in western Washington County and thickens westward into Allegany County where it is up to 300 feet thick (15-90 m).' where label_1='Do';
update sources.md_western set descrip_long='Interbedded, gray, silty shale, light gray to tan sandstone, and coaly and reddish shale. In Allegany and Washington counties a reddish brown to gray, polymictic diamictite marks the base of the formation. The Rockwell Formation is more than 400 feet thick in western Washington County; thins to less than 100 feet in southern Garrett County (30 -120 m).' where label_1='MDr';
update sources.md_western set descrip_long='Interbedded, reddish brown to brownish red, locally greenish gray sandstone, reddish brown siltstone, shale, and rooted claystone. The thickness of the Hampshire varies from approximately 2,000 feet in Garrett County to more than 3,000 feet in eastern Allegany and western Washington counties (600-900m).' where label_1='Dh';
update sources.md_western set descrip_long='Interbedded, olive-gray medium- to coarse-grained, cross-bedded sandstone; greenish gray to dusky red, fossiliferous shale and siltstone. Thick (>30 feet, 10m) sandstone intervals occur both near the base and near the top of the formation. The Foreknobs ranges from 1,200 feet thick in Garrett County to more then 1,500 feet in thicknes s in e astern Allegany County (365 -460 m).' where label_1='Df';
update sources.md_western set descrip_long='The Harrell Shale is a dark gray, fissile, calcareous, thinly laminated, shale that weathers to thin yellowish gray shale chips. The base of the Harrell is marked by the black, very fissile Burket Shale Member. The Harrell grades eastward into the Brallier Formation. The Harrell Shale is up to 150 feet thick (45m).
The Brallier Formation is a succession of thinly interbedded, gray to olive-gray shale and siltstone and thin, fine-grained sandstone. The Brallier is 2,000 to 2,500 feet thick (600 -760 m).
The Sherr Formation is interbedded, reddish-brown to grayish brown shale; thin, gray siltstone; and fine-grained, bioturbated and fossiliferous sandstone. The thickness of the Sherr is approximately 1,000 feet in Garrett County and becomes indistinct in eastern Allegany and western Washington counties (300 m).' where label_1='Dhbs';
update sources.md_western set descrip_long='Medium gray to olive-gray, massive siltstone to fine-grained sandstone near the base and top of the formation; interbedded with these siltstone intervals are thinly interbedded siltstone, sandstone, and silty, hackly shale. Weathers brownish gray to grayish brown. The Mahantango Formation is approximately 1,400 feet thick in Allegany County and thins westward to less than 1,000 feet in thickness in the subsurface of Garrett County (300-425 m).' where label_1='Dm';
update sources.md_western set descrip_long='Light gray, tan, and reddish brown, coarse-grained to conglomeratic, thick-bedded to cross-bedded sandstone and thin beds of gray shale, and coaly shale. The Purslane is more than 300 feet thick in western Washington County and thins westward to approximately 150 feet thick in western Garrett County (45-90 m).' where label_1='Mp';
update sources.md_western set descrip_long='Light gray , cross-bedded, sandy lime stone to calcareous sandstone at the base (Loyalhanna Member); overlain by interbedded, reddish, fossiliferous mudstone, and tan to reddish brown, fine-grained sandstone, and reddish brown siltstone and variegated shale (Savage Dam Member); succeeded by thin- to medium-bedded, light to medium gray, argillaceous, fossiliferous limestone at the top (Wymps Gap Member). The Greenbrier Formation is 150 to 200 feet thick (45-60m).' where label_1='Mg';
update sources.md_western set descrip_long='Interbedded, reddish brown shale; variegated, root-mottled mudstone and siltstone, and reddish brown to greenish gray lenticular sandstone. The Mauch Chunk Formation is approximately 600 feet thick in Allegany County and thins westward to 300 feet in thickness in western Garrett County (90-180 m).' where label_1='Mmc';
update sources.md_western set descrip_long='Interbedded, light gray, micaceous sandstone and gray silty shale and thin, dark gray, marine shales in the lower half of the group, and greenish-gray and reddish brown to variegated mudstone, shale, claystone, and nodular nonmarine limestone in its upper part. The Conemaugh Group is 800 to 900 feet thick (245 to 275 m).' where label_1='*c';
update sources.md_western set descrip_long='Interbedded, medium gray to dark gray, carbonaceous, silty shale and siltstone; light to medium gray, micaceous, medium- to coarse-grained sandstone; and thin, discontinuous nodular limestone, and thin coal beds. The Dunkard Formation caps several hills in the Georges Creek Syncline, and may be as much as 250 feet (76 m) thick.' where label_1='Pd';
update sources.md_western set descrip_long='Interbedded, medium gray to dark gray, carbonaceous, silty shale and siltstone, light to medium gray, micaceous, medium- to coarse-grained sandstone and thin, discontinuous nodular limestone, and coal beds. The thickness of the Monongahela Group is 225 to 250 feet (68 to 76 m).' where label_1='*m';
update sources.md_western set descrip_long='The Neeedmore Shale is a dark-brownish-gray to medium-dark gray, calcareous, fossiliferous shale, with thin (1 foot, 30 c m) beds of d ark gray, a rgillaceous limestone. The upper Needmore Shale consists of approximately 35 feet (10 m) of interbedded, dark gray, argillaceous limestone and black shale. This interval is correlative with the Onondaga Limestone of New York. The top of the Needmore Shale is marked by the Tioga Bentonite, a brown, tuffaceous claystone. The Needmore Shale is 150 feet thick in Allegany County (45 m). The Marcellus Shale consists of black, brittle, fissile shale in the lower 100 feet (30 m); interbedded, thinly bedded, black limestone and shale in the middle; and very dark gray, fissile shale containing thin (0.5-1 inch, 1-2 cm) siltstone beds at the top. The Marcellus Shale is more the 350 feet thick in western Washington County and thins to approximately 150 feet in the subsurface at Keysers Ridge (45-105 m).' where label_1='Dnm';

INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,198,mapunit,strat_name,geologic_1,descrip_long,late_id,early_id,ST_MakeValid(geom) FROM sources.md_western where geom is not null;

INSERT INTO lines.medium (orig_id,source_id,name,new_type,geom) SELECT gid,198,notes,new_type,ST_MakeValid(geom) FROM sources.md_western_lines where new_type is not null and geom is not null;

pg_dump -t sources.md_western_lines -C -O burwell | gzip > ~/Desktop/md_western_lines.sql.gz
pg_dump -t sources.md_western -C -O burwell | gzip > ~/Desktop/md_western.sql.gz

#199 ut_escalante
update sources.ut_escalante set description=replace(description,'wellsorted','well-sorted');
update sources.ut_escalante set unitname=notes where notes='Lake Powell';
update sources.ut_escalante set strat_name='Carmel Formation' where unitname='Carmel Formation, undivided';
update sources.ut_escalante set strat_name='Dakota Formation' where unitname='Dakota Formation';
update sources.ut_escalante set strat_name='Tropic Shale' where unitname='Tropic Shale';
update sources.ut_escalante set age='Upper Cretaceous, Cenomanian' where age='Upper Cretaceous, Cenomanian, (see notes field)'

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,199,unitname,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_escalante where geom is not null and unitname not ilike 'unmapped';

update sources.ut_escalante_lines set descrip=modifier where notes is not null;
update sources.ut_escalante_lines set new_type=NULL where type='shoreline';
update sources.ut_escalante_lines set new_type=lower(new_type);
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,199,notes,descrip,new_type,ST_MakeValid(geom) FROM sources.ut_escalante_lines where new_type is not null and geom is not null;

pg_dump -t sources.ut_escalante_lines -C -O burwell | gzip > ~/Desktop/ut_escalante_lines.sql.gz
pg_dump -t sources.ut_escalante -C -O burwell | gzip > ~/Desktop/ut_escalante.sql.gz

#200 az_winslow
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,200,name,strat_name,age,description,comments,late_id,early_id,ST_MakeValid(geom) FROM sources.az_winslow where geom is not null;

update sources.az_winslow_lines set new_type=lower(new_type);
update sources.az_winslow_points set point_type=lower(point_type);
update sources.az_winslow_points set point_type=lower(point_type);
update sources.az_winslow_points set point_type=NULL where pointtype ilike '%implied%';
update sources.az_winslow_points set point_type=NULL where pointtype ilike '%ball%';
update sources.az_winslow_points set point_type='joint' where pointtype ilike 'vertical joint';
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,200,linetype,new_type,ST_MakeValid(geom) FROM sources.az_winslow_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,200,point_type,strike,dip,dip_dir,ST_MakeValid(geom) FROM sources.az_winslow_points where point_type is not null;

#201 ut_salina
update sources.ut_salina set compositio=replace(compositio,'FG to CG','fine to coarse grained');
update sources.ut_salina set compositio=replace(compositio,'FG','fine grained');
update sources.ut_salina set compositio=replace(compositio,'MG','medium grained');
update sources.ut_salina set compositio=replace(compositio,'VFG','very fine grained');
update sources.ut_salina set compositio=replace(compositio,'Vfine','very fine');
update sources.ut_salina_lines set new_type=lower(new_type);
update sources.ut_salina_points set point_type=lower(point_type);
update sources.ut_salina_points set point_type=NULL where subtype like '%ball%';
update sources.ut_salina_points set point_type=NULL where point_type like 'fold axis';
update sources.ut_salina_points set dipangle=90 where subtype='vertical';
update sources.ut_salina_lines set new_type=lower(new_type);
update sources.ut_salina_points set point_type=lower(point_type);
update sources.ut_salina_points set dipdirecti=strike+90-360 where point_type='joint';
update sources.ut_salina_points set strike=rotation where type='Joint';

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,t_interval,b_interval,geom) SELECT gid,201,unitname,strat_name,age_strat,description,compositio,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_salina where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,201,feature,new_type,ST_MakeValid(geom) FROM sources.ut_salina_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,201,point_type,strike::int,dipangle::int,dipdirecti::int,ST_MakeValid(geom) FROM sources.ut_salina_points where point_type is not null;

#202 id_deadwood
update sources.id_deadwood set name='water' where name is null;

INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,202,name,strat_name,age,description,comments,lith,late_id,early_id,ST_MakeValid(geom) FROM sources.id_deadwood where geom is not null;

update sources.id_deadwood_lines set new_type=lower(new_type);

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,202,label,authloccon,new_type,ST_MakeValid(geom) FROM sources.id_deadwood_lines where new_type is not null and geom is not null;

update sources.id_deadwood_points set point_type='foliation' where type ilike 'FOL%';
update sources.id_deadwood_points set point_type='joint' where type ilike 'JOI%';
update sources.id_deadwood_points set point_type=null where point_type ilike 'f-plung';
update sources.id_deadwood_points set point_type='bedding' where type ilike 'STRIKE';
INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) SELECT gid,202,point_type,azimuth::int,inclinatio::int,dip_dir::int,ST_MakeValid(geom) FROM sources.id_deadwood_points where point_type is not null;

pg_dump -t sources.id_deadwood_lines -C -O burwell | gzip > ~/Desktop/id_deadwood_lines.sql.gz
pg_dump -t sources.id_deadwood -C -O burwell | gzip > ~/Desktop/id_deadwood.sql.gz
pg_dump -t sources.id_deadwood_points -C -O burwell | gzip > ~/Desktop/id_deadwood_points.sql.gz

#203 wy_bairoil
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,t_interval,b_interval,geom) SELECT gid,203,name,strat_name,age,description,late_id,early_id,ST_MakeValid(geom) FROM sources.wy_bairoil where geom is not null;
update sources.wy_bairoil_lines set name=initcap(name);
update sources.wy_bairoil_lines set new_type=lower(new_type);
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,203,name,type,new_type,ST_MakeValid(geom) FROM sources.wy_bairoil_lines where new_type is not null and geom is not null;
pg_dump -t sources.wy_bairoil_lines -C -O burwell | gzip > ~/Desktop/wy_bairoil_lines.sql.gz
pg_dump -t sources.wy_bairoil -C -O burwell | gzip > ~/Desktop/wy_bairoil.sql.gz

#204 ut_dugway
update sources.ut_dugway set early_id=late_id where age_strat like 'Holocene over%';
update sources.ut_dugway set early_id=late_id where age_strat like '% over %';
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,204,unitname,strat_name,age_strat,description,compositio,genesis,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_dugway where geom is not null;

update sources.ut_dugway_lines set new_type='normal fault' where subtype='normal';
update sources.ut_dugway_lines set new_type='thrust fault' where subtype like 'thrust%';
update sources.ut_dugway_lines set featurenam=initcap(featurenam);
update sources.ut_dugway_lines set featurenam='Lake Bonneville level' where subtype like 'Bonneville%' and featurenam is null;
update sources.ut_dugway_lines set featurenam=null where featurenam='C';
update sources.ut_dugway_lines set new_direction='right-lateral' where subtype like '%right-lat%';
update sources.ut_dugway_lines set new_direction='left-lateral' where subtype like '%left-lat%';

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,204,featurenam,feature,new_type,new_direction,ST_MakeValid(geom) FROM sources.ut_dugway_lines where new_type is not null and geom is not null;

update sources.ut_dugway_points set point_type=null where subtype='ball & bar';
update sources.ut_dugway_points set point_type=null where point_type like 'fold%';
update sources.ut_dugway_points set dipangle=90 where subtype='vertical';
INSERT INTO points.points (orig_id,source_id,point_type,comments,strike,dip,dip_dir,geom) SELECT gid,204,point_type,feature,strike::int,dipangle::int,dipdirecti::int,ST_MakeValid(geom) FROM sources.ut_dugway_points where point_type is not null;

pg_dump -t sources.ut_dugway_points -C -O burwell | gzip > ~/Desktop/ut_dugway_points.sql.gz
pg_dump -t sources.ut_dugway_lines -C -O burwell | gzip > ~/Desktop/ut_dugway_lines.sql.gz
pg_dump -t sources.ut_dugway -C -O burwell | gzip > ~/Desktop/ut_dugway.sql.gz

#bc_2017
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Carnian' and age_max='Late Carnian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Oxfordian' and age_max='Late Oxfordian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Late Triassic' and age_max='Late Triassic or Early Jurassic';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_max='Lower Norian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Pliensbachian' and age_max='Lower Pliensbachian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Turonian' and age_max='Lower Turonian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Cretaceous' and age_max='Mid-Cretaceous';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Permian' and age_max='Permian or older';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Carnian' and age_max='Upper Carnian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_max='Upper Norian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_max='upper Norian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Pliensbachian' and age_max='Upper Pliensbachian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Late Triassic' and age_max='Upper Triassic and/or Lower Jurassic';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Late Triassic' and age_max='Upper Triassic or Lower Jurassic';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Valanginian' and age_max='Upper Valanginian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Cenomanian' and age_max='Cenomanian or Lower Turonian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Devonian' and age_max='Devonian (or older)';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Jurassic' and age_max='Jurassic or Cretaceous';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Anisian' and age_max='Late Anisian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_max='Upper Norian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_max='upper Norian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Pliensbachian' and age_max='Upper Pliensbachian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Upper Triassic' and age_max='Upper Triassic and/or Lower Jurassic';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Upper Triassic' and age_max='Upper Triassic or Lower Jurassic';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Valanginian' and age_max='Upper Valanginian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Cenomanian' and age_max='Cenomanian or Lower Turonian';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Devonian' and age_max='Devonian (or older)';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Jurassic' and age_max='Jurassic or Cretaceous';
update sources.bc_2017 set early_id=e.id from macrostrat.intervals e where e.interval_name='Anisian' and age_max='Late Anisian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Middle Jurassic' and age_min='Early Middle Jurassic';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_min='Early Norian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Oxfordian' and age_min='Early Oxfordian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Late Mississippian' and age_min='Late Mississipian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Aalenian' and age_min='Lower Aalenian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Callovian' and age_min='Lower Callovian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Sinemurian' and age_min='Lower Sinemurian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_min='Middle Norian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Wenlock' and age_min='Middle Silurian';
update sources.bc_2017 set late_id=e.id from macrostrat.intervals e where e.interval_name='Norian' and age_min='Upper Norian';

update sources.bc_2017 set use_strat_name='Banff Formation; Exshaw Formation' where fm_lithodm='Banff and Exshaw Formations';
update sources.bc_2017 set use_strat_name='Beaverfoot Formation; Mount Wilson Formation' where fm_lithodm='Beaverfoot, Mount Wilson Formations';
update sources.bc_2017 set use_strat_name='Mount Wilson Formation; Skoki Formation; Tipperary Formation; Glenogle Formation; Survey Peak Formation; Lyell Formation' where fm_lithodm='Mount Wilson, Skoki, Tipperary, Glenogle, Survey Peak and Lyell Formations';
update sources.bc_2017 set use_strat_name='Eager Formation; Cranbrook Formation' where fm_lithodm='Eager and Cranbrook Formations';
update sources.bc_2017 set use_strat_name='Baldonnel Formation; Pardonet Formation' where fm_lithodm='Baldonnel and Pardonet Formations';
update sources.bc_2017 set use_strat_name='Beaverfoot Formation; Mount Wilson Formation' where fm_lithodm='Beaverfoot, Mount Wilson Formations';
update sources.bc_2017 set use_strat_name='Mount Roberts Formation' where fm_lithodm='Mount Roberts Formation?';
update sources.bc_2017 set use_strat_name='Arctomys Formation; Waterfowl Formation' where fm_lithodm='Arctomys, Waterfowl Formations';
update sources.bc_2017 set use_strat_name='Australian Creek Formation; Fraser Bend Formation; Crownite Formation' where fm_lithodm='Australian Creek, Fraser Bend, Crownite formations';
update sources.bc_2017 set use_strat_name='Badshot Formation; Index Formation' where fm_lithodm='Badshot and Index Formations';
update sources.bc_2017 set use_strat_name='Cathedral Formation; Tanglefoot Formation; Elko Formation; Gordon Formation' where fm_lithodm='Cathedral, Tanglefoot, Elko, Gordon Formations';
update sources.bc_2017 set use_strat_name='Cedared Formation; Burnais Formation; Harrogate Formation' where fm_lithodm='Cedared, Burnais and Harrogate Formations';
update sources.bc_2017 set use_strat_name='Chancellor Formation' where fm_lithodm='Chancellor Formation (Upper)';
update sources.bc_2017 set use_strat_name='Dunira Formation; Ducie Island Formation' where fm_lithodm='Dunira, Ducie Island fms.';
update sources.bc_2017 set use_strat_name='Cedared Formation; Burnais Formation; Harrogate Formation' where fm_lithodm='Cedared, Burnais and Harrogate Formations';
update sources.bc_2017 set use_strat_name='Flathead Formation; Elko Formation' where fm_lithodm='Flathead and Elko Formations';
update sources.bc_2017 set use_strat_name='Liard Formation; Charlie Lake Formation' where fm_lithodm='Liard and Charlie Lake Formations';
update sources.bc_2017 set use_strat_name='Chancellor Formation' where fm_lithodm='Lower Chancellor';
update sources.bc_2017 set use_strat_name='Lyell Formation; Sullivan Formation; Jubilee Formation' where fm_lithodm='Lyell, Sullivan or Jubilee Formations';
update sources.bc_2017 set use_strat_name='Marsh Adams Formation; Mount Gainer Formation' where fm_lithodm='Marsh Adams and Mount Gainer Formations';
update sources.bc_2017 set use_strat_name='Mathieson Channel Formation' where fm_lithodm='Mathieson Channel formation';
update sources.bc_2017 set use_strat_name='Mistaya Formation; Bison Creek Formation; Lyell Formation' where fm_lithodm='Mistaya, Bison Creek and Lyell Formations';
update sources.bc_2017 set use_strat_name='Muncho-McConnell Formation; Wokkpash Formation' where fm_lithodm='Muncho-McConnell and Wokkpash Formations';
update sources.bc_2017 set use_strat_name='Muncho-McConnell Formation; Stone Formation; Dunedin Formation' where fm_lithodm='Muncho-McConnell, Stone and Dunedin Formations';
update sources.bc_2017 set use_strat_name='Purcell Supergroup' where fm_lithodm='Nicol Creek, Sheppard, Gateway, Phillips and Roosville *S';
update sources.bc_2017 set use_strat_name='Nicol Creek Formation' where fm_lithodm='Nicol Creek';
update sources.bc_2017 set use_strat_name='Stoddart Formation; Fantasque Formation' where fm_lithodm='Stoddart and Fantasque Formations';
update sources.bc_2017 set use_strat_name='Stone Formation; Dunedin Formation' where fm_lithodm='Stone and Dunedin Formations';
update sources.bc_2017 set use_strat_name='Stoddart Formation; Fantasque Formation; Kindle Formation' where fm_lithodm='Stoddart, Fantasque and Kindle Formations';
update sources.bc_2017 set use_strat_name='Three Sisters Formation; Monk Formation; Irene Formation' where fm_lithodm='Three Sisters, Monk and Irene Formations';
update sources.bc_2017 set use_strat_name='Toad Formation; Grayling Formation' where fm_lithodm='Toad and Grayling Formations';
update sources.bc_2017 set use_strat_name='Cleaver Gneiss; Resurrection Schist; Charon Amphibolite' where fm_lithodm='Cleaver Gneiss, Resurrection Schist and Charon Amphibolite';
update sources.bc_2017 set use_strat_name='Flapjack Peak Formation' where fm_lithodm='Flapjack Peak formation';
update sources.bc_2017 set use_strat_name='Riske Creek Formation' where fm_lithodm='Riske Creek formation';
update sources.bc_2017 set use_strat_name='Nonda Formation; Muncho-McConnell Formation; Wokkpash Formation' where fm_lithodm='Nonda, Muncho-McConnell and Wokkpash Formations';
update sources.bc_2017 set use_strat_name='Stephen Formation; Mount White Formation' where fm_lithodm='Stephen and Mount White Formations';
update sources.bc_2017 set use_strat_name='Brooks Diorite Complex' where fm_lithodm='Brooks Diorite Complex';
update sources.bc_2017 set use_strat_name='Kutcho Formation; Inklin Formation' where fm_lithodm='Kutcho and Inklin Formations';
update sources.bc_2017 set use_strat_name='Randall Formation' where fm_lithodm='Randall Formation?';
update sources.bc_2017 set use_strat_name='Nanaimo Group' where fm_lithodm='Extension - Protection Formation';
update sources.bc_2017 set use_strat_name='Kinnaird Gneiss' where fm_lithodm='Greenwood, Wallace Creek Plutons, Kinnaird Gneiss';
update sources.bc_2017 set use_strat_name='Harper Ranch Group; Nicola Group' where strat_name='Harper Ranch Group and? Nicola Group';
update sources.bc_2017 set use_strat_name='Black Riders Mafic Complex' where fm_lithodm='Black Riders Mafic-Ultramafic Complex';
update sources.bc_2017 set use_strat_name='Buckinghorse Formation; Badheart Formation' where fm_lithodm='Buckinghorse or Badheart Formation';
update sources.bc_2017 set use_strat_name='Saddle Hill Formation' where fm_lithodm='Saddle Hill Formation - Subvolcanic Rhyolite Domes';
update sources.bc_2017 set use_strat_name='Miette Group' where fm_lithodm='Upper Division, Includes Byng Formation';
update sources.bc_2017 set use_strat_name='Quatsino Formation; Parson Bay Formation' where fm_lithodm='Quatsino and Parson Bay formations undivided';
update sources.bc_2017 set use_strat_name='Misinchinka Group; Miette Group' where gp_suite='Misinchinka Group or Miette Group';
update sources.bc_2017 set use_strat_name='Cadwallader Group' where gp_suite='Cadwallader Group?' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Bowser Lake Group' where gp_suite='Bowser Lake (or Skeena Group?)' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Buttle Lake Group; Mount Hall Gabbro' where gp_suite='Buttle Lake Group and Mount Hall Gabbro' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Asitka Group; Takla Group' where gp_suite='Deformed Asitka or Takla Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Crooked Amphibolite' where gp_suite='Crooked Amphibolite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Francois Lake Suite' where gp_suite='Endako Batholith - Francois Lake Suite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Francois Lake Suite' where gp_suite='Endako Batholith - Francois Lake Plutonic Suite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Stag Lake Plutonic Suite' where gp_suite='Endako Batholith - Stag Lake Plutonic Suite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Harper Ranch Group; Nicola Group' where gp_suite='Harper Ranch and(?) Nicola Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Hyland Group' where gp_suite='Hyland Group and younger clastics' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Ingenika Group' where gp_suite='Ingenika Group?' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Kechika Group; Lower Road River Group' where gp_suite='Kechika and Lower Road River Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Kechika Group' where gp_suite='Kechika Group and Younger' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Minnes Group; Bullhead Group' where gp_suite='Minnes and Bullhead Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Mount Hall Gabbro' where gp_suite='Mount Hall Gabbro' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Coast Plutonic Complex' where gp_suite='Coast Plutonic Complex?' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Francois Lake Suite' where gp_suite='Endako Batholith - Francois Lake  Suite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Fraser Lake Suite' where gp_suite='Endako Batholith - Fraser Lake Suite' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Gog Group' where gp_suite='Gog Group and Younger Cambrian Rocks' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Grand Forks Gneiss' where gp_suite='Grand Forks Gneiss / Monashee Complex' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Road River Group; Earn Group' where gp_suite='Road River and Earn Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Sandpile Group; McDame Group' where gp_suite='Sandpile and McDame Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Sandpile Group; Ramhorn Group; McDame Group' where gp_suite='Sandpile, Ramhorn and McDame Groups' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Taylor Creek Group' where gp_suite='Taylor Creek Group?' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Mason Lakes Ultramafics' where fm_lithodm='Mason Lakes Ultramafics' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Little Shuswap Orthogneiss' where fm_lithodm='Little Shuswap Orthogneiss' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Nickel Mountain Gabbro' where fm_lithodm='Nickel Mountain or Copper King Gabbro' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Nikolai Greenstone' where fm_lithodm='Nikolai Greenstone (In Part)' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Wolf Ridge Gabbro' where fm_lithodm='Wolf Ridge Gabbro' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Tetachuck Lake Plutonic Suite' where gp_suite='Chelaslie River-Tetachuck Lake Plutonic Suite';
update sources.bc_2017 set use_strat_name='Mount Ida Plutonic Suite' where gp_suite='Moyie or Mount Ida Plutonic Suite';
update sources.bc_2017 set use_strat_name='Snake Indian Formation; Titkana Formation; Arctomys Formation; Eldon Formation; Pika Formation' where unit_desc='Silty, sandy and argillaceous dolomite, varicoloured shale, dolomite; minor quartzite; includes Snake Indian, Titkana, Arctomys, Eldon, and Pika Formations' and use_strat_name is null;
update sources.bc_2017 set use_strat_name='Prophet Formation; Kindle Formation; Fantasque Formation' where unit_desc='Cherty limestone and chert, shale, siliceous mudstone and siltstone, chert (marine); includes Prophet, Kindle and Fantasque Formations' and use_strat_name is null;
update sources.bc_2017 set strat_name='includes Prophet, Kindle and Fantasque Formations' where unit_desc='Cherty limestone and chert, shale, siliceous mudstone and siltstone, chert (marine); includes Prophet, Kindle and Fantasque Formations' and strat_name is null;
update sources.bc_2017 set use_strat_name='Beaverfoot Formation; Nonda Formation; Munch-McConnell Formation' where unit_desc='Dolomite, silty, argillaceous and sandy dolomite, limestone, quartzite; includes Beaverfoot, Nonda and Munch-McConnell Formations, an unnamed limestone-shale unit and an unnamed quartzite-dolomite unit' and use_strat_name is null;
update sources.bc_2017 set strat_name='includes Beaverfoot, Nonda and Munch-McConnell Formations and unnamed quartzite-dolomite' where unit_desc='Dolomite, silty, argillaceous and sandy dolomite, limestone, quartzite; includes Beaverfoot, Nonda and Munch-McConnell Formations, an unnamed limestone-shale unit and an unnamed quartzite-dolomite unit' and strat_name is null;
update sources.bc_2017 set use_strat_name='Settler Schist; Broken Formation' where unit_desc='Garnet-biotite, staurolite, kyanite and sillimanite schist, local amphibolite, minor ultramafic rocks and siliceous schist, metamorphosed in Cretaceous; includes Settler Schist and Broken Formation' and use_strat_name is null;
update sources.bc_2017 set strat_name='includes Settler Schist and Broken Formation' where unit_desc='Garnet-biotite, staurolite, kyanite and sillimanite schist, local amphibolite, minor ultramafic rocks and siliceous schist, metamorphosed in Cretaceous; includes Settler Schist and Broken Formation' and strat_name is null;
update sources.bc_2017 set use_strat_name='Snake Indian Formation; Titkana Formation; Arctomys Formation; Eldon Formation; Pika Formation' where unit_desc='Silty, sandy and argillaceous dolomite, varicoloured shale, dolomite; minor quartzite; includes Snake Indian, Titkana, Arctomys, Eldon, and Pika Formations' and use_strat_name is null;
update sources.bc_2017 set strat_name='includes Snake Indian, Titkana, Arctomys, Eldon, and Pika Formations' where unit_desc='Silty, sandy and argillaceous dolomite, varicoloured shale, dolomite; minor quartzite; includes Snake Indian, Titkana, Arctomys, Eldon, and Pika Formations' and strat_name is null;
update sources.bc_2017 set use_strat_name='Fraser Bend Formation; Australian Creek Formation' where unit_desc='Poorly consolidated to unconsolidated conglomerate, sandstone and mudstone; minor diatomite, lignite, basalt; includes the Fraser Bend and Australian Creek Formations' and use_strat_name is null;
update sources.bc_2017 set strat_name='includes the Fraser Bend and Australian Creek Formations' where unit_desc='Poorly consolidated to unconsolidated conglomerate, sandstone and mudstone; minor diatomite, lignite, basalt; includes the Fraser Bend and Australian Creek Formations' and strat_name is null;
update sources.bc_2017 set use_strat_name='Halfway Formation; Grayling Formation; Toad Formation; Liard Formation; Charlie Lake Formation; Baldonnel Formation; Luddington Formation; Pardonet Formation' where unit_desc='Undivided; includes Halfway Formation and ''Grey Beds'' in southwest corner of 94J; includes Grayling, Toad, Liard, Charlie Lake, Baldonnel, Luddington and Pardonet formations in 94B and G.' and use_strat_name is null;

INSERT INTO maps.medium (orig_id,source_id,name,strat_name,age,descrip,lith,comments,t_interval,b_interval,geom) SELECT gid,205,strat_name,use_strat_name,strat_age,unit_desc,rock_type,concat_ws('; ',concat(terrane, ' terrane'),basin),late_id,early_id,ST_MakeValid(geom) FROM sources.bc_2017 where geom is not null;

update sources.bc_2017_lines set new_type='strike-slip fault' where fault_type='Strike-slip fault';
update sources.bc_2017_lines set new_type='normal fault' where fault_type='Extension fault';
update sources.bc_2017_lines set new_type='fault' where fault_type='Fault';
update sources.bc_2017_lines set new_type='fault' where fault_type='High-angle fault';
update sources.bc_2017_lines set new_type='normal fault' where fault_type='Normal fault';
update sources.bc_2017_lines set new_type='thrust fault' where fault_type='Reverse fault';
update sources.bc_2017_lines set new_type='fault' where fault_type='Steeply dipping fault';
update sources.bc_2017_lines set new_type='thrust fault' where fault_type='Thrust fault';
update sources.bc_2017_lines set new_type='strike-slip fault',new_direction='left-lateral' where fault_type='Sinistral fault';
update sources.bc_2017_lines set new_type='strike-slip fault',new_direction='right-lateral' where fault_type='Dextral fault';

INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,new_direction,geom) SELECT gid,205,fault_name,confidence,new_type,new_direction,ST_MakeValid(geom) FROM sources.bc_2017_lines where new_type is not null and geom is not null;

pg_dump -t sources.bc_2017_lines -C -O burwell | gzip > ~/Desktop/bc_2017_lines.sql.gz
pg_dump -t sources.bc_2017 -C -O burwell | gzip > ~/Desktop/bc_2017.sql.gz
pg_dump -t sources.bc_2017_quat -C -O burwell | gzip > ~/Desktop/bc_2017_quat.sql.gz

INSERT INTO maps.medium (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) SELECT gid,206,use_name,age_name,lith,late_id,early_id,ST_MakeValid(geom) FROM sources.bc_2017_quat where geom is not null;


#german_nuremburg
INSERT INTO maps.large (orig_id,source_id,name,strat_name,age,descrip,comments,t_interval,b_interval,geom) SELECT gid,207,t1_matbez_eng,strat_name_eng,age_name,t1_pethtxt_eng,t1_gentxt_eng,late_id,early_id,ST_MakeValid(geom) FROM sources.german_nuremburg where geom is not null;
INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,207,descrip,new_type,ST_MakeValid(geom) FROM sources.german_nuremburg_lines where new_type is not null and geom is not null;

pg_dump -t sources.german_nuremburg_lines -C -O burwell | gzip > ~/Desktop/german_nuremburg_lines.sql.gz
pg_dump -t sources.german_nuremburg -C -O burwell | gzip > ~/Desktop/german_nuremburg.sql.gz


#co_ftcollins
update sources.co_ftcollins set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.co_ftcollins set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');
update sources.co_ftcollins set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'upper','Late');
update sources.co_ftcollins set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'lower','Early');

update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoproterozoic' and l.interval_name='Devonian' and age='Devonian? and Neoproterozoic';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Eocene' and age='Eocene and Paleocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age='Holocene and late Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age='Holocene and latest Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pleistocene' and l.interval_name='Holocene' and age='Holocene to middle? Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pleistocene' and l.interval_name='Late Pleistocene' and age='late and late middle? Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pleistocene' and l.interval_name='Late Pleistocene' and age='late and middle Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Late Pleistocene' and age='late Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age='latest Holocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Late Pleistocene' and age='latest Pleistocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Oligocene' and l.interval_name='Early Miocene' and age='lower Miocene or Oligocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Priabonian' and l.interval_name='Oligocene' and age='lower Oligocene and upper Eocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Pennsylvanian' and l.interval_name='Early Permian' and age='Lower Permian to Lower Pennsylvanian';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pennsylvanian' and l.interval_name='Early Permian' and age='Lower Permian to Middle Pennsylvanian';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Permian' and l.interval_name='Early Triassic' and age='Lower Triassic and Upper Permian';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Miocene' and l.interval_name='Early Pliocene' and age='lowermost Pliocene(?) to middle Miocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Oligocene' and l.interval_name='Miocene' and age='Miocene and upper Oligocene?';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Oligocene' and l.interval_name='Miocene' and age='Miocene? and Oligocene';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Eocene' and l.interval_name='Oligocene' and age='Oligocene and Eocene?';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cretaceous' and l.interval_name='Cretaceous' and age='Upper and Lower Cretaceous';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Permian' and l.interval_name='Permian' and age='Upper and Lower Permian';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Jurassic' and l.interval_name='Late Jurassic' and age='Upper and Middle Jurassic';
update sources.co_ftcollins set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Triassic' and l.interval_name='Middle Jurassic' and age='Upper and Middle Jurassic and Upper Triassic';
update sources.co_ftcollins_d set strat_name='Arikaree Formation' where name='Arikaree(?) Formation';
update sources.co_ftcollins_d set strat_name='Benton Group' where name='Benton Group';
update sources.co_ftcollins_d set strat_name='Casper Formation' where name='Casper Formation';
update sources.co_ftcollins_d set strat_name='Coalmont Formation' where name='Coalmont Formation';
update sources.co_ftcollins_d set strat_name='Dakota Group' where name='Dakota Group';
update sources.co_ftcollins_d set strat_name='Forelle Limestone Member; Satanka Shale Member' where name='Forelle Limestone Member and upper part of Satanka Shale Member, undivided of Goose Egg Formation';
update sources.co_ftcollins_d set strat_name='Fountain Formation' where name='Fountain Formation';
update sources.co_ftcollins_d set strat_name='Fox Hills Sandstone' where name='Fox Hills Sandstone';
update sources.co_ftcollins_d set strat_name='Hygiene Sandstone Member' where name='Hygiene Sandstone Member of the Pierre Shale';
update sources.co_ftcollins_d set strat_name='Ingleside Formation' where name='Ingleside Formation';
update sources.co_ftcollins_d set strat_name='Goose Egg Formation' where name='Lower part of Goose Egg Formation';
update sources.co_ftcollins_d set strat_name='Satanka Shale Member' where name='Lower part of Satanka Shale Member of Goose Egg Formation';
update sources.co_ftcollins_d set strat_name='Pierre Shale' where name='Lower shale member of the Pierre Shale';
update sources.co_ftcollins_d set strat_name='Lyons Sandstone' where name='Lyons Sandstone';
update sources.co_ftcollins_d set strat_name='Lykins Formation' where name='Lykins Formation';
update sources.co_ftcollins_d set strat_name='Lyons Sandstone; Owl Canyon Formation; Ingleside Formation' where name='Lyons Sandstone and Owl Canyon and Ingleside Formations, undivided';
update sources.co_ftcollins_d set strat_name='Mesaverde Formation' where name='Mesaverde Formation';
update sources.co_ftcollins_d set strat_name='Pierre Shale' where name='Middle shale member of the Pierre Shale';
update sources.co_ftcollins_d set strat_name='Morrison Formation' where name='Morrison Formation';
update sources.co_ftcollins_d set strat_name='Morrison Formation; Sundance Formation' where name='Morrison Formation and Sundance Formation, undivided';
update sources.co_ftcollins_d set strat_name='Morrison Formation; Sundance Formation; Jelm Formation' where name='Morrison, Sundance, and Jelm Formations, undivided';
update sources.co_ftcollins_d set strat_name='Niobrara Formation' where name='Niobrara Formation';
update sources.co_ftcollins_d set strat_name='North Park Formation' where name='North Park Formation';
update sources.co_ftcollins_d set strat_name='Ogallala Formation' where name='Ogallala Formation';
update sources.co_ftcollins_d set strat_name='Red Peak Formation; Goose Egg Formation' where name='Red Peak Formation and upper part of Goose Egg Formation, undivided';
update sources.co_ftcollins_d set strat_name='Pierre Shale' where name='Richard Sandstone Member, Larimer Sandstone Member, Rocky Ridge Sandstone Member and two intervening unnamed shale members of the Pierre Shale';
update sources.co_ftcollins_d set strat_name='Sundance Formation; Jelm Formation' where name='Sundance and Jelm Formations, undivided';
update sources.co_ftcollins_d set strat_name='White River Group' where name='White River Group, undivided';
update sources.co_ftcollins_d set strat_name='White River Group' where name='White River Group, undivided';
update sources.co_ftcollins_d set strat_name='Slocum Alluvium' where name='Slocum Alluvium';
update sources.co_ftcollins_d set strat_name='Verdos Alluvium' where name='Verdos Alluvium';
update sources.co_ftcollins_d set strat_name='Steele Shale' where name='Steele Shale';
update sources.co_ftcollins_d set strat_name='Pierre Shale' where name='Pierre Shale, undivided';
update sources.co_ftcollins_d set strat_name='Pierre Shale' where name='Upper shale member of the Pierre Shale';
update sources.co_ftcollins_d set strat_name='Owl Canyon Formation' where name='Owl Canyon Formation';
update sources.co_ftcollins_d set strat_name='Sherman Granite' where name='Sherman Granite';
update sources.co_ftcollins_lines set new_type='fault' where type='fault';
update sources.co_ftcollins_lines set new_type='joint' where type='joint';
update sources.co_ftcollins_lines set new_type='dike' where type='dike';
update sources.co_ftcollins_lines set new_type='fault' where type ilike '%fault zone%';
update sources.co_ftcollins_lines set new_type='normal fault' where type ilike '%normal fault%';
update sources.co_ftcollins_lines set new_type='bed' where type ilike '%bed%';
update sources.co_ftcollins_lines set new_type='thrust fault' where type ilike '%thrust fault%';
update sources.co_ftcollins_lines set new_type='anticline' where type ilike '%anticline%';
update sources.co_ftcollins_lines set new_type='anticline' where type ilike '%antiform%';
update sources.co_ftcollins_lines set new_type='monocline' where type ilike '%monocline%';
update sources.co_ftcollins_lines set new_type='syncline' where type ilike '%syncline%';
update sources.co_ftcollins_lines set new_type='syncline' where type ilike '%synform%';
insert into sources.co_ftcollins_lines (gid,type,isconceale,locationco,existencec,identityco,label,geom) select gid,type,isconceale,locationco,existencec,identityco,label,geom from sources.co_ftcollins_folds;

update sources.co_ftcollins set descrip=m.descrip,strat_name=m.strat_name,lith=m.lith from sources.co_ftcollins_d m where m.mapunit=co_ftcollins.mapunit and m.mapunit is not null;

INSERT INTO maps.large (orig_id,source_id,name,age,lith,strat_name,descrip,t_interval,b_interval,geom) SELECT gid,208,name,age,lith,strat_name,descrip,late_id,early_id,ST_MakeValid(geom) FROM sources.co_ftcollins where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,208,label,concat_ws('; ',name,age,existencec),new_type,ST_MakeValid(geom) FROM sources.co_ftcollins_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,208,azimuth,inclinatio,dip_dir,point_type,type,ST_MakeValid(geom) FROM sources.co_ftcollins_points where point_type is not null;

pg_dump -t sources.co_ftcollins -C -O burwell | gzip > ~/Desktop/co_ftcollins.sql.gz
pg_dump -t sources.co_ftcollins_lines -C -O burwell | gzip > ~/Desktop/co_ftcollins_lines.sql.gz
pg_dump -t sources.co_ftcollins_points -C -O burwell | gzip > ~/Desktop/co_ftcollins_points.sql.gz

#209 az_whitehills
update sources.az_whitehills set lith='alluvium' where mapunit='Qa3';
update sources.az_whitehills set lith='alluvium' where mapunit='Ta';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tca';
update sources.az_whitehills set lith='granodiorite, gneiss' where mapunit='Xg';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tc';
update sources.az_whitehills set lith='basalt' where mapunit='Tbi';
update sources.az_whitehills set lith='silt, mudstone, diamictite' where mapunit='Tdh';
update sources.az_whitehills set lith='Breccia, conglomerate, granite, gneiss' where mapunit='TXbrk';
update sources.az_whitehills set lith='basalt' where mapunit='Tby';
update sources.az_whitehills set lith='mudstone, gypsum' where mapunit='Tmg';
update sources.az_whitehills set lith='mudstone, gypsum' where mapunit='Tmg?';
update sources.az_whitehills set lith='gneiss' where mapunit='Xgg';
update sources.az_whitehills set lith='gravel' where mapunit='Trg';
update sources.az_whitehills set lith='conglomerate, breccia' where mapunit='Tbc';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tcu';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tca?';
update sources.az_whitehills set lith='granite' where mapunit='Yb';
update sources.az_whitehills set lith='paleosol' where mapunit='QTk';
update sources.az_whitehills set lith='limestone, mudstone' where mapunit='Th';
update sources.az_whitehills set lith='conglomerate, sandstone' where mapunit='Tdc';
update sources.az_whitehills set lith='basalt' where mapunit='Tdo';
update sources.az_whitehills set lith='alluvium' where mapunit='QTa1';
update sources.az_whitehills set lith='mudsdtone, siltstone, sandstone' where mapunit='Tm';
update sources.az_whitehills set lith='trachybasalt, trachyandesite, andesite, basalt' where mapunit='Tda?';
update sources.az_whitehills set lith='trachybasalt, trachyandesite, andesite, basalt' where mapunit='Tda';
update sources.az_whitehills set lith='alluvium' where mapunit='Tr';
update sources.az_whitehills set lith='basalt' where mapunit='Tob';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tbco';
update sources.az_whitehills set lith='colluvium' where mapunit='Ql';
update sources.az_whitehills set lith='conglomerate' where mapunit='Tcl';
update sources.az_whitehills set lith='gneiss' where mapunit='Xgp';
update sources.az_whitehills set lith='alluvium' where mapunit='Qa2';
update sources.az_whitehills set lith='breccia' where mapunit='Tbx';
update sources.az_whitehills set lith='welded tuff' where mapunit='Twt';
update sources.az_whitehills set lith='alluvium' where mapunit='Trb';
update sources.az_whitehills set lith='colluvium' where mapunit='Qt';
update sources.az_whitehills set lith='colluvium' where mapunit='Tlr';
update sources.az_whitehills set lith='leucogranite' where mapunit='Xhl';
update sources.az_whitehills set lith='gneiss' where mapunit='Xgm';
update sources.az_whitehills set lith='gneiss' where mapunit='Xgr';
update sources.az_whitehills set lith='alluvium' where mapunit='Trbs';
update sources.az_whitehills set lith='sand' where mapunit='Trs';
update sources.az_whitehills set lith='leucogranite, gneiss' where mapunit='Xgl';
update sources.az_whitehills set lith='gravel' where mapunit='Trbg';
update sources.az_whitehills set lith='alluvium' where mapunit='Qa4';
update sources.az_whitehills set lith='tephra, ash' where mapunit='Tct';

update sources.az_whitehills set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Upper','Late');
update sources.az_whitehills set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'Lower','Early');
update sources.az_whitehills set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'upper','Late');
update sources.az_whitehills set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age,'lower','Early');
update sources.az_whitehills set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age='Pleistocene and Pliocene';
update sources.az_whitehills set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Proterozoic' and l.interval_name='Miocene' and age='Miocene and Proterozoic';
update sources.az_whitehills set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Miocene' and l.interval_name='Late Miocene' and age='upper and middle Miocene';
update sources.az_whitehills set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Miocene' and l.interval_name='Middle Miocene' and age='middle Miocene';


INSERT INTO maps.large (orig_id,source_id,name,age,lith,strat_name,descrip,t_interval,b_interval,geom) SELECT gid,209,name,age,lith,strat_name,descrip,late_id,early_id,ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3) FROM sources.az_whitehills where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,209,label,concat_ws('; ',isconceale,existencec),new_type,ST_MakeValid(geom) FROM sources.az_whitehills_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,geom) SELECT gid,209,azimuth,inclinatio,dip_dir,point_type,ST_MakeValid(geom) FROM sources.az_whitehills_points where point_type is not null;

pg_dump -t sources.az_whitehills -C -O burwell | gzip > ~/Desktop/az_whitehills.sql.gz
pg_dump -t sources.az_whitehills_lines -C -O burwell | gzip > ~/Desktop/az_whitehills_lines.sql.gz
pg_dump -t sources.az_whitehills_points -C -O burwell | gzip > ~/Desktop/az_whitehills_points.sql.gz


### bc_chinook
update sources.bc_chinook set max_age=replace(max_age,'Famenian','Famennian');
update sources.bc_chinook set min_age=replace(min_age,'Famenian','Famennian');
update sources.bc_chinook set max_age=replace(max_age,'Tournasian','Tournaisian');
update sources.bc_chinook set min_age=replace(min_age,'Tournasian','Tournaisian');
update sources.bc_chinook set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Upper','Late'));
update sources.bc_chinook set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Lower','Early'));
update sources.bc_chinook set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Upper','Late'));
update sources.bc_chinook set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Lower','Early'));
update sources.bc_chinook set late_id=e.id from macrostrat.intervals e where  min_age ilike concat('%',e.interval_name,'%') and late_id is null;
update sources.bc_chinook set early_id=e.id from macrostrat.intervals e where  max_age ilike concat('%',e.interval_name,'%') and early_id is null;

insert into sources.bc_chinook_lines (gid,map_theme,feature,subfeature,attitude,confidence,generation,name,remarks,reference,source_ref,map_id,include_hc,symbol,symbol_100,shape_leng,geom,hwall_dir)
select 2570+gid,map_theme,feature,subfeature,attitude,confidence,generation,name,remarks,reference,source_ref,map_id,include_hc,symbol,symbol_100,shape_leng,geom,foldplunge from sources.bc_chinook_folds;

update sources.bc_chinook_lines set new_type='thrust fault' where subfeature='thrust';
update sources.bc_chinook_lines set new_type='syncline' where subfeature in ('synform','syncline');
update sources.bc_chinook_lines set new_type='syncline' where subfeature like 'syncline%';
update sources.bc_chinook_lines set new_type='normal fault' where subfeature like 'normal';
update sources.bc_chinook_lines set new_type='anticline' where subfeature like 'anticline%';
update sources.bc_chinook_lines set new_type='thrust fault' where subfeature='back-thrust';
update sources.bc_chinook_lines set new_type='strike-slip fault',new_direction='right-lateral' where subfeature='dextral strike-slip';
update sources.bc_chinook_lines set new_type='strike-slip fault',new_direction='left-lateral' where subfeature='sinistral strike-slip';
update sources.bc_chinook_lines set new_type='monocline' where subfeature like 'monocline%';
update sources.bc_chinook_lines set new_type='normal fault' where subfeature='detachment';
update sources.bc_chinook_lines set new_type='fault' where subfeature like 'generic%';

update sources.bc_chinook_points set point_type='bedding' where subfeature='bedding';
update sources.bc_chinook_points set point_type='cleavage' where subfeature like 'cleavage%';
update sources.bc_chinook_points set point_type='joint' where subfeature like 'joint';
update sources.bc_chinook_points set point_type='fault plane' where subfeature like 'fault%';
update sources.bc_chinook_points set point_type='axial plane' where subfeature like 'axial plane%';
update sources.bc_chinook_points set point_type='joint' where subfeature like 'joint';
update sources.bc_chinook_points set point_type='vein' where subfeature like 'vein%';
update sources.bc_chinook_points set point_type='dike' where subfeature like 'dyke%';
update sources.bc_chinook_points set point_type='transport direction' where subfeature like 'cross-%';

update sources.bc_chinook set strat_name=map_unit where map_unit like '% Formation' and map_unit not like '% and %';
update sources.bc_chinook set strat_name=map_unit where map_unit like '% Group' and map_unit not like '% and %';
update sources.bc_chinook set strat_name=map_unit where map_unit like '% Supergroup' and map_unit not like '% and %';
update sources.bc_chinook set strat_name=map_unit where map_unit like '% Member' and map_unit not like '% and %';
update sources.bc_chinook set strat_name=map_unit where map_unit like '% Quartzite' and map_unit not like '% and %';
update sources.bc_chinook set strat_name='McKay Group' where map_unit like 'McKay Group,%';
update sources.bc_chinook set strat_name=replace(replace(replace(map_unit,', ', ' Formation; '),' and ',' Formation; '),'formations','Formation')  where strat_name is null and map_unit like '%formations';
update sources.bc_chinook set strat_name=replace(strat_name,'Formation; Formation;','Formation;');
update sources.bc_chinook set strat_name=replace(strat_name,'lower unit)(','Formation;');
update sources.bc_chinook set strat_name=replace(replace(replace(map_unit,', ', ' Member; '),' and ',' Member; '),'members','Member')  where strat_name is null and map_unit like '%members';
update sources.bc_chinook set strat_name=replace(strat_name,'Member; Member;','Member;');
update sources.bc_chinook set strat_name='Virgelle Formation; Deadhorse Coulee Formation; Pakowki Formation; Belly River Group' where map_unit like 'Virgelle, Deadhorse Coulee, and Pakowki formations, and Belly River Group';
update sources.bc_chinook set strat_name='Tipperary Quartzite; Skoki Formation' where map_unit like 'Tipperary Quartzite and Skoki Formation';
update sources.bc_chinook set strat_name='Banff Formation' where map_unit like 'Banff Formation';
update sources.bc_chinook set strat_name=parents where strat_name is null and parents like '% Formation';
update sources.bc_chinook set strat_name=replace(strat_name,'(?)','');

update sources.bc_chinook set use_age=max_age where max_age=min_age;
update sources.bc_chinook set use_age=concat_ws(' - ', max_age,min_age) where use_age is null;

pg_dump -t sources.bc_chinook -C -O burwell | gzip > ~/Desktop/bc_chinook.sql.gz
pg_dump -t sources.bc_chinook_lines -C -O burwell | gzip > ~/Desktop/bc_chinook_lines.sql.gz
pg_dump -t sources.bc_chinook_points -C -O burwell | gzip > ~/Desktop/bc_chinook_points.sql.gz
scp -P 2200 shananp@teststrata.geology.wisc.edu:~/Desktop/bc_chinook.sql.gz /home/shananp/Desktop/bc_chinook.sql.gz

update sources.bc_chinook set lith_list='conglomerate, breccia, tuff, shale' where descrip like 'agglomerate and volcanic breccia:%' and lith_list is null;
update sources.bc_chinook set lith_list='dolostone, sandstone, siltstone' where descrip like 'dolostone:%' and lith_list is null;
update sources.bc_chinook set lith_list='shale, siltstone' where descrip like 'Exshaw Formation:%' and lith_list is null;
update sources.bc_chinook set lith_list='siltstone, shale' where descrip like 'Johnston Canyon%' and lith_list is null;
update sources.bc_chinook set lith_list='wackestone, grainstone, dolostone, shale' where descrip like 'limestone:%' and lith_list is null;
update sources.bc_chinook set lith_list='sandstone, dolostone' where descrip like 'Misty Form%' and lith_list is null;
update sources.bc_chinook set lith_list='mudstone, siltstone, sandstone' where descrip like 'mudstone and siltstone:%' and lith_list is null;
update sources.bc_chinook set lith_list='mudstone, shale' where descrip like 'mudstone and shale:%' and lith_list is null;
update sources.bc_chinook set lith_list='wackestone, packstone, grainstone, dolostone' where descrip like 'Opal Memb%' and lith_list is null;
update sources.bc_chinook set lith_list='quartzite' where descrip like 'quartzite:%' and lith_list is null;
update sources.bc_chinook set lith_list='dolostone, siltstone' where descrip like 'Salter Memb:%' and lith_list is null;
update sources.bc_chinook set lith_list='shale, mudstone' where descrip like 'shale and mudstone:%' and lith_list is null;
update sources.bc_chinook set lith_list='shale, sandstone, mudstone' where descrip like 'shale: carbonaceous%' and lith_list is null;
update sources.bc_chinook set lith_list='shale, limestone, siltstone' where descrip like 'shale: dark%' and lith_list is null;
update sources.bc_chinook set lith_list='dolostone, grainstone, mudstone' where descrip like 'Salter Member:%' and lith_list is null;
update sources.bc_chinook set lith_list='sandstone, shale' where descrip like 'sandstone: fine%' and lith_list is null;
update sources.bc_chinook set lith_list='sandstone, shale' where descrip like 'sandstone:%' and lith_list is null;


INSERT INTO maps.large (orig_id,source_id,name,age,lith,strat_name,descrip,comments,t_interval,b_interval,geom) SELECT gid,210,map_unit,use_age,lith_list,strat_name,descrip,concat_ws(';',genesis,remarks),late_id,early_id,ST_MakeValid(geom) FROM sources.bc_chinook where geom is not null;

update maps.large set comments=NULL where comments='';

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,new_type,new_direction,geom) SELECT gid,210,name,subfeature,concat_ws('; ',remarks,confidence),new_type,new_direction,ST_MakeValid(geom) FROM sources.bc_chinook_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,certainty,comments,geom) SELECT gid,210,strike,dip,dip_dir,point_type,young_evid,concat_ws('; ',subfeature,attitude,method),ST_MakeValid(geom) FROM sources.bc_chinook_points where point_type is not null;

###### 211 yukon_mtmartin
update sources.yukon_mtmartin set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Upper','Late'));
update sources.yukon_mtmartin set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Lower','Early'));
update sources.yukon_mtmartin set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Upper','Late'));
update sources.yukon_mtmartin set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Lower','Early'));
update sources.yukon_mtmartin set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Permian' and l.interval_name='Guadalupian' and max_age='Lower Permian' and min_age='Middle Permian';

insert into sources.yukon_mtmartin_folds (gid,type,subtype,attitude,confidence,dip_dir_ap,reference,name,geom) SELECT gid+28,type,subtype,attitude,confidence,dip_dir_fp,reference,name,geom from sources.yukon_mtmartin_lines;
update sources.yukon_mtmartin_folds set new_type='anticline' where subtype like 'anti%';
update sources.yukon_mtmartin_folds set new_type='syncline' where subtype like 'sync%';
update sources.yukon_mtmartin_folds set new_type='thrust fault' where subtype like 'thrust';

update sources.yukon_mtmartin_points set remarks=concat_ws(' ',type,remarks) where type='cross-bedding';
update sources.yukon_mtmartin_points set type='transport direction' where type='cross-bedding';
update sources.yukon_mtmartin_points set type='overturned bedding' where modifier='overturned';
update sources.yukon_mtmartin set use_age=max_age where max_age=min_age;
update sources.yukon_mtmartin set use_age=concat_ws(' - ',max_age,min_age) where use_age is null;
update sources.yukon_mtmartin_points set strike=dip_dir-90;
update sources.yukon_mtmartin_points set strike=360+strike where strike<0;

pg_dump -t sources.yukon_mtmartin_points -C -O burwell | gzip > ~/Desktop/yukon_mtmartin_points.sql.gz
pg_dump -t sources.yukon_mtmartin_folds -C -O burwell | gzip > ~/Desktop/yukon_mtmartin_folds.sql.gz
pg_dump -t sources.yukon_mtmartin -C -O burwell | gzip > ~/Desktop/yukon_mtmartin.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,lith,comments,strat_name,t_interval,b_interval,geom) SELECT gid,211,use_name,use_age,replace(concat('major:{',major_lith,'}, minor:{',minor_lith,'}'),', minor:{}',''),remarks,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.yukon_mtmartin where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,new_type,geom) SELECT gid,211,name,subtype,concat_ws('; ',attitude,confidence),new_type,ST_MakeValid(geom) FROM sources.yukon_mtmartin_folds where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,211,strike,dip,dip_dir,type,concat_ws('; ',location,remarks),ST_MakeValid(geom) FROM sources.yukon_mtmartin_points where geom is not null;

# 212 nw_slave_rv
update sources.nw_slave_rv set max_age='Archean', min_age='Paleoproterozoic' where i_map_unit='Precambrian shield' and max_age is null;
update sources.nw_slave_rv set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Upper','Late'));
update sources.nw_slave_rv set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Lower','Early'));
update sources.nw_slave_rv set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Upper','Late'));
update sources.nw_slave_rv set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Lower','Early'));

update sources.nw_slave_rv set late_id=l.id from macrostrat.intervals l where l.interval_name='Eifelian' and min_age like '%Eifelian%' and late_id is null;
update sources.nw_slave_rv set late_id=l.id from macrostrat.intervals l where l.interval_name='Albian' and min_age like '%Albian%' and late_id is null;
update sources.nw_slave_rv set early_id=l.id from macrostrat.intervals l where l.interval_name='Aptian' and max_age like '%Aptian%' and early_id is null;
update sources.nw_slave_rv set early_id=l.id from macrostrat.intervals l where l.interval_name='Albian' and max_age like '%Albian%' and early_id is null;
update sources.nw_slave_rv set early_id=l.id from macrostrat.intervals l where l.interval_name='Emsian' and max_age like '%Emsian%' and early_id is null;
update sources.nw_slave_rv set strat_name=concat(member,' Member') where member is not null;
update sources.nw_slave_rv set strat_name=concat(fm_ld,' Formation') where fm_ld is not null and strat_name is null;
update sources.nw_slave_rv set strat_name=concat(gr_ste,' Group') where gr_ste is not null and strat_name is null;

update sources.nw_slave_rv set use_age=max_age where max_age=min_age;
update sources.nw_slave_rv set use_age=concat_ws('-',max_age,min_age) where use_age is null;
update sources.nw_slave_rv set use_name=concat(member,' Member of ',fm_ld,' Formation') where member is not null;
update sources.nw_slave_rv set use_name=concat(fm_ld,' Formation of ',gr_ste,' Group') where fm_ld is not null and gr_ste is not null and use_name is null;
update sources.nw_slave_rv set use_name=strat_name where use_name is null;
update sources.nw_slave_rv set use_name=i_map_unit where use_name is null;
update sources.nw_slave_rv set major_lith=replace(major_lith,'quartzite','qtzite') where major_lith like 'gravel%';
update sources.nw_slave_rv set major_lith=replace(major_lith,'sandstone','ss') where major_lith like 'gravel%';
update sources.nw_slave_rv set minor_lith=replace(minor_lith,'chert','chrt.') where minor_lith like 'gravel%';
update sources.nw_slave_rv set minor_lith=replace(minor_lith,'granite','gran.') where minor_lith like 'gravel%';
update sources.nw_slave_rv set minor_lith=replace(minor_lith,'volcanic','volc.') where minor_lith like 'gravel%';

INSERT INTO maps.medium (orig_id,source_id,name,age,lith,comments,strat_name,t_interval,b_interval,geom) SELECT gid,212,use_name,use_age,replace(concat('major:{',major_lith,'}, minor:{',minor_lith,'}'),', minor:{}',''),remarks,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.nw_slave_rv where geom is not null;

update sources.nw_slave_lines set new_type='anticline' where subtype='anticline';
update sources.nw_slave_lines set new_type='syncline' where subtype='syncline';
update sources.nw_slave_lines set new_type='fault' where type='fault';
update sources.nw_slave_lines set new_type='normal fault' where subtype='normal';
update sources.nw_slave_lines set new_type='shear zone' where type='shear zone';

#this is outside bedrock boundary:
delete from sources.nw_slave_lines where gid=22;

INSERT INTO lines.medium (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,212,name,concat_ws('; ',remarks,attitude,confidence),new_type,ST_MakeValid(geom) FROM sources.nw_slave_lines where new_type is not null and geom is not null;

pg_dump -t sources.nw_slave_lines -C -O burwell | gzip > ~/Desktop/nw_slave_lines.sql.gz
pg_dump -t sources.nw_slave_rv -C -O burwell | gzip > ~/Desktop/nw_slave_rv.sql.gz


#213 nw_lacmaunoir

update sources.nw_lacmaunoir set descrip='dolostone: dolomudstone to dolograinstone, cherty in upper part, grey, cream, or light brown, weathers white to light grey, yellowish-grey,  or orange-brown, very thin- to thick-bedded, typically recrystallized, locally vuggy, stromatolitic, bioturbated, oolitic, or intraclast-bearing; minor shale: greenish-grey or red, fissile, and laminated; shale found in basal part of unit; resistant.' where map_unit='Franklin Mountain Formation';
update sources.nw_lacmaunoir set descrip='dolostone: dolowackestone to dolopackstone and dolofloatstone, siliceous and cherty, light to dark grey or brownish-grey fresh and weathered surfaces, locally colour-mottled, thin- to very thick-bedded, vuggy, recrystallized, bioturbated, and fossiliferous (mainly silicified corals, crinoids, orthocone cephalopods, and stromatoporoids); interbedded with dolomudstone: light grey or cream, laminated, unfossiliferous.' where map_unit='Mount Kindle Formation';
update sources.nw_lacmaunoir set descrip='limestone and dolostone: variably petroliferous, locally evaporitic (gypsum and/or anhydrite), commonly brecciated with angular clasts ranging from granule- to boulder-sized, greyish-brown to grey, weathers light grey, thin- to thick-bedded but massive and rubbly where brecciated, features include microbial laminae, fenestrae, peloids, and vugs; includes strata equivalent to Delorme Group, Bear Rock Formation, Arnica Formation, and Landry Formation documented in adjacent map areas.' where map_unit='Bear Rock Formation';
update sources.nw_lacmaunoir set descrip='sandstone: quartz arenite, patchy calcareous cement, locally oil-bearing, white to light grey or light brown on fresh and weathered surfaces but oil-bearing exposures have dark brown fresh surfaces, thin- to thick-bedded, crossbedded, friable, comminuted plant debris, rare interbeds of brown mudstone; overlain by shale or mudstone: sideritic concretions common, medium to dark grey, weathers grey or rusty-brown; shale may be equivalent to Arctic Red Formation.' where map_unit='Martin House Formation';
update sources.nw_lacmaunoir set descrip='shale and mudstone: locally sulphurous or gypsiferous, sideritic concretions common, dark grey to brownish grey; and sandstone: light grey, light brown weathering, laminated to thin-bedded; unit very poorly exposed; recessive; may include equivalents of Martin House, Arctic Red, and Slater River formations.' where map_unit='Cretaceous undivided';
update sources.nw_lacmaunoir set descrip='conglomerate: polymict with clasts of chert, quartz arenite and minor shale, hematitic cement, orange-brown to rusty weathering, granules to cobbles; and sandstone: quartzose, hematitic cement conglomeratic, dark red, dark brown weathering, very thick-bedded, cross-bedded; likely equivalent to Summit Creek Formation of the Mackenzie Valley.' where map_unit='Paleogene conglomerate';
update sources.nw_lacmaunoir set descrip='conglomerate: polymict with clasts of chert, quartz arenite and minor shale, hematitic cement, orange-brown to rusty weathering, granules to cobbles; and sandstone: quartzose, hematitic cement conglomeratic, dark red, dark brown weathering, very thick-bedded, cross-bedded; likely equivalent to Summit Creek Formation of the Mackenzie Valley.' where map_unit='Paleogene conglomerate';

update sources.nw_lacmaunoir set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Upper','Late'));
update sources.nw_lacmaunoir set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Lower','Early'));
update sources.nw_lacmaunoir set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Upper','Late'));
update sources.nw_lacmaunoir set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Lower','Early'));

update sources.nw_lacmaunoir set use_age=max_age where max_age=min_age;
update sources.nw_lacmaunoir set use_age=concat_ws('-',max_age,min_age) where use_age is null;


insert into sources.nw_lacmaunoir_folds (gid,feature,subfeature,attitude,confidence,evid_from,max_age,min_age,name,remarks,reference,geom)
SELECT gid+17,feature,subfeature,attitude,confidence,evid_from,max_age,min_age,name,remarks,reference,geom from sources.nw_lacmaunoir_faults;

update sources.nw_lacmaunoir_folds set new_type='anticline' where subfeature like 'anticline';
update sources.nw_lacmaunoir_folds set new_type='thrust fault' where subfeature like 'thrust';
update sources.nw_lacmaunoir_folds set new_type='thrust fault' where subfeature like 'reverse';
update sources.nw_lacmaunoir_folds set new_type='monocline' where subfeature like 'monocline%';
update sources.nw_lacmaunoir_folds set new_type='syncline' where subfeature like 'syncline';


update sources.nw_lacmaunoir_drift set descrip='sand, gravel, and mud: sediment includes sedimentary, igneous, and metamorphic material; sandy deposits typically brown to light orange or pale tan, some grey mud layers; unconsolidated.';

INSERT INTO maps.large (orig_id,source_id,name,age,lith,comments,strat_name,t_interval,b_interval,geom) SELECT gid,213,map_unit,use_age,lith_list,descrip,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.nw_lacmaunoir where geom is not null;

INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,comments,t_interval,b_interval,geom) SELECT gid,214,map_unit,'Quaternary to Recent',lith_list,descrip,genesis,late_id,early_id,ST_MakeValid(geom) FROM sources.nw_lacmaunoir_drift where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,213,name,concat_ws('; ',evid_from,remarks,attitude,confidence),new_type,ST_MakeValid(geom) FROM sources.nw_lacmaunoir_folds where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,213,strike,dip,dip_dir,subfeature,concat_ws('; ',attitude,method,young_evid),ST_MakeValid(geom) FROM sources.nw_lacmaunoir_points where geom is not null;

pg_dump -t sources.nw_lacmaunoir_points -C -O burwell | gzip > ~/Desktop/nw_lacmaunoir_points.sql.gz
pg_dump -t sources.nw_lacmaunoir_folds -C -O burwell | gzip > ~/Desktop/nw_lacmaunoir_folds.sql.gz
pg_dump -t sources.nw_lacmaunoir_drift -C -O burwell | gzip > ~/Desktop/nw_lacmaunoir_drift.sql.gz
pg_dump -t sources.nw_lacmaunoir -C -O burwell | gzip > ~/Desktop/nw_lacmaunoir.sql.gz

#214 accommodates drift

## 215 yukon_mtmerrill
update sources.yukon_mtmerril set min_age=replace(min_age,'Permain','Permian');
update sources.yukon_mtmerril set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Upper','Late'));
update sources.yukon_mtmerril set early_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(max_age),' (',1),'Lower','Early'));
update sources.yukon_mtmerril set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Upper','Late'));
update sources.yukon_mtmerril set late_id=e.id from macrostrat.intervals e where  e.interval_name ilike (replace(split_part(initcap(min_age),' (',1),'Lower','Early'));
update sources.yukon_mtmerril set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Permian' and l.interval_name='Guadalupian' and max_age='lower Permian' and min_age='middle Permian';

update sources.yukon_mtmerril set strat_name=concat(member,' Member') where member is not null;
update sources.yukon_mtmerril set strat_name=concat(formation,' Formation') where formation is not null and strat_name is null;
update sources.yukon_mtmerril set strat_name=concat(gp,' Group') where gp is not null and strat_name is null;
update sources.yukon_mtmerril set use_age=max_age where max_age=min_age;
update sources.yukon_mtmerril set use_age=concat_ws('-',max_age,min_age) where use_age is null;
update sources.yukon_mtmerril set use_name=concat(member,' Member of ',formation,' Formation') where member is not null;
update sources.yukon_mtmerril set use_name=concat(formation,' Formation of ',gp,' Group') where formation is not null and gp is not null and use_name is null;

update sources.yukon_mtmerril set use_name=concat(member,' Member of ',formation,' Formation') where member is not null;
update sources.yukon_mtmerril set use_name=concat(formation,' Formation of ',gp,' Group') where formation is not null and gp is not null and use_name is null;
update sources.yukon_mtmerril set use_name=strat_name where use_name is null;
update sources.yukon_mtmerril set use_name=i_map_unit where use_name is null;
update sources.yukon_mtmerril set i_map_unit=replace(i_map_unit,'Mattson', 'Mattson Fm.');
update sources.yukon_mtmerril set i_map_unit='Tika formation (informal) of Ishbel Gp' where i_map_unit='Tika formation (informal)';
update sources.yukon_mtmerril set use_name=i_map_unit where i_map_unit is not null;

insert into sources.yukon_mtmerril_folds (gid,type,subtype,attitude,confidence,dip_dir_ap,reference,name,geom) SELECT gid+58,type,subtype,attitude,confidence,dip_dir_fp,reference,name,geom from sources.yukon_mtmerril_lines;
update sources.yukon_mtmerril_folds set new_type='anticline' where subtype like 'anti%';
update sources.yukon_mtmerril_folds set new_type='syncline' where subtype like 'sync%';
update sources.yukon_mtmerril_folds set new_type='thrust fault' where subtype like 'thrust';
update sources.yukon_mtmerril_folds set new_type='fault' where subtype like 'undefined';

update sources.yukon_mtmerril_points set remarks=concat_ws(' ',type,remarks) where type='cross-bedding';
update sources.yukon_mtmerril_points set type='transport direction' where type='cross-bedding';
update sources.yukon_mtmerril_points set type='overturned bedding' where modifier='overturned';
update sources.yukon_mtmerril_points set strike=dip_dir-90;
update sources.yukon_mtmerril_points set strike=360+strike where strike<0;


pg_dump -t sources.yukon_mtmerril_points -C -O burwell | gzip > ~/Desktop/yukon_mtmerril_points.sql.gz
pg_dump -t sources.yukon_mtmerril_folds -C -O burwell | gzip > ~/Desktop/yukon_mtmerril_folds.sql.gz
pg_dump -t sources.yukon_mtmerril -C -O burwell | gzip > ~/Desktop/yukon_mtmerril.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,lith,comments,strat_name,t_interval,b_interval,geom) SELECT gid,215,use_name,use_age,replace(concat('major:{',major_lith,'}, minor:{',minor_lith,'}'),', minor:{}',''),remarks,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.yukon_mtmerril where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,new_type,geom) SELECT gid,215,name,subtype,concat_ws('; ',attitude,confidence),new_type,ST_MakeValid(geom) FROM sources.yukon_mtmerril_folds where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,215,strike,dip,dip_dir,type,concat_ws('; ',unit,location,remarks),ST_MakeValid(geom) FROM sources.yukon_mtmerril_points where geom is not null;


# md_newwindsor
update sources.md_newwindsor set early_id=257 where age='Late Proterozoic to Cambrian?';

INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,strat_name,t_interval,b_interval,geom) SELECT gid,220,unit_name,age,lith_abbre,description,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.md_newwindsor where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,new_type,geom) SELECT gid,220,struct_nam,modifier,desc_struc,new_type,ST_MakeValid(geom) FROM sources.md_newwindsor_lines where new_type is not null and geom is not null;

update sources.md_newwindsor_points set dip=dipamount;
update sources.md_newwindsor_points set dip=0 where dipamount=-99;
update sources.md_newwindsor_points set strike=strikedegr;
update sources.md_newwindsor_points set strike=azimuth where strikedegr<0 or strike is null;
update sources.md_newwindsor_points set dip_dir=strike,dip=0 where strikedegr is null;
update sources.md_newwindsor_points set dip_dir=NULL where type='lineation';

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) SELECT gid,220,strike,dip,dip_dir,point_type,desc_struc,ST_MakeValid(geom) FROM sources.md_newwindsor_points where geom is not null and point_type is not null;

# md_clearspring
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,comments,strat_name,t_interval,b_interval,geom) SELECT gid,221,name,age,description,comments,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.md_clearspring where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,new_type,geom) SELECT gid,221,label,new_type,ST_MakeValid(geom) FROM sources.md_clearspring_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,geom) SELECT gid,221,azimuth,inclinatio,dip_dir,point_type,ST_MakeValid(geom) FROM sources.md_clearspring_points where geom is not null and point_type is not null;


# md_keedysville
update sources.md_keedysville set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoproterozoic' and l.interval_name='Cambrian' and age='Cambrian or Late Proterozoic';
update sources.md_keedysville set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoproterozoic' and l.interval_name='Neoproterozoic' and age='Late Proterozoic';
update sources.md_keedysville set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Mesoproterozoic' and l.interval_name='Mesoproterozoic' and age='Middle Proterozoic';
update sources.md_keedysville set strat_name=NULL, unit_name='water',early_id=3,late_id=3,age='Holocene', description=concat_ws('; ',lower(unit_name),strat_name), comments=NULL where unit_label like 'water%';
update sources.md_keedysville set strat_name=NULL where unit_name='water';
delete from sources.md_keedysville where unit_name is null;
update sources.md_keedysville set strat_name=NULL, unit_name='Quaternary alluvium over bedrock',early_id=421,late_id=421,age='Quaternary', description=concat_ws(' ', age, strat_name,'concealed by Quaternary alluvium'), comments=NULL where unit_label like 'Q on%';
update sources.md_keedysville set lith_abbre=NULL where unit_name='water';
update sources.md_keedysville set lith_abbre='alluvium' where unit_label like 'Q on %';
update sources.md_keedysville_line set struc_name=initcap(struc_name);
update sources.md_keedysville set early_id=122,late_id=122,age='Cambrian' where early_id IS NULL;

INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,strat_name,t_interval,b_interval,geom) SELECT gid,222,unit_name,age,lith_abbre,description,strat_name,late_id,early_id,ST_MakeValid(geom) FROM sources.md_keedysville where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,222,struc_name,concat_ws('; ',desc_struc,concat('location ',struc_crt)),new_type,ST_MakeValid(geom) FROM sources.md_keedysville_line where new_type is not null and geom is not null;

# md_myerssmith
update sources.md_myerssmith set early_id=122, late_id=122 where age='Cambrian' and early_id is null;

INSERT INTO maps.large (orig_id,source_id,name,age,lith,descrip,comments,strat_name,t_interval,b_interval,geom) SELECT gid,223,unit_name,age,lith_abbre,trim(description),trim(comments),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.md_myerssmith where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,223,initcap(struc_name),concat_ws('; ',desc_struc,concat('location ',struct_crt)),new_type,ST_MakeValid(geom) FROM sources.md_myerssmith_lines where new_type is not null and geom is not null;

# md catocinfurnace

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) SELECT gid,232,unit_name,age,trim(description),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.md_catocinfurnace where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) SELECT gid,232,concat_ws('; ',concat('location ',lower(struc_crtn))),new_type,ST_MakeValid(geom) FROM sources.md_catocinfurnace_lines where new_type is not null and geom is not null;

# wi_fond_du 241
update sources.wi_fond_du set strat_name='Engadine Formation; Manistique Formations; Burnt Bluff Group' where mapunit='Su';
update sources.wi_fond_du set strat_name='Trempealeau Group; Tunnel City Group; Elk Mound Group' where mapunit='_u';
update sources.wi_fond_du set strat_name=muname where strat_name is null;
update sources.wi_fond_du set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(muagedis,'Upper','Late');
update sources.wi_fond_du set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=replace(muagedis,'Lower','Early');


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,241,muname,muagedis,trim(mudescr),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.wi_fond_du where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) SELECT gid,241,type,new_type,ST_MakeValid(geom) FROM sources.wi_fond_du_lines where new_type is not null and geom is not null;

pg_dump -t sources.wi_fond_du_lines -C -O burwell | gzip > ~/Desktop/wi_fond_du_lines.sql.gz
pg_dump -t sources.wi_fond_du -C -O burwell | gzip > ~/Desktop/wi_fond_du.sql.gz


# in_lawrence
update sources.in_lawrence set strat_name='St. Louis Limestone' where unit_name='St. Louis Limestone of Blue River Group';
update sources.in_lawrence set strat_name='Salem Limestone' where unit_name='Salem Limestone of Sanders Group';
update sources.in_lawrence set strat_name='Harrodsburg Limestone' where unit_name='Harrodsburg Limestone of Sanders Group';
update sources.in_lawrence set strat_name='Ste. Genevieve Limestone' where unit_name='Ste. Genevieve Limestone of Blue River Group';
update sources.in_lawrence set strat_name='Ramp Creek Formation' where unit_name='Ramp Creek Formationof Sanders Group';
update sources.in_lawrence set strat_name='Paoli Limestone' where unit_name='Paoli Limestone of Blue River Group';
update sources.in_lawrence set strat_name='Borden Group' where unit_name='Borden Group';
update sources.in_lawrence set strat_name='Stephensport Group' where unit_name='Stephensport Group';
update sources.in_lawrence set strat_name='West Baden Group' where unit_name='West Baden Group';

update sources.in_lawrence set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pleistocene' and l.interval_name='Holocene' and age='Holocene to Pleistocene';
update sources.in_lawrence set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Chesterian' and l.interval_name='Chesterian' and age='Mississippian, Chesterian';
update sources.in_lawrence set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Morrowan' and l.interval_name='Desmoinesian' and age='Pennsylvanian, Morrowan to Desmoinesian';
update sources.in_lawrence set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age='Pleistocene and older';

update sources.in_lawrence set late_id=l.id,early_id=1036 from macrostrat.intervals e, macrostrat.intervals l where l.interval_name='Chesterian' and age='Mississippian, Chesterian and Valmeyeran';
update sources.in_lawrence set late_id=1036,early_id=1036 from macrostrat.intervals e, macrostrat.intervals l where age='Mississippian, Valmeyeran';

pg_dump -t sources.in_lawrence_lines -C -O burwell | gzip > ~/Desktop/in_lawrence_lines.sql.gz
pg_dump -t sources.in_lawrence -C -O burwell | gzip > ~/Desktop/in_lawrence.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,245,unit_name,age,trim(descrip),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.in_lawrence where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,245,label,notes,lower(type),ST_MakeValid(geom) FROM sources.in_lawrence_lines where type not like ('contact') and geom is not null;

# france_1m
update sources.france set early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age_olde_1,'Upper','Late');
update sources.france set early_id=e.id from macrostrat.intervals e where e.interval_name=replace(age_olde_1,'Lower','Early');
update sources.france set late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age_youn_1,'Upper','Late');
update sources.france set late_id=e.id from macrostrat.intervals e where e.interval_name=replace(age_youn_1,'Lower','Early');

pg_dump -t sources.france -C -O burwell | gzip > ~/Desktop/france_lines.sql.gz
pg_dump -t sources.france_lines -C -O burwell | gzip > ~/Desktop/france.sql.gz

INSERT INTO maps.medium (orig_id,source_id,age,lith,comments,t_interval,b_interval,geom)
SELECT gid,249,use_age,trim(aggregated),descrip_eng,late_id,early_id,ST_CollectionExtract(ST_Multi(ST_MakeValid((ST_Dump(geom)).geom)),3) FROM sources.france where geom is not null;
INSERT INTO lines.medium (orig_id,source_id,new_type,new_direction,new_type,geom) 
SELECT gid,249,new_type,new_direction,ST_MakeValid(geom) FROM sources.france_lines where new_type is not null and geom is not null;

# in_marion 250
update sources.in_marion set late_id=e.id,early_id=e.id from macrostrat.intervals e where e.interval_name=age;
update sources.in_marion set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Devonian' and l.interval_name='Mississippian' and age='Devonian and Mississippian';

pg_dump -t sources.in_marion -C -O burwell | gzip > ~/Desktop/in_marion.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,250,bedrock_un,age,trim(descriptio),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.in_marion where geom is not null;


# ut_saltlake
INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,251,unitname,age,trim(descrip),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.ut_saltlake where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) 
SELECT gid,251,modifier,new_type,ST_MakeValid(geom) FROM sources.ut_saltlake_lines where new_type is not null and geom is not null;

pg_dump -t sources.ut_saltlake -C -O burwell | gzip > ~/Desktop/ut_saltlake.sql.gz
pg_dump -t sources.ut_saltlake_lines -C -O burwell | gzip > ~/Desktop/ut_saltlake_lines.sql.gz

# nh_lisbon 258
update sources.nh_lisbon set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(replace(age,'?',''),'Upper','Late');
update sources.nh_lisbon set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(replace(age,'?',''),'Lower','Early');
update sources.nh_lisbon set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(replace(age,'?',''),'upper','Late');
update sources.nh_lisbon set early_id=e.id,late_id=e.id from macrostrat.intervals e where e.interval_name=replace(replace(age,'?',''),'lower','Early');

update sources.nh_lisbon set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Devonian' and l.interval_name='Mississippian' and age='Devonian and Mississippian';
update sources.nh_lisbon set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Silurian' and l.interval_name='Early Devonian' and age='Lower Devonian and upper Silurian';
update sources.nh_lisbon set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Silurian' and l.interval_name='Late Silurian' and age='late Silurian';
update sources.nh_lisbon set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Cambrian' and l.interval_name='Middle Ordovician' and age='Middle Ordovocian and Upper Cambrian';
update sources.nh_lisbon set strat_name='Ammonoosuc Volcanics' where unitname='Ammonoosuc Volcanics';
update sources.nh_lisbon set strat_name='Clough Quartzite' where unitname='Clough Quartzite';
update sources.nh_lisbon set strat_name='Comerford Intrusive Complex' where unitname='Comerford Intrusive Complex';
update sources.nh_lisbon set strat_name='Fitch Formation' where unitname='Fitch Formation';
update sources.nh_lisbon set strat_name='French Pond Granite' where unitname='French Pond Granite';
update sources.nh_lisbon set strat_name='Littleton Formation' where unitname like '%Littleton Formation';
update sources.nh_lisbon set strat_name='Moody Ledge Granite' where unitname='Moody Ledge Granite';
update sources.nh_lisbon set strat_name='Partridge Formation' where unitname like '%Partridge Formation';
update sources.nh_lisbon set strat_name='Albee Formation' where unitname like '%Albee Formation';
update sources.nh_lisbon_lines set new_type='normal fault' where type like '%Normal Fault%';
update sources.nh_lisbon_lines set new_type='thrust fault' where type like '%Thrust Fault%';
update sources.nh_lisbon_lines set new_type='fault' where type like '%Fault%' and new_type is null;
update sources.nh_lisbon_points set point_type='foliation' where type ilike '%foliation%';
update sources.nh_lisbon_points set point_type='lineation' where type ilike '%lineation%';
update sources.nh_lisbon_points set point_type='bedding' where type ilike '%bedding%';
update sources.nh_lisbon_points set point_type='cleavage' where type ilike '%cleavage%';
update sources.nh_lisbon_points set point_type='fold axis' where type ilike '%fold axis%';
update sources.nh_lisbon_points set point_type='lineation' where type ilike '%slickens%';
update sources.nh_lisbon_points set point_type='fault plane' where type ilike '%fault%';
update sources.nh_lisbon_points set dip_dir=azimuth+90;
update sources.nh_lisbon_points set dip_dir=dip_dir-360 where dip_dir>360;

pg_dump -t sources.nh_lisbon_points -C -O burwell | gzip > ~/Desktop/nh_lisbon_points.sql.gz
pg_dump -t sources.nh_lisbon_lines -C -O burwell | gzip > ~/Desktop/nh_lisbon_lines.sql.gz
pg_dump -t sources.nh_lisbon -C -O burwell | gzip > ~/Desktop/nh_lisbon.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,258,unitname,age,trim(descrip2),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.nh_lisbon where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,geom) 
SELECT gid,258,type,new_type,ST_MakeValid(geom) FROM sources.nh_lisbon_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) 
SELECT gid,258,azimuth,inclinatio,dip_dir,point_type,type,ST_MakeValid(geom) FROM sources.nh_lisbon_points where geom is not null and point_type is not null;


# ca_funeralmtns
update sources.ca_funeralmtns set early_id=e.id from macrostrat.intervals e where e.interval_name ilike (replace(split_part(initcap(age),' and ', 2),'upper','Late'));
update sources.ca_funeralmtns set early_id=e.id from macrostrat.intervals e where e.interval_name ilike (replace(split_part(initcap(age),' and ', 2),'lower','Early'));
update sources.ca_funeralmtns set late_id=e.id from macrostrat.intervals e where e.interval_name ilike (replace(split_part(initcap(age),' and ', 1),'upper','Late'));
update sources.ca_funeralmtns set late_id=e.id from macrostrat.intervals e where e.interval_name ilike (replace(split_part(initcap(age),' and ', 1),'lower','Early'));
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age='late Holocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age='middle and early Holocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pliocene' and l.interval_name='Early Pleistocene' and age='lower Pleistocene to Pliocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Silurian' and l.interval_name='Devonian' and age='Devonian and Silurian';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pliocene' and l.interval_name='Early Pleistocene' and age='early Pleistocene and late Pliocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Pliocene' and age='middle Pliocene to upper Miocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Early Pliocene' and age='lower Pliocene to upper Miocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pleistocene' and l.interval_name='Holocene' and age='Holocene and Pleistocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Oligocene' and l.interval_name='Early Miocene' and age='early Miocene to Oligocene';
update sources.ca_funeralmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Pliocene' and age='Pliocene to upper Miocene';

pg_dump -t sources.ca_funeralmtns_points -C -O burwell | gzip > ~/Desktop/ca_funeralmtns_points.sql.gz
pg_dump -t sources.ca_funeralmtns_lines -C -O burwell | gzip > ~/Desktop/ca_funeralmtns_lines.sql.gz
pg_dump -t sources.ca_funeralmtns -C -O burwell | gzip > ~/Desktop/ca_funeralmtns.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,259,descriptio,age,trim(descrip),trim(strat_name),late_id,early_id,ST_MakeValid(geom) FROM sources.ca_funeralmtns where geom is not null;

INSERT INTO lines.large (orig_id,source_id,descrip,new_type,new_direction,geom) 
SELECT gid,259,descriptio,new_type,new_direction,ST_MakeValid(geom) FROM sources.ca_funeralmtns_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,strike,dip,dip_dir,point_type,comments,geom) 
SELECT gid,259,azimuth,dip,dip_dir,point_type,descriptio,ST_MakeValid(geom) FROM sources.ca_funeralmtns_points where geom is not null and point_type is not null;

# in_allen
pg_dump -t sources.in_allen -C -O burwell | gzip > ~/Desktop/yukon_mtmartin_points.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,descrip,strat_name,t_interval,b_interval,geom) 
SELECT gid,260,stratigrap,system,trim(unit_desc),trim(stratigrap),late_id,early_id,ST_MakeValid(geom) FROM sources.in_allen where geom is not null;


#id_salmon 275
update sources.id_salmon set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'lower','Early');
update sources.id_salmon set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'upper','Late');
update sources.id_salmon set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_salmon set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,275,name,use_age,trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_salmon where geom is not null;


INSERT INTO lines.large (orig_id,source_id,descrip,name,new_type,geom) 
SELECT gid,275,descrip,name,new_type,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_salmon_lines where new_type is not null and geom is not null;

#id_grangeville 276
update sources.id_grangeville set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'lower','Early');
update sources.id_grangeville set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'upper','Late');
update sources.id_grangeville set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_grangeville set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_grangeville set strat_name=null,bottom_age=null,top_age=null,description=null,generallithology=null,igs_lithology=null where name='water';
update sources.id_grangeville set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_grangeville set strat_name='Priest Rapids Member' where name='Priest Rapids Member';
update sources.id_grangeville set strat_name='Lucile Slate' where name='Lucile Slate';
update sources.id_grangeville set strat_name='Asotin Member; Wilbur Creek Member' where strat_name='Asotin Member; Wilbur Creek Member; Columbia River Basalt Group';
update sources.id_grangeville set strat_name='Craigmont Member' where strat_name='Craigmont Member; Columbia River Basalt Group';
update sources.id_grangeville set strat_name='Grande Ronde Basalt' where strat_name='Grande Ronde Basalt Formation';
update sources.id_grangeville set strat_name='Imnaha Basalt' where strat_name='Imnaha Basalt Formation';
update sources.id_grangeville set strat_name='Chair Point Complex' where mapunit in ('KPdm','KPmsg','^Pttc','Felsite');
update sources.id_grangeville set use_age=bottom_age where bottom_age=top_age;
update sources.id_grangeville set use_age=concat(bottom_age, ' - ', top_age) where use_age is null;

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,276,name,use_age,trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_grangeville where geom is not null;


update sources.id_grangeville_lines set new_type='normal fault' where faulttype='normal';
update sources.id_grangeville_lines set new_type='fault' where faulttype='unknown';
update sources.id_grangeville_lines set new_type='thrust fault' where faulttype ilike 'thrust%';

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,276,label,concat('location ',authorlocationconfidence),new_type,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_grangeville_lines where new_type is not null and geom is not null;


# id_arco 277
update sources.id_arco set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'lower','Early');
update sources.id_arco set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'upper','Late');
update sources.id_arco set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_arco set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_arco set strat_name=null,bottom_age=null,top_age=null,description=null,generallithology=null,igs_lithology=null where name='water';
update sources.id_arco set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_arco set strat_name='Drummond Mine Limestone' where strat_name='Drummond Mine Limestone Member; Copper Basin Group';
update sources.id_arco set strat_name='Eagle Creek Member' where strat_name='Eagle Creek Member; Wood River Formation';
update sources.id_arco set strat_name='Hailey Member' where strat_name='Hailey Member; Wood River Formation';
update sources.id_arco set strat_name='Little Copper Formation' where strat_name='Little Copper Formation; Copper Basin Group';
update sources.id_arco set strat_name='McGowan Creek Formation; Three Forks Formation' where strat_name='McGowan Creek; Three Forks Formation';
update sources.id_arco set strat_name='Middle Canyon Formation; McGowan Creek Formation' where strat_name='Middle Canyon;  McGowan Creek ';
update sources.id_arco set strat_name='Three Forks Formation; Jefferson Formation' where strat_name='Three Forks; Jefferson Formations';
update sources.id_arco set strat_name='Wilson Creek Member' where strat_name='Wilson Creek Member; Wood River Formation';

update sources.id_arco_lines set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_arco set use_age=top_age where top_age=bottom_age;
update sources.id_arco set use_age=concat(bottom_age, ' - ',top_age) where use_age is null;

pg_dump -t sources.id_arco -C -O burwell | gzip > ~/Desktop/id_arco.sql.gz
pg_dump -t sources.id_arco_lines -C -O burwell | gzip > ~/Desktop/id_arco_lines.sql.gz
INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,277,name,use_age,trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_arco where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,277,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_arco_lines where new_type is not null and geom is not null;

# id_idahocity 278
update sources.id_idahocity set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_idahocity set strat_name=null,bottom_age=null,top_age=null,description=null,generallithology=null,igs_lithology=null where name='water';

update sources.id_idahocity set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'lower','Early');
update sources.id_idahocity set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'upper','Late');
update sources.id_idahocity set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_idahocity set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');

update sources.id_idahocity set use_age=top_age where top_age=bottom_age;
update sources.id_idahocity set use_age=concat(bottom_age, ' - ',top_age) where use_age is null;

insert into sources.id_idahocity_lines (gid,type,descrip,wkb_geometry) SELECT objectid+884,type,authorlocationconfidence,wkb_geometry from sources.id_idahocity_veins;
update sources.id_idahocity_lines set geom=ST_TRANSFORM(wkb_geometry,4326);

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,278,trim(name),trim(use_age),trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_idahocity where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,278,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_idahocity_lines where new_type is not null and geom is not null;

pg_dump -t sources.id_idahocity -C -O burwell | gzip > ~/Desktop/id_idahocity.sql.gz
pg_dump -t sources.id_idahocity_lines -C -O burwell | gzip > ~/Desktop/id_idahocity_lines.sql.gz

# id_fairfield 279
update sources.id_fairfield set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_fairfield set strat_name=null,bottom_age=null,top_age=null,desc_=null,general_lithology=null,igs_lithology=null where name='water';
update sources.id_fairfield set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'lower','Early');
update sources.id_fairfield set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'upper','Late');
update sources.id_fairfield set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_fairfield set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_fairfield set use_age=top_age where top_age=bottom_age;
update sources.id_fairfield set use_age=concat(bottom_age, ' - ',top_age) where use_age is null;

update sources.id_fairfield set strat_name='Eagle Creek Member' where strat_name='Eagle Creek Member; Wood River Formation';
update sources.id_fairfield set strat_name='Glenns Ferry Formation' where strat_name='Glenns Ferry Formation; Idaho Group';
update sources.id_fairfield set strat_name='Wilson Creek Member' where strat_name='Wilson Creek Member; Wood River Formation,';
update sources.id_fairfield set strat_name='Hailey Member' where strat_name='Wood River Formation; Hailey Member';

update sources.id_fairfield_lines set new_type='syncline' where type like '%syncline%';
update sources.id_fairfield_lines set new_type='anticline' where type like '%anticline%';
update sources.id_fairfield_lines set new_type='monocline' where type like '%monocline%';
update sources.id_fairfield_lines set new_type='vein' where type like '%veins%';
update sources.id_fairfield_lines set new_type='syncline',descrip=concat('overturned; ',descrip) where type='fold-axis_oversync';
update sources.id_fairfield_lines set new_type='anticline',descrip=concat('overturned; ',descrip) where type='fold-axis_overanti';
update sources.id_fairfield_lines set geom=ST_TRANSFORM(wkb_geometry,4326);

pg_dump -t sources.id_fairfield_lines -C -O burwell | gzip > ~/Desktop/id_fairfield_lines.sql.gz
pg_dump -t sources.id_fairfield -C -O burwell | gzip > ~/Desktop/id_fairfield.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,279,trim(name),trim(use_age),trim(strat_name),trim(desc_),trim(igs_lithology),trim(general_lithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_fairfield where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,279,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_fairfield_lines where new_type is not null and geom is not null;

#280 id_murphy
update sources.id_murphy set top_age=trim(top_age);
update sources.id_murphy set b_age=trim(b_age);
update sources.id_murphy set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_murphy set strat_name=null,b_age=null,top_age=null,description=null,generallit=null,igs_lithol=null where name='water';
update sources.id_murphy set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'lower','Early');
update sources.id_murphy set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'upper','Late');
update sources.id_murphy set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_murphy set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_murphy set use_age=top_age where top_age=b_age;
update sources.id_murphy set use_age=concat(b_age, ' - ',top_age) where use_age is null;
update sources.id_murphy set use_age=NULL where use_age like ' - ';

update sources.id_murphy set strat_name='Chalk Hills Formation' where strat_name='Chalk Hills Formation; Idaho Group';
update sources.id_murphy set strat_name='Glenns Ferry Formation' where strat_name='Idaho Group';
update sources.id_murphy set strat_name='Poison Creek Formation; Chalk Hills Formation' where strat_name='Poison Creek Formation; Chalk Hills Formation; Idaho Group';
update sources.id_murphy set strat_name='Poison Creek Formation' where strat_name='Poison Creek Formation; Idaho Group';
update sources.id_murphy set strat_name='Glenns Ferry Formation' where strat_name='Idaho Group';
update sources.id_murphy set strat_name='Glenns Ferry Formation' where strat_name='Idaho Group';
update sources.id_murphy set description=null;
update sources.id_murphy set igs_lithol='basalt' where name ilike 'Basalt%' and igs_lithol is null;
select distinct mapunit,name,description,igs_lithol,generallit from sources.id_murphy;
update sources.id_murphy set generallit=null where generallit in ('Sediment','Clastic sediment','Dune sand','Extrusive igneous material','Intrusive igneous rock','Sedimentary material','Sandstone');

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,280,trim(name),trim(use_age),trim(strat_name),trim(description),trim(igs_lithol),trim(generallit),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_murphy where geom is not null;

update sources.id_murphy_lines set geom=ST_TRANSFORM(wkb_geometry,4326);

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,280,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_murphy_lines where new_type is not null and geom is not null;

pg_dump -t sources.id_murphy_lines -C -O burwell | gzip > ~/Desktop/id_murphy_lines.sql.gz
pg_dump -t sources.id_murphy -C -O burwell | gzip > ~/Desktop/id_murphy.sql.gz


#281 id_twinfalls
update sources.id_twinfalls set top_age=trim(top_age);
update sources.id_twinfalls set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_twinfalls set strat_name=null,b_age=null,top_age=null,description=null,generallithology=null,igs_lithology=null where name='water';
update sources.id_twinfalls set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'lower','Early');
update sources.id_twinfalls set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(b_age,'upper','Late');
update sources.id_twinfalls set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_twinfalls set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_twinfalls set use_age=top_age where top_age=b_age;
update sources.id_twinfalls set use_age=concat(b_age, ' - ',top_age) where use_age is null;
update sources.id_twinfalls set use_age=null where use_age like ' - ';
update sources.id_twinfalls set igs_lithology=rtrim(igs_lithology,';');
update sources.id_twinfalls set igs_lithology=replace(igs_lithology,'volcanoclastic','volcaniclastic');
update sources.id_twinfalls set igs_lithology='sand,gravel' where igs_lithology='man-made ground';

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,281,trim(name),trim(use_age),trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_twinfalls where geom is not null;

insert into sources.id_twinfalls_lines (gid,type,descrip,wkb_geometry) select objectid+88,lower(type),concat('location ',authorlocationconfidence),wkb_geometry from sources.id_twinfalls_veins;
update sources.id_twinfalls_veins set geom=ST_TRANSFORM(wkb_geometry,4326);


update  sources.id_bonners_lines set new_type='syncline' where type like '%syncline';
update  sources.id_bonners_lines set new_type='anticline' where type like '%anticline';
INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,281,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_twinfalls_lines where new_type is not null and geom is not null;
pg_dump -t sources.id_twinfalls_lines -C -O burwell | gzip > ~/Desktop/id_twinfalls_lines.sql.gz
pg_dump -t sources.id_twinfalls -C -O burwell | gzip > ~/Desktop/id_twinfalls.sql.gz


#282 id_bonners

update sources.id_bonners set top=trim(top),bottom=trim(bottom);
update sources.id_bonners set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_bonners set strat_name=null,bottom=null,top=null,description=null,generallithology=null where name='water';
update sources.id_bonners set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom,'lower','Early');
update sources.id_bonners set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom,'upper','Late');
update sources.id_bonners set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top,'lower','Early');
update sources.id_bonners set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top,'upper','Late');
update sources.id_bonners set use_age=top where top=bottom;
update sources.id_bonners set use_age=concat(bottom, ' - ',top) where use_age is null;
update sources.id_bonners set use_age=null where use_age like ' - ';

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,282,trim(name),trim(use_age),trim(strat_name),trim(description),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_bonners where geom is not null;


insert into sources.id_bonners_lines (gid,type,descrip,wkb_geometry) select objectid+312,lower(type),concat('location ',authorlocationconfidence),wkb_geometry from sources.id_bonners_veins;

update sources.id_bonners_lines set geom=ST_TRANSFORM(wkb_geometry,4326);
update  sources.id_bonners_lines set new_type='syncline' where type like '%syncline';
update  sources.id_bonners_lines set new_type='anticline' where type like '%anticline';
update  sources.id_bonners_lines set new_type='moraine' where type like 'moraine%';
update  sources.id_bonners_lines set new_type='vein' where type like 'veins';

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,282,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_bonners_lines where new_type is not null and geom is not null;

pg_dump -t sources.id_bonners_lines -C -O burwell | gzip > ~/Desktop/id_bonners_lines.sql.gz
pg_dump -t sources.id_bonners -C -O burwell | gzip > ~/Desktop/id_bonners.sql.gz


#281 id_headquarters
update sources.id_headquarters set top_age=trim(top_age);
update sources.id_headquarters set geom=ST_TRANSFORM(wkb_geometry,4326);
update sources.id_headquarters set strat_name=null,bottom_age=null,top_age=null,description=null,generallithology=null,igs_lithology=null where name='water';
update sources.id_headquarters set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'lower','Early');
update sources.id_headquarters set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(bottom_age,'upper','Late');
update sources.id_headquarters set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'lower','Early');
update sources.id_headquarters set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(top_age,'upper','Late');
update sources.id_headquarters set use_age=top_age where top_age=bottom_age;
update sources.id_headquarters set use_age=concat(bottom_age, ' - ',top_age) where use_age is null;
update sources.id_headquarters set igs_lithology='boudler gravel, silt, clay' where description like 'Poorly sorted and poorly stratified angular cobbles and boulders mixed with silt and clay%';
update sources.id_headquarters set igs_lithology='alluvium; pebbles, cobbles, sand, silt' where description like 'Stream deposits in modern drainages%';
update sources.id_headquarters set igs_lithology='till' where description like 'Poorly sorted till%';

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,281,trim(name),trim(use_age),trim(strat_name),trim(description),trim(igs_lithology),trim(generallithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_headquarters where geom is not null;

## ut_beaver
update sources.ut_beaver set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'lower','Early');
update sources.ut_beaver set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'upper','Late');
update sources.ut_beaver set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'lower','Early');
update sources.ut_beaver set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'upper','Late');

update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Holocene' and age_strat='Holocene and upper Pleistocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Eocene' and l.interval_name='Early Oligocene' and age_strat='lower Oligocene to middle Eocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Early Pleistocene' and age_strat='lower Pleistocene to upper Miocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age_strat='Historical';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pleistocene' and l.interval_name='Holocene' and age_strat='Holocene to middle Pleistocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Pliocene' and age_strat='Pliocene and upper Miocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Oligocene' and l.interval_name='Early Miocene' and age_strat='lower Miocene to upper Oligocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Eocene' and age_strat='Eocene and Paleocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Oligocene' and l.interval_name='Oligocene' and age_strat='upper and lower Oligocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Triassic' and l.interval_name='Triassic' and age_strat='Upper and Lower Triassic';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Eocene' and age_strat='Eocene and/or Paleocene';
update sources.ut_beaver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Oligocene' and l.interval_name='Early Miocene' and age_strat='lower Miocene and upper Oligocene';

update sources.ut_beaver set composition='basalt' where composition='basaltic';
update sources.ut_beaver set composition='silt, sand, gravel' where unitlabel in ('Qaf3','Qaf2','Qaf4','Qal1');
update sources.ut_beaver set composition='sand and gravel' where unitlabel in ('Qat1');
update sources.ut_beaver set composition='Sand, gravel, silt, and clay' where unitlabel in ('Qal2');
update sources.ut_beaver set composition='sandstone, mudstone, siltstone, conglomerate' where unitlabel in ('QTs');
update sources.ut_beaver set composition='sand and gravel' where unitlabel in ('Qat2');
update sources.ut_beaver set composition='silt, sand, gravel' where unitlabel in ('Qaf1');
update sources.ut_beaver set composition='colluvium' where unitlabel in ('Qms');
update sources.ut_beaver set composition='conglomerate and sandstone' where unitlabel in ('Tm (Tbmm)');
update sources.ut_beaver set composition='volcaniclastic mudflow breccia' where unitlabel in ('Tm (Tda)','Tda');
update sources.ut_beaver set composition='sand, mud, gravel' where unitlabel in ('Qf');

update sources.ut_beaver set composition='igneous plugs and dikes' where unitlabel in ('Tm (Tdp)');
update sources.ut_beaver_lines set new_type='normal fault' where feature ilike '%normal%';
update sources.ut_beaver_lines set new_type='strike-slip fault',direction='left-lateral' where feature ilike '%left-lateral%';
update sources.ut_beaver_lines set new_type='strike-slip fault',direction='left-lateral' where feature ilike '%left-lateral%';
update sources.ut_beaver_lines set new_type='normal fault' where type ilike 'Fault';

update sources.ut_beaver set geom=st_transform(wkb_geometry,4326);
update sources.ut_beaver_lines set geom=st_transform(wkb_geometry,4326);

pg_dump -t sources.ut_beaver_lines -C -O burwell | gzip > ~/Desktop/ut_beaver_lines.sql.gz
pg_dump -t sources.ut_beaver -C -O burwell | gzip > ~/Desktop/ut_beaver.sql.gz

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,t_interval,b_interval,geom) 
SELECT gid,290,trim(unitname),trim(age_strat),trim(strat_name),trim(description),trim(composition),late_id,early_id,ST_MakeValid(geom) FROM sources.ut_beaver where geom is not null;


INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,290,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.id_bonners_lines where new_type is not null and geom is not null;

#### 291 ut_prommontorymtns
update sources.ut_prommontorymtns set early_id=NULL, late_id=NULL;
update sources.ut_prommontorymtns set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'Lower','Early');
update sources.ut_prommontorymtns set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'Upper','Late');
update sources.ut_prommontorymtns set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'Lower','Early');
update sources.ut_prommontorymtns set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(age_strat,'Upper','Late');
update sources.ut_prommontorymtns set early_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age_strat,'Upper','Late'),' and ',2) ilike m.interval_name and early_id IS NULL;
update sources.ut_prommontorymtns set late_id=m.id FROM macrostrat.intervals m WHERE split_part(replace(age_strat,'Lower','Early'),' and ',1) ilike m.interval_name and late_id IS NULL;
update sources.ut_prommontorymtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Cambrian' and l.interval_name='Middle Cambrian' and age_strat='Middle and Lower Cambrian';


update sources.ut_prommontorymtns set strat_name=replace(unitname,'?','') where replace(unitname,'?','') like '% Formation';
update sources.ut_prommontorymtns set strat_name=replace(unitname,'?','') where replace(unitname,'?','') like '% Shale';
update sources.ut_prommontorymtns set strat_name=replace(unitname,'?','') where replace(unitname,'?','') like '% Quartzite';
update sources.ut_prommontorymtns set strat_name=replace(unitname,'?','') where replace(unitname,'?','') like '% Dolomite';
update sources.ut_prommontorymtns set strat_name=replace(unitname,'?','') where replace(unitname,'?','') like '% Limestone';
update sources.ut_prommontorymtns set strat_name='St. Charles Dolomite; Nounan Dolomite' where unitname='St. Charles Dolomite and Nounan Dolomite, undivided';
update sources.ut_prommontorymtns set strat_name='Oquirrh Formation' where unitname='Oquirrh Formation, sandy member';
update sources.ut_prommontorymtns set strat_name='Deseret Limestone; Gardison Limestone' where unitname='Deseret Limestone and Gardison Limestone, undivided?';
update sources.ut_prommontorymtns set strat_name='Deseret Limestone; Gardison Limestone' where unitname='Deseret Limestone and Gardison Limestone, undivided';
update sources.ut_prommontorymtns set strat_name='Calls Fort Shale Member' where unitname='Bloomington Formation, Calls Fort Shale Member';

update sources.ut_prommontorymtns_folds set new_type='bed' where type='Bed';
update sources.ut_prommontorymtns_folds set new_type='normal fault' where feature like 'Fault, normal%';
update sources.ut_prommontorymtns_folds set new_type='thrust fault' where feature like 'Fault, thrust%';
update sources.ut_prommontorymtns_folds set new_type='fault' where feature like 'Fault, unknown%';
update sources.ut_prommontorymtns_folds set new_type='normal fault' where feature like 'Fault, detachment%';
update sources.ut_prommontorymtns_folds set new_type='syncline' where feature like '%syncline%';
update sources.ut_prommontorymtns_folds set new_type='anticline' where feature like '%anticline%';

pg_dump -t sources.ut_prommontorymtns_folds -C -O burwell | gzip > ~/Desktop/ut_prommontorymtns_folds.sql.gz
pg_dump -t sources.ut_prommontorymtns -C -O burwell | gzip > ~/Desktop/ut_prommontorymtns.sql.gz
pg_dump -t sources.ut_prommontorymtns_points -C -O burwell | gzip > ~/Desktop/ut_prommontorymtns_points.sql.gz


INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,291,trim(unitname),trim(age_strat),trim(strat_name),trim(description),trim(composition),trim(genesis),late_id,early_id,ST_MakeValid(geom) FROM sources.ut_prommontorymtns where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,geom) 
SELECT gid,291,trim(name),trim(descrip),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.ut_prommontorymts_folds where new_type is not null and geom is not null;


INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom)
SELECT gid,291,point_type,new_strike,dip,strike,ST_MakeValid(geom) FROM sources.ut_prommontorymtns_points;


### id_sandpoint
#Geologic Map of the Sandpoint 30x60 Minute Quadrangle, Idaho and Montana, and the Idaho Part of the Chewelah 30 x 60 #Minute Quadrangle; DWM-189; Lewis and others, 2019; https://www.idahogeology.org/product/dwm-189

update sources.id_sandpoint set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat,intervals l where e.interval_name ilike replace(bottom_age,'Lower','Early') and l.interval_name ilike replace(top_age,'Lower','Early') ;

update sources.id_sandpoint set name='water' where mapunit='water' and name is null;
update sources.id_sandpoint set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name ilike replace(bottom_age,'Lower','Early') and l.interval_name ilike replace(top_age,'Lower','Early') ;

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,292,trim(name),CASE when top_age=bottom_age THEN top_age ELSE concat_ws('-',bottom_age,top_age) END,trim(strat_name),trim(description),trim(general_lithology),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_sandpoint where geom is not null;

INSERT INTO lines.large (orig_id,source_id,name,descrip,new_type,new_direction,geom) 
SELECT gid,292,trim(label),trim(concat(type, '; location ',authorlocationconfidence)),trim(new_type),new_direction,ST_MakeValid(ST_Force2D(geom)) FROM sources.id_sandpoint_lines where new_type is not null and geom is not null;


pg_dump -t sources.id_sandpoint -C -O burwell | gzip > ~/Desktop/id_sandpoint.sql.gz
pg_dump -t sources.id_sandpoint_lines -C -O burwell | gzip > ~/Desktop/id_sandpoint_lines.sql.gz


### 
https://pubs.er.usgs.gov/publication/sim3451
update sources.co_homestake set early_id=e.id,late_id=e.id from macrostrat.intervals e, macrostrat where e.interval_name ilike replace(bottom_age,'latest','late');

update sources.co_homestake set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' and ',2) ilike concat('%',m.interval_name,'%') and late_id IS NULL;
update sources.co_homestake set late_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' and ',1) ilike concat('%',m.interval_name,'%') and late_id IS NULL;
update sources.co_homestake set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Pleistocene' and l.interval_name='Middle Pleistocene' and age='late middle Pleistocene';
update sources.co_homestake set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age='latest Holocene';
update sources.co_homestake set geom=ST_TRANSFORM(shape,4326);
update sources.co_homestake_lines set geom=ST_TRANSFORM(shape,4326);
update sources.co_homestake_points set geom=ST_TRANSFORM(shape,4326);
update sources.co_homestake set descrip=m.description from sources.co_homestake_desc m where m.map_unit=co_homestake.map_unit;

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,t_interval,b_interval,geom) 
SELECT gid,294,trim(name),trim(age),trim(strat_name),trim(descrip),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.co_homestake where geom is not null;

INSERT INTO lines.large (orig_id,source_id,type,descrip,new_type,geom) 
SELECT gid,294,trim(type),trim(description),trim(new_type),ST_MakeValid(ST_Force2D(geom)) FROM sources.co_homestake_lines where new_type is not null and geom is not null;

INSERT INTO points.points (orig_id,source_id,point_type,comments,strike,dip,dip_dir,geom) 
SELECT gid,294,new_type,type,azimuth,inclination,dip_dir,ST_MakeValid(ST_Force2D(geom)) FROM sources.co_homestake_points where new_type is not null;

pg_dump -t sources.co_homestake -C -O burwell | gzip > ~/Desktop/co_homestake.sql.gz
pg_dump -t sources.co_homestake_lines -C -O burwell | gzip > ~/Desktop/co_homestake_lines.sql.gz
pg_dump -t sources.co_homestake_points -C -O burwell | gzip > ~/Desktop/co_homestake_points.sql.gz


## 295 ellesmere
update sources.ellesmere set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name ilike replace(source_uni,'?','') and l.interval_name ilike replace(source_u_1,'?','') ;
update sources.ellesmere set source_uni='Furongian' where source_uni='Late Cambrian (Furongian)';
update sources.ellesmere set source_uni='Terreneuvian' where source_uni='Early Cambrian (Terreneuvian)';
update sources.ellesmere set source_u_1='Series 3' where source_u_1='Middle Cambrian (Series 3)';
update sources.ellesmere set source_u_1='Blackriverian' where source_u_1='Blackriveran';
update sources.ellesmere set source_uni='Blackriverian' where source_uni='Blackriveran';

update sources.ellesmere set early_id=e.id,late_id=l.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name ilike replace(source_uni,'?','') and l.interval_name ilike replace(source_u_1,'?','') ;

update sources.ellesmere set early_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(source_uni,'early ','') and early_id is null;
update sources.ellesmere set late_id=e.id from macrostrat.intervals e where e.interval_name ilike replace(source_u_1,'middle ','') and late_id is null;

update sources.ellesmere set descrip=regional_dec from sources.ellesmere_units eu where eu.regional_lab=regional_l and concat(regional_dec,'%') ilike concat(regional_d,'%');

pg_dump -t sources.ellesmere -C -O burwell | gzip > ~/Desktop/ellesmere.sql.gz
pg_dump -t sources.ellesmere_lines -C -O burwell | gzip > ~/Desktop/ellesmere_lines.sql.gz


INSERT INTO maps.medium (orig_id,source_id,name,age,strat_name,descrip,lith,comments,t_interval,b_interval,geom) 
SELECT gid,295,trim(assembla_2),regional_a,trim(strat_name),trim(regional_d),trim(lith),concat_ws('; ',regional_s,natural_re),late_id,early_id,ST_MakeValid(ST_Force2D(geom)) FROM sources.ellesmere where geom is not null;

INSERT INTO lines.medium (orig_id,source_id,type,descrip,new_type,new_direction,geom)
SELECT gid,295,trim(feature),trim(descrip),trim(new_type),new_direction, ST_MakeValid(ST_Force2D(geom)) FROM sources.ellesmere_lines where new_type is not null and geom is not null;


##antarctica source_id 296
update sources.antarctica set strat_name=replace(strat_name,' (');
select regexp_replace(strat_name,' (%+)','') from sources.antarctica;

update sources.antarctica set new_min=round(absmin_ma,3);
update sources.antarctica set new_max=round(absmax_ma,3);

# this doesnt appear to work because the ages are all messed up in original file
update sources.antarctica set early_id=e.id from macrostrat.intervals e where age_bottom >=absmax_ma and age_top<absmax_ma and e.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=2);
update sources.antarctica set late_id=e.id from macrostrat.intervals e where age_bottom >new_min and age_top<=new_min and e.id IN (SELECT interval_id from macrostrat.timescales_intervals where timescale_id=2);

update sources.antarctica set geolhist=replace(geolhist,'Archaean','Archean');
update sources.antarctica set geolhist=replace(geolhist,'Late Archaean','Neoarchean');
update sources.antarctica set geolhist=replace(geolhist,'Eoachean','Eoarchean');
update sources.antarctica set geolhist=replace(geolhist,'Palaeoproterozoic','Paleoproterozoic');
update sources.antarctica set geolhist=replace(geolhist,'Mesoproteozoic','Mesoproterozoic');
update sources.antarctica set geolhist=replace(geolhist,'Proterzoic-Cambrian','Proterozoic to Cambrian');
update sources.antarctica set geolhist=replace(geolhist,'Archean-Ordovician','Archean to Ordovician');
update sources.antarctica set geolhist=replace(geolhist,'Permiam','Permian');
update sources.antarctica set geolhist=replace(geolhist,'Neoproterozoic-Early Cambrian','Neoproterozoic to Early Cambrian');
update sources.antarctica set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike m.interval_name;
update sources.antarctica set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike replace(m.interval_name,'lower','Early');
update sources.antarctica set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE geolhist ilike replace(m.interval_name,'upper','Late');
update sources.antarctica set late_id=m.id FROM macrostrat.intervals m WHERE split_part(geolhist,' to ',2) ilike m.interval_name and late_id IS NULL;
update sources.antarctica set early_id=m.id FROM macrostrat.intervals m WHERE split_part(geolhist,' to ',1) ilike m.interval_name and early_id IS NULL;
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Cambrian' and l.interval_name='Early Ordovician' and geolhist='upper Cambrian to lower Ordovician';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cambrian' and l.interval_name='Early Ordovician' and geolhist='Cambrian-?Early Ordovician';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Carboniferous' and l.interval_name='Middle Jurassic' and geolhist='Paleozoic to mid-Jurassic';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoarchean' and l.interval_name='Neoarchean' and geolhist='Late Archean';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Cambrian' and l.interval_name='Late Cambrian' and geolhist='middle to upper Cambrian';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Oligocene' and l.interval_name='Quaternary' and geolhist='Oligocene(?) to Quaternary(?)';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Rupelian' and geolhist='Paleocene to lower Oligocene';
update sources.antarctica set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Triassic' and l.interval_name='Middle Jurassic' and geolhist='pre late Jurassic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Early Miocene' and geolhist='Early Miocene(?) to Middle Miocene';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Triassic' and geolhist='Middle to Late Triassic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Miocene' and geolhist='Middle to Late Miocene';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Neoarchean' and geolhist='Late Archean to Paleoproterozoic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Jurassic' and geolhist='mid to late Jurassic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Late Cambrian' and geolhist='upper Cambrian to Devonian';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Early Jurassic' and geolhist='Early to Middle Jurassic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Jurassic' and geolhist='mid Jurassic to early Cretaceous';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Neoproterozoic' and geolhist='Late Proterozoic to Early Ordovician';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Jurassic' and geolhist='Middle to Late Jurassic';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Miocene' and geolhist='Miocene(?) to Quaternary';
update sources.antarctica set early_id=e.id from macrostrat.intervals e where e.interval_name='Early Devonian' and geolhist='Early to Middle Devonian';

update sources.antarctica set fmnequiv = 'Duncan Formation; Party Formation' where fmnequiv='Duncan & Party Formations';
update sources.antarctica set fmnequiv = 'Stornes Gneiss' where fmnequiv='Stornes Gneiss.';
update sources.antarctica set fmnequiv = 'Vereteno Diorite' where fmnequiv='Vereteno Diorite.';
update sources.antarctica set fmnequiv = 'Wyeth Heights Formation' where fmnequiv='Wyeth Heights Formation (inferred)';
update sources.antarctica set fmnequiv = 'Patuxent Formation' where fmnequiv='?Patuxent Formation';
update sources.antarctica set fmnequiv = NULL where fmnequiv='Brownworth lacustrine deposits';
update sources.antarctica set fmnequiv = NULL where fmnequiv like 'Ross Sea %';

update sources.antarctica set strat_name=fmnequiv;
update sources.antarctica set strat_name=grpequiv where strat_name is null;
update sources.antarctica set strat_name=spgrpequiv where strat_name is null;

update sources.antarctica set strat_parents=grpequiv where fmnequiv is not null;
update sources.antarctica set strat_parents=spgrpequiv where fmnequiv is not null and strat_parents is null;
update sources.antarctica set strat_parents=spgrpequiv where grpequiv is not null and strat_parents is null;
update sources.antarctica set strat_parents=concat(strat_parents,' of ',spgrpequiv) where spgrpequiv is not null and strat_parents is not null and strat_parents not like spgrpequiv;

update sources.antarctica set lithology=replace(lithology,'metasediments','metasedimentary');
update sources.antarctica set lithology=replace(lithology,'breccias','breccia');
update sources.antarctica set lithology=replace(lithology,'meta-limestone','marble');
update sources.antarctica set lithology=replace(lithology,'metalimestone','marble');
update sources.antarctica set lithology=replace(lithology,'metamorphic_rock','metamorphic');
update sources.antarctica set lithology=replace(lithology,'volcanics','volcanic');
update sources.antarctica set lithology='monzonite, monzonitic rocks' where lithology like 'monzonitic rocks';
update sources.antarctica set lithology='mugearite basalt' where lithology like 'mugearite';
update sources.antarctica set lithology='hawaiite basalt' where lithology like 'hawaiite';
update sources.antarctica set lithology='gneiss' where lithology like 'greiss';
update sources.antarctica set lithology='granitoid, granite' where lithology like 'granitoid';
update sources.antarctica set lithology='basalt, basaltic-andesite, agglomerate rhyodacite, tuff, andesite, trachytic lava, sandstone, conglomerate' where lithology like 'basalts, basaltic-andesites, agglomerates rhyodacites, tuffs, andesites, trachytic lavas, sandstones, conglomerates';
update sources.antarctica set lithology='clinopyroxene-orthopyroxene-hornblende-plagioclase igneous cumulate' where lithology like 'clinopyroxene-orthopyroxene-hornblende-plagioclase cumulate';
update sources.antarctica set lithology='gabbro and gabbroic rock' where lithology like 'gabbroic rock';
update sources.antarctica set lithology='metasedimentary' where lithology like 'metasediment';
update sources.antarctica set lithology='metasedimentary, minor mafic volcanic' where lithology like 'metasediment, minor mafic volcanic';
update sources.antarctica set lithology='metasedimentary, orthogneiss' where lithology like 'metasediment, orthogneiss';
update sources.antarctica set lithology='granite porphyry' where lithology like 'porphyry';
update sources.antarctica set lithology='metamorphic ultramafic' where lithology like 'serpentinized ultrabasic rocks';
update sources.antarctica set lithology='norite, ultramafic xenoliths' where lithology like 'ultramafic xenoliths';
update sources.antarctica set lithology='volcanic silicic porphyry' where lithology like 'silicic porphyry';
update sources.antarctica set lithology='sandstone, conglomerate, dolerite' where lithology like 'sanstone, dolerite';
update sources.antarctica set strat_name='Beacon Supergroup; Ferrar Dolerite' where name='undifferentiated Beacon Supergroup and Ferrar Dolerite' and strat_name is null;
update sources.antarctica set lithology='basanite' where lithology like 'basanitic';

INSERT INTO maps.medium (orig_id,source_id,name,age,strat_name,lith,descrip,comments,t_interval,b_interval,geom) 
SELECT gid,296,trim(name),trim(geolhist),trim(strat_name),trim(lithology),trim(descr),concat_ws('; ',strat_parents,confidence),late_id,early_id,ST_MakeValid(geom) FROM sources.antarctica where geom is not null;

update sources.antarctica_lines set new_type='normal fault' where typename='high angle normal fault';
update sources.antarctica_lines set new_type='reverse fault' where typename='high angle reverse';
update sources.antarctica_lines set new_type='strike-slip fault',new_direction='left-lateral' where typename='sinistral strike slip fault';
update sources.antarctica_lines set new_type='strike-slip fault',new_direction='right-lateral' where typename='dextral strike slip fault';
update sources.antarctica_lines set new_type='fault' where typename='fault';
update sources.antarctica_lines set new_type='normal fault' where typename='normal fault';
update sources.antarctica_lines set new_type='fault' where typename='oblique slip fault';
update sources.antarctica_lines set new_type='thrust fault' where typename='thrust fault';
update sources.antarctica_lines set new_type='reverse fault' where typename='reverse fault';
update sources.antarctica_lines set new_type='fault' where typename='high angle fault';

INSERT INTO lines.medium (orig_id,source_id,name,type,direction,descrip,geom,new_type,new_direction)
SELECT gid,296,name,typename,domsense,concat_ws('; ',descr,displcmnt, concat(defrmstyle,' deformation')), ST_MakeValid(geom),new_type,new_direction from sources.antarctica_lines;

pg_dump -t sources.antarctica -C -O burwell | gzip > ~/Desktop/antarctica.sql.gz
pg_dump -t sources.antarctica_lines -C -O burwell | gzip > ~/Desktop/antarctica_lines.sql.gz

# 297 ut_nwfndlndmtns
#https://geology.utah.gov/publication-details/?pub=mp-173dm

update sources.ut_nwfndlndmtns set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age_strat ilike m.interval_name;
update sources.ut_nwfndlndmtns set late_id=m.id FROM macrostrat.intervals m WHERE split_part(age_strat,' and ',1) ilike m.interval_name and late_id IS NULL;
update sources.ut_nwfndlndmtns set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age_strat,' and ',2) ilike m.interval_name and early_id IS NULL;
update sources.ut_nwfndlndmtns set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pliocene' and l.interval_name='Pleistocene' and age_strat='Pleistocene and Pliocene?';

update sources.ut_nwfndlndmtns set strat_name=unitname where unitname in ('Toano Limestone','Simonson Dolomite','Gerster Formation','Kanosh Shale','Crater Island Quartz Monzonite','Bettridge Creek Granodiorite','Badger Gulch Formation','Dinwoody Formation','Ely Limestone','Ely Springs Dolomite','Eureka Quartzite','Gerster Formation','Guilmette Formation','Joana Limestone','Kanosh Shale','Kanosh Shale?','Killian Springs Formation','Laketown Dolomite','Lamb Dolomite','Lamb Dolomite?','Lehman Formation','Lone Mountain Dolomite','McGinty Monzogranite','Miners Spring Granite','Murdock Mountain Formation','Notch Peak Formation','Pequop Formation','Pilot Shale','Prospect Mountain Quartzite','Prospect Mountain Quartzite?','Riepetown Sandstone','Simonson Dolomite','Strathearn Formation','Toano Limestone','Trapper Creek Formation','Tripon Pass Limestone','Trippe Limestone');

update sources.ut_nwfndlndmtns set strat_name=replace(strat_name,'?','');
update sources.ut_nwfndlndmtns set strat_name='Big Horse Limestone Member' where unitname='Big Horse Limestone Member of the Orr Formation';
update sources.ut_nwfndlndmtns set strat_name='Candland Shale Member' where unitname='Candland Shale Member of the Orr Formation';
update sources.ut_nwfndlndmtns set strat_name='Corset Spring Shale Member' where unitname='Corset Spring Shale Member of the Orr Formation';
update sources.ut_nwfndlndmtns set strat_name='Crystal Peak Dolomite; Watson Ranch Quartzite' where unitname='Crystal Peak Dolomite and Watson Ranch Quartzite';
update sources.ut_nwfndlndmtns set strat_name='Diamond Peak Formation; Chainman Shale' where unitname='Diamond Peak Formation and Chainman Shale, undivided';
update sources.ut_nwfndlndmtns set strat_name='Grandeur Formation' where unitname like 'Grandeur Formation %';
update sources.ut_nwfndlndmtns set strat_name='Johns Wash Limestone Member' where unitname='Johns Wash Limestone Member of the Orr Formation';
update sources.ut_nwfndlndmtns set strat_name='Pogonip Group' where unitname='Lower Pogonip Group';
update sources.ut_nwfndlndmtns set strat_name='McCoy Creek Group' where unitname like 'McCoy Creek Group %';
update sources.ut_nwfndlndmtns set strat_name='Oquirrh Group' where unitname like 'Oquirrh Group%';
update sources.ut_nwfndlndmtns set strat_name='Phosphoria Formation' where unitname='Phosphoria Formation, Meade Peak Phosphatic Shale Tongue';
update sources.ut_nwfndlndmtns set strat_name='Salt Lake Formation' where unitname like 'Salt Lake Formation%';
update sources.ut_nwfndlndmtns set strat_name='Third Fork Formation' where unitname like 'Third Fork(?) Formation';


INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,lith,descrip,comments,t_interval,b_interval,geom) 
SELECT gid,297,trim(unitname),trim(age_strat),trim(strat_name),trim(compositio),trim(descriptio),genesis,late_id,early_id,ST_MakeValid(geom) FROM sources.ut_nwfndlndmtns where geom is not null;

insert into sources.ut_nwfndlndmtns_folds (gid,feature,type,subtype,modifier,featurenam,notes,geom) select gid+30,feature,type,subtype,modifier,featurenam,notes,geom from sources.ut_nwfndlndmtns_lines where type='Fault';

update sources.ut_nwfndlndmtns_folds set new_type='anticline' where subtype='anticline, upright';
update sources.ut_nwfndlndmtns_folds set new_type='normal fault' where subtype='low-angle normal, overturned';
update sources.ut_nwfndlndmtns_folds set new_type='normal fault' where subtype='low-angle normal, type1';
update sources.ut_nwfndlndmtns_folds set new_type='normal fault' where subtype='normal';
update sources.ut_nwfndlndmtns_folds set new_type='syncline' where subtype='syncline, upright';
update sources.ut_nwfndlndmtns_folds set new_type='thrust fault' where subtype='thrust, type1';
update sources.ut_nwfndlndmtns_folds set new_type='fault' where subtype='unknown';
update sources.ut_nwfndlndmtns_folds set new_type='fault' where subtype='bedding plane';
update sources.ut_nwfndlndmtns_folds set new_type='fault' where subtype='geophysical';
update sources.ut_nwfndlndmtns_folds set new_type='slide' where subtype='gravity slide';

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,geom,new_type,new_direction)
SELECT gid,297,featurenam,concat(type,', ',subtype),modifier, ST_MakeValid(geom),new_type,new_direction from sources.ut_nwfndlndmtns_folds;

pg_dump -t sources.ut_nwfndlndmtns -C -O burwell | gzip > ~/Desktop/ut_nwfndlndmtns.sql.gz
pg_dump -t sources.ut_nwfndlndmtns_folds -C -O burwell | gzip > ~/Desktop/ut_nwfndlndmtns_folds.sql.gz

#298 ca_santamaria
# https://www.sciencebase.gov/catalog/item/5d76b9a7e4b0c4f70d01ff80
copy sources.ca_santamaria_units FROM '/Users/shananp/Public/map_units.csv' delimiter ',' CSV HEADER;
update sources.ca_santamaria set descrip=csmu.descrip, lith=geomaterial, age=csmu.age from sources.ca_santamaria_units csmu where ca_santamaria.mapunit=csmu.mapunit;

update sources.ca_santamaria set lith=replace(lith,'Alluvial','Alluvium');
update sources.ca_santamaria set lith='siliciclastic' where lith like 'Clastic sedimentary rock';

update sources.ca_santamaria set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update sources.ca_santamaria set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike replace(age,'lower','Early');
update sources.ca_santamaria set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE m.interval_name ilike replace(age,'upper','Late');
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tithonian' and l.interval_name='Early Cretaceous' and age='Lower Cretaceous and Upper Jurassic (Tithonian)';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Miocene' and l.interval_name='Late Miocene' and age='middle and upper Miocene, Mohnian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Ypresian' and l.interval_name='Lutetian' and age='lower to middle Eocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Early Miocene' and age='uppermost lower Miocene—Saucesian and Relizian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Eocene' and l.interval_name='Late Eocene' and age='upper Eocene—Refugian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Pliocene' and age='upper Miocene and lower Pliocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pliocene' and l.interval_name='Early Pleistocene' and age='lower Pleistocene and upper Pliocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Early Miocene' and age='lower Miocene—Saucesian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Oligocene' and l.interval_name='Early Miocene' and age='lower Miocene to upper Oligocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Eocene' and age='lower Eocene to Paleocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Callovian' and l.interval_name='Callovian' and age='Upper Jurassic (Callovian)';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Eocene' and age='Eocene and (or) Paleocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Early Miocene' and age='upper, middle, and upper lower Miocene— Mohnian, Luisian, Relizian, and Saucesian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Miocene' and l.interval_name='Early Pliocene' and age='lower Pliocene and upper Miocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Middle Miocene' and age='lower middle Miocene to upper lower Miocene—Relizian to Saucesian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Eocene' and l.interval_name='Eocene' and age='upper and middle Eocene—Narizian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Campanian' and l.interval_name='Maastrichtian' and age='Upper Cretaceous—Campanian to Maastrichtian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Oligocene' and l.interval_name='Early Miocene' and age='upper Oligocene (?)-lower Miocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Early Miocene' and age='upper lower Miocene—Saucesian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Jurassic' and l.interval_name='Cretaceous' and age='Cretaceous and Jurassic';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Eocene' and l.interval_name='Late Eocene' and age='upper and middle (?) Eocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Eocene' and l.interval_name='Oligocene' and age='Oligocene to upper Eocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Paleocene' and l.interval_name='Early Eocene' and age='lower Eocene to upper Paleocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pleistocene' and l.interval_name='Pleistocene' and age='middle and lower Pleistocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Eocene' and l.interval_name='Oligocene' and age='Oligocene and upper Eocene—Zemorrian and Refugian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Middle Miocene' and age='lower to middle Miocene, upper Saucesian, Relizian, Luisian, Mohnian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Miocene' and l.interval_name='Early Miocene' and age='uppermost lower Miocene—upper Saucesian to Relizian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cenomanian' and l.interval_name='Cenomanian' and age='lowermost Upper Cretaceous; Cenomanian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pliocene' and l.interval_name='Pliocene' and age='upper and middle Pliocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Pleistocene' and l.interval_name='Pleistocene' and age='upper Pleistocene, middle and lower Pleistocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Campanian' and l.interval_name='Maastrichtian' and age='Upper Cretaceous; Campanian and Maastrichtian';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Pleistocene' and l.interval_name='Late Pleistocene' and age='upper? Pleistocene';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Cretaceous' and l.interval_name='Late Cretaceous' and age='Upper Cretaceous';
update sources.ca_santamaria set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Eocene' and l.interval_name='Eocene' and age='upper to middle Eocene';

update sources.ca_santamaria set lith='Debris flow and landslide mass-movement sediment; colluvium' where lith='Debris flow and landslide mass-movement sediment'; 
update sources.ca_santamaria set lith='Felsic-composition pyroclastic flows; tuff' where lith='Felsic-composition pyroclastic flows'; 
update sources.ca_santamaria set lith='Meta-ultramafic rock; serpentinite' where lith='Meta-ultramafic rock'; 

update sources.ca_santamaria set strat_name=label where label='Alegria Formation';
update sources.ca_santamaria set strat_name=label where label='Anita Shale';
update sources.ca_santamaria set strat_name=label where label='Careaga Sandstone';
update sources.ca_santamaria set strat_name=label where label='Cozy Dell Shale';
update sources.ca_santamaria set strat_name=label where label='Espada Formation';
update sources.ca_santamaria set strat_name=label where label='Foxen Mudstone';
update sources.ca_santamaria set strat_name=label where label='Franciscan Complex';
update sources.ca_santamaria set strat_name=label where label='Gaviota Formation';
update sources.ca_santamaria set strat_name=label where label='Honda Formation';
update sources.ca_santamaria set strat_name=label where label='Jalama Formation';
update sources.ca_santamaria set strat_name=label where label='Juncal Formation';
update sources.ca_santamaria set strat_name=label where label='Lospe Formation';
update sources.ca_santamaria set strat_name=label where label='Matilija Formation';
update sources.ca_santamaria set strat_name=label where label='Matilija Sandstone';
update sources.ca_santamaria set strat_name=label where label='Monterey Formation';
update sources.ca_santamaria set strat_name=label where label='Obispo Formation';
update sources.ca_santamaria set strat_name=label where label='Paso Robles Formation';
update sources.ca_santamaria set strat_name=label where label='Point Sal Formation';
update sources.ca_santamaria set strat_name=label where label='Rincon Shale';
update sources.ca_santamaria set strat_name=label where label='Sacate Formation';
update sources.ca_santamaria set strat_name=label where label='Sespe Formation';
update sources.ca_santamaria set strat_name=label where label='Sierra Blanca Limestone';
update sources.ca_santamaria set strat_name=label where label='Simmler Formation';
update sources.ca_santamaria set strat_name=label where label='Sisquoc Formation';
update sources.ca_santamaria set strat_name=label where label='Tranquillon Volcanics';
update sources.ca_santamaria set strat_name=label where label='Vaqueros Formation';
update sources.ca_santamaria set strat_name='Sisquoc Formation' where label='Sisquoc Formation, mudstone and sandstone';
update sources.ca_santamaria set strat_name='Orcutt Sand' where label='Orcutt Sand';
update sources.ca_santamaria set strat_name='Monterey Formation' where label='Monterey Formation, informal lower member';
update sources.ca_santamaria set strat_name='Monterey Formation' where label='Monterey Formation, informal upper member';
update sources.ca_santamaria set strat_name='Gaviota Formation; Sacate Formation' where label='Gaviota and Sacate Formations, undivided';


INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,lith,descrip,t_interval,b_interval,geom) 
SELECT gid,298,trim(label),trim(age),trim(strat_name),trim(lith),trim(descrip),late_id,early_id,ST_MakeValid(geom) FROM sources.ca_santamaria where geom is not null;


insert into sources.ca_santamaria_folds (gid,type,isconceale,existencec,identityco,symbol,label,notes,geom)
select gid,type,isconceale,existencec,identityco,symbol, label,descriptio,geom from sources.ca_santamaria_lines where type like 'fault%';

update sources.ca_santamaria_folds set new_type='syncline' where type ilike '%syncline%';
update sources.ca_santamaria_folds set new_type='anticline' where type ilike '%anticline%';
update sources.ca_santamaria_folds set new_type='strike-slip fault' where type ilike '%strike-slip%';
update sources.ca_santamaria_folds set new_type='normal fault' where type ilike 'fault, normal';
update sources.ca_santamaria_folds set new_type='fault' where type ilike 'fault';
update sources.ca_santamaria_folds set new_type='reverse fault' where type ilike 'fault, reverse';
update sources.ca_santamaria_folds set new_type='fault' where type ilike 'Fault located by seismic reflection survey';
update sources.ca_santamaria_folds set new_type='fault' where type ilike 'Fault from gravity and magnetic surveys'; 
update sources.ca_santamaria_folds set new_direction='right-lateral' where notes like '%right-lateral%';
update sources.ca_santamaria_folds set new_direction='left-lateral' where notes like '%left-lateral%';
update sources.ca_santamaria_folds set notes=concat('existence ',existencec,', identity ',identityco) where notes is null;

INSERT INTO lines.large (orig_id,source_id,name,type,descrip,geom,new_type,new_direction)
SELECT gid,298,label,type,notes, ST_MakeValid(geom),new_type,new_direction from sources.ca_santamaria_folds;

update sources.ca_santamaria_points set dip_dir=azimuth+90;
update sources.ca_santamaria_points set dip_dir=dip_dir-360 where dip_dir>360;

INSERT INTO points.points (orig_id,source_id,point_type,strike,dip,dip_dir,geom) 
SELECT gid,298,new_type,azimuth,inclinatio,dip_dir,ST_MakeValid(geom) FROM sources.ca_santamaria_points;

pg_dump -t sources.ca_santamaria -C -O burwell | gzip > ~/Desktop/ca_santamaria.sql.gz
pg_dump -t sources.ca_santamaria_folds -C -O burwell | gzip > ~/Desktop/ca_santamaria_folds.sql.gz
pg_dump -t sources.ca_santamaria_points -C -O burwell | gzip > ~/Desktop/ca_santamaria_points.sql.gz


# 299 south_america
update sources.south_america set type=NULL where type='<Null>';
update sources.south_america set period_min=NULL where period_min='<Null>';
update sources.south_america set period_max=NULL where period_max='<Null>';
update sources.south_america set period_min=NULL where period_min='';
update sources.south_america set period_max=NULL where period_max='';

update sources.south_america set use_age=period_min where period_min=period_max;
update sources.south_america set use_age=period_min where period_max is null;
update sources.south_america set use_age=concat(period_max,' - ',period_min) where period_min not like period_max and use_age is null;

update sources.south_america set use_age=era_min where era_min=era_max and use_age is null;
update sources.south_america set use_age=concat(era_max,' - ',era_min) where era_min not like era_max and use_age is null;
update sources.south_america set use_age='Proterozoic' where use_age is null and eon_min='Proterozoic ';

update sources.south_america set new_lith='Andesite and related volcanic' where type='Andesitic and related';
update sources.south_america set new_lith=NULL where type='Lagoon';
update sources.south_america set new_lith='Siliciclastic' where type='Siliciclastic';
update sources.south_america set new_lith='basalt' where type='Basaltic';
update sources.south_america set new_lith='Alkaline volcanic' where type='Alkaline' and rock_type='Volcanic';
update sources.south_america set new_lith='Alkaline plutonic' where type='Alkaline' and rock_type='Plutonic';
update sources.south_america set new_lith='Evaporite' where type='Evaporitic';
update sources.south_america set new_lith='Carbonate' where type='Carbonatic';
update sources.south_america set new_lith='Gabbro and ultramafic' where type='Gabbroic and Ultramafic';
update sources.south_america set new_lith='Granite' where type='Granitic';
update sources.south_america set new_lith='Low to medium grade metamorphic' where type='Low to medium grade';
update sources.south_america set new_lith='Medium to high grade metamorphic' where type='Medium to high grade';
update sources.south_america set new_lith='Rhyolite' where type='Rhyolitic';
update sources.south_america set new_lith='Volcanic' where type='Undifferentiated' and rock_type='Volcanic';
update sources.south_america set new_lith='Sedimentary' where type='Undifferentiated' and rock_type='Sedimentary';
update sources.south_america set new_lith='Metamorphic' where type='Undifferentiated' and rock_type='Metamorphic';

update sources.south_america set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE use_age ilike m.interval_name;
update sources.south_america set late_id=m.id FROM macrostrat.intervals m WHERE split_part(use_age,' and ',2) ilike m.interval_name and late_id IS NULL;
update sources.south_america set early_id=m.id FROM macrostrat.intervals m WHERE split_part(use_age,' and ',1) ilike m.interval_name and early_id IS NULL;

INSERT INTO maps.small (orig_id,source_id,name,age,lith,t_interval,b_interval,geom) 
SELECT gid,299,concat(use_age,' ', type),trim(use_age),trim(new_lith),late_id,early_id,ST_MakeValid(geom) FROM sources.south_america where geom is not null;

insert into sources.south_america_faults (objectid,type,name,shape) SELECT objectid+2860,type,name,shape from sources.south_america_folds;
update sources.south_america_faults set new_type='strike-slip fault' where type like '%strike-slip%';
update sources.south_america_faults set new_type='thrust fault' where type like '%thrust fault%';
update sources.south_america_faults set new_type='fault' where type ilike '%fault%' and new_type is null;
update sources.south_america_faults set new_type='syncline' where type ilike '%syncline%' and new_type is null;
update sources.south_america_faults set new_type='anticline' where type ilike '%anticline%' and new_type is null;
update sources.south_america_faults set new_type='anticline' where type like '%anticline%' and new_type is null;
update sources.south_america_faults set new_type='lineament' where type ilike '%lineament' and new_type is null;

INSERT INTO lines.small (orig_id,source_id,name,type,geom,new_type,new_direction)
SELECT gid,299,name,type,ST_MakeValid(geom),new_type,new_direction from sources.south_america_faults;

pg_dump -t sources.south_america -C -O burwell | gzip > ~/Desktop/south_america.sql.gz
pg_dump -t sources.south_america_faults -C -O burwell | gzip > ~/Desktop/south_america_faults.sql.gz

# 300 ireland_100k

update sources.ireland_100k set strat_name=formation where formation ilike '% Formation';
update sources.ireland_100k set strat_name=formation where formation ilike '% Group';
update sources.ireland_100k set strat_name=split_part(formation,' (',1) where formation ilike '% Member%';

update sources.ireland_100k set strat_name='Rosses Granite' where formation like 'Rosses Granite %';

update sources.ireland_100k set strat_name=NULL where strat_name IN ('Upper Sandstone Member','Slate Members','Lower Sandstone Member','Intermediate volcanics','Grit Unit','Felsic volcanics','Dolomitised oolitic limestone');
update sources.ireland_100k set strat_name=replace(strat_name,' lower','');
update sources.ireland_100k set strat_name=replace(strat_name,' upper','');
update sources.ireland_100k set strat_name='Aillwee Member; Maumcaha Member' where strat_name='Aillwee & Maumcaha Members';
update sources.ireland_100k set strat_name='Bangor Formation; Corslieve Formation' where strat_name='Bangor/Corslieve Formation';
update sources.ireland_100k set strat_name='Castlebar River Limestone; Lough Akeel Oolite Formation' where strat_name='Castlebar River Limestone/Lough Akeel Oolite Formation';
update sources.ireland_100k set strat_name='Inishowen Head Grits Formation; Phyllites Formation' where strat_name='Inishowen Head Grits and Phyllites Formation';

update sources.ireland_100k set strat_name='Lough Acoose Sandstone Formation' where formation='Conglomerate (Lough Acoose Sandstone Formation)';
update sources.ireland_100k set strat_name='Thorr Granite' where formation='Lithologically Diverse Raft (Thorr Granite)';
update sources.ireland_100k set strat_name='Cronamuck Granodiorite; Barnesmore Granite' where formation='Cronamuck Granodiorite (Barnesmore Granite)';
update sources.ireland_100k set strat_name='Kilmacthomas Formation' where formation='Intermediate volcanics (Kilmacthomas Formation)';
update sources.ireland_100k set strat_name='Broadford Formation' where formation='Greywacke (Broadford Formation)';
update sources.ireland_100k set strat_name='Galway Granite' where formation='Fine-grained foliated granite (Galway Granite)';
update sources.ireland_100k set strat_name='St. Finan''s Sandstone Formation' where formation='Conglomerate (St. Finan''s Sandstone Formation)';
update sources.ireland_100k set strat_name='Dartry Limestone Formation' where formation='Knockmore Reef Bedded Facies (Dartry Limestone Formation)';
update sources.ireland_100k set strat_name='Ballymore Sandstone Formation' where formation='Tuff (Ballymore Sandstone Formation)';
update sources.ireland_100k set strat_name='Limerick Volcanics' where formation='Trachyte Breccias (Limerick Volcanics)';
update sources.ireland_100k set strat_name='Ballina Limestone Formation' where formation='Ballina Limestone Formation (Upper)';
update sources.ireland_100k set strat_name='Slieve Gullion Complex' where formation='Porphyritic Felsite (Slieve Gullion Complex)';
update sources.ireland_100k set strat_name='Aghyaran Formation; Killygordon Limestone Formation' where formation='Marble Unit (Aghyaran and Killygordon Limestone Formations)';
update sources.ireland_100k set strat_name='Butter Mountain Formation' where formation='Mafic Volcanics (Butter Mountain Formation)';
update sources.ireland_100k set strat_name='Galway Granite' where formation='Banded Zone (Galway Granite)';
update sources.ireland_100k set strat_name='Carrawaystick Aplite' where formation='Carrawaystick Aplite (Lugnaquilla Pluton)';
update sources.ireland_100k set strat_name='Avoca Formation' where formation='Intermediate volcanics (Avoca Formation)';
update sources.ireland_100k set strat_name='Slieve Gullion Complex' where formation='Porphyritic Granophyre (Slieve Gullion Complex)';
update sources.ireland_100k set strat_name='Slieve Gullion Complex' where formation='Early Gabbro (Slieve Gullion Complex)';
update sources.ireland_100k set strat_name='Galway Granite' where formation='Cuilleen-Type Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Ballina Limestone Formation' where formation='Ballina Limestone Formation (Lower)';
update sources.ireland_100k set strat_name='Attymass Formation' where formation='Attymass Formation undifferentiated';
update sources.ireland_100k set strat_name='Barnesmore Granite' where formation='Main Granite (Barnesmore Granite)';
update sources.ireland_100k set strat_name='Monaughrim Member' where formation='Intermediate volcanics (Monaughrim Member)';
update sources.ireland_100k set strat_name='Carlingford Complex' where formation='Layered Gabbro, Layer 4 (Carlingford Complex)';
update sources.ireland_100k set strat_name='Ardara Granite' where formation='Quartz monzodiorite (Ardara Granite)';
update sources.ireland_100k set strat_name='Aghyaran Formation; Killygordon Limestone Formation' where formation='Aghyaran and Killygordon Limestone Formations';
update sources.ireland_100k set strat_name='Campile Formation' where formation='Shale units (Campile Formation)';
update sources.ireland_100k set strat_name='Trawenagh Bay Granite' where formation='G1 Biotite Granite (Trawenagh Bay Granite)';
update sources.ireland_100k set strat_name='South Connemara Group' where formation='Undifferentiated South Connemara Group';
update sources.ireland_100k set strat_name='Slieve Gullion Complex' where formation='Granophyre (Slieve Gullion Complex)';
update sources.ireland_100k set strat_name='Finnalaghta Formation' where formation='Red shale (Finnalaghta Formation)';
update sources.ireland_100k set strat_name='Maulin Formation' where formation='Mafic Volcanics (Maulin Formation)';
update sources.ireland_100k set strat_name='Carlingford Complex' where formation='Layered Gabbro (Carlingford Complex)';
update sources.ireland_100k set strat_name='Galway Granite' where formation='Granodiorite and diorite (Galway Granite)';
update sources.ireland_100k set strat_name='St. Finan''s Formation' where formation='Lough Guitane rhyolites (St. Finan''s Formation)';
update sources.ireland_100k set strat_name='Bricklieve Limestone Formation; Mudbank Limestone Formation' where formation='Mudbank Limestone (Lower Bricklieve Limestone Formation)';
update sources.ireland_100k set strat_name='Cregg House Formation' where formation='Cregg House Formation (Slishwood Division)';
update sources.ireland_100k set strat_name='Coosgorrib Conglomerate Formation' where formation='Coosgorrib Conglomerate Formation (Glashabeg Conglomerate Formation)';
update sources.ireland_100k set strat_name='Moygara Formation' where formation='Conglomerate (Moygara Formation)';
update sources.ireland_100k set strat_name='Ballylane Formation' where formation='Intermediate volcanics (Ballylane Formation)';
update sources.ireland_100k set strat_name='Lough Lurgan Granite' where formation='Lough Lurgan Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Castlehaven Formation' where formation='Sandstone (Castlehaven Formation)';
update sources.ireland_100k set strat_name='Rinn Point Limestone Formation' where formation='Basal Clastics (Rinn Point Limestone Formation)';
update sources.ireland_100k set strat_name='Newtown Head Member' where formation='Felsic volcanics (Newtown Head Member)';
update sources.ireland_100k set strat_name='Butlersgrove Formation' where formation='Dolomitised argillaceous limestone (Butlersgrove Formation)';
update sources.ireland_100k set strat_name='South Connemara Group' where formation='Undifferentiated South Connemara Group';
update sources.ireland_100k set strat_name='Comeragh Group' where formation='Comeragh Conglomerate-Sandstone Group';
update sources.ireland_100k set strat_name='Maulin Formation' where formation='Intermediate volcanics (Maulin Formation)';
update sources.ireland_100k set strat_name='Slieve Bernagh Formation' where formation='Greywacke (Slieve Bernagh Formation)';
update sources.ireland_100k set strat_name='Callowfinish Granite' where formation='Callowfinish Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Cloghmore Granodiorite' where formation='Cloghmore Granodiorite (Galway Granite)';
update sources.ireland_100k set strat_name='Errisbeg Townland Granite' where formation='Errisbeg Townland Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Knock Granite' where formation='Knock Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Lettermore Granodiorite' where formation='Lettermore Granodiorite (Galway Granite)';
update sources.ireland_100k set strat_name='Lough Fadda Granodiorite' where formation='Lough Fadda Granodiorite (Galway Granite)';
update sources.ireland_100k set strat_name='Murvey Granite' where formation='Murvey Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Shannapheasteen Granite' where formation='Shannapheasteen Granite (Galway Granite)';
update sources.ireland_100k set strat_name='Attymass Group' where formation='Attymass Group undifferentiated';
update sources.ireland_100k set strat_name='Grahormack Formation' where formation='Grahormack Formation (Tagoat Group)';
update sources.ireland_100k set strat_name='Shannon Group' where formation='Shannon Group, undifferentiated';
update sources.ireland_100k set strat_name='Nephin Group' where formation='Middle Nephin Group (undifferentiated)';
update sources.ireland_100k set strat_name='Doonamo Formation' where formation='Doonamo Fomation';
update sources.ireland_100k set strat_name=NULL where formation='Pelite (Lough Foyle Succession)';

update sources.ireland_100k set strat_name=split_part(replace(formation,')',''),' (',2) where strat_name is null and formation ilike '%(%' and formation not like '%Division)' and formation not ilike '%(undifferentiated)';
update sources.ireland_100k set strat_name=NULL where strat_name ilike 'undifferentiated' or strat_name ilike '% and %';
update sources.ireland_100k set strat_name=NULL where strat_name ilike 'Northern and Upper Liffey Valley Plutons';
update sources.ireland_100k set strat_name=NULL where strat_name ilike 'Ox Mountains';
update sources.ireland_100k set strat_name=formation where strat_name is null and formation like '% Granite';
update sources.ireland_100k set strat_name=formation where strat_name is null and formation like '% Sandstone';
update sources.ireland_100k set strat_name='Derrymore Formation' where formation='Derrymore Fomation';
update sources.ireland_100k set strat_name='Kinrovar Schist' where formation='Kinrovar Schist';
update sources.ireland_100k set strat_name='Thorr Granite' where formation='Thorr Granite Migmattitic Facies';
update sources.ireland_100k set strat_name='Easky Adamellite' where formation='Easky Adamellite';
update sources.ireland_100k set strat_name='Scotch Port Schist' where formation='Scotch Port Schist';
update sources.ireland_100k set strat_name='Doolough Granite Gneiss' where formation='Doolough Granite Gneiss';
update sources.ireland_100k set strat_name='Benmore Formation; Broad Haven Formation' where formation='Benmore Formation and Broad Haven Formation (Undifferentiated)';
update sources.ireland_100k set strat_name='Srahmore Member' where formation='Srahmore Quartzite and Schist Member (Cullydoo Formation)';
update sources.ireland_100k set strat_name='Aille Formation; Barney Formation' where formation='Aille and Barney Formations (Undifferentiated)';
update sources.ireland_100k set strat_name='Lack Sandstone Formation' where formation='Lack Sandstone Fomation';
update sources.ireland_100k set strat_name='Ballygawley Tonalitic Gneiss' where formation='Ballygawley Tonalitic Gneiss';

update sources.ireland_100k set strat_name_parent=split_part(replace(formation,')',''),' (',2) where formation ilike '%)' and strat_name is not null;
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'undifferentiated';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'lower';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'upper';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'G1%';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'G2%';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'G3%';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'G4%';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent ilike 'Visean Limestones';
update sources.ireland_100k set strat_name_parent=NULL where strat_name_parent=strat_name;

update sources.ireland_100k set lithlegend=replace(lithlegend,'orthogneisses','orthogneiss');
 	#many like the above

update sources.ireland_100k set strat_name='Kilmore Formation',system='Devonian & Carboniferous',use_age='Dinantian' where strat_name is null and unit_name='Kilmore Formation';
update sources.ireland_100k set system='Carboniferous' where system is null and unit_name='Volcanics (in Carboniferous)';
update sources.ireland_100k set system='Early Paleozoic' where system is null and unit_name='Caledonian Diorite';
update sources.ireland_100k set series='Caradoc' where system is null and unit_name='in Glen Lodge Formation';
update sources.ireland_100k set series='Caradoc' where system is null and unit_name='in Coronea Formation';

update sources.ireland_100k set use_age=initcap(stage);
update sources.ireland_100k set use_age=initcap(series) where use_age is null;
update sources.ireland_100k set use_age=initcap(system) where use_age is null;
update sources.ireland_100k set use_age=system where use_age in ('(?)Late','Lr-M');
update sources.ireland_100k set use_age=series where use_age='?Courceyan - ?Chadian - Brigantian - ?Earlynamurian';
update sources.ireland_100k set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(replace(use_age,'?',''),'Upper','Late') ilike m.interval_name;
update sources.ireland_100k set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE replace(replace(use_age,'?',''),'Lower','Early') ilike m.interval_name;

update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Llandovery' and use_age='Late Llandovery To Mid Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Arenigian' and use_age='Lowerarenig ?';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Arenigian' and use_age='Arenig?';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Wenlock' and use_age='Llandovery-Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Ordovician' and l.interval_name='Silurian' and use_age='Ordovician/Silurian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Ludlow' and use_age='Llandovery-Ludlow';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Ashgill' and use_age='Caradoc-Ashgill';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Llanvirnian' and use_age='Arenig To Llanvirn';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Devonian' and l.interval_name='Carboniferous' and use_age='Devonian-Carboniferous';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cambrian-Ordovician' and l.interval_name='Cambrian-Ordovician' and use_age='Cambro-Ordovician';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandeilo' and l.interval_name='Caradocian' and use_age='Llandeilo-Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Silurian' and l.interval_name='Devonian' and use_age='Silurian-Devonian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Paleozoic' and l.interval_name='Late Paleozoic' and use_age='Upper Palaeozoic';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Caradocian' and use_age='Arenig To Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Richmondian-Hirnantian' and l.interval_name='Richmondian-Hirnantian' and use_age='Rawtheyan-Hirnantian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Caradocian' and use_age='Arenig To Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Wenlock' and use_age='Caradoc-Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Devonian' and l.interval_name='Carboniferous' and use_age='Devonian & Carboniferous';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleoproterozoic' and l.interval_name='Paleoproterozoic' and use_age='Palaeoproterozoic';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Mesozoic' and l.interval_name='Mesozoic' and use_age='Pre-Tertiary';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Arenigian' and use_age='Lower Arenig ?';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llanvirnian' and l.interval_name='Llanvirnian' and use_age='Llanvirn';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Caradocian' and use_age='Arenig? To Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Llanvirnian' and use_age='Arenig-Llanvirn';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cambrian-Ordovician' and l.interval_name='Cambrian-Ordovician' and use_age='Cambro-Ordovician?';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Wenlock' and use_age='Llandovery To Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tremadocian' and l.interval_name='Tremadocian' and use_age='Tremadoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoproterozoic' and l.interval_name='Early Cambrian' and use_age='Neoproterozoic Or Cambrian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Wenlock' and use_age='Late Llandovery To Mid Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tremadocian' and l.interval_name='Arenigian' and use_age='Tremadoc-Arenig';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Caradocian' and use_age='Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Paleozoic' and l.interval_name='Early Paleozoic' and use_age='Lower Palaeozoic';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Arenigian' and l.interval_name='Arenigian' and use_age='Arenig';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Paleozoic' and l.interval_name='Late Paleozoic' and use_age='Post-Devonian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Wenlock' and use_age='Late Llandovery To Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Ashgill' and l.interval_name='Llandovery' and use_age='Ashgill-Llandovery';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tremadocian' and l.interval_name='Llanvirnian' and use_age='Tremadoc-Llanvirn';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleocene' and l.interval_name='Paleocene' and use_age='Palaeocene';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Wenlock' and use_age='Llandovery - Wenlock';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llandovery' and l.interval_name='Ludlow' and use_age='Llandovery To Ludlow';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Paleozoic' and l.interval_name='Late Paleozoic' and use_age='Post-Ordovician';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Llanvirnian' and l.interval_name='Caradocian' and use_age='Llanvirn-Caradoc';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tremadocian' and l.interval_name='Arenigian' and use_age='Tremadoc To Arenig';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Paleozoic' and l.interval_name='Late Paleozoic' and use_age='Post Devonian';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Tournaisian' and l.interval_name='Visean' and use_age='Tournaisian - Lower Visean';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Neoproterozoic' and l.interval_name='Ordovician' and use_age='Neoproterozoic-Ordovician';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Ashgill' and use_age='Caradoc-Ashgill?';
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Cambrian-Ordovician' and l.interval_name='Cambrian-Ordovician' and use_age='Cambro-Ordivician?';


update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Caradocian' and l.interval_name='Caradocian' and series='Caradoc' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Mississippian' and l.interval_name='Mississippian' and series ilike 'Dinantian' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Devonian' and l.interval_name='Late Devonian' and series ilike 'Upper Devonian' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Middle Devonian' and l.interval_name='Late Devonian' and system ilike 'Devonian' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Proterozoic' and l.interval_name='Proterozoic' and system ilike 'Proterozoic' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Proterozoic' and l.interval_name='Proterozoic' and system ilike 'Proterozioic' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Proterozoic' and l.interval_name='Proterozoic' and system ilike 'Precambrian' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Paleozoic' and l.interval_name='Early Paleozoic' and system ilike 'Caledonian%' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Paleozoic' and l.interval_name='Early Paleozoic' and system ilike 'Old Red%' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Permian' and l.interval_name='Triassic' and system ilike 'Permotrias' and early_id is null and late_id is null;
update sources.ireland_100k set late_id=m.id FROM macrostrat.intervals m WHERE split_part(use_age,' and ',2) ilike m.interval_name and late_id IS NULL;
update sources.ireland_100k set early_id=m.id FROM macrostrat.intervals m WHERE split_part(use_age,' and ',1) ilike m.interval_name and early_id IS NULL;
update sources.ireland_100k set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE series ilike m.interval_name and early_id is null and late_id is null;

update sources.ireland_100k set unit_name='unknown unit' where unit_name is null;
update sources.ireland_100k set lithlegend='dolerite' where unit_name ilike 'Metadolerite' and lithlegend is null;


INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,lith,descrip,comments,t_interval,b_interval,geom) 
SELECT gid,300,trim(unit_name),trim(use_age),trim(strat_name),trim(lithlegend),trim(lithsummar),trim(lithdescri),late_id,early_id,ST_MakeValid(geom) FROM sources.ireland_100k where geom is not null;

update  sources.ireland_100k_lines set new_name=faultname;
update  sources.ireland_100k_lines set new_name=foldname;
update sources.ireland_100k_lines set new_type='dike' where descript ilike '%dyke%';
update sources.ireland_100k_lines set new_type='dike' where descript ilike '%dyke%';
update sources.ireland_100k_lines set new_type='syncline' where descript ilike '%synclin%';
update sources.ireland_100k_lines set new_type='anticline' where descript ilike '%Anticlin%';
update sources.ireland_100k_lines set new_type='fault' where descript ilike 'Fault';

INSERT INTO lines.large (orig_id,source_id,name,type,geom,new_type,new_direction)
SELECT gid,300,new_name,descript,ST_MakeValid(geom),new_type,new_direction from sources.ireland_100k_lines where new_type is not null;

pg_dump -t sources.ireland_100k -C -O burwell | gzip > ~/Desktop/ireland_100k.sql.gz
pg_dump -t sources.ireland_100k_lines -C -O burwell | gzip > ~/Desktop/ireland_100k_lines.sql.gz

# 301 az_littlehorn

ALTER TABLE sources.az_littlehorn
    ALTER COLUMN shape TYPE geometry(MultiPolygon,4326) USING ST_Transform(shape,4326);
ALTER TABLE sources.az_littlehorn_lines
    ALTER COLUMN shape TYPE geometry(MultiLineString,4326) USING ST_Transform(shape,4326);
ALTER TABLE sources.az_littlehorn_points
    ALTER COLUMN shape TYPE geometry(MultiPoint,4326) USING ST_Transform(shape,4326);

update sources.az_littlehorn set name=l.name,age=l.age,descrip=l.description from sources.az_littlehorn_units l where l.mapunit=az_littlehorn.mapunit;
update sources.az_littlehorn set lith_types=geomaterial from sources.az_littlehorn_units l where l.mapunit=az_littlehorn.mapunit;

update sources.az_littlehorn set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update sources.az_littlehorn set late_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' to ',2) ilike m.interval_name and late_id IS NULL;
update sources.az_littlehorn set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,' to ',1) ilike m.interval_name and early_id IS NULL;

update sources.az_littlehorn set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Paleoproterozoic' and l.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic' and early_id is null and late_id is null;
update sources.az_littlehorn set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Holocene' and l.interval_name='Holocene' and age ilike 'Modern' and early_id is null and late_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic to Cretaceous' and early_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic to Tertiary' and early_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Paleoproterozoic' and age ilike 'Early Proterozoic to Jurassic' and early_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Early Miocene' and age ilike 'Early to Middle Miocene' and early_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Middle Pleistocene' and age ilike 'Middle to late Pleistocene' and early_id is null;
update sources.az_littlehorn set early_id=e.id from macrostrat.intervals e where e.interval_name='Cretaceous' and age ilike ' Cretaceous to Paleogene' and early_id is null;
update sources.az_littlehorn set late_id=e.id from macrostrat.intervals e where e.interval_name='Pleistocene' and age ilike ' Pliocene to Early Quaternary' and late_id is null;
update sources.az_littlehorn set late_id=e.id from macrostrat.intervals e where e.interval_name='Pleistocene' and age ilike ' Pliocene to Early Quaternary' and late_id is null;

update sources.az_littlehorn set strat_name='Orocopia Schist' where name='Orocopia Schist';

update sources.az_littlehorn_points set dip_dir=azimuth+90;
update sources.az_littlehorn_points set dip_dir=dip_dir-360 where dip_dir>360;
update sources.az_littlehorn_points set new_type='lineation' where type='lineation';
update sources.az_littlehorn_points set new_type='fault plane' where type='fault orientation, dip direction and dip';
update sources.az_littlehorn_points set new_type='bedding' where type='bedding, strike and dip';
update sources.az_littlehorn_points set new_type='foliation' where type='foliation';
update sources.az_littlehorn_points set new_type='bedding' where type='horizontal bedding';

INSERT INTO points.points (orig_id,source_id,point_type,comments,strike,dip,dip_dir,geom) 
SELECT gid,301,new_type,type,azimuth,inclination,dip_dir,ST_MakeValid(geom) FROM sources.az_littlehorn_points where new_type is not NULL;

INSERT INTO lines.large (orig_id,source_id,type,geom,new_type,descrip)
SELECT gid,301,type,ST_MakeValid(geom),type,concat('location and existence certain') from sources.az_littlehorn_lines where type is not null;

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,comments,t_interval,b_interval,geom) 
SELECT gid,301,trim(name),trim(age),trim(strat_name),trim(descrip),trim(lith_types),late_id,early_id,ST_MakeValid(geom) FROM sources.az_littlehorn where shape is not null;

pg_dump -t sources.az_littlehorn_points -C -O burwell | gzip > ~/Desktop/az_littlehorn_points.sql.gz
pg_dump -t sources.az_littlehorn_lines -C -O burwell | gzip > ~/Desktop/az_littlehorn_lines.sql.gz
pg_dump -t sources.az_littlehorn -C -O burwell | gzip > ~/Desktop/az_littlehorn.sql.gz

# 302 wy_rockriver

update sources.wy_rockriver set late_id=m.id,early_id=m.id FROM macrostrat.intervals m WHERE age ilike m.interval_name;
update sources.wy_rockriver set late_id=m.id FROM macrostrat.intervals m WHERE split_part(age,'-',1) ilike m.interval_name and late_id IS NULL;
update sources.wy_rockriver set early_id=m.id FROM macrostrat.intervals m WHERE split_part(age,'-',2) ilike m.interval_name and early_id IS NULL;
update sources.wy_rockriver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Cretaceous' and l.interval_name='Early Cretaceous' and age ilike 'Lower Cretaceous' and early_id is null and late_id is null;
update sources.wy_rockriver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Late Cretaceous' and l.interval_name='Late Cretaceous' and age ilike 'Upper Cretaceous' and early_id is null and late_id is null;
update sources.wy_rockriver set late_id=l.id,early_id=e.id from macrostrat.intervals e, macrostrat.intervals l where e.interval_name='Early Cretaceous' and l.interval_name='Jurassic' and age ilike 'Lower Cretaceous-Jurassic';
update sources.wy_rockriver set strat_name='Arikaree Formation' where name='Arikaree Formation';
update sources.wy_rockriver set strat_name='Casper Formation' where name='Casper Formation';
update sources.wy_rockriver set strat_name='Chugwater Formation' where name='Chugwater Formation';
update sources.wy_rockriver set strat_name='Cloverly Formation' where name='Cloverly Formation';
update sources.wy_rockriver set strat_name='Cloverly Formation; Morrison Formation; Sundance Formation' where name='Cloverly, Morrison, and Sundance formations, undivided';
update sources.wy_rockriver set strat_name='Frontier Formation' where name='Frontier Formation';
update sources.wy_rockriver set strat_name='Goose Egg Formation; Chugwater formations' where name='Goose Egg and Chugwater formations, undivided';
update sources.wy_rockriver set strat_name='Goose Egg Formation' where name='Goose Egg Formation';
update sources.wy_rockriver set strat_name='Hanna Formation' where name='Hanna Formation';
update sources.wy_rockriver set strat_name='Lewis Shale' where name='Lewis Shale';
update sources.wy_rockriver set strat_name='Medicine Bow Formation' where name='Medicine Bow Formation';
update sources.wy_rockriver set strat_name='Mesaverde Formation' where name='Mesaverde Formation';
update sources.wy_rockriver set strat_name='Morrison Formation' where name='Morrison Formation';
update sources.wy_rockriver set strat_name='Mowry Shale; Muddy Sandstone; Thermopolis Shale' where name='Mowry Shale, Muddy Sandstone, and Thermopolis Shale';
update sources.wy_rockriver set strat_name='Mule Creek Granite' where name='Mule Creek granite';
update sources.wy_rockriver set strat_name='Niobrara Formation' where name='Niobrara Formation';
update sources.wy_rockriver set strat_name='Ogallala Formation' where name='Ogallala Formation';
update sources.wy_rockriver set strat_name='Pierre Shale' where name='Pierre Shale';
update sources.wy_rockriver set strat_name='Poe Mountain Anorthosite' where name='Poe Mountain anorthosite, undifferentiated';
update sources.wy_rockriver set strat_name='Steele Shale' where name='Steele Shale';
update sources.wy_rockriver set strat_name='Sundance Formation' where name='Sundance Formation';
update sources.wy_rockriver set strat_name='White River Formation' where name='White River Formation';
update sources.wy_rockriver set strat_name='Wind River Formation' where name='Wind River Formation';


INSERT INTO lines.large (orig_id,source_id,type,name,geom,new_type,descrip)
SELECT gid,302,type,label,ST_MakeValid(geom),type,concat('location and existence certain') from sources.wy_rockriver_lines where type is not null;

INSERT INTO maps.large (orig_id,source_id,name,age,strat_name,descrip,comments,t_interval,b_interval,geom) 
SELECT gid,302,trim(fullname),trim(age),trim(strat_name),trim(descr),trim(geomat),late_id,early_id,ST_MakeValid(geom) FROM sources.wy_rockriver where geom is not null;

pg_dump -t sources.wy_rockriver -C -O burwell | gzip > ~/Desktop/wy_rockriver.sql.gz
pg_dump -t sources.wy_rockriver_lines -C -O burwell | gzip > ~/Desktop/wy_rockriver_lines.sql.gz


################# inspection query
select distinct early_id,late_id,e.interval_name early,l.interval_name, use_age from sources.south_america JOIN macrostrat.intervals e ON e.id=early_id JOIN macrostrat.intervals l on l.id=late_id;

#import on steno query
gunzip -c ~/Desktop/az_whitehills.sql.gz | psql burwell -U john
gunzip -c ~/Desktop/ellesmere.sql.gz | psql -U john burwell

select source_id,name,primary_table,scale from maps.sources where source_id NOT IN (select source_id from maps.legend where unit_ids is not null);

## fix bad ages (zero duration and negative duration legend_ids)
update maps.small set b_interval=268,t_interval=267 where b_interval=267 and t_interval=268;
update maps.legend set b_interval=268,t_interval=267,best_age_bottom=1600,best_age_top=1200 where b_interval=267 and t_interval=268;

update maps.tiny set b_interval=105,t_interval=94 where b_interval=94 and t_interval=105;
update maps.medium set b_interval=105,t_interval=94 where b_interval=94 and t_interval=105;
update maps.legend set b_interval=105,t_interval=94,best_age_bottom=443.8,best_age_top=358.9 where b_interval=94 and t_interval=105 and best_age_top=best_age_bottom;

# found large number of these so had to fix them with more complex update
update maps.medium set b_interval=l.t_interval, t_interval=l.b_interval FROM maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=medium.map_id and l.best_age_bottom<=l.best_age_top;
update maps.large set b_interval=l.t_interval, t_interval=l.b_interval FROM maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=large.map_id and l.best_age_bottom<=l.best_age_top;
update maps.tiny set b_interval=l.t_interval, t_interval=l.b_interval FROM maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=tiny.map_id and l.best_age_bottom<=l.best_age_top;

select medium.* from maps.medium, maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=medium.map_id and l.best_age_bottom<=l.best_age_top;
select large.* from maps.large, maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=large.map_id and l.best_age_bottom<=l.best_age_top;
select tiny.* from maps.tiny, maps.legend l, maps.map_legend ml WHERE l.legend_id=ml.legend_id and ml.map_id=tiny.map_id and l.best_age_bottom<=l.best_age_top;

update maps.legend set b_interval=t_interval,t_interval=b_interval where best_age_bottom<=best_age_top;
update maps.legend set best_age_bottom=e.age_bottom,best_age_top=l.age_top FROM macrostrat.intervals l, macrostrat.intervals e where e.id=b_interval and l.id=t_interval and best_age_bottom<=best_age_top;



####### update legend areas: must do scales separately #######
WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN carto_new.large USING (map_id) group by legend.legend_id)
update maps.legend  set large_area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN carto_new.medium USING (map_id) group by legend.legend_id)
update maps.legend  set medium_area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN carto_new.small USING (map_id) group by legend.legend_id)
update maps.legend  set small_area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN carto_new.tiny USING (map_id) group by legend.legend_id)
update maps.legend  set tiny_area=a from legend_areas where legend.legend_id=legend_areas.legend_id;


WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN maps.tiny USING (map_id) group by legend.legend_id)
update maps.legend  set area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN maps.small USING (map_id) group by legend.legend_id)
update maps.legend  set area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN maps.medium USING (map_id) group by legend.legend_id)
update maps.legend  set area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

WITH legend_areas AS (select legend.legend_id,sum(ST_Area(geom::geography)/1000000) a from maps.legend JOIN maps.map_legend USING (legend_id) JOIN maps.large USING (map_id) group by legend.legend_id)
update maps.legend  set area=a from legend_areas where legend.legend_id=legend_areas.legend_id;

update maps.legend set large_area=round(large_area,3);
update maps.legend set medium_area=round(medium_area,3);
update maps.legend set small_area=round(small_area,3);
update maps.legend set tiny_area=round(tiny_area,3);
update maps.legend set area=round(area,3);


select legend.legend_id,sum(ST_Area(geom::geography)/1000000)  from maps.legend JOIN maps.map_legend USING (legend_id) JOIN carto_new.large USING (map_id) group by legend.legend_id

#gdb 
ogr2ogr -f "PostgreSQL" PG:"host=localhost port=5432 dbname=burwell" gmsa2019.gdb -nlt PROMOTE_TO_MULTI -nln sources.south_america CU -overwrite

ogr2ogr -f "PostgreSQL" PG:"host=localhost port=5432 dbname=burwell" LittleHornMtn.gdb -nlt PROMOTE_TO_MULTI -nln sources.az_littlehorn DescriptionOfMapUnits -overwrite
ALTER TABLE az_littlehorn
    ALTER COLUMN geom TYPE geometry(MultiPolygon,4326) USING ST_Transform(geom,4326);

# kill and restart postgres to deal with hang rgeom.py
pg_ctlcluster 10 main status
pg_lsclusters
sudo pg_ctlcluster 10 main status
sudo pg_ctlcluster -f 10 main restart
